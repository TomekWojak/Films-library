import{getData,createBrowsePage,createMainHeroSection,showErrorPopup,showBigLoader,hideBigLoader,createFilmSlider,createFooter,closeAllNotClicked,createFourCategories}from"./components.min.js";document.addEventListener("DOMContentLoaded",function(){const e={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNTYwZjM4MjU3NDQ1ZGE1ZGZkYTYxYzE0YWM4YmM4MyIsIm5iZiI6MTc1OTc2NTAzOC45NCwic3ViIjoiNjhlM2UyMmUyNjY5NzY4MzhlYzI3NzI5Iiwic2NvcGVzIjpbImFwaV9yZWFkIl0sInZlcnNpb24iOjF9.nuGfEjclJLepmzzHi2omNhp29THgrJf9Nv6D4_gTdxA"}},t=new Map;let r,o=1e4,a=0;const n=new Date,i=`https://api.themoviedb.org/3/discover/movie?primary_release_year=2025&primary_release_date.gte=${n.getFullYear()}-${n.getMonth()+1}-${n.getDate()}&sort_by=popularity.desc\n`,s="&page=",c=async(t,...r)=>{const o=[];for await(const a of r){const r=a+t+s+1,n=await fetch(r,e),i=await n.json();o.push(i)}return console.log(o),o},l=async(t,r,o)=>{const a=o+t+s+r;try{const t=await fetch(a,e);return await t.json()}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},d=async(e,t)=>{const r=[];for(let o=1;o<=t;o++)r.push(l(e,o,"https://api.themoviedb.org/3/movie/popular?with_origin_country=US|GB|CA&language="));try{return await Promise.all(r)}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},w=async(e,t)=>{try{const r=await e(t,5),o=Math.trunc(20*Math.random()),a=r.map(e=>e.results[o]);return console.log(a),a}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}},h=(e,t)=>{const r=e.querySelector(".browse-main__images"),o=r.querySelectorAll(".browse-main__img-box"),n=e.querySelector(".browse-main__carousell-controls");o.forEach(e=>e.classList.remove("currentVisible")),r.style.transform=`translateX(${100*-a}%)`,u(a,n),o[a].classList.add("currentVisible"),a++,a>t.length-1&&(a=0),b(e)},u=(e,r)=>{const o=r.querySelectorAll(".browse-main__btn"),a=r.querySelector(`.browse-main__btn[data-img="${e}"]`),n=a.querySelector(".browse-main__progress-bar"),i=r.querySelectorAll(".browse-main__progress-bar");t.forEach(e=>clearInterval(e)),t.clear(),i.forEach(e=>e.style.width="0"),g(n,e),o.forEach(e=>e.classList.remove("active")),a.classList.add("active")},g=(e,r)=>{t.has(r)&&clearInterval(t.get(r));let o=0;const a=setInterval(()=>{o+=2,e.style.width=`${o}%`,o>=100&&(e.style.width="0",clearInterval(a),t.delete(r))},200);t.set(r,a)},m=(e,t)=>{t.querySelector(".browse-main__carousell-controls").addEventListener("click",n=>{if(n.target.matches(".browse-main__btn")){if(n.target.classList.contains("active"))return;clearInterval(r);const i=n.target,s=parseInt(i.dataset.img);a=s,h(t,e),r=setInterval(()=>{h(t,e)},o)}})},b=e=>{e.querySelectorAll(".browse-main__img-box").forEach(e=>{const t=e.classList.contains("currentVisible")?0:-1;p(e,t,0===t?"visible":"hidden")})},p=(e,t,r)=>{const o=e.querySelector(".browse-main__trailer-btn"),a=e.querySelector(".browse-main__see-more-btn");o.setAttribute("tabindex",t),a.setAttribute("tabindex",t),o.style.visibility=r,a.style.visibility=r};let y,_,v,f;const S=(e,t)=>{const n=Math.abs(y-_),i=Math.abs(v-f);n<30||i>30||(_-y>30?(a=(a-2+t.length)%t.length,h(e,t)):y-_>30&&h(e,t),clearInterval(r),r=setInterval(()=>{h(e,t)},o))},E=(e,t)=>{const r=e.querySelector(".browse-main__images");r.addEventListener("touchstart",e=>{(e=>{y=e.touches[0].clientX,v=e.touches[0].clientY})(e)}),r.addEventListener("touchend",r=>{((e,t,r)=>{_=e.changedTouches[0].clientX,f=e.changedTouches[0].clientY,S(t,r)})(r,e,t)})},I=(e,t)=>{e.dataset.index=t},L=e=>{const t=(()=>{let e=2;return window.innerWidth>576&&window.innerWidth<992&&(e=1),window.innerWidth>=992&&window.innerWidth<1200&&(e=4),e})();let r=e.dataset.index;const o=e.querySelector(".browse-section__slider-images"),a=e.querySelector(".browse-section__slider-box");if(!a)return;const n=a.offsetWidth;o.style.transform=`translateX(${-r*n*t}px)`},q=(e,t)=>{let r=0===t?parseInt(e.dataset.index):0;r>=(()=>{let e;return window.innerWidth<576&&(e=9),window.innerWidth>=576&&window.innerWidth<992&&(e=17),window.innerWidth>=992&&window.innerWidth<1200&&(e=4),window.innerWidth>=1200&&(e=7),e})()||(r++,I(e,r),L(e))},N=e=>{e.querySelectorAll(".browse-section__slider").forEach(e=>e.addEventListener("click",t=>{t.target.matches(".browse-section__slider-next-btn")?q(e,0):t.target.matches(".browse-section__slider-prev-btn")&&((e,t)=>{let r=0===t?parseInt(e.dataset.index):0;r<=0||(r--,I(e,r),L(e))})(e,0)}))};let M=window.innerWidth;window.addEventListener("resize",()=>{if(window.innerWidth===M)return;M=window.innerWidth;document.querySelectorAll(".browse-section__slider").forEach(e=>{const t=e.querySelector(".browse-section__slider-images");I(e,0),t.style.transform="translateX(0)"})}),window.addEventListener("unload",()=>{clearInterval(r),t.forEach(e=>clearInterval(e)),t.clear()}),window.addEventListener("click",e=>{closeAllNotClicked(e)}),(async()=>{const e=getData(),t=e?.translations,a=e?.preferredLanguage,n=e?.loggedIn,s=document.querySelector(".container"),l=e?.currentProfile;if(e&&n&&l){s.prepend(createBrowsePage(t)),s.append(showBigLoader());try{const e=await w(d,a);createMainHeroSection(e,t,s),h(s,e),r=setInterval(()=>h(s,e),o),m(e,s),E(s,e);const n=await c(a,"https://api.themoviedb.org/3/movie/upcoming?language=","https://api.themoviedb.org/3/trending/all/week?language=","https://api.themoviedb.org/3/discover/tv?with_origin_country=US|GB&language=&sort_by=popularity.desc\n",i),l=document.querySelector("main");l||showErrorPopup(t.browsePage.loadingDataError,"#dc4a34"),l.append(createFourCategories(t),createFilmSlider(n,t,1,t.browseSection.sectionNames.trending),createFilmSlider(n,t,0,t.browseSection.sectionNames.upcoming),createFilmSlider(n,t,2,t.browseSection.sectionNames.topRatedSeries),createFilmSlider(n,t,3,t.browseSection.sectionNames.futureFilms)),N(s),s.append(createFooter(t))}catch{showErrorPopup(t.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}}else window.location.href="/"})()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi1wYWdlLm1pbi5qcyIsIm5hbWVzIjpbImdldERhdGEiLCJjcmVhdGVCcm93c2VQYWdlIiwiY3JlYXRlTWFpbkhlcm9TZWN0aW9uIiwic2hvd0Vycm9yUG9wdXAiLCJzaG93QmlnTG9hZGVyIiwiaGlkZUJpZ0xvYWRlciIsImNyZWF0ZUZpbG1TbGlkZXIiLCJjcmVhdGVGb290ZXIiLCJjbG9zZUFsbE5vdENsaWNrZWQiLCJjcmVhdGVGb3VyQ2F0ZWdvcmllcyIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9wdGlvbnMiLCJtZXRob2QiLCJoZWFkZXJzIiwiYWNjZXB0IiwiQXV0aG9yaXphdGlvbiIsInByb2dyZXNzQmFySW50ZXJ2YWxzIiwiTWFwIiwiY2Fyb3VzZWxsSW50ZXJ2YWwiLCJjYXJvdXNlbGxTcGVlZCIsImluZGV4IiwiY3VycmVudERhdGUiLCJEYXRlIiwiVVBDT01JTkdfRklMTVMiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsIkZJTE1TX1BBR0VTX0FNT1VOVCIsImdldEFsbEZpbG1zIiwiYXN5bmMiLCJsYW5nIiwidXJscyIsImZpbG1zQXJyIiwidXJsIiwiVVJMIiwicmVzcG9uc2UiLCJmZXRjaCIsImRhdGEiLCJqc29uIiwicHVzaCIsImNvbnNvbGUiLCJsb2ciLCJnZXRGaWxtcyIsInBhZ2VOdW0iLCJ0cmFuc2xhdGlvbnMiLCJicm93c2VQYWdlIiwibG9hZGluZ0RhdGFFcnJvciIsImxvYWRGaWxtc1RvQ2Fyb3VzZWxsIiwicmVxdWVzdHMiLCJpIiwiUHJvbWlzZSIsImFsbCIsImNob29zZUZpbG1zVG9DYXJvdXNlbGwiLCJjdXJyZW50TGFuZ3VhZ2UiLCJwYWdlc0RhdGEiLCJyYW5kb21OdW1iZXIiLCJNYXRoIiwidHJ1bmMiLCJyYW5kb20iLCJjaG9vc2VuTW92aWVzIiwibWFwIiwicGFnZSIsInJlc3VsdHMiLCJoYW5kbGVGaWxtc0Nhcm91c2VsbCIsImNvbnRhaW5lciIsIm1vdmllcyIsImltYWdlU2xpZGVyIiwicXVlcnlTZWxlY3RvciIsImFsbEltYWdlcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjYXJvdXNlbGxDb250cm9scyIsImZvckVhY2giLCJpbWciLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJzdHlsZSIsInRyYW5zZm9ybSIsImhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUiLCJhZGQiLCJsZW5ndGgiLCJoYW5kbGVCdG5zVmlzaWJpbGl0eSIsImNhcm91c2VsbENvbnRyb2xzQm94IiwiYWxsQ29udHJvbEJ0bnMiLCJjdXJyZW50QnRuIiwicHJvZ3Jlc3NCYXIiLCJhbGxQcm9ncmVzc0JhcnMiLCJpbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJjbGVhciIsImJhciIsIndpZHRoIiwiY2hhbmdlUHJvZ3Jlc3NCYXIiLCJidG4iLCJidG5JbmRleCIsImhhcyIsImdldCIsInByb2dyZXNzQmFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImRlbGV0ZSIsInNldCIsImNoYW5nZUN1cnJlbnRJbWciLCJlIiwidGFyZ2V0IiwibWF0Y2hlcyIsImNvbnRhaW5zIiwiaW1nRGF0YSIsInBhcnNlSW50IiwiZGF0YXNldCIsImZpbG0iLCJ0YWJpbmRleCIsImdpdmVCdG5zQXR0cmlidXRlIiwidmlzaWJpbGl0eSIsInRyYWlsZXJCdG4iLCJzZWVNb3JlQnRuIiwic2V0QXR0cmlidXRlIiwic3RhcnRYIiwiZW5kWCIsInN0YXJ0WSIsImVuZFkiLCJoYW5kbGVTd2lwZSIsImhvcml6b250YWxEaXN0YW5jZSIsImFicyIsInZlcnRpY2FsRGlzdGFuY2UiLCJzZXRUb3VjaEV2ZW50TGlzdGVuZXIiLCJ0b3VjaGVzIiwiY2xpZW50WCIsImNsaWVudFkiLCJoYW5kbGVUb3VjaFN0YXJ0RXZlbnQiLCJjaGFuZ2VkVG91Y2hlcyIsImhhbmRsZVRvdWNoRW5kRXZlbnQiLCJjaGFuZ2VDYXJvdXNlbGxEYXRhSW5kZXgiLCJzbGlkZXIiLCJtb3ZlU2xpZGVyIiwidGhyZXNob2xkIiwid2luZG93IiwiaW5uZXJXaWR0aCIsInNldFRocmVzaG9sZCIsInNsaWRlckRhdGFzZXQiLCJzbGlkZXJDYXJvdXNlbGwiLCJwb3N0ZXIiLCJwb3N0ZXJXaWR0aCIsIm9mZnNldFdpZHRoIiwic2hvd05leHRTbGlkZSIsImluaXRpYWxJbmRleCIsIm1heEluZGV4IiwiZ2V0Q2Fyb3VzZWxDb25maWciLCJwcmVwYXJlQ2Fyb3VzZWxJdGVtcyIsInNob3dQcmV2U2xpZGUiLCJsYXN0V2lkdGgiLCJ1c2VyRGF0YSIsInByZWZlcnJlZExhbmd1YWdlIiwiaXNMb2dnZWRJbiIsImxvZ2dlZEluIiwiY3VycmVudFByb2ZpbGUiLCJwcmVwZW5kIiwiYXBwZW5kIiwiZmlsbXMiLCJtYWluIiwiYnJvd3NlU2VjdGlvbiIsInNlY3Rpb25OYW1lcyIsInRyZW5kaW5nIiwidXBjb21pbmciLCJ0b3BSYXRlZFNlcmllcyIsImZ1dHVyZUZpbG1zIiwibG9jYXRpb24iLCJocmVmIiwiY2hlY2tBdXRob3JpemF0aW9uIl0sInNvdXJjZXMiOlsibWFpbi1wYWdlLmpzIl0sIm1hcHBpbmdzIjoiT0FDQ0EsUUFDQUMsaUJBQ0FDLHNCQUNBQyxlQUNBQyxjQUNBQyxjQUNBQyxpQkFDQUMsYUFDQUMsbUJBQ0FDLHlCQUNNLHNCQUNQQyxTQUFTQyxpQkFBaUIsbUJBQW9CLFdBQzdDLE1BR01DLEVBQVUsQ0FDZkMsT0FBUSxNQUNSQyxRQUFTLENBQ1JDLE9BQVEsbUJBQ1JDLGNBQ0MseVBBR0dDLEVBQXVCLElBQUlDLElBQ2pDLElBS0lDLEVBTEFDLEVBQWlCLElBSWpCQyxFQUFRLEVBR1osTUFLTUMsRUFBYyxJQUFJQyxLQUNsQkMsRUFBaUIsa0dBQWtHRixFQUFZRyxpQkFDcElILEVBQVlJLFdBQWEsS0FDdEJKLEVBQVlLLHNDQUdWQyxFQUFxQixTQXFGckJDLEVBQWNDLE1BQU9DLEtBQVNDLEtBQ25DLE1BQU1DLEVBQVcsR0FDakIsVUFBVyxNQUFNQyxLQUFPRixFQUFNLENBQzdCLE1BQU1HLEVBQ0xELEVBQU1ILEVBQU9ILEVBckh3QixFQXNIaENRLFFBQWlC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NEMsSUFDbkNvQixFQUFVMkYsT0FBT3hKLGlCQUVqQixJQUNDLE1BQU04RCxRQUFlYixFQUNwQkwsRUFDQU0sR0FHRHBELHNCQUFzQmdFLEVBQVFyQixFQUFjb0IsR0FDNUNELEVBQXFCQyxFQUFXQyxHQUVoQy9DLEVBQW9CK0UsWUFDbkIsSUFBTWxDLEVBQXFCQyxFQUFXQyxHQUN0QzlDLEdBR0RpRixFQUFpQm5DLEVBQVFELEdBQ3pCMkQsRUFBc0IzRCxFQUFXQyxHQUVqQyxNQUFNMkYsUUFBY2hJLEVBQ25CeUIsRUE5Q3lCLHdEQUNELDJEQUNLLHlHQWdEN0I5QixHQUdLc0ksRUFBT3BKLFNBQVMwRCxjQUFjLFFBRS9CMEYsR0FDSjNKLGVBQWUwQyxFQUFhQyxXQUFXQyxpQkFBa0IsV0FHMUQrRyxFQUFLRixPQUNKbkoscUJBQXFCb0MsR0FDckJ2QyxpQkFDQ3VKLEVBQ0FoSCxFQUNBLEVBQ0FBLEVBQWFrSCxjQUFjQyxhQUFhQyxVQUV6QzNKLGlCQUNDdUosRUFDQWhILEVBQ0EsRUFDQUEsRUFBYWtILGNBQWNDLGFBQWFFLFVBRXpDNUosaUJBQ0N1SixFQUNBaEgsRUFDQSxFQUNBQSxFQUFha0gsY0FBY0MsYUFBYUcsZ0JBRXpDN0osaUJBQ0N1SixFQUNBaEgsRUFDQSxFQUNBQSxFQUFha0gsY0FBY0MsYUFBYUksY0FHMUNqQixFQUFxQmxGLEdBQ3JCQSxFQUFVMkYsT0FBT3JKLGFBQWFzQyxHQUMvQixDQUFFLE1BQ0QxQyxlQUFlMEMsRUFBYUMsV0FBV0MsaUJBQWtCLFVBQzFELENBQUUsUUFDRDFDLGVBQ0QsQ0FyRUEsTUFGQ2tJLE9BQU84QixTQUFTQyxLQUFPLEtBcVl6QkMsRUFDRCIsImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG5cdGdldERhdGEsXHJcblx0Y3JlYXRlQnJvd3NlUGFnZSxcclxuXHRjcmVhdGVNYWluSGVyb1NlY3Rpb24sXHJcblx0c2hvd0Vycm9yUG9wdXAsXHJcblx0c2hvd0JpZ0xvYWRlcixcclxuXHRoaWRlQmlnTG9hZGVyLFxyXG5cdGNyZWF0ZUZpbG1TbGlkZXIsXHJcblx0Y3JlYXRlRm9vdGVyLFxyXG5cdGNsb3NlQWxsTm90Q2xpY2tlZCxcclxuXHRjcmVhdGVGb3VyQ2F0ZWdvcmllcyxcclxufSBmcm9tIFwiLi9jb21wb25lbnRzLm1pbi5qc1wiO1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XHJcblx0Y29uc3QgQ0FST1VTRUxMX0xFTkdUSCA9IDU7XHJcblx0Y29uc3QgRklMTV9BTU9VTlRfUEVSX1BBR0UgPSAyMDtcclxuXHRjb25zdCBQQUdFX1RPX1NIT1dfT05fU01BTExfQ0FST1VTRUxTID0gMTtcclxuXHRjb25zdCBvcHRpb25zID0ge1xyXG5cdFx0bWV0aG9kOiBcIkdFVFwiLFxyXG5cdFx0aGVhZGVyczoge1xyXG5cdFx0XHRhY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG5cdFx0XHRBdXRob3JpemF0aW9uOlxyXG5cdFx0XHRcdFwiQmVhcmVyIGV5SmhiR2NpT2lKSVV6STFOaUo5LmV5SmhkV1FpT2lJek5UWXdaak00TWpVM05EUTFaR0UxWkdaa1lUWXhZekUwWVdNNFltTTRNeUlzSW01aVppSTZNVGMxT1RjMk5UQXpPQzQ1TkN3aWMzVmlJam9pTmpobE0yVXlNbVV5TmpZNU56WTRNemhsWXpJM056STVJaXdpYzJOdmNHVnpJanBiSW1Gd2FWOXlaV0ZrSWwwc0luWmxjbk5wYjI0aU9qRjkubnVHZkVqY2xKTGVwbXp6SGkyb21OaHAyOVRIZ3JKZjlOdjZENF9nVGR4QVwiLFxyXG5cdFx0fSxcclxuXHR9O1xyXG5cdGNvbnN0IHByb2dyZXNzQmFySW50ZXJ2YWxzID0gbmV3IE1hcCgpO1xyXG5cdGxldCBjYXJvdXNlbGxTcGVlZCA9IDEwMDAwO1xyXG5cdGxldCBjYXJvdXNlbGxTdHJva2VSYW5nZSA9IDI7XHJcblx0bGV0IGludGVydmFsU3BlZWQgPSAoY2Fyb3VzZWxsU3BlZWQgKiBjYXJvdXNlbGxTdHJva2VSYW5nZSkgLyAxMDA7XHJcblx0bGV0IGNhcm91c2VsbFdpZHRoID0gMTAwO1xyXG5cdGxldCBpbmRleCA9IDA7XHJcblx0bGV0IGNhcm91c2VsbEludGVydmFsO1xyXG5cclxuXHRjb25zdCBQT1BVTEFSX0ZJTE1TX1VSTCA9IGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllL3BvcHVsYXI/d2l0aF9vcmlnaW5fY291bnRyeT1VU3xHQnxDQSZsYW5ndWFnZT1gO1xyXG5cdGNvbnN0IEhPVF9SQVRFRF9GSUxNU19VUkwgPSBgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9tb3ZpZS91cGNvbWluZz9sYW5ndWFnZT1gO1xyXG5cdGNvbnN0IFRSRU5ESU5HX0ZJTE1TX1VSTCA9IGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL3RyZW5kaW5nL2FsbC93ZWVrP2xhbmd1YWdlPWA7XHJcblx0Y29uc3QgVE9QX1JBVEVEX1RWX1NFUklFU19VUkwgPSBgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9kaXNjb3Zlci90dj93aXRoX29yaWdpbl9jb3VudHJ5PVVTfEdCJmxhbmd1YWdlPSZzb3J0X2J5PXBvcHVsYXJpdHkuZGVzY1xyXG5gO1xyXG5cdGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcclxuXHRjb25zdCBVUENPTUlOR19GSUxNUyA9IGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL2Rpc2NvdmVyL21vdmllP3ByaW1hcnlfcmVsZWFzZV95ZWFyPTIwMjUmcHJpbWFyeV9yZWxlYXNlX2RhdGUuZ3RlPSR7Y3VycmVudERhdGUuZ2V0RnVsbFllYXIoKX0tJHtcclxuXHRcdGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxXHJcblx0fS0ke2N1cnJlbnREYXRlLmdldERhdGUoKX0mc29ydF9ieT1wb3B1bGFyaXR5LmRlc2NcclxuYDtcclxuXHJcblx0Y29uc3QgRklMTVNfUEFHRVNfQU1PVU5UID0gYCZwYWdlPWA7XHJcblxyXG5cdGNvbnN0IGNoZWNrQXV0aG9yaXphdGlvbiA9IGFzeW5jICgpID0+IHtcclxuXHRcdGNvbnN0IHVzZXJEYXRhID0gZ2V0RGF0YSgpO1xyXG5cdFx0Y29uc3QgdHJhbnNsYXRpb25zID0gdXNlckRhdGE/LnRyYW5zbGF0aW9ucztcclxuXHRcdGNvbnN0IGN1cnJlbnRMYW5ndWFnZSA9IHVzZXJEYXRhPy5wcmVmZXJyZWRMYW5ndWFnZTtcclxuXHRcdGNvbnN0IGlzTG9nZ2VkSW4gPSB1c2VyRGF0YT8ubG9nZ2VkSW47XHJcblx0XHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhaW5lclwiKTtcclxuXHRcdGNvbnN0IGN1cnJlbnRQcm9maWxlID0gdXNlckRhdGE/LmN1cnJlbnRQcm9maWxlO1xyXG5cclxuXHRcdGlmICghdXNlckRhdGEgfHwgIWlzTG9nZ2VkSW4gfHwgIWN1cnJlbnRQcm9maWxlKSB7XHJcblx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvXCI7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRjb250YWluZXIucHJlcGVuZChjcmVhdGVCcm93c2VQYWdlKHRyYW5zbGF0aW9ucykpO1xyXG5cdFx0Y29udGFpbmVyLmFwcGVuZChzaG93QmlnTG9hZGVyKCkpO1xyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IG1vdmllcyA9IGF3YWl0IGNob29zZUZpbG1zVG9DYXJvdXNlbGwoXHJcblx0XHRcdFx0bG9hZEZpbG1zVG9DYXJvdXNlbGwsXHJcblx0XHRcdFx0Y3VycmVudExhbmd1YWdlXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRjcmVhdGVNYWluSGVyb1NlY3Rpb24obW92aWVzLCB0cmFuc2xhdGlvbnMsIGNvbnRhaW5lcik7XHJcblx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHJcblx0XHRcdGNhcm91c2VsbEludGVydmFsID0gc2V0SW50ZXJ2YWwoXHJcblx0XHRcdFx0KCkgPT4gaGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpLFxyXG5cdFx0XHRcdGNhcm91c2VsbFNwZWVkXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRjaGFuZ2VDdXJyZW50SW1nKG1vdmllcywgY29udGFpbmVyKTtcclxuXHRcdFx0c2V0VG91Y2hFdmVudExpc3RlbmVyKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHJcblx0XHRcdGNvbnN0IGZpbG1zID0gYXdhaXQgZ2V0QWxsRmlsbXMoXHJcblx0XHRcdFx0Y3VycmVudExhbmd1YWdlLFxyXG5cdFx0XHRcdEhPVF9SQVRFRF9GSUxNU19VUkwsXHJcblx0XHRcdFx0VFJFTkRJTkdfRklMTVNfVVJMLFxyXG5cdFx0XHRcdFRPUF9SQVRFRF9UVl9TRVJJRVNfVVJMLFxyXG5cdFx0XHRcdFVQQ09NSU5HX0ZJTE1TXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XHJcblxyXG5cdFx0XHRpZiAoIW1haW4pIHtcclxuXHRcdFx0XHRzaG93RXJyb3JQb3B1cCh0cmFuc2xhdGlvbnMuYnJvd3NlUGFnZS5sb2FkaW5nRGF0YUVycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdG1haW4uYXBwZW5kKFxyXG5cdFx0XHRcdGNyZWF0ZUZvdXJDYXRlZ29yaWVzKHRyYW5zbGF0aW9ucyksXHJcblx0XHRcdFx0Y3JlYXRlRmlsbVNsaWRlcihcclxuXHRcdFx0XHRcdGZpbG1zLFxyXG5cdFx0XHRcdFx0dHJhbnNsYXRpb25zLFxyXG5cdFx0XHRcdFx0MSxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucy5icm93c2VTZWN0aW9uLnNlY3Rpb25OYW1lcy50cmVuZGluZ1xyXG5cdFx0XHRcdCksXHJcblx0XHRcdFx0Y3JlYXRlRmlsbVNsaWRlcihcclxuXHRcdFx0XHRcdGZpbG1zLFxyXG5cdFx0XHRcdFx0dHJhbnNsYXRpb25zLFxyXG5cdFx0XHRcdFx0MCxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucy5icm93c2VTZWN0aW9uLnNlY3Rpb25OYW1lcy51cGNvbWluZ1xyXG5cdFx0XHRcdCksXHJcblx0XHRcdFx0Y3JlYXRlRmlsbVNsaWRlcihcclxuXHRcdFx0XHRcdGZpbG1zLFxyXG5cdFx0XHRcdFx0dHJhbnNsYXRpb25zLFxyXG5cdFx0XHRcdFx0MixcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucy5icm93c2VTZWN0aW9uLnNlY3Rpb25OYW1lcy50b3BSYXRlZFNlcmllc1xyXG5cdFx0XHRcdCksXHJcblx0XHRcdFx0Y3JlYXRlRmlsbVNsaWRlcihcclxuXHRcdFx0XHRcdGZpbG1zLFxyXG5cdFx0XHRcdFx0dHJhbnNsYXRpb25zLFxyXG5cdFx0XHRcdFx0MyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucy5icm93c2VTZWN0aW9uLnNlY3Rpb25OYW1lcy5mdXR1cmVGaWxtc1xyXG5cdFx0XHRcdClcclxuXHRcdFx0KTtcclxuXHRcdFx0cHJlcGFyZUNhcm91c2VsSXRlbXMoY29udGFpbmVyKTtcclxuXHRcdFx0Y29udGFpbmVyLmFwcGVuZChjcmVhdGVGb290ZXIodHJhbnNsYXRpb25zKSk7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fSBmaW5hbGx5IHtcclxuXHRcdFx0aGlkZUJpZ0xvYWRlcigpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdGNvbnN0IGdldEFsbEZpbG1zID0gYXN5bmMgKGxhbmcsIC4uLnVybHMpID0+IHtcclxuXHRcdGNvbnN0IGZpbG1zQXJyID0gW107XHJcblx0XHRmb3IgYXdhaXQgKGNvbnN0IHVybCBvZiB1cmxzKSB7XHJcblx0XHRcdGNvbnN0IFVSTCA9XHJcblx0XHRcdFx0dXJsICsgbGFuZyArIEZJTE1TX1BBR0VTX0FNT1VOVCArIFBBR0VfVE9fU0hPV19PTl9TTUFMTF9DQVJPVVNFTFM7XHJcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goVVJMLCBvcHRpb25zKTtcclxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuXHJcblx0XHRcdGZpbG1zQXJyLnB1c2goZGF0YSk7XHJcblx0XHR9XHJcblx0XHRjb25zb2xlLmxvZyhmaWxtc0Fycik7XHJcblx0XHRyZXR1cm4gZmlsbXNBcnI7XHJcblx0fTtcclxuXHRjb25zdCBnZXRGaWxtcyA9IGFzeW5jIChsYW5nLCBwYWdlTnVtLCB1cmwpID0+IHtcclxuXHRcdGNvbnN0IFVSTCA9IHVybCArIGxhbmcgKyBGSUxNU19QQUdFU19BTU9VTlQgKyBwYWdlTnVtO1xyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goVVJMLCBvcHRpb25zKTtcclxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuXHJcblx0XHRcdHJldHVybiBkYXRhO1xyXG5cdFx0fSBjYXRjaCB7XHJcblx0XHRcdHNob3dFcnJvclBvcHVwKHRyYW5zbGF0aW9ucy5icm93c2VQYWdlLmxvYWRpbmdEYXRhRXJyb3IsIFwiI2RjNGEzNFwiKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRjb25zdCBsb2FkRmlsbXNUb0Nhcm91c2VsbCA9IGFzeW5jIChsYW5nLCBwYWdlTnVtKSA9PiB7XHJcblx0XHRjb25zdCByZXF1ZXN0cyA9IFtdO1xyXG5cclxuXHRcdGZvciAobGV0IGkgPSAxOyBpIDw9IHBhZ2VOdW07IGkrKykge1xyXG5cdFx0XHRyZXF1ZXN0cy5wdXNoKGdldEZpbG1zKGxhbmcsIGksIFBPUFVMQVJfRklMTVNfVVJMKSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwocmVxdWVzdHMpO1xyXG5cdFx0XHRyZXR1cm4gcmVzcG9uc2VzO1xyXG5cdFx0fSBjYXRjaCB7XHJcblx0XHRcdHNob3dFcnJvclBvcHVwKHRyYW5zbGF0aW9ucy5icm93c2VQYWdlLmxvYWRpbmdEYXRhRXJyb3IsIFwiI2RjNGEzNFwiKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRjb25zdCBjaG9vc2VGaWxtc1RvQ2Fyb3VzZWxsID0gYXN5bmMgKGRhdGEsIGN1cnJlbnRMYW5ndWFnZSkgPT4ge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgcGFnZXNEYXRhID0gYXdhaXQgZGF0YShjdXJyZW50TGFuZ3VhZ2UsIENBUk9VU0VMTF9MRU5HVEgpO1xyXG5cdFx0XHRjb25zdCByYW5kb21OdW1iZXIgPSBNYXRoLnRydW5jKE1hdGgucmFuZG9tKCkgKiBGSUxNX0FNT1VOVF9QRVJfUEFHRSk7XHJcblx0XHRcdGNvbnN0IGNob29zZW5Nb3ZpZXMgPSBwYWdlc0RhdGEubWFwKChwYWdlKSA9PiBwYWdlLnJlc3VsdHNbcmFuZG9tTnVtYmVyXSk7XHJcblx0XHRcdGNvbnNvbGUubG9nKGNob29zZW5Nb3ZpZXMpO1xyXG5cdFx0XHRyZXR1cm4gY2hvb3Nlbk1vdmllcztcclxuXHRcdH0gY2F0Y2gge1xyXG5cdFx0XHRzaG93RXJyb3JQb3B1cCh0cmFuc2xhdGlvbnMuYnJvd3NlUGFnZS5sb2FkaW5nRGF0YUVycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHR9IGZpbmFsbHkge1xyXG5cdFx0XHRoaWRlQmlnTG9hZGVyKCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0Ly8gQ0FST1VTRUxMXHJcblxyXG5cdGNvbnN0IGhhbmRsZUZpbG1zQ2Fyb3VzZWxsID0gKGNvbnRhaW5lciwgbW92aWVzKSA9PiB7XHJcblx0XHRjb25zdCBpbWFnZVNsaWRlciA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1tYWluX19pbWFnZXNcIik7XHJcblx0XHRjb25zdCBhbGxJbWFnZXMgPSBpbWFnZVNsaWRlci5xdWVyeVNlbGVjdG9yQWxsKFwiLmJyb3dzZS1tYWluX19pbWctYm94XCIpO1xyXG5cdFx0Y29uc3QgY2Fyb3VzZWxsQ29udHJvbHMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcclxuXHRcdFx0XCIuYnJvd3NlLW1haW5fX2Nhcm91c2VsbC1jb250cm9sc1wiXHJcblx0XHQpO1xyXG5cdFx0YWxsSW1hZ2VzLmZvckVhY2goKGltZykgPT4gaW1nLmNsYXNzTGlzdC5yZW1vdmUoXCJjdXJyZW50VmlzaWJsZVwiKSk7XHJcblxyXG5cdFx0aW1hZ2VTbGlkZXIuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHstaW5kZXggKiBjYXJvdXNlbGxXaWR0aH0lKWA7XHJcblx0XHRoYW5kbGVDYXJvdXNlbGxDb250cm9sc1N0YXRlKGluZGV4LCBjYXJvdXNlbGxDb250cm9scyk7XHJcblx0XHRhbGxJbWFnZXNbaW5kZXhdLmNsYXNzTGlzdC5hZGQoXCJjdXJyZW50VmlzaWJsZVwiKTtcclxuXHJcblx0XHRpbmRleCsrO1xyXG5cclxuXHRcdGlmIChpbmRleCA+IG1vdmllcy5sZW5ndGggLSAxKSBpbmRleCA9IDA7XHJcblxyXG5cdFx0aGFuZGxlQnRuc1Zpc2liaWxpdHkoY29udGFpbmVyKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVDYXJvdXNlbGxDb250cm9sc1N0YXRlID0gKGluZGV4LCBjYXJvdXNlbGxDb250cm9sc0JveCkgPT4ge1xyXG5cdFx0Y29uc3QgYWxsQ29udHJvbEJ0bnMgPVxyXG5cdFx0XHRjYXJvdXNlbGxDb250cm9sc0JveC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJyb3dzZS1tYWluX19idG5cIik7XHJcblx0XHRjb25zdCBjdXJyZW50QnRuID0gY2Fyb3VzZWxsQ29udHJvbHNCb3gucXVlcnlTZWxlY3RvcihcclxuXHRcdFx0YC5icm93c2UtbWFpbl9fYnRuW2RhdGEtaW1nPVwiJHtpbmRleH1cIl1gXHJcblx0XHQpO1xyXG5cdFx0Y29uc3QgcHJvZ3Jlc3NCYXIgPSBjdXJyZW50QnRuLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX3Byb2dyZXNzLWJhclwiKTtcclxuXHRcdGNvbnN0IGFsbFByb2dyZXNzQmFycyA9IGNhcm91c2VsbENvbnRyb2xzQm94LnF1ZXJ5U2VsZWN0b3JBbGwoXHJcblx0XHRcdFwiLmJyb3dzZS1tYWluX19wcm9ncmVzcy1iYXJcIlxyXG5cdFx0KTtcclxuXHJcblx0XHRwcm9ncmVzc0JhckludGVydmFscy5mb3JFYWNoKChpbnRlcnZhbCkgPT4gY2xlYXJJbnRlcnZhbChpbnRlcnZhbCkpO1xyXG5cdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuY2xlYXIoKTtcclxuXHJcblx0XHRhbGxQcm9ncmVzc0JhcnMuZm9yRWFjaCgoYmFyKSA9PiAoYmFyLnN0eWxlLndpZHRoID0gXCIwXCIpKTtcclxuXHJcblx0XHRjaGFuZ2VQcm9ncmVzc0Jhcihwcm9ncmVzc0JhciwgaW5kZXgpO1xyXG5cclxuXHRcdGFsbENvbnRyb2xCdG5zLmZvckVhY2goKGJ0bikgPT4gYnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIikpO1xyXG5cdFx0Y3VycmVudEJ0bi5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGNoYW5nZVByb2dyZXNzQmFyID0gKHByb2dyZXNzQmFyLCBidG5JbmRleCkgPT4ge1xyXG5cdFx0aWYgKHByb2dyZXNzQmFySW50ZXJ2YWxzLmhhcyhidG5JbmRleCkpIHtcclxuXHRcdFx0Y2xlYXJJbnRlcnZhbChwcm9ncmVzc0JhckludGVydmFscy5nZXQoYnRuSW5kZXgpKTtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgd2lkdGggPSAwO1xyXG5cdFx0Y29uc3QgcHJvZ3Jlc3NCYXJJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuXHRcdFx0d2lkdGggKz0gY2Fyb3VzZWxsU3Ryb2tlUmFuZ2U7XHJcblx0XHRcdHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gYCR7d2lkdGh9JWA7XHJcblx0XHRcdGlmICh3aWR0aCA+PSAxMDApIHtcclxuXHRcdFx0XHRwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IFwiMFwiO1xyXG5cdFx0XHRcdGNsZWFySW50ZXJ2YWwocHJvZ3Jlc3NCYXJJbnRlcnZhbCk7XHJcblxyXG5cdFx0XHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLmRlbGV0ZShidG5JbmRleCk7XHJcblx0XHRcdH1cclxuXHRcdH0sIGludGVydmFsU3BlZWQpO1xyXG5cclxuXHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLnNldChidG5JbmRleCwgcHJvZ3Jlc3NCYXJJbnRlcnZhbCk7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgY2hhbmdlQ3VycmVudEltZyA9IChtb3ZpZXMsIGNvbnRhaW5lcikgPT4ge1xyXG5cdFx0Y29uc3QgY2Fyb3VzZWxsQ29udHJvbHMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcclxuXHRcdFx0XCIuYnJvd3NlLW1haW5fX2Nhcm91c2VsbC1jb250cm9sc1wiXHJcblx0XHQpO1xyXG5cclxuXHRcdGNhcm91c2VsbENvbnRyb2xzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0XHRpZiAoZS50YXJnZXQubWF0Y2hlcyhcIi5icm93c2UtbWFpbl9fYnRuXCIpKSB7XHJcblx0XHRcdFx0aWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSkgcmV0dXJuO1xyXG5cclxuXHRcdFx0XHRjbGVhckludGVydmFsKGNhcm91c2VsbEludGVydmFsKTtcclxuXHJcblx0XHRcdFx0Y29uc3QgY3VycmVudEJ0biA9IGUudGFyZ2V0O1xyXG5cdFx0XHRcdGNvbnN0IGltZ0RhdGEgPSBwYXJzZUludChjdXJyZW50QnRuLmRhdGFzZXQuaW1nKTtcclxuXHJcblx0XHRcdFx0aW5kZXggPSBpbWdEYXRhO1xyXG5cdFx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHJcblx0XHRcdFx0Y2Fyb3VzZWxsSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblx0XHRcdFx0fSwgY2Fyb3VzZWxsU3BlZWQpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVCdG5zVmlzaWJpbGl0eSA9IChjb250YWluZXIpID0+IHtcclxuXHRcdGNvbnN0IGFsbEZpbG1zID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLW1haW5fX2ltZy1ib3hcIik7XHJcblxyXG5cdFx0YWxsRmlsbXMuZm9yRWFjaCgoZmlsbSkgPT4ge1xyXG5cdFx0XHRjb25zdCBpc0FjdGl2ZSA9IGZpbG0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY3VycmVudFZpc2libGVcIik7XHJcblx0XHRcdGNvbnN0IHRhYmluZGV4ID0gaXNBY3RpdmUgPyAwIDogLTE7XHJcblx0XHRcdGNvbnN0IHZpc2liaWxpdHkgPSB0YWJpbmRleCA9PT0gMCA/IFwidmlzaWJsZVwiIDogXCJoaWRkZW5cIjtcclxuXHRcdFx0Z2l2ZUJ0bnNBdHRyaWJ1dGUoZmlsbSwgdGFiaW5kZXgsIHZpc2liaWxpdHkpO1xyXG5cdFx0fSk7XHJcblx0fTtcclxuXHRjb25zdCBnaXZlQnRuc0F0dHJpYnV0ZSA9IChmaWxtLCB0YWJpbmRleCwgdmlzaWJpbGl0eSkgPT4ge1xyXG5cdFx0Y29uc3QgdHJhaWxlckJ0biA9IGZpbG0ucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9fdHJhaWxlci1idG5cIik7XHJcblx0XHRjb25zdCBzZWVNb3JlQnRuID0gZmlsbS5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1tYWluX19zZWUtbW9yZS1idG5cIik7XHJcblxyXG5cdFx0dHJhaWxlckJ0bi5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCB0YWJpbmRleCk7XHJcblx0XHRzZWVNb3JlQnRuLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIHRhYmluZGV4KTtcclxuXHRcdHRyYWlsZXJCdG4uc3R5bGUudmlzaWJpbGl0eSA9IHZpc2liaWxpdHk7XHJcblx0XHRzZWVNb3JlQnRuLnN0eWxlLnZpc2liaWxpdHkgPSB2aXNpYmlsaXR5O1xyXG5cdH07XHJcblxyXG5cdGxldCBzdGFydFg7XHJcblx0bGV0IGVuZFg7XHJcblx0bGV0IHN0YXJ0WTtcclxuXHRsZXQgZW5kWTtcclxuXHJcblx0Y29uc3QgaGFuZGxlVG91Y2hTdGFydEV2ZW50ID0gKGUpID0+IHtcclxuXHRcdHN0YXJ0WCA9IGUudG91Y2hlc1swXS5jbGllbnRYO1xyXG5cdFx0c3RhcnRZID0gZS50b3VjaGVzWzBdLmNsaWVudFk7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgaGFuZGxlVG91Y2hFbmRFdmVudCA9IChlLCBjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0ZW5kWCA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WDtcclxuXHRcdGVuZFkgPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFk7XHJcblx0XHRoYW5kbGVTd2lwZShjb250YWluZXIsIG1vdmllcyk7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgaGFuZGxlU3dpcGUgPSAoY29udGFpbmVyLCBtb3ZpZXMpID0+IHtcclxuXHRcdGNvbnN0IEhPUklaT05UQUxfUkFOR0UgPSAzMDtcclxuXHRcdGNvbnN0IFZFUlRJQ0FMX1JBTkdFID0gMzA7XHJcblxyXG5cdFx0Y29uc3QgaG9yaXpvbnRhbERpc3RhbmNlID0gTWF0aC5hYnMoc3RhcnRYIC0gZW5kWCk7XHJcblx0XHRjb25zdCB2ZXJ0aWNhbERpc3RhbmNlID0gTWF0aC5hYnMoc3RhcnRZIC0gZW5kWSk7XHJcblxyXG5cdFx0aWYgKFxyXG5cdFx0XHRob3Jpem9udGFsRGlzdGFuY2UgPCBIT1JJWk9OVEFMX1JBTkdFIHx8XHJcblx0XHRcdHZlcnRpY2FsRGlzdGFuY2UgPiBWRVJUSUNBTF9SQU5HRVxyXG5cdFx0KSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGlmIChlbmRYIC0gc3RhcnRYID4gSE9SSVpPTlRBTF9SQU5HRSkge1xyXG5cdFx0XHRpbmRleCA9IChpbmRleCAtIDIgKyBtb3ZpZXMubGVuZ3RoKSAlIG1vdmllcy5sZW5ndGg7XHJcblx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdH0gZWxzZSBpZiAoc3RhcnRYIC0gZW5kWCA+IEhPUklaT05UQUxfUkFOR0UpIHtcclxuXHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNsZWFySW50ZXJ2YWwoY2Fyb3VzZWxsSW50ZXJ2YWwpO1xyXG5cdFx0Y2Fyb3VzZWxsSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdH0sIGNhcm91c2VsbFNwZWVkKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBzZXRUb3VjaEV2ZW50TGlzdGVuZXIgPSAoY29udGFpbmVyLCBtb3ZpZXMpID0+IHtcclxuXHRcdGNvbnN0IGltYWdlU2xpZGVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX2ltYWdlc1wiKTtcclxuXHJcblx0XHRpbWFnZVNsaWRlci5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCAoZSkgPT4ge1xyXG5cdFx0XHRoYW5kbGVUb3VjaFN0YXJ0RXZlbnQoZSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRpbWFnZVNsaWRlci5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgKGUpID0+IHtcclxuXHRcdFx0aGFuZGxlVG91Y2hFbmRFdmVudChlLCBjb250YWluZXIsIG1vdmllcyk7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBjaGFuZ2VDYXJvdXNlbGxEYXRhSW5kZXggPSAoc2xpZGVyLCBpbmRleCkgPT4ge1xyXG5cdFx0c2xpZGVyLmRhdGFzZXQuaW5kZXggPSBpbmRleDtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBnZXRDYXJvdXNlbENvbmZpZyA9ICgpID0+IHtcclxuXHRcdGxldCBtYXhJbmRleDtcclxuXHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPCA1NzYpIG1heEluZGV4ID0gOTtcclxuXHRcdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSA1NzYgJiYgd2luZG93LmlubmVyV2lkdGggPCA5OTIpIG1heEluZGV4ID0gMTc7XHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPj0gOTkyICYmIHdpbmRvdy5pbm5lcldpZHRoIDwgMTIwMCkgbWF4SW5kZXggPSA0O1xyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoID49IDEyMDApIG1heEluZGV4ID0gNztcclxuXHJcblx0XHRyZXR1cm4gbWF4SW5kZXg7XHJcblx0fTtcclxuXHJcblx0Y29uc3Qgc2V0VGhyZXNob2xkID0gKCkgPT4ge1xyXG5cdFx0bGV0IHRocmVzaG9sZCA9IDI7XHJcblxyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoID4gNTc2ICYmIHdpbmRvdy5pbm5lcldpZHRoIDwgOTkyKSB0aHJlc2hvbGQgPSAxO1xyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoID49IDk5MiAmJiB3aW5kb3cuaW5uZXJXaWR0aCA8IDEyMDApIHRocmVzaG9sZCA9IDQ7XHJcblxyXG5cdFx0cmV0dXJuIHRocmVzaG9sZDtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBtb3ZlU2xpZGVyID0gKHNsaWRlcikgPT4ge1xyXG5cdFx0Y29uc3QgdGhyZXNob2xkID0gc2V0VGhyZXNob2xkKCk7XHJcblx0XHRsZXQgc2xpZGVyRGF0YXNldCA9IHNsaWRlci5kYXRhc2V0LmluZGV4O1xyXG5cdFx0Y29uc3Qgc2xpZGVyQ2Fyb3VzZWxsID0gc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRcdFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXItaW1hZ2VzXCJcclxuXHRcdCk7XHJcblxyXG5cdFx0Y29uc3QgcG9zdGVyID0gc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlci1ib3hcIik7XHJcblx0XHRpZiAoIXBvc3RlcikgcmV0dXJuO1xyXG5cclxuXHRcdGNvbnN0IHBvc3RlcldpZHRoID0gcG9zdGVyLm9mZnNldFdpZHRoO1xyXG5cdFx0c2xpZGVyQ2Fyb3VzZWxsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKCR7XHJcblx0XHRcdC1zbGlkZXJEYXRhc2V0ICogcG9zdGVyV2lkdGggKiB0aHJlc2hvbGRcclxuXHRcdH1weClgO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IHNob3dOZXh0U2xpZGUgPSAoc2xpZGVyLCBpbmRleCkgPT4ge1xyXG5cdFx0bGV0IGluaXRpYWxJbmRleCA9IGluZGV4ID09PSAwID8gcGFyc2VJbnQoc2xpZGVyLmRhdGFzZXQuaW5kZXgpIDogMDtcclxuXHRcdGNvbnN0IG1heEluZGV4ID0gZ2V0Q2Fyb3VzZWxDb25maWcoKTtcclxuXHJcblx0XHRpZiAoaW5pdGlhbEluZGV4ID49IG1heEluZGV4KSByZXR1cm47XHJcblxyXG5cdFx0aW5pdGlhbEluZGV4Kys7XHJcblx0XHRjaGFuZ2VDYXJvdXNlbGxEYXRhSW5kZXgoc2xpZGVyLCBpbml0aWFsSW5kZXgpO1xyXG5cdFx0bW92ZVNsaWRlcihzbGlkZXIpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IHNob3dQcmV2U2xpZGUgPSAoc2xpZGVyLCBpbmRleCkgPT4ge1xyXG5cdFx0bGV0IGluaXRpYWxJbmRleCA9IGluZGV4ID09PSAwID8gcGFyc2VJbnQoc2xpZGVyLmRhdGFzZXQuaW5kZXgpIDogMDtcclxuXHJcblx0XHRpZiAoaW5pdGlhbEluZGV4IDw9IDApIHJldHVybjtcclxuXHJcblx0XHRpbml0aWFsSW5kZXgtLTtcclxuXHRcdGNoYW5nZUNhcm91c2VsbERhdGFJbmRleChzbGlkZXIsIGluaXRpYWxJbmRleCk7XHJcblx0XHRtb3ZlU2xpZGVyKHNsaWRlcik7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgcHJlcGFyZUNhcm91c2VsSXRlbXMgPSAoY29udGFpbmVyKSA9PiB7XHJcblx0XHRjb25zdCBzbGlkZXJzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlclwiKTtcclxuXHJcblx0XHRzbGlkZXJzLmZvckVhY2goKHNsaWRlcikgPT5cclxuXHRcdFx0c2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0XHRcdGxldCBzbWFsbENhcm91c2VsbEluZGV4ID0gMDtcclxuXHJcblx0XHRcdFx0aWYgKGUudGFyZ2V0Lm1hdGNoZXMoXCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlci1uZXh0LWJ0blwiKSkge1xyXG5cdFx0XHRcdFx0c2hvd05leHRTbGlkZShzbGlkZXIsIHNtYWxsQ2Fyb3VzZWxsSW5kZXgpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoZS50YXJnZXQubWF0Y2hlcyhcIi5icm93c2Utc2VjdGlvbl9fc2xpZGVyLXByZXYtYnRuXCIpKSB7XHJcblx0XHRcdFx0XHRzaG93UHJldlNsaWRlKHNsaWRlciwgc21hbGxDYXJvdXNlbGxJbmRleCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KVxyXG5cdFx0KTtcclxuXHR9O1xyXG5cclxuXHRsZXQgbGFzdFdpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XHJcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgKCkgPT4ge1xyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoID09PSBsYXN0V2lkdGgpIHJldHVybjtcclxuXHRcdGxhc3RXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG5cclxuXHRcdGNvbnN0IGFsbFNsaWRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXJcIik7XHJcblx0XHRhbGxTbGlkZXJzLmZvckVhY2goKHNsaWRlcikgPT4ge1xyXG5cdFx0XHRjb25zdCBzbGlkZXJDYXJvdXNlbGwgPSBzbGlkZXIucXVlcnlTZWxlY3RvcihcclxuXHRcdFx0XHRcIi5icm93c2Utc2VjdGlvbl9fc2xpZGVyLWltYWdlc1wiXHJcblx0XHRcdCk7XHJcblx0XHRcdGNoYW5nZUNhcm91c2VsbERhdGFJbmRleChzbGlkZXIsIDApO1xyXG5cdFx0XHRzbGlkZXJDYXJvdXNlbGwuc3R5bGUudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGVYKDApXCI7XHJcblx0XHR9KTtcclxuXHR9KTtcclxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInVubG9hZFwiLCAoKSA9PiB7XHJcblx0XHRjbGVhckludGVydmFsKGNhcm91c2VsbEludGVydmFsKTtcclxuXHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLmZvckVhY2goKGludGVydmFsKSA9PiBjbGVhckludGVydmFsKGludGVydmFsKSk7XHJcblx0XHRwcm9ncmVzc0JhckludGVydmFscy5jbGVhcigpO1xyXG5cdH0pO1xyXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdGNsb3NlQWxsTm90Q2xpY2tlZChlKTtcclxuXHR9KTtcclxuXHRjaGVja0F1dGhvcml6YXRpb24oKTtcclxufSk7XHJcbiJdfQ==
