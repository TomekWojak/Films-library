import{getData,createBrowsePage,createMainHeroSection,showErrorPopup,showBigLoader,hideBigLoader,createFilmSlider,createFooter,closeAllNotClicked,createFourCategories,createTrailerWindow,hideTrailerWindow}from"./components.min.js";document.addEventListener("DOMContentLoaded",function(){const e={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNTYwZjM4MjU3NDQ1ZGE1ZGZkYTYxYzE0YWM4YmM4MyIsIm5iZiI6MTc1OTc2NTAzOC45NCwic3ViIjoiNjhlM2UyMmUyNjY5NzY4MzhlYzI3NzI5Iiwic2NvcGVzIjpbImFwaV9yZWFkIl0sInZlcnNpb24iOjF9.nuGfEjclJLepmzzHi2omNhp29THgrJf9Nv6D4_gTdxA"}},t=new Map;let r,a=1e4,i=0;const o=new Date,n=`https://api.themoviedb.org/3/discover/movie?primary_release_year=2025&primary_release_date.gte=${o.getFullYear()}-${o.getMonth()+1}-${o.getDate()}&sort_by=popularity.desc\n`,s="&page=",c=async(t,...r)=>{const a=[];for await(const i of r){const r=i+t+s+1,o=await fetch(r,e),n=await o.json();a.push(n)}return a},l=async(t,r,a)=>{const i=a+t+s+r;try{const t=await fetch(i,e);return await t.json()}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},d=async(e,t)=>{const r=[];for(let a=1;a<=t;a++)r.push(l(e,a,"https://api.themoviedb.org/3/movie/popular?with_origin_country=US|GB|CA&language="));try{return await Promise.all(r)}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},w=async(e,t)=>{try{const r=(await e(t,5)).map(e=>h(e.results)),a=Math.trunc(20*Math.random());return r.map(e=>e[a])}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}},h=e=>e.filter(e=>e.popularity>=10),m=(e,t)=>{const r=e.querySelector(".browse-main__images"),a=r.querySelectorAll(".browse-main__img-box"),o=e.querySelector(".browse-main__carousell-controls");a.forEach(e=>e.classList.remove("currentVisible")),r.style.transform=`translateX(${100*-i}%)`,u(i,o),a[i].classList.add("currentVisible"),i++,i>t.length-1&&(i=0),p(e)},u=(e,r)=>{const a=r.querySelectorAll(".browse-main__btn"),i=r.querySelector(`.browse-main__btn[data-img="${e}"]`),o=i.querySelector(".browse-main__progress-bar"),n=r.querySelectorAll(".browse-main__progress-bar");t.forEach(e=>clearInterval(e)),t.clear(),n.forEach(e=>e.style.width="0"),g(o,e),a.forEach(e=>e.classList.remove("active")),i.classList.add("active")},g=(e,r)=>{t.has(r)&&clearInterval(t.get(r));let a=0;const i=setInterval(()=>{a+=2,e.style.width=`${a}%`,a>=100&&(e.style.width="0",clearInterval(i),t.delete(r))},200);t.set(r,i)},b=(e,t)=>{t.querySelector(".browse-main__carousell-controls").addEventListener("click",o=>{if(o.target.matches(".browse-main__btn")){if(o.target.classList.contains("active"))return;clearInterval(r);const n=o.target,s=parseInt(n.dataset.img);i=s,m(t,e),r=setInterval(()=>{m(t,e)},a)}})},p=e=>{e.querySelectorAll(".browse-main__img-box").forEach(e=>{const t=e.classList.contains("currentVisible")?0:-1;y(e,t,0===t?"visible":"hidden")})},y=(e,t,r)=>{const a=e.querySelector(".browse-main__trailer-btn"),i=e.querySelector(".browse-main__see-more-btn");a.setAttribute("tabindex",t),i.setAttribute("tabindex",t),a.style.visibility=r,i.style.visibility=r};let _,v,f,S;const E=(e,t)=>{const o=Math.abs(_-v),n=Math.abs(f-S);o<30||n>30||(v-_>30?(i=(i-2+t.length)%t.length,m(e,t)):_-v>30&&m(e,t),clearInterval(r),r=setInterval(()=>{m(e,t)},a))},I=(e,t)=>{const r=e.querySelector(".browse-main__images");r.addEventListener("touchstart",e=>{(e=>{_=e.touches[0].clientX,f=e.touches[0].clientY})(e)}),r.addEventListener("touchend",r=>{((e,t,r)=>{v=e.changedTouches[0].clientX,S=e.changedTouches[0].clientY,E(t,r)})(r,e,t)})},L=(e,t)=>{e.dataset.index=t},W=e=>{const t=(()=>{let e=2;return window.innerWidth>576&&window.innerWidth<992&&(e=1),window.innerWidth>=992&&window.innerWidth<1200&&(e=4),e})();let r=e.dataset.index;const a=e.querySelector(".browse-section__slider-images"),i=e.querySelector(".browse-section__slider-box");if(!i)return;const o=i.offsetWidth;a.style.transform=`translateX(${-r*o*t}px)`},q=(e,t)=>{let r=0===t?parseInt(e.dataset.index):0;r>=(()=>{let e;return window.innerWidth<576&&(e=9),window.innerWidth>=576&&window.innerWidth<992&&(e=17),window.innerWidth>=992&&window.innerWidth<1200&&(e=4),window.innerWidth>=1200&&(e=7),e})()||(r++,L(e,r),W(e))},N=e=>{e.querySelectorAll(".browse-section__slider").forEach(e=>e.addEventListener("click",t=>{t.target.matches(".browse-section__slider-next-btn")?q(e,0):t.target.matches(".browse-section__slider-prev-btn")&&((e,t)=>{let r=0===t?parseInt(e.dataset.index):0;r<=0||(r--,L(e,r),W(e))})(e,0)}))};let M=window.innerWidth;window.addEventListener("resize",()=>{if(window.innerWidth===M)return;M=window.innerWidth;document.querySelectorAll(".browse-section__slider").forEach(e=>{const t=e.querySelector(".browse-section__slider-images");L(e,0),t.style.transform="translateX(0)"})}),window.addEventListener("unload",()=>{clearInterval(r),t.forEach(e=>clearInterval(e)),t.clear()}),window.addEventListener("click",e=>{closeAllNotClicked(e)}),document.body.addEventListener("click",e=>{const t=document.querySelector(".trailer-window");e.target.matches(".browse-main__trailer-btn")||e.target.matches(".explore__film-show-trailer-btn")?createTrailerWindow(e):t&&(e.target.matches(".close-trailer-window")||e.target.matches(".overlay"))&&hideTrailerWindow()}),(async()=>{const e=getData(),t=e?.translations,i=e?.preferredLanguage,o=e?.loggedIn,s=document.querySelector(".container"),l=e?.currentProfile;if(e&&o&&l){s.prepend(createBrowsePage(t)),s.append(showBigLoader());try{const e=await w(d,i);createMainHeroSection(e,t,s),m(s,e),r=setInterval(()=>m(s,e),a),b(e,s),I(s,e);const o=await c(i,"https://api.themoviedb.org/3/movie/upcoming?language=","https://api.themoviedb.org/3/trending/all/week?language=","https://api.themoviedb.org/3/discover/tv?with_origin_country=US|GB&language=&sort_by=popularity.desc\n",n),l=document.querySelector("main");l||showErrorPopup(t.browsePage.loadingDataError,"#dc4a34"),l.append(createFourCategories(t),createFilmSlider(o,t,1,t.browseSection.sectionNames.trending,"movie"),createFilmSlider(o,t,0,t.browseSection.sectionNames.upcoming,"movie"),createFilmSlider(o,t,2,t.browseSection.sectionNames.topRatedSeries,"tv"),createFilmSlider(o,t,3,t.browseSection.sectionNames.futureFilms,"movie")),N(s),s.append(createFooter(t))}catch{showErrorPopup(t.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}}else window.location.href="/"})()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi1wYWdlLm1pbi5qcyIsIm5hbWVzIjpbImdldERhdGEiLCJjcmVhdGVCcm93c2VQYWdlIiwiY3JlYXRlTWFpbkhlcm9TZWN0aW9uIiwic2hvd0Vycm9yUG9wdXAiLCJzaG93QmlnTG9hZGVyIiwiaGlkZUJpZ0xvYWRlciIsImNyZWF0ZUZpbG1TbGlkZXIiLCJjcmVhdGVGb290ZXIiLCJjbG9zZUFsbE5vdENsaWNrZWQiLCJjcmVhdGVGb3VyQ2F0ZWdvcmllcyIsImNyZWF0ZVRyYWlsZXJXaW5kb3ciLCJoaWRlVHJhaWxlcldpbmRvdyIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9wdGlvbnMiLCJtZXRob2QiLCJoZWFkZXJzIiwiYWNjZXB0IiwiQXV0aG9yaXphdGlvbiIsInByb2dyZXNzQmFySW50ZXJ2YWxzIiwiTWFwIiwiY2Fyb3VzZWxsSW50ZXJ2YWwiLCJjYXJvdXNlbGxTcGVlZCIsImluZGV4IiwiY3VycmVudERhdGUiLCJEYXRlIiwiVVBDT01JTkdfRklMTVMiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsIkZJTE1TX1BBR0VTX0FNT1VOVCIsImdldEFsbEZpbG1zIiwiYXN5bmMiLCJsYW5nIiwidXJscyIsImZpbG1zQXJyIiwidXJsIiwiVVJMIiwicmVzcG9uc2UiLCJmZXRjaCIsImRhdGEiLCJqc29uIiwicHVzaCIsImdldEZpbG1zIiwicGFnZU51bSIsInRyYW5zbGF0aW9ucyIsImJyb3dzZVBhZ2UiLCJsb2FkaW5nRGF0YUVycm9yIiwibG9hZEZpbG1zVG9DYXJvdXNlbGwiLCJyZXF1ZXN0cyIsImkiLCJQcm9taXNlIiwiYWxsIiwiY2hvb3NlRmlsbXNUb0Nhcm91c2VsbCIsImN1cnJlbnRMYW5ndWFnZSIsImZpbHRlcmVkRGF0YSIsIm1hcCIsImZpbG0iLCJmaWx0ZXJEYXRhIiwicmVzdWx0cyIsInJhbmRvbU51bWJlciIsIk1hdGgiLCJ0cnVuYyIsInJhbmRvbSIsInBhZ2UiLCJmaWxtcyIsImZpbHRlciIsInBvcHVsYXJpdHkiLCJoYW5kbGVGaWxtc0Nhcm91c2VsbCIsImNvbnRhaW5lciIsIm1vdmllcyIsImltYWdlU2xpZGVyIiwicXVlcnlTZWxlY3RvciIsImFsbEltYWdlcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjYXJvdXNlbGxDb250cm9scyIsImZvckVhY2giLCJpbWciLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJzdHlsZSIsInRyYW5zZm9ybSIsImhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUiLCJhZGQiLCJsZW5ndGgiLCJoYW5kbGVCdG5zVmlzaWJpbGl0eSIsImNhcm91c2VsbENvbnRyb2xzQm94IiwiYWxsQ29udHJvbEJ0bnMiLCJjdXJyZW50QnRuIiwicHJvZ3Jlc3NCYXIiLCJhbGxQcm9ncmVzc0JhcnMiLCJpbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJjbGVhciIsImJhciIsIndpZHRoIiwiY2hhbmdlUHJvZ3Jlc3NCYXIiLCJidG4iLCJidG5JbmRleCIsImhhcyIsImdldCIsInByb2dyZXNzQmFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImRlbGV0ZSIsInNldCIsImNoYW5nZUN1cnJlbnRJbWciLCJlIiwidGFyZ2V0IiwibWF0Y2hlcyIsImNvbnRhaW5zIiwiaW1nRGF0YSIsInBhcnNlSW50IiwiZGF0YXNldCIsInRhYmluZGV4IiwiZ2l2ZUJ0bnNBdHRyaWJ1dGUiLCJ2aXNpYmlsaXR5IiwidHJhaWxlckJ0biIsInNlZU1vcmVCdG4iLCJzZXRBdHRyaWJ1dGUiLCJzdGFydFgiLCJlbmRYIiwic3RhcnRZIiwiZW5kWSIsImhhbmRsZVN3aXBlIiwiaG9yaXpvbnRhbERpc3RhbmNlIiwiYWJzIiwidmVydGljYWxEaXN0YW5jZSIsInNldFRvdWNoRXZlbnRMaXN0ZW5lciIsInRvdWNoZXMiLCJjbGllbnRYIiwiY2xpZW50WSIsImhhbmRsZVRvdWNoU3RhcnRFdmVudCIsImNoYW5nZWRUb3VjaGVzIiwiaGFuZGxlVG91Y2hFbmRFdmVudCIsImNoYW5nZUNhcm91c2VsbERhdGFJbmRleCIsInNsaWRlciIsIm1vdmVTbGlkZXIiLCJ0aHJlc2hvbGQiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwic2V0VGhyZXNob2xkIiwic2xpZGVyRGF0YXNldCIsInNsaWRlckNhcm91c2VsbCIsInBvc3RlciIsInBvc3RlcldpZHRoIiwib2Zmc2V0V2lkdGgiLCJzaG93TmV4dFNsaWRlIiwiaW5pdGlhbEluZGV4IiwibWF4SW5kZXgiLCJnZXRDYXJvdXNlbENvbmZpZyIsInByZXBhcmVDYXJvdXNlbEl0ZW1zIiwic2hvd1ByZXZTbGlkZSIsImxhc3RXaWR0aCIsImJvZHkiLCJ3aW5kb3dFeGlzdHMiLCJ1c2VyRGF0YSIsInByZWZlcnJlZExhbmd1YWdlIiwiaXNMb2dnZWRJbiIsImxvZ2dlZEluIiwiY3VycmVudFByb2ZpbGUiLCJwcmVwZW5kIiwiYXBwZW5kIiwibWFpbiIsImJyb3dzZVNlY3Rpb24iLCJzZWN0aW9uTmFtZXMiLCJ0cmVuZGluZyIsInVwY29taW5nIiwidG9wUmF0ZWRTZXJpZXMiLCJmdXR1cmVGaWxtcyIsImxvY2F0aW9uIiwiaHJlZiIsImNoZWNrQXV0aG9yaXphdGlvbiJdLCJzb3VyY2VzIjpbIm1haW4tcGFnZS5qcyJdLCJtYXBwaW5ncyI6Ik9BQ0NBLFFBQ0FDLGlCQUNBQyxzQkFDQUMsZUFDQUMsY0FDQUMsY0FDQUMsaUJBQ0FDLGFBQ0FDLG1CQUNBQyxxQkFDQUMsb0JBQ0FDLHNCQUNNLHNCQUNQQyxTQUFTQyxpQkFBaUIsbUJBQW9CLFdBQzdDLE1BR01DLEVBQVUsQ0FDZkMsT0FBUSxNQUNSQyxRQUFTLENBQ1JDLE9BQVEsbUJBQ1JDLGNBQ0MseVBBR0dDLEVBQXVCLElBQUlDLElBQ2pDLElBS0lDLEVBTEFDLEVBQWlCLElBSWpCQyxFQUFRLEVBR1osTUFLTUMsRUFBYyxJQUFJQyxLQUNsQkMsRUFBaUIsa0dBQWtHRixFQUFZRyxpQkFDcElILEVBQVlJLFdBQWEsS0FDdEJKLEVBQVlLLHNDQUdWQyxFQUFxQixTQXlGckJDLEVBQWNDLE1BQU9DLEtBQVNDLEtBQ25DLE1BQU1D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QUN4QyxVQUdGbEIsRUFBcUJqRixHQUNyQkEsRUFBVTRGLE9BQU8xSixhQUFhc0MsR0FDL0IsQ0FBRSxNQUNEMUMsZUFBZTBDLEVBQWFDLFdBQVdDLGlCQUFrQixVQUMxRCxDQUFFLFFBQ0QxQyxlQUNELENBekVBLE1BRkNxSSxPQUFPK0IsU0FBU0MsS0FBTyxLQTJaekJDLEVBQ0QiLCJpZ25vcmVMaXN0IjpbXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuXHRnZXREYXRhLFxyXG5cdGNyZWF0ZUJyb3dzZVBhZ2UsXHJcblx0Y3JlYXRlTWFpbkhlcm9TZWN0aW9uLFxyXG5cdHNob3dFcnJvclBvcHVwLFxyXG5cdHNob3dCaWdMb2FkZXIsXHJcblx0aGlkZUJpZ0xvYWRlcixcclxuXHRjcmVhdGVGaWxtU2xpZGVyLFxyXG5cdGNyZWF0ZUZvb3RlcixcclxuXHRjbG9zZUFsbE5vdENsaWNrZWQsXHJcblx0Y3JlYXRlRm91ckNhdGVnb3JpZXMsXHJcblx0Y3JlYXRlVHJhaWxlcldpbmRvdyxcclxuXHRoaWRlVHJhaWxlcldpbmRvdyxcclxufSBmcm9tIFwiLi9jb21wb25lbnRzLm1pbi5qc1wiO1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XHJcblx0Y29uc3QgQ0FST1VTRUxMX0xFTkdUSCA9IDU7XHJcblx0Y29uc3QgRklMTV9BTU9VTlRfUEVSX1BBR0UgPSAyMDtcclxuXHRjb25zdCBQQUdFX1RPX1NIT1dfT05fU01BTExfQ0FST1VTRUxTID0gMTtcclxuXHRjb25zdCBvcHRpb25zID0ge1xyXG5cdFx0bWV0aG9kOiBcIkdFVFwiLFxyXG5cdFx0aGVhZGVyczoge1xyXG5cdFx0XHRhY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG5cdFx0XHRBdXRob3JpemF0aW9uOlxyXG5cdFx0XHRcdFwiQmVhcmVyIGV5SmhiR2NpT2lKSVV6STFOaUo5LmV5SmhkV1FpT2lJek5UWXdaak00TWpVM05EUTFaR0UxWkdaa1lUWXhZekUwWVdNNFltTTRNeUlzSW01aVppSTZNVGMxT1RjMk5UQXpPQzQ1TkN3aWMzVmlJam9pTmpobE0yVXlNbVV5TmpZNU56WTRNemhsWXpJM056STVJaXdpYzJOdmNHVnpJanBiSW1Gd2FWOXlaV0ZrSWwwc0luWmxjbk5wYjI0aU9qRjkubnVHZkVqY2xKTGVwbXp6SGkyb21OaHAyOVRIZ3JKZjlOdjZENF9nVGR4QVwiLFxyXG5cdFx0fSxcclxuXHR9O1xyXG5cdGNvbnN0IHByb2dyZXNzQmFySW50ZXJ2YWxzID0gbmV3IE1hcCgpO1xyXG5cdGxldCBjYXJvdXNlbGxTcGVlZCA9IDEwMDAwO1xyXG5cdGxldCBjYXJvdXNlbGxTdHJva2VSYW5nZSA9IDI7XHJcblx0bGV0IGludGVydmFsU3BlZWQgPSAoY2Fyb3VzZWxsU3BlZWQgKiBjYXJvdXNlbGxTdHJva2VSYW5nZSkgLyAxMDA7XHJcblx0bGV0IGNhcm91c2VsbFdpZHRoID0gMTAwO1xyXG5cdGxldCBpbmRleCA9IDA7XHJcblx0bGV0IGNhcm91c2VsbEludGVydmFsO1xyXG5cclxuXHRjb25zdCBQT1BVTEFSX0ZJTE1TX1VSTCA9IGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllL3BvcHVsYXI/d2l0aF9vcmlnaW5fY291bnRyeT1VU3xHQnxDQSZsYW5ndWFnZT1gO1xyXG5cdGNvbnN0IEhPVF9SQVRFRF9GSUxNU19VUkwgPSBgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9tb3ZpZS91cGNvbWluZz9sYW5ndWFnZT1gO1xyXG5cdGNvbnN0IFRSRU5ESU5HX0ZJTE1TX1VSTCA9IGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL3RyZW5kaW5nL2FsbC93ZWVrP2xhbmd1YWdlPWA7XHJcblx0Y29uc3QgVE9QX1JBVEVEX1RWX1NFUklFU19VUkwgPSBgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9kaXNjb3Zlci90dj93aXRoX29yaWdpbl9jb3VudHJ5PVVTfEdCJmxhbmd1YWdlPSZzb3J0X2J5PXBvcHVsYXJpdHkuZGVzY1xyXG5gO1xyXG5cdGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcclxuXHRjb25zdCBVUENPTUlOR19GSUxNUyA9IGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL2Rpc2NvdmVyL21vdmllP3ByaW1hcnlfcmVsZWFzZV95ZWFyPTIwMjUmcHJpbWFyeV9yZWxlYXNlX2RhdGUuZ3RlPSR7Y3VycmVudERhdGUuZ2V0RnVsbFllYXIoKX0tJHtcclxuXHRcdGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxXHJcblx0fS0ke2N1cnJlbnREYXRlLmdldERhdGUoKX0mc29ydF9ieT1wb3B1bGFyaXR5LmRlc2NcclxuYDtcclxuXHJcblx0Y29uc3QgRklMTVNfUEFHRVNfQU1PVU5UID0gYCZwYWdlPWA7XHJcblxyXG5cdGNvbnN0IGNoZWNrQXV0aG9yaXphdGlvbiA9IGFzeW5jICgpID0+IHtcclxuXHRcdGNvbnN0IHVzZXJEYXRhID0gZ2V0RGF0YSgpO1xyXG5cdFx0Y29uc3QgdHJhbnNsYXRpb25zID0gdXNlckRhdGE/LnRyYW5zbGF0aW9ucztcclxuXHRcdGNvbnN0IGN1cnJlbnRMYW5ndWFnZSA9IHVzZXJEYXRhPy5wcmVmZXJyZWRMYW5ndWFnZTtcclxuXHRcdGNvbnN0IGlzTG9nZ2VkSW4gPSB1c2VyRGF0YT8ubG9nZ2VkSW47XHJcblx0XHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhaW5lclwiKTtcclxuXHRcdGNvbnN0IGN1cnJlbnRQcm9maWxlID0gdXNlckRhdGE/LmN1cnJlbnRQcm9maWxlO1xyXG5cclxuXHRcdGlmICghdXNlckRhdGEgfHwgIWlzTG9nZ2VkSW4gfHwgIWN1cnJlbnRQcm9maWxlKSB7XHJcblx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvXCI7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRjb250YWluZXIucHJlcGVuZChjcmVhdGVCcm93c2VQYWdlKHRyYW5zbGF0aW9ucykpO1xyXG5cdFx0Y29udGFpbmVyLmFwcGVuZChzaG93QmlnTG9hZGVyKCkpO1xyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IG1vdmllcyA9IGF3YWl0IGNob29zZUZpbG1zVG9DYXJvdXNlbGwoXHJcblx0XHRcdFx0bG9hZEZpbG1zVG9DYXJvdXNlbGwsXHJcblx0XHRcdFx0Y3VycmVudExhbmd1YWdlXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRjcmVhdGVNYWluSGVyb1NlY3Rpb24obW92aWVzLCB0cmFuc2xhdGlvbnMsIGNvbnRhaW5lcik7XHJcblx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHJcblx0XHRcdGNhcm91c2VsbEludGVydmFsID0gc2V0SW50ZXJ2YWwoXHJcblx0XHRcdFx0KCkgPT4gaGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpLFxyXG5cdFx0XHRcdGNhcm91c2VsbFNwZWVkXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRjaGFuZ2VDdXJyZW50SW1nKG1vdmllcywgY29udGFpbmVyKTtcclxuXHRcdFx0c2V0VG91Y2hFdmVudExpc3RlbmVyKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHJcblx0XHRcdGNvbnN0IGZpbG1zID0gYXdhaXQgZ2V0QWxsRmlsbXMoXHJcblx0XHRcdFx0Y3VycmVudExhbmd1YWdlLFxyXG5cdFx0XHRcdEhPVF9SQVRFRF9GSUxNU19VUkwsXHJcblx0XHRcdFx0VFJFTkRJTkdfRklMTVNfVVJMLFxyXG5cdFx0XHRcdFRPUF9SQVRFRF9UVl9TRVJJRVNfVVJMLFxyXG5cdFx0XHRcdFVQQ09NSU5HX0ZJTE1TXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XHJcblxyXG5cdFx0XHRpZiAoIW1haW4pIHtcclxuXHRcdFx0XHRzaG93RXJyb3JQb3B1cCh0cmFuc2xhdGlvbnMuYnJvd3NlUGFnZS5sb2FkaW5nRGF0YUVycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0bWFpbi5hcHBlbmQoXHJcblx0XHRcdFx0Y3JlYXRlRm91ckNhdGVnb3JpZXModHJhbnNsYXRpb25zKSxcclxuXHJcblx0XHRcdFx0Y3JlYXRlRmlsbVNsaWRlcihcclxuXHRcdFx0XHRcdGZpbG1zLFxyXG5cdFx0XHRcdFx0dHJhbnNsYXRpb25zLFxyXG5cdFx0XHRcdFx0MSxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucy5icm93c2VTZWN0aW9uLnNlY3Rpb25OYW1lcy50cmVuZGluZyxcclxuXHRcdFx0XHRcdFwibW92aWVcIlxyXG5cdFx0XHRcdCksXHJcblx0XHRcdFx0Y3JlYXRlRmlsbVNsaWRlcihcclxuXHRcdFx0XHRcdGZpbG1zLFxyXG5cdFx0XHRcdFx0dHJhbnNsYXRpb25zLFxyXG5cdFx0XHRcdFx0MCxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucy5icm93c2VTZWN0aW9uLnNlY3Rpb25OYW1lcy51cGNvbWluZyxcclxuXHRcdFx0XHRcdFwibW92aWVcIlxyXG5cdFx0XHRcdCksXHJcblx0XHRcdFx0Y3JlYXRlRmlsbVNsaWRlcihcclxuXHRcdFx0XHRcdGZpbG1zLFxyXG5cdFx0XHRcdFx0dHJhbnNsYXRpb25zLFxyXG5cdFx0XHRcdFx0MixcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucy5icm93c2VTZWN0aW9uLnNlY3Rpb25OYW1lcy50b3BSYXRlZFNlcmllcyxcclxuXHRcdFx0XHRcdFwidHZcIlxyXG5cdFx0XHRcdCksXHJcblx0XHRcdFx0Y3JlYXRlRmlsbVNsaWRlcihcclxuXHRcdFx0XHRcdGZpbG1zLFxyXG5cdFx0XHRcdFx0dHJhbnNsYXRpb25zLFxyXG5cdFx0XHRcdFx0MyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucy5icm93c2VTZWN0aW9uLnNlY3Rpb25OYW1lcy5mdXR1cmVGaWxtcyxcclxuXHRcdFx0XHRcdFwibW92aWVcIlxyXG5cdFx0XHRcdClcclxuXHRcdFx0KTtcclxuXHRcdFx0cHJlcGFyZUNhcm91c2VsSXRlbXMoY29udGFpbmVyKTtcclxuXHRcdFx0Y29udGFpbmVyLmFwcGVuZChjcmVhdGVGb290ZXIodHJhbnNsYXRpb25zKSk7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fSBmaW5hbGx5IHtcclxuXHRcdFx0aGlkZUJpZ0xvYWRlcigpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdGNvbnN0IGdldEFsbEZpbG1zID0gYXN5bmMgKGxhbmcsIC4uLnVybHMpID0+IHtcclxuXHRcdGNvbnN0IGZpbG1zQXJyID0gW107XHJcblx0XHRmb3IgYXdhaXQgKGNvbnN0IHVybCBvZiB1cmxzKSB7XHJcblx0XHRcdGNvbnN0IFVSTCA9XHJcblx0XHRcdFx0dXJsICsgbGFuZyArIEZJTE1TX1BBR0VTX0FNT1VOVCArIFBBR0VfVE9fU0hPV19PTl9TTUFMTF9DQVJPVVNFTFM7XHJcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goVVJMLCBvcHRpb25zKTtcclxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuXHJcblx0XHRcdGZpbG1zQXJyLnB1c2goZGF0YSk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gZmlsbXNBcnI7XHJcblx0fTtcclxuXHRjb25zdCBnZXRGaWxtcyA9IGFzeW5jIChsYW5nLCBwYWdlTnVtLCB1cmwpID0+IHtcclxuXHRcdGNvbnN0IFVSTCA9IHVybCArIGxhbmcgKyBGSUxNU19QQUdFU19BTU9VTlQgKyBwYWdlTnVtO1xyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goVVJMLCBvcHRpb25zKTtcclxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuXHJcblx0XHRcdHJldHVybiBkYXRhO1xyXG5cdFx0fSBjYXRjaCB7XHJcblx0XHRcdHNob3dFcnJvclBvcHVwKHRyYW5zbGF0aW9ucy5icm93c2VQYWdlLmxvYWRpbmdEYXRhRXJyb3IsIFwiI2RjNGEzNFwiKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRjb25zdCBsb2FkRmlsbXNUb0Nhcm91c2VsbCA9IGFzeW5jIChsYW5nLCBwYWdlTnVtKSA9PiB7XHJcblx0XHRjb25zdCByZXF1ZXN0cyA9IFtdO1xyXG5cclxuXHRcdGZvciAobGV0IGkgPSAxOyBpIDw9IHBhZ2VOdW07IGkrKykge1xyXG5cdFx0XHRyZXF1ZXN0cy5wdXNoKGdldEZpbG1zKGxhbmcsIGksIFBPUFVMQVJfRklMTVNfVVJMKSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwocmVxdWVzdHMpO1xyXG5cdFx0XHRyZXR1cm4gcmVzcG9uc2VzO1xyXG5cdFx0fSBjYXRjaCB7XHJcblx0XHRcdHNob3dFcnJvclBvcHVwKHRyYW5zbGF0aW9ucy5icm93c2VQYWdlLmxvYWRpbmdEYXRhRXJyb3IsIFwiI2RjNGEzNFwiKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRjb25zdCBjaG9vc2VGaWxtc1RvQ2Fyb3VzZWxsID0gYXN5bmMgKGRhdGEsIGN1cnJlbnRMYW5ndWFnZSkgPT4ge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgcGFnZXNEYXRhID0gYXdhaXQgZGF0YShjdXJyZW50TGFuZ3VhZ2UsIENBUk9VU0VMTF9MRU5HVEgpO1xyXG5cdFx0XHRjb25zdCBmaWx0ZXJlZERhdGEgPSBwYWdlc0RhdGEubWFwKChmaWxtKSA9PiBmaWx0ZXJEYXRhKGZpbG0ucmVzdWx0cykpO1xyXG5cdFx0XHRjb25zdCByYW5kb21OdW1iZXIgPSBNYXRoLnRydW5jKE1hdGgucmFuZG9tKCkgKiBGSUxNX0FNT1VOVF9QRVJfUEFHRSk7XHJcblx0XHRcdGNvbnN0IGNob29zZW5Nb3ZpZXMgPSBmaWx0ZXJlZERhdGEubWFwKChwYWdlKSA9PiBwYWdlW3JhbmRvbU51bWJlcl0pO1xyXG5cdFx0XHRyZXR1cm4gY2hvb3Nlbk1vdmllcztcclxuXHRcdH0gY2F0Y2gge1xyXG5cdFx0XHRzaG93RXJyb3JQb3B1cCh0cmFuc2xhdGlvbnMuYnJvd3NlUGFnZS5sb2FkaW5nRGF0YUVycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHR9IGZpbmFsbHkge1xyXG5cdFx0XHRoaWRlQmlnTG9hZGVyKCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHRjb25zdCBmaWx0ZXJEYXRhID0gKGZpbG1zKSA9PiB7XHJcblx0XHRjb25zdCBjaG9vc2VuRmlsbXMgPSBmaWxtcy5maWx0ZXIoKGZpbG0pID0+IGZpbG0ucG9wdWxhcml0eSA+PSAxMC4wKTtcclxuXHRcdHJldHVybiBjaG9vc2VuRmlsbXM7XHJcblx0fTtcclxuXHQvLyBDQVJPVVNFTExcclxuXHJcblx0Y29uc3QgaGFuZGxlRmlsbXNDYXJvdXNlbGwgPSAoY29udGFpbmVyLCBtb3ZpZXMpID0+IHtcclxuXHRcdGNvbnN0IGltYWdlU2xpZGVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX2ltYWdlc1wiKTtcclxuXHRcdGNvbnN0IGFsbEltYWdlcyA9IGltYWdlU2xpZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLW1haW5fX2ltZy1ib3hcIik7XHJcblx0XHRjb25zdCBjYXJvdXNlbGxDb250cm9scyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRcIi5icm93c2UtbWFpbl9fY2Fyb3VzZWxsLWNvbnRyb2xzXCJcclxuXHRcdCk7XHJcblx0XHRhbGxJbWFnZXMuZm9yRWFjaCgoaW1nKSA9PiBpbWcuY2xhc3NMaXN0LnJlbW92ZShcImN1cnJlbnRWaXNpYmxlXCIpKTtcclxuXHJcblx0XHRpbWFnZVNsaWRlci5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgkey1pbmRleCAqIGNhcm91c2VsbFdpZHRofSUpYDtcclxuXHRcdGhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUoaW5kZXgsIGNhcm91c2VsbENvbnRyb2xzKTtcclxuXHRcdGFsbEltYWdlc1tpbmRleF0uY2xhc3NMaXN0LmFkZChcImN1cnJlbnRWaXNpYmxlXCIpO1xyXG5cclxuXHRcdGluZGV4Kys7XHJcblxyXG5cdFx0aWYgKGluZGV4ID4gbW92aWVzLmxlbmd0aCAtIDEpIGluZGV4ID0gMDtcclxuXHJcblx0XHRoYW5kbGVCdG5zVmlzaWJpbGl0eShjb250YWluZXIpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUgPSAoaW5kZXgsIGNhcm91c2VsbENvbnRyb2xzQm94KSA9PiB7XHJcblx0XHRjb25zdCBhbGxDb250cm9sQnRucyA9XHJcblx0XHRcdGNhcm91c2VsbENvbnRyb2xzQm94LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLW1haW5fX2J0blwiKTtcclxuXHRcdGNvbnN0IGN1cnJlbnRCdG4gPSBjYXJvdXNlbGxDb250cm9sc0JveC5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRgLmJyb3dzZS1tYWluX19idG5bZGF0YS1pbWc9XCIke2luZGV4fVwiXWBcclxuXHRcdCk7XHJcblx0XHRjb25zdCBwcm9ncmVzc0JhciA9IGN1cnJlbnRCdG4ucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9fcHJvZ3Jlc3MtYmFyXCIpO1xyXG5cdFx0Y29uc3QgYWxsUHJvZ3Jlc3NCYXJzID0gY2Fyb3VzZWxsQ29udHJvbHNCb3gucXVlcnlTZWxlY3RvckFsbChcclxuXHRcdFx0XCIuYnJvd3NlLW1haW5fX3Byb2dyZXNzLWJhclwiXHJcblx0XHQpO1xyXG5cclxuXHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLmZvckVhY2goKGludGVydmFsKSA9PiBjbGVhckludGVydmFsKGludGVydmFsKSk7XHJcblx0XHRwcm9ncmVzc0JhckludGVydmFscy5jbGVhcigpO1xyXG5cclxuXHRcdGFsbFByb2dyZXNzQmFycy5mb3JFYWNoKChiYXIpID0+IChiYXIuc3R5bGUud2lkdGggPSBcIjBcIikpO1xyXG5cclxuXHRcdGNoYW5nZVByb2dyZXNzQmFyKHByb2dyZXNzQmFyLCBpbmRleCk7XHJcblxyXG5cdFx0YWxsQ29udHJvbEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKSk7XHJcblx0XHRjdXJyZW50QnRuLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgY2hhbmdlUHJvZ3Jlc3NCYXIgPSAocHJvZ3Jlc3NCYXIsIGJ0bkluZGV4KSA9PiB7XHJcblx0XHRpZiAocHJvZ3Jlc3NCYXJJbnRlcnZhbHMuaGFzKGJ0bkluZGV4KSkge1xyXG5cdFx0XHRjbGVhckludGVydmFsKHByb2dyZXNzQmFySW50ZXJ2YWxzLmdldChidG5JbmRleCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCB3aWR0aCA9IDA7XHJcblx0XHRjb25zdCBwcm9ncmVzc0JhckludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHR3aWR0aCArPSBjYXJvdXNlbGxTdHJva2VSYW5nZTtcclxuXHRcdFx0cHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHt3aWR0aH0lYDtcclxuXHRcdFx0aWYgKHdpZHRoID49IDEwMCkge1xyXG5cdFx0XHRcdHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gXCIwXCI7XHJcblx0XHRcdFx0Y2xlYXJJbnRlcnZhbChwcm9ncmVzc0JhckludGVydmFsKTtcclxuXHJcblx0XHRcdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuZGVsZXRlKGJ0bkluZGV4KTtcclxuXHRcdFx0fVxyXG5cdFx0fSwgaW50ZXJ2YWxTcGVlZCk7XHJcblxyXG5cdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuc2V0KGJ0bkluZGV4LCBwcm9ncmVzc0JhckludGVydmFsKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBjaGFuZ2VDdXJyZW50SW1nID0gKG1vdmllcywgY29udGFpbmVyKSA9PiB7XHJcblx0XHRjb25zdCBjYXJvdXNlbGxDb250cm9scyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRcIi5icm93c2UtbWFpbl9fY2Fyb3VzZWxsLWNvbnRyb2xzXCJcclxuXHRcdCk7XHJcblxyXG5cdFx0Y2Fyb3VzZWxsQ29udHJvbHMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRcdGlmIChlLnRhcmdldC5tYXRjaGVzKFwiLmJyb3dzZS1tYWluX19idG5cIikpIHtcclxuXHRcdFx0XHRpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlXCIpKSByZXR1cm47XHJcblxyXG5cdFx0XHRcdGNsZWFySW50ZXJ2YWwoY2Fyb3VzZWxsSW50ZXJ2YWwpO1xyXG5cclxuXHRcdFx0XHRjb25zdCBjdXJyZW50QnRuID0gZS50YXJnZXQ7XHJcblx0XHRcdFx0Y29uc3QgaW1nRGF0YSA9IHBhcnNlSW50KGN1cnJlbnRCdG4uZGF0YXNldC5pbWcpO1xyXG5cclxuXHRcdFx0XHRpbmRleCA9IGltZ0RhdGE7XHJcblx0XHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cclxuXHRcdFx0XHRjYXJvdXNlbGxJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuXHRcdFx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdFx0XHR9LCBjYXJvdXNlbGxTcGVlZCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZUJ0bnNWaXNpYmlsaXR5ID0gKGNvbnRhaW5lcikgPT4ge1xyXG5cdFx0Y29uc3QgYWxsRmlsbXMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2UtbWFpbl9faW1nLWJveFwiKTtcclxuXHJcblx0XHRhbGxGaWxtcy5mb3JFYWNoKChmaWxtKSA9PiB7XHJcblx0XHRcdGNvbnN0IGlzQWN0aXZlID0gZmlsbS5jbGFzc0xpc3QuY29udGFpbnMoXCJjdXJyZW50VmlzaWJsZVwiKTtcclxuXHRcdFx0Y29uc3QgdGFiaW5kZXggPSBpc0FjdGl2ZSA/IDAgOiAtMTtcclxuXHRcdFx0Y29uc3QgdmlzaWJpbGl0eSA9IHRhYmluZGV4ID09PSAwID8gXCJ2aXNpYmxlXCIgOiBcImhpZGRlblwiO1xyXG5cdFx0XHRnaXZlQnRuc0F0dHJpYnV0ZShmaWxtLCB0YWJpbmRleCwgdmlzaWJpbGl0eSk7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cdGNvbnN0IGdpdmVCdG5zQXR0cmlidXRlID0gKGZpbG0sIHRhYmluZGV4LCB2aXNpYmlsaXR5KSA9PiB7XHJcblx0XHRjb25zdCB0cmFpbGVyQnRuID0gZmlsbS5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1tYWluX190cmFpbGVyLWJ0blwiKTtcclxuXHRcdGNvbnN0IHNlZU1vcmVCdG4gPSBmaWxtLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX3NlZS1tb3JlLWJ0blwiKTtcclxuXHJcblx0XHR0cmFpbGVyQnRuLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIHRhYmluZGV4KTtcclxuXHRcdHNlZU1vcmVCdG4uc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgdGFiaW5kZXgpO1xyXG5cdFx0dHJhaWxlckJ0bi5zdHlsZS52aXNpYmlsaXR5ID0gdmlzaWJpbGl0eTtcclxuXHRcdHNlZU1vcmVCdG4uc3R5bGUudmlzaWJpbGl0eSA9IHZpc2liaWxpdHk7XHJcblx0fTtcclxuXHJcblx0bGV0IHN0YXJ0WDtcclxuXHRsZXQgZW5kWDtcclxuXHRsZXQgc3RhcnRZO1xyXG5cdGxldCBlbmRZO1xyXG5cclxuXHRjb25zdCBoYW5kbGVUb3VjaFN0YXJ0RXZlbnQgPSAoZSkgPT4ge1xyXG5cdFx0c3RhcnRYID0gZS50b3VjaGVzWzBdLmNsaWVudFg7XHJcblx0XHRzdGFydFkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVUb3VjaEVuZEV2ZW50ID0gKGUsIGNvbnRhaW5lciwgbW92aWVzKSA9PiB7XHJcblx0XHRlbmRYID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRYO1xyXG5cdFx0ZW5kWSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WTtcclxuXHRcdGhhbmRsZVN3aXBlKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVTd2lwZSA9IChjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0Y29uc3QgSE9SSVpPTlRBTF9SQU5HRSA9IDMwO1xyXG5cdFx0Y29uc3QgVkVSVElDQUxfUkFOR0UgPSAzMDtcclxuXHJcblx0XHRjb25zdCBob3Jpem9udGFsRGlzdGFuY2UgPSBNYXRoLmFicyhzdGFydFggLSBlbmRYKTtcclxuXHRcdGNvbnN0IHZlcnRpY2FsRGlzdGFuY2UgPSBNYXRoLmFicyhzdGFydFkgLSBlbmRZKTtcclxuXHJcblx0XHRpZiAoXHJcblx0XHRcdGhvcml6b250YWxEaXN0YW5jZSA8IEhPUklaT05UQUxfUkFOR0UgfHxcclxuXHRcdFx0dmVydGljYWxEaXN0YW5jZSA+IFZFUlRJQ0FMX1JBTkdFXHJcblx0XHQpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGVuZFggLSBzdGFydFggPiBIT1JJWk9OVEFMX1JBTkdFKSB7XHJcblx0XHRcdGluZGV4ID0gKGluZGV4IC0gMiArIG1vdmllcy5sZW5ndGgpICUgbW92aWVzLmxlbmd0aDtcclxuXHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0fSBlbHNlIGlmIChzdGFydFggLSBlbmRYID4gSE9SSVpPTlRBTF9SQU5HRSkge1xyXG5cdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y2xlYXJJbnRlcnZhbChjYXJvdXNlbGxJbnRlcnZhbCk7XHJcblx0XHRjYXJvdXNlbGxJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuXHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0fSwgY2Fyb3VzZWxsU3BlZWQpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IHNldFRvdWNoRXZlbnRMaXN0ZW5lciA9IChjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0Y29uc3QgaW1hZ2VTbGlkZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9faW1hZ2VzXCIpO1xyXG5cclxuXHRcdGltYWdlU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIChlKSA9PiB7XHJcblx0XHRcdGhhbmRsZVRvdWNoU3RhcnRFdmVudChlKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGltYWdlU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCAoZSkgPT4ge1xyXG5cdFx0XHRoYW5kbGVUb3VjaEVuZEV2ZW50KGUsIGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGNoYW5nZUNhcm91c2VsbERhdGFJbmRleCA9IChzbGlkZXIsIGluZGV4KSA9PiB7XHJcblx0XHRzbGlkZXIuZGF0YXNldC5pbmRleCA9IGluZGV4O1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGdldENhcm91c2VsQ29uZmlnID0gKCkgPT4ge1xyXG5cdFx0bGV0IG1heEluZGV4O1xyXG5cclxuXHRcdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IDU3NikgbWF4SW5kZXggPSA5O1xyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoID49IDU3NiAmJiB3aW5kb3cuaW5uZXJXaWR0aCA8IDk5MikgbWF4SW5kZXggPSAxNztcclxuXHRcdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSA5OTIgJiYgd2luZG93LmlubmVyV2lkdGggPCAxMjAwKSBtYXhJbmRleCA9IDQ7XHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPj0gMTIwMCkgbWF4SW5kZXggPSA3O1xyXG5cclxuXHRcdHJldHVybiBtYXhJbmRleDtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBzZXRUaHJlc2hvbGQgPSAoKSA9PiB7XHJcblx0XHRsZXQgdGhyZXNob2xkID0gMjtcclxuXHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPiA1NzYgJiYgd2luZG93LmlubmVyV2lkdGggPCA5OTIpIHRocmVzaG9sZCA9IDE7XHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPj0gOTkyICYmIHdpbmRvdy5pbm5lcldpZHRoIDwgMTIwMCkgdGhyZXNob2xkID0gNDtcclxuXHJcblx0XHRyZXR1cm4gdGhyZXNob2xkO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IG1vdmVTbGlkZXIgPSAoc2xpZGVyKSA9PiB7XHJcblx0XHRjb25zdCB0aHJlc2hvbGQgPSBzZXRUaHJlc2hvbGQoKTtcclxuXHRcdGxldCBzbGlkZXJEYXRhc2V0ID0gc2xpZGVyLmRhdGFzZXQuaW5kZXg7XHJcblx0XHRjb25zdCBzbGlkZXJDYXJvdXNlbGwgPSBzbGlkZXIucXVlcnlTZWxlY3RvcihcclxuXHRcdFx0XCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlci1pbWFnZXNcIlxyXG5cdFx0KTtcclxuXHJcblx0XHRjb25zdCBwb3N0ZXIgPSBzbGlkZXIucXVlcnlTZWxlY3RvcihcIi5icm93c2Utc2VjdGlvbl9fc2xpZGVyLWJveFwiKTtcclxuXHRcdGlmICghcG9zdGVyKSByZXR1cm47XHJcblxyXG5cdFx0Y29uc3QgcG9zdGVyV2lkdGggPSBwb3N0ZXIub2Zmc2V0V2lkdGg7XHJcblx0XHRzbGlkZXJDYXJvdXNlbGwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHtcclxuXHRcdFx0LXNsaWRlckRhdGFzZXQgKiBwb3N0ZXJXaWR0aCAqIHRocmVzaG9sZFxyXG5cdFx0fXB4KWA7XHJcblx0fTtcclxuXHJcblx0Y29uc3Qgc2hvd05leHRTbGlkZSA9IChzbGlkZXIsIGluZGV4KSA9PiB7XHJcblx0XHRsZXQgaW5pdGlhbEluZGV4ID0gaW5kZXggPT09IDAgPyBwYXJzZUludChzbGlkZXIuZGF0YXNldC5pbmRleCkgOiAwO1xyXG5cdFx0Y29uc3QgbWF4SW5kZXggPSBnZXRDYXJvdXNlbENvbmZpZygpO1xyXG5cclxuXHRcdGlmIChpbml0aWFsSW5kZXggPj0gbWF4SW5kZXgpIHJldHVybjtcclxuXHJcblx0XHRpbml0aWFsSW5kZXgrKztcclxuXHRcdGNoYW5nZUNhcm91c2VsbERhdGFJbmRleChzbGlkZXIsIGluaXRpYWxJbmRleCk7XHJcblx0XHRtb3ZlU2xpZGVyKHNsaWRlcik7XHJcblx0fTtcclxuXHJcblx0Y29uc3Qgc2hvd1ByZXZTbGlkZSA9IChzbGlkZXIsIGluZGV4KSA9PiB7XHJcblx0XHRsZXQgaW5pdGlhbEluZGV4ID0gaW5kZXggPT09IDAgPyBwYXJzZUludChzbGlkZXIuZGF0YXNldC5pbmRleCkgOiAwO1xyXG5cclxuXHRcdGlmIChpbml0aWFsSW5kZXggPD0gMCkgcmV0dXJuO1xyXG5cclxuXHRcdGluaXRpYWxJbmRleC0tO1xyXG5cdFx0Y2hhbmdlQ2Fyb3VzZWxsRGF0YUluZGV4KHNsaWRlciwgaW5pdGlhbEluZGV4KTtcclxuXHRcdG1vdmVTbGlkZXIoc2xpZGVyKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBwcmVwYXJlQ2Fyb3VzZWxJdGVtcyA9IChjb250YWluZXIpID0+IHtcclxuXHRcdGNvbnN0IHNsaWRlcnMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2Utc2VjdGlvbl9fc2xpZGVyXCIpO1xyXG5cclxuXHRcdHNsaWRlcnMuZm9yRWFjaCgoc2xpZGVyKSA9PlxyXG5cdFx0XHRzbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRcdFx0bGV0IHNtYWxsQ2Fyb3VzZWxsSW5kZXggPSAwO1xyXG5cclxuXHRcdFx0XHRpZiAoZS50YXJnZXQubWF0Y2hlcyhcIi5icm93c2Utc2VjdGlvbl9fc2xpZGVyLW5leHQtYnRuXCIpKSB7XHJcblx0XHRcdFx0XHRzaG93TmV4dFNsaWRlKHNsaWRlciwgc21hbGxDYXJvdXNlbGxJbmRleCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmIChlLnRhcmdldC5tYXRjaGVzKFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXItcHJldi1idG5cIikpIHtcclxuXHRcdFx0XHRcdHNob3dQcmV2U2xpZGUoc2xpZGVyLCBzbWFsbENhcm91c2VsbEluZGV4KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pXHJcblx0XHQpO1xyXG5cdH07XHJcblxyXG5cdGxldCBsYXN0V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCAoKSA9PiB7XHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPT09IGxhc3RXaWR0aCkgcmV0dXJuO1xyXG5cdFx0bGFzdFdpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XHJcblxyXG5cdFx0Y29uc3QgYWxsU2xpZGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlclwiKTtcclxuXHRcdGFsbFNsaWRlcnMuZm9yRWFjaCgoc2xpZGVyKSA9PiB7XHJcblx0XHRcdGNvbnN0IHNsaWRlckNhcm91c2VsbCA9IHNsaWRlci5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRcdFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXItaW1hZ2VzXCJcclxuXHRcdFx0KTtcclxuXHRcdFx0Y2hhbmdlQ2Fyb3VzZWxsRGF0YUluZGV4KHNsaWRlciwgMCk7XHJcblx0XHRcdHNsaWRlckNhcm91c2VsbC5zdHlsZS50cmFuc2Zvcm0gPSBcInRyYW5zbGF0ZVgoMClcIjtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidW5sb2FkXCIsICgpID0+IHtcclxuXHRcdGNsZWFySW50ZXJ2YWwoY2Fyb3VzZWxsSW50ZXJ2YWwpO1xyXG5cdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuZm9yRWFjaCgoaW50ZXJ2YWwpID0+IGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpKTtcclxuXHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLmNsZWFyKCk7XHJcblx0fSk7XHJcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0Y2xvc2VBbGxOb3RDbGlja2VkKGUpO1xyXG5cdH0pO1xyXG5cdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRjb25zdCB3aW5kb3dFeGlzdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRyYWlsZXItd2luZG93XCIpO1xyXG5cclxuXHRcdGlmIChcclxuXHRcdFx0ZS50YXJnZXQubWF0Y2hlcyhcIi5icm93c2UtbWFpbl9fdHJhaWxlci1idG5cIikgfHxcclxuXHRcdFx0ZS50YXJnZXQubWF0Y2hlcyhcIi5leHBsb3JlX19maWxtLXNob3ctdHJhaWxlci1idG5cIilcclxuXHRcdCkge1xyXG5cdFx0XHRjcmVhdGVUcmFpbGVyV2luZG93KGUpO1xyXG5cdFx0fSBlbHNlIGlmIChcclxuXHRcdFx0d2luZG93RXhpc3RzICYmXHJcblx0XHRcdChlLnRhcmdldC5tYXRjaGVzKFwiLmNsb3NlLXRyYWlsZXItd2luZG93XCIpIHx8XHJcblx0XHRcdFx0ZS50YXJnZXQubWF0Y2hlcyhcIi5vdmVybGF5XCIpKVxyXG5cdFx0KSB7XHJcblx0XHRcdGhpZGVUcmFpbGVyV2luZG93KCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblx0Y2hlY2tBdXRob3JpemF0aW9uKCk7XHJcbn0pO1xyXG4iXX0=
