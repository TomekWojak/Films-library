import{getData,createBrowsePage,createMainHeroSection,showErrorPopup,showBigLoader,hideBigLoader}from"./components.min.js";document.addEventListener("DOMContentLoaded",function(){const e={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNTYwZjM4MjU3NDQ1ZGE1ZGZkYTYxYzE0YWM4YmM4MyIsIm5iZiI6MTc1OTc2NTAzOC45NCwic3ViIjoiNjhlM2UyMmUyNjY5NzY4MzhlYzI3NzI5Iiwic2NvcGVzIjpbImFwaV9yZWFkIl0sInZlcnNpb24iOjF9.nuGfEjclJLepmzzHi2omNhp29THgrJf9Nv6D4_gTdxA"}},t=new Map;let r,a=15e3,o=0;const s=async(t,r)=>{const a=`https://api.themoviedb.org/3/movie/popular?language=${t}&page=${r}`;try{const t=await fetch(a,e);return await t.json()}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},n=async(e,t)=>{const r=[];for(let a=1;a<=t;a++)r.push(s(e,a));try{return await Promise.all(r)}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},i=async(e,t)=>{try{const r=await e(t,5),a=Math.trunc(20*Math.random());return r.map(e=>e.results[a])}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}},c=(e,t)=>{const r=e.querySelector(".browse-main__images"),a=r.querySelectorAll(".browse-main__img-box"),s=e.querySelector(".browse-main__carousell-controls");a[a.length-1].classList.remove("currentVisible"),a[o-1]?.classList.remove("currentVisible"),r.style.transform=`translateX(${100*-o}%)`,l(o,s),a[o].classList.add("currentVisible"),o++,o>t.length-1&&(o=0),u(e)},l=(e,r)=>{const a=r.querySelectorAll(".browse-main__btn"),o=r.querySelector(`.browse-main__btn[data-img="${e}"]`),s=o.querySelector(".browse-main__progress-bar"),n=r.querySelectorAll(".browse-main__progress-bar");t.forEach(e=>clearInterval(e)),t.clear(),n.forEach(e=>e.style.width="0"),d(s,e),a.forEach(e=>e.classList.remove("active")),o.classList.add("active")},d=(e,r)=>{t.has(r)&&clearInterval(t.get(r));let a=0;const o=setInterval(()=>{a+=5,e.style.width=`${a}%`,a>=100&&(e.style.width="0",clearInterval(o),t.delete(r))},750);t.set(r,o)},m=(e,t,r)=>{t.querySelector(".browse-main__carousell-controls").addEventListener("click",s=>{if(s.target.matches(".browse-main__btn")){if(s.target.classList.contains("active"))return;clearInterval(r);const n=s.target,i=parseInt(n.dataset.img);o=i,c(t,e),r=setInterval(()=>{c(t,e)},a)}})},u=e=>{e.querySelectorAll(".browse-main__img-box").forEach(e=>{const t=e.classList.contains("currentVisible");h(e,t?0:-1)})},h=(e,t)=>{const r=e.querySelector(".browse-main__trailer-btn"),a=e.querySelector(".browse-main__see-more-btn");r.setAttribute("tabindex",t),a.setAttribute("tabindex",t)};(()=>{const e=getData(),t=e?.translations,o=e?.preferredLanguage,s=e?.loggedIn,l=document.querySelector(".container");e&&s?(l.prepend(createBrowsePage(t)),l.append(showBigLoader()),i(n,o).then(e=>{createMainHeroSection(e,t,l),c(l,e),r=setInterval(()=>{c(l,e)},a),m(e,l,r)})):window.location.href="/"})()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi1wYWdlLm1pbi5qcyIsIm5hbWVzIjpbImdldERhdGEiLCJjcmVhdGVCcm93c2VQYWdlIiwiY3JlYXRlTWFpbkhlcm9TZWN0aW9uIiwic2hvd0Vycm9yUG9wdXAiLCJzaG93QmlnTG9hZGVyIiwiaGlkZUJpZ0xvYWRlciIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9wdGlvbnMiLCJtZXRob2QiLCJoZWFkZXJzIiwiYWNjZXB0IiwiQXV0aG9yaXphdGlvbiIsInByb2dyZXNzQmFySW50ZXJ2YWxzIiwiTWFwIiwiY2Fyb3VzZWxsSW50ZXJ2YWwiLCJjYXJvdXNlbGxTcGVlZCIsImluZGV4IiwiZ2V0UG9wdWxhckZpbG1zIiwiYXN5bmMiLCJsYW5nIiwicGFnZU51bSIsIlVSTCIsInJlc3BvbnNlIiwiZmV0Y2giLCJqc29uIiwidHJhbnNsYXRpb25zIiwiYnJvd3NlUGFnZSIsImxvYWRpbmdEYXRhRXJyb3IiLCJsb2FkRmlsbXNUb0Nhcm91c2VsbCIsInJlcXVlc3RzIiwiaSIsInB1c2giLCJQcm9taXNlIiwiYWxsIiwiY2hvb3NlRmlsbXNUb0Nhcm91c2VsbCIsImRhdGEiLCJjdXJyZW50TGFuZ3VhZ2UiLCJwYWdlc0RhdGEiLCJyYW5kb21OdW1iZXIiLCJNYXRoIiwidHJ1bmMiLCJyYW5kb20iLCJtYXAiLCJwYWdlIiwicmVzdWx0cyIsImhhbmRsZUZpbG1zQ2Fyb3VzZWxsIiwiY29udGFpbmVyIiwibW92aWVzIiwiaW1hZ2VTbGlkZXIiLCJxdWVyeVNlbGVjdG9yIiwiYWxsSW1hZ2VzIiwicXVlcnlTZWxlY3RvckFsbCIsImNhcm91c2VsbENvbnRyb2xzIiwibGVuZ3RoIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJoYW5kbGVDYXJvdXNlbGxDb250cm9sc1N0YXRlIiwiYWRkIiwiaGFuZGxlQnRuc1Zpc2liaWxpdHkiLCJjYXJvdXNlbGxDb250cm9sc0JveCIsImFsbENvbnRyb2xCdG5zIiwiY3VycmVudEJ0biIsInByb2dyZXNzQmFyIiwiYWxsUHJvZ3Jlc3NCYXJzIiwiZm9yRWFjaCIsImludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImNsZWFyIiwiYmFyIiwid2lkdGgiLCJjaGFuZ2VQcm9ncmVzc0JhciIsImJ0biIsImJ0bkluZGV4IiwiaGFzIiwiZ2V0IiwicHJvZ3Jlc3NCYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiZGVsZXRlIiwic2V0IiwiY2hhbmdlQ3VycmVudEltZyIsImUiLCJ0YXJnZXQiLCJtYXRjaGVzIiwiY29udGFpbnMiLCJpbWdEYXRhIiwicGFyc2VJbnQiLCJkYXRhc2V0IiwiaW1nIiwiZmlsbSIsImlzQWN0aXZlIiwiZ2l2ZUJ0bnNBdHRyaWJ1dGUiLCJ0YWJpbmRleCIsInRyYWlsZXJCdG4iLCJzZWVNb3JlQnRuIiwic2V0QXR0cmlidXRlIiwidXNlckRhdGEiLCJwcmVmZXJyZWRMYW5ndWFnZSIsImlzTG9nZ2VkSW4iLCJsb2dnZWRJbiIsInByZXBlbmQiLCJhcHBlbmQiLCJ0aGVuIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiY2hlY2tBdXRob3JpemF0aW9uIl0sInNvdXJjZXMiOlsibWFpbi1wYWdlLmpzIl0sIm1hcHBpbmdzIjoiT0FDQ0EsUUFDQUMsaUJBQ0FDLHNCQUNBQyxlQUNBQyxjQUNBQyxrQkFDTSxzQkFDUEMsU0FBU0MsaUJBQWlCLG1CQUFvQixXQUU3QyxNQUVNQyxFQUFVLENBQ2ZDLE9BQVEsTUFDUkMsUUFBUyxDQUNSQyxPQUFRLG1CQUNSQyxjQUNDLHlQQUdHQyxFQUF1QixJQUFJQyxJQUNqQyxJQUtJQyxFQUxBQyxFQUFpQixLQUlqQkMsRUFBUSxFQUdaLE1BNkJNQyxFQUFrQkMsTUFBT0MsRUFBTUMsS0FDcEMsTUFBTUMsRUFBTSx1REFBdURGLFVBQWFDLElBRWhGLElBQ0MsTUFBTUUsUUFBaUJDLE1BQU1GLEVBQUtkLEdBR2xDLGFBRm1CZSxFQUFTRSxNQUc3QixDQUFFLE1BQ0R0QixlQUFldUIsYUFBYUMsV0FBV0MsaUJBQWtCLFVBQzFELEdB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QUNoQyxNQUFNQyxFQUFhSixFQUFLekMsY0FBYyw2QkFDaEM4QyxFQUFhTCxFQUFLekMsY0FBYyw4QkFFdEM2QyxFQUFXRSxhQUFhLFdBQVlILEdBQ3BDRSxFQUFXQyxhQUFhLFdBQVlILElBN0tWLE1BQzFCLE1BQU1JLEVBQVdsRyxVQUNYMEIsRUFBZXdFLEdBQVV4RSxhQUN6QlcsRUFBa0I2RCxHQUFVQyxrQkFDNUJDLEVBQWFGLEdBQVVHLFNBRXZCdEQsRUFBWXpDLFNBQVM0QyxjQUFjLGNBRXBDZ0QsR0FBYUUsR0FHakJyRCxFQUFVdUQsUUFBUXJHLGlCQUFpQnlCLElBQ25DcUIsRUFBVXdELE9BQU9uRyxpQkFFakIrQixFQUF1Qk4sRUFBc0JRLEdBQWlCbUUsS0FDNUR4RCxJQUNBOUMsc0JBQXNCOEMsRUFBUXRCLEVBQWNxQixHQUM1Q0QsRUFBcUJDLEVBQVdDLEdBRWhDakMsRUFBb0JnRSxZQUFZLEtBQy9CakMsRUFBcUJDLEVBQVdDLElBQzlCaEMsR0FFSGtFLEVBQWlCbEMsRUFBUUQsRUFBV2hDLE1BZHRDMEYsT0FBT0MsU0FBU0MsS0FBTyxLQXNLekJDLEVBQ0QiLCJpZ25vcmVMaXN0IjpbXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuXHRnZXREYXRhLFxyXG5cdGNyZWF0ZUJyb3dzZVBhZ2UsXHJcblx0Y3JlYXRlTWFpbkhlcm9TZWN0aW9uLFxyXG5cdHNob3dFcnJvclBvcHVwLFxyXG5cdHNob3dCaWdMb2FkZXIsXHJcblx0aGlkZUJpZ0xvYWRlcixcclxufSBmcm9tIFwiLi9jb21wb25lbnRzLm1pbi5qc1wiO1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XHJcblx0Ly8gaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9kaXNjb3Zlci9tb3ZpZT9sYW5ndWFnZT1wbFxyXG5cdGNvbnN0IENBUk9VU0VMTF9MRU5HVEggPSA1O1xyXG5cdGNvbnN0IEZJTE1fQU1PVU5UX1BFUl9QQUdFID0gMjA7XHJcblx0Y29uc3Qgb3B0aW9ucyA9IHtcclxuXHRcdG1ldGhvZDogXCJHRVRcIixcclxuXHRcdGhlYWRlcnM6IHtcclxuXHRcdFx0YWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuXHRcdFx0QXV0aG9yaXphdGlvbjpcclxuXHRcdFx0XHRcIkJlYXJlciBleUpoYkdjaU9pSklVekkxTmlKOS5leUpoZFdRaU9pSXpOVFl3WmpNNE1qVTNORFExWkdFMVpHWmtZVFl4WXpFMFlXTTRZbU00TXlJc0ltNWlaaUk2TVRjMU9UYzJOVEF6T0M0NU5Dd2ljM1ZpSWpvaU5qaGxNMlV5TW1VeU5qWTVOelk0TXpobFl6STNOekk1SWl3aWMyTnZjR1Z6SWpwYkltRndhVjl5WldGa0lsMHNJblpsY25OcGIyNGlPakY5Lm51R2ZFamNsSkxlcG16ekhpMm9tTmhwMjlUSGdySmY5TnY2RDRfZ1RkeEFcIixcclxuXHRcdH0sXHJcblx0fTtcclxuXHRjb25zdCBwcm9ncmVzc0JhckludGVydmFscyA9IG5ldyBNYXAoKTtcclxuXHRsZXQgY2Fyb3VzZWxsU3BlZWQgPSAxNTAwMDtcclxuXHRsZXQgY2Fyb3VzZWxsU3Ryb2tlUmFuZ2UgPSA1O1xyXG5cdGxldCBpbnRlcnZhbFNwZWVkID0gKGNhcm91c2VsbFNwZWVkICogY2Fyb3VzZWxsU3Ryb2tlUmFuZ2UpIC8gMTAwO1xyXG5cdGxldCBjYXJvdXNlbGxXaWR0aCA9IDEwMDtcclxuXHRsZXQgaW5kZXggPSAwO1xyXG5cdGxldCBjYXJvdXNlbGxJbnRlcnZhbDtcclxuXHJcblx0Y29uc3QgY2hlY2tBdXRob3JpemF0aW9uID0gKCkgPT4ge1xyXG5cdFx0Y29uc3QgdXNlckRhdGEgPSBnZXREYXRhKCk7XHJcblx0XHRjb25zdCB0cmFuc2xhdGlvbnMgPSB1c2VyRGF0YT8udHJhbnNsYXRpb25zO1xyXG5cdFx0Y29uc3QgY3VycmVudExhbmd1YWdlID0gdXNlckRhdGE/LnByZWZlcnJlZExhbmd1YWdlO1xyXG5cdFx0Y29uc3QgaXNMb2dnZWRJbiA9IHVzZXJEYXRhPy5sb2dnZWRJbjtcclxuXHJcblx0XHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhaW5lclwiKTtcclxuXHJcblx0XHRpZiAoIXVzZXJEYXRhIHx8ICFpc0xvZ2dlZEluKSB7XHJcblx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvXCI7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRjb250YWluZXIucHJlcGVuZChjcmVhdGVCcm93c2VQYWdlKHRyYW5zbGF0aW9ucykpO1xyXG5cdFx0XHRjb250YWluZXIuYXBwZW5kKHNob3dCaWdMb2FkZXIoKSk7XHJcblxyXG5cdFx0XHRjaG9vc2VGaWxtc1RvQ2Fyb3VzZWxsKGxvYWRGaWxtc1RvQ2Fyb3VzZWxsLCBjdXJyZW50TGFuZ3VhZ2UpLnRoZW4oXHJcblx0XHRcdFx0KG1vdmllcykgPT4ge1xyXG5cdFx0XHRcdFx0Y3JlYXRlTWFpbkhlcm9TZWN0aW9uKG1vdmllcywgdHJhbnNsYXRpb25zLCBjb250YWluZXIpO1xyXG5cdFx0XHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cclxuXHRcdFx0XHRcdGNhcm91c2VsbEludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblx0XHRcdFx0XHR9LCBjYXJvdXNlbGxTcGVlZCk7XHJcblxyXG5cdFx0XHRcdFx0Y2hhbmdlQ3VycmVudEltZyhtb3ZpZXMsIGNvbnRhaW5lciwgY2Fyb3VzZWxsSW50ZXJ2YWwpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0KTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRjb25zdCBnZXRQb3B1bGFyRmlsbXMgPSBhc3luYyAobGFuZywgcGFnZU51bSkgPT4ge1xyXG5cdFx0Y29uc3QgVVJMID0gYGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvcG9wdWxhcj9sYW5ndWFnZT0ke2xhbmd9JnBhZ2U9JHtwYWdlTnVtfWA7XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChVUkwsIG9wdGlvbnMpO1xyXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG5cclxuXHRcdFx0cmV0dXJuIGRhdGE7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fVxyXG5cdH07XHJcblx0Y29uc3QgbG9hZEZpbG1zVG9DYXJvdXNlbGwgPSBhc3luYyAobGFuZywgcGFnZU51bSkgPT4ge1xyXG5cdFx0Y29uc3QgcmVxdWVzdHMgPSBbXTtcclxuXHJcblx0XHRmb3IgKGxldCBpID0gMTsgaSA8PSBwYWdlTnVtOyBpKyspIHtcclxuXHRcdFx0cmVxdWVzdHMucHVzaChnZXRQb3B1bGFyRmlsbXMobGFuZywgaSkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IFByb21pc2UuYWxsKHJlcXVlc3RzKTtcclxuXHRcdFx0cmV0dXJuIHJlc3BvbnNlcztcclxuXHRcdH0gY2F0Y2gge1xyXG5cdFx0XHRzaG93RXJyb3JQb3B1cCh0cmFuc2xhdGlvbnMuYnJvd3NlUGFnZS5sb2FkaW5nRGF0YUVycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0Y29uc3QgY2hvb3NlRmlsbXNUb0Nhcm91c2VsbCA9IGFzeW5jIChkYXRhLCBjdXJyZW50TGFuZ3VhZ2UpID0+IHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHBhZ2VzRGF0YSA9IGF3YWl0IGRhdGEoY3VycmVudExhbmd1YWdlLCBDQVJPVVNFTExfTEVOR1RIKTtcclxuXHRcdFx0Y29uc3QgcmFuZG9tTnVtYmVyID0gTWF0aC50cnVuYyhNYXRoLnJhbmRvbSgpICogRklMTV9BTU9VTlRfUEVSX1BBR0UpO1xyXG5cdFx0XHRjb25zdCBjaG9vc2VuTW92aWVzID0gcGFnZXNEYXRhLm1hcCgocGFnZSkgPT4gcGFnZS5yZXN1bHRzW3JhbmRvbU51bWJlcl0pO1xyXG5cclxuXHRcdFx0cmV0dXJuIGNob29zZW5Nb3ZpZXM7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fSBmaW5hbGx5IHtcclxuXHRcdFx0aGlkZUJpZ0xvYWRlcigpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8vIENBUk9VU0VMTFxyXG5cclxuXHRjb25zdCBoYW5kbGVGaWxtc0Nhcm91c2VsbCA9IChjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0Y29uc3QgaW1hZ2VTbGlkZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9faW1hZ2VzXCIpO1xyXG5cdFx0Y29uc3QgYWxsSW1hZ2VzID0gaW1hZ2VTbGlkZXIucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2UtbWFpbl9faW1nLWJveFwiKTtcclxuXHRcdGNvbnN0IGNhcm91c2VsbENvbnRyb2xzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRcdFwiLmJyb3dzZS1tYWluX19jYXJvdXNlbGwtY29udHJvbHNcIlxyXG5cdFx0KTtcclxuXHRcdC8vIE9ic8WCdWdhIG9zdGF0bmllZ28gaSBwaWVyd3N6ZWdvIGZpbG11XHJcblx0XHRhbGxJbWFnZXNbYWxsSW1hZ2VzLmxlbmd0aCAtIDFdLmNsYXNzTGlzdC5yZW1vdmUoXCJjdXJyZW50VmlzaWJsZVwiKTtcclxuXHRcdGFsbEltYWdlc1tpbmRleCAtIDFdPy5jbGFzc0xpc3QucmVtb3ZlKFwiY3VycmVudFZpc2libGVcIik7XHJcblxyXG5cdFx0aW1hZ2VTbGlkZXIuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHstaW5kZXggKiBjYXJvdXNlbGxXaWR0aH0lKWA7XHJcblx0XHRoYW5kbGVDYXJvdXNlbGxDb250cm9sc1N0YXRlKGluZGV4LCBjYXJvdXNlbGxDb250cm9scyk7XHJcblxyXG5cdFx0YWxsSW1hZ2VzW2luZGV4XS5jbGFzc0xpc3QuYWRkKFwiY3VycmVudFZpc2libGVcIik7XHJcblxyXG5cdFx0aW5kZXgrKztcclxuXHJcblx0XHRpZiAoaW5kZXggPiBtb3ZpZXMubGVuZ3RoIC0gMSkgaW5kZXggPSAwO1xyXG5cclxuXHRcdGhhbmRsZUJ0bnNWaXNpYmlsaXR5KGNvbnRhaW5lcik7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgaGFuZGxlQ2Fyb3VzZWxsQ29udHJvbHNTdGF0ZSA9IChpbmRleCwgY2Fyb3VzZWxsQ29udHJvbHNCb3gpID0+IHtcclxuXHRcdGNvbnN0IGFsbENvbnRyb2xCdG5zID1cclxuXHRcdFx0Y2Fyb3VzZWxsQ29udHJvbHNCb3gucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2UtbWFpbl9fYnRuXCIpO1xyXG5cdFx0Y29uc3QgY3VycmVudEJ0biA9IGNhcm91c2VsbENvbnRyb2xzQm94LnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRcdGAuYnJvd3NlLW1haW5fX2J0bltkYXRhLWltZz1cIiR7aW5kZXh9XCJdYFxyXG5cdFx0KTtcclxuXHRcdGNvbnN0IHByb2dyZXNzQmFyID0gY3VycmVudEJ0bi5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1tYWluX19wcm9ncmVzcy1iYXJcIik7XHJcblx0XHRjb25zdCBhbGxQcm9ncmVzc0JhcnMgPSBjYXJvdXNlbGxDb250cm9sc0JveC5xdWVyeVNlbGVjdG9yQWxsKFxyXG5cdFx0XHRcIi5icm93c2UtbWFpbl9fcHJvZ3Jlc3MtYmFyXCJcclxuXHRcdCk7XHJcblxyXG5cdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuZm9yRWFjaCgoaW50ZXJ2YWwpID0+IGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpKTtcclxuXHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLmNsZWFyKCk7XHJcblxyXG5cdFx0YWxsUHJvZ3Jlc3NCYXJzLmZvckVhY2goKGJhcikgPT4gKGJhci5zdHlsZS53aWR0aCA9IFwiMFwiKSk7XHJcblxyXG5cdFx0Y2hhbmdlUHJvZ3Jlc3NCYXIocHJvZ3Jlc3NCYXIsIGluZGV4KTtcclxuXHJcblx0XHRhbGxDb250cm9sQnRucy5mb3JFYWNoKChidG4pID0+IGJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpKTtcclxuXHRcdGN1cnJlbnRCdG4uY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBjaGFuZ2VQcm9ncmVzc0JhciA9IChwcm9ncmVzc0JhciwgYnRuSW5kZXgpID0+IHtcclxuXHRcdGlmIChwcm9ncmVzc0JhckludGVydmFscy5oYXMoYnRuSW5kZXgpKSB7XHJcblx0XHRcdGNsZWFySW50ZXJ2YWwocHJvZ3Jlc3NCYXJJbnRlcnZhbHMuZ2V0KGJ0bkluZGV4KSk7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHdpZHRoID0gMDtcclxuXHRcdGNvbnN0IHByb2dyZXNzQmFySW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdHdpZHRoICs9IGNhcm91c2VsbFN0cm9rZVJhbmdlO1xyXG5cdFx0XHRwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IGAke3dpZHRofSVgO1xyXG5cdFx0XHRpZiAod2lkdGggPj0gMTAwKSB7XHJcblx0XHRcdFx0cHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBcIjBcIjtcclxuXHRcdFx0XHRjbGVhckludGVydmFsKHByb2dyZXNzQmFySW50ZXJ2YWwpO1xyXG5cclxuXHRcdFx0XHRwcm9ncmVzc0JhckludGVydmFscy5kZWxldGUoYnRuSW5kZXgpO1xyXG5cdFx0XHR9XHJcblx0XHR9LCBpbnRlcnZhbFNwZWVkKTtcclxuXHJcblx0XHRwcm9ncmVzc0JhckludGVydmFscy5zZXQoYnRuSW5kZXgsIHByb2dyZXNzQmFySW50ZXJ2YWwpO1xyXG5cdH07XHJcblx0Y29uc3QgY2hhbmdlQ3VycmVudEltZyA9IChtb3ZpZXMsIGNvbnRhaW5lciwgY2Fyb3VzZWxsSW50ZXJ2YWwpID0+IHtcclxuXHRcdGNvbnN0IGNhcm91c2VsbENvbnRyb2xzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRcdFwiLmJyb3dzZS1tYWluX19jYXJvdXNlbGwtY29udHJvbHNcIlxyXG5cdFx0KTtcclxuXHJcblx0XHRjYXJvdXNlbGxDb250cm9scy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdFx0aWYgKGUudGFyZ2V0Lm1hdGNoZXMoXCIuYnJvd3NlLW1haW5fX2J0blwiKSkge1xyXG5cdFx0XHRcdGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIikpIHJldHVybjtcclxuXHJcblx0XHRcdFx0Y2xlYXJJbnRlcnZhbChjYXJvdXNlbGxJbnRlcnZhbCk7XHJcblxyXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRCdG4gPSBlLnRhcmdldDtcclxuXHRcdFx0XHRjb25zdCBpbWdEYXRhID0gcGFyc2VJbnQoY3VycmVudEJ0bi5kYXRhc2V0LmltZyk7XHJcblxyXG5cdFx0XHRcdGluZGV4ID0gaW1nRGF0YTtcclxuXHRcdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblxyXG5cdFx0XHRcdGNhcm91c2VsbEludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0XHRcdH0sIGNhcm91c2VsbFNwZWVkKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgaGFuZGxlQnRuc1Zpc2liaWxpdHkgPSAoY29udGFpbmVyKSA9PiB7XHJcblx0XHRjb25zdCBhbGxGaWxtcyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFwiLmJyb3dzZS1tYWluX19pbWctYm94XCIpO1xyXG5cclxuXHRcdGFsbEZpbG1zLmZvckVhY2goKGZpbG0pID0+IHtcclxuXHRcdFx0Y29uc3QgaXNBY3RpdmUgPSBmaWxtLmNsYXNzTGlzdC5jb250YWlucyhcImN1cnJlbnRWaXNpYmxlXCIpO1xyXG5cdFx0XHRjb25zdCB0YWJpbmRleCA9IGlzQWN0aXZlID8gMCA6IC0xO1xyXG5cdFx0XHRnaXZlQnRuc0F0dHJpYnV0ZShmaWxtLCB0YWJpbmRleCk7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cdGNvbnN0IGdpdmVCdG5zQXR0cmlidXRlID0gKGZpbG0sIHRhYmluZGV4KSA9PiB7XHJcblx0XHRjb25zdCB0cmFpbGVyQnRuID0gZmlsbS5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1tYWluX190cmFpbGVyLWJ0blwiKTtcclxuXHRcdGNvbnN0IHNlZU1vcmVCdG4gPSBmaWxtLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX3NlZS1tb3JlLWJ0blwiKTtcclxuXHJcblx0XHR0cmFpbGVyQnRuLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIHRhYmluZGV4KTtcclxuXHRcdHNlZU1vcmVCdG4uc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgdGFiaW5kZXgpO1xyXG5cdH07XHJcblx0Y2hlY2tBdXRob3JpemF0aW9uKCk7XHJcbn0pO1xyXG4iXX0=
