import{getData,createBrowsePage,createMainHeroSection,showErrorPopup,showBigLoader,hideBigLoader}from"./components.min.js";document.addEventListener("DOMContentLoaded",function(){const e={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNTYwZjM4MjU3NDQ1ZGE1ZGZkYTYxYzE0YWM4YmM4MyIsIm5iZiI6MTc1OTc2NTAzOC45NCwic3ViIjoiNjhlM2UyMmUyNjY5NzY4MzhlYzI3NzI5Iiwic2NvcGVzIjpbImFwaV9yZWFkIl0sInZlcnNpb24iOjF9.nuGfEjclJLepmzzHi2omNhp29THgrJf9Nv6D4_gTdxA"}},t=new Map;let r,a=1e4,o=0;const n=async(t,r)=>{const a=`https://api.themoviedb.org/3/movie/popular?language=${t}&page=${r}`;try{const t=await fetch(a,e);return await t.json()}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},s=async(e,t)=>{const r=[];for(let a=1;a<=t;a++)r.push(n(e,a));try{return await Promise.all(r)}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},c=async(e,t)=>{try{const r=await e(t,5),a=Math.trunc(20*Math.random());return r.map(e=>e.results[a])}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}},i=(e,t)=>{const r=e.querySelector(".browse-main__images"),a=r.querySelectorAll(".browse-main__img-box"),n=e.querySelector(".browse-main__carousell-controls");a.forEach(e=>e.classList.remove("currentVisible")),r.style.transform=`translateX(${100*-o}%)`,l(o,n),a[o].classList.add("currentVisible"),o++,o>t.length-1&&(o=0),u(e)},l=(e,r)=>{const a=r.querySelectorAll(".browse-main__btn"),o=r.querySelector(`.browse-main__btn[data-img="${e}"]`),n=o.querySelector(".browse-main__progress-bar"),s=r.querySelectorAll(".browse-main__progress-bar");t.forEach(e=>clearInterval(e)),t.clear(),s.forEach(e=>e.style.width="0"),d(n,e),a.forEach(e=>e.classList.remove("active")),o.classList.add("active")},d=(e,r)=>{t.has(r)&&clearInterval(t.get(r));let a=0;const o=setInterval(()=>{a+=2,e.style.width=`${a}%`,a>=100&&(e.style.width="0",clearInterval(o),t.delete(r))},200);t.set(r,o)},h=(e,t,r)=>{t.querySelector(".browse-main__carousell-controls").addEventListener("click",n=>{if(n.target.matches(".browse-main__btn")){if(n.target.classList.contains("active"))return;clearInterval(r);const s=n.target,c=parseInt(s.dataset.img);o=c,i(t,e),r=setInterval(()=>{i(t,e)},a)}})},u=e=>{e.querySelectorAll(".browse-main__img-box").forEach(e=>{const t=e.classList.contains("currentVisible");m(e,t?0:-1)})},m=(e,t)=>{const r=e.querySelector(".browse-main__trailer-btn"),a=e.querySelector(".browse-main__see-more-btn");r.setAttribute("tabindex",t),a.setAttribute("tabindex",t)};let g,w;const b=(e,t)=>{g-w>50?i(e,t):w-g>50&&(o=(o-2+t.length)%t.length,i(e,t)),clearInterval(r),r=setInterval(()=>{i(e,t)},a)},p=(e,t)=>{const r=e.querySelector(".browse-main__images");r.addEventListener("touchstart",e=>{(e=>{g=e.touches[0].clientX})(e)}),r.addEventListener("touchend",r=>{((e,t,r)=>{w=e.changedTouches[0].clientX,b(t,r)})(r,e,t)})};(()=>{const e=getData(),t=e?.translations,o=e?.preferredLanguage,n=e?.loggedIn,l=document.querySelector(".container");e&&n?(l.prepend(createBrowsePage(t)),l.append(showBigLoader()),c(s,o).then(e=>{createMainHeroSection(e,t,l),i(l,e),r=setInterval(()=>{i(l,e)},a),h(e,l,r),p(l,e)})):window.location.href="/"})()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi1wYWdlLm1pbi5qcyIsIm5hbWVzIjpbImdldERhdGEiLCJjcmVhdGVCcm93c2VQYWdlIiwiY3JlYXRlTWFpbkhlcm9TZWN0aW9uIiwic2hvd0Vycm9yUG9wdXAiLCJzaG93QmlnTG9hZGVyIiwiaGlkZUJpZ0xvYWRlciIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9wdGlvbnMiLCJtZXRob2QiLCJoZWFkZXJzIiwiYWNjZXB0IiwiQXV0aG9yaXphdGlvbiIsInByb2dyZXNzQmFySW50ZXJ2YWxzIiwiTWFwIiwiY2Fyb3VzZWxsSW50ZXJ2YWwiLCJjYXJvdXNlbGxTcGVlZCIsImluZGV4IiwiZ2V0UG9wdWxhckZpbG1zIiwiYXN5bmMiLCJsYW5nIiwicGFnZU51bSIsIlVSTCIsInJlc3BvbnNlIiwiZmV0Y2giLCJqc29uIiwidHJhbnNsYXRpb25zIiwiYnJvd3NlUGFnZSIsImxvYWRpbmdEYXRhRXJyb3IiLCJsb2FkRmlsbXNUb0Nhcm91c2VsbCIsInJlcXVlc3RzIiwiaSIsInB1c2giLCJQcm9taXNlIiwiYWxsIiwiY2hvb3NlRmlsbXNUb0Nhcm91c2VsbCIsImRhdGEiLCJjdXJyZW50TGFuZ3VhZ2UiLCJwYWdlc0RhdGEiLCJyYW5kb21OdW1iZXIiLCJNYXRoIiwidHJ1bmMiLCJyYW5kb20iLCJtYXAiLCJwYWdlIiwicmVzdWx0cyIsImhhbmRsZUZpbG1zQ2Fyb3VzZWxsIiwiY29udGFpbmVyIiwibW92aWVzIiwiaW1hZ2VTbGlkZXIiLCJxdWVyeVNlbGVjdG9yIiwiYWxsSW1hZ2VzIiwicXVlcnlTZWxlY3RvckFsbCIsImNhcm91c2VsbENvbnRyb2xzIiwiZm9yRWFjaCIsImltZyIsImNsYXNzTGlzdCIsInJlbW92ZSIsInN0eWxlIiwidHJhbnNmb3JtIiwiaGFuZGxlQ2Fyb3VzZWxsQ29udHJvbHNTdGF0ZSIsImFkZCIsImxlbmd0aCIsImhhbmRsZUJ0bnNWaXNpYmlsaXR5IiwiY2Fyb3VzZWxsQ29udHJvbHNCb3giLCJhbGxDb250cm9sQnRucyIsImN1cnJlbnRCdG4iLCJwcm9ncmVzc0JhciIsImFsbFByb2dyZXNzQmFycyIsImludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImNsZWFyIiwiYmFyIiwid2lkdGgiLCJjaGFuZ2VQcm9ncmVzc0JhciIsImJ0biIsImJ0bkluZGV4IiwiaGFzIiwiZ2V0IiwicHJvZ3Jlc3NCYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiZGVsZXRlIiwic2V0IiwiY2hhbmdlQ3VycmVudEltZyIsImUiLCJ0YXJnZXQiLCJtYXRjaGVzIiwiY29udGFpbnMiLCJpbWdEYXRhIiwicGFyc2VJbnQiLCJkYXRhc2V0IiwiZmlsbSIsImlzQWN0aXZlIiwiZ2l2ZUJ0bnNBdHRyaWJ1dGUiLCJ0YWJpbmRleCIsInRyYWlsZXJCdG4iLCJzZWVNb3JlQnRuIiwic2V0QXR0cmlidXRlIiwic3RhcnRYIiwiZW5kWCIsImhhbmRsZVN3aXBlIiwic2V0VG91Y2hFdmVudExpc3RlbmVyIiwidG91Y2hlcyIsImNsaWVudFgiLCJoYW5kbGVUb3VjaFN0YXJ0RXZlbnQiLCJjaGFuZ2VkVG91Y2hlcyIsImhhbmRsZVRvdWNoRW5kRXZlbnQiLCJ1c2VyRGF0YSIsInByZWZlcnJlZExhbmd1YWdlIiwiaXNMb2dnZWRJbiIsImxvZ2dlZEluIiwicHJlcGVuZCIsImFwcGVuZCIsInRoZW4iLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJjaGVja0F1dGhvcml6YXRpb24iXSwic291cmNlcyI6WyJtYWluLXBhZ2UuanMiXSwibWFwcGluZ3MiOiJPQUNDQSxRQUNBQyxpQkFDQUMsc0JBQ0FDLGVBQ0FDLGNBQ0FDLGtCQUNNLHNCQUNQQyxTQUFTQyxpQkFBaUIsbUJBQW9CLFdBRTdDLE1BRU1DLEVBQVUsQ0FDZkMsT0FBUSxNQUNSQyxRQUFTLENBQ1JDLE9BQVEsbUJBQ1JDLGNBQ0MseVBBR0dDLEVBQXVCLElBQUlDLElBQ2pDLElBS0lDLEVBTEFDLEVBQWlCLElBSWpCQyxFQUFRLEVBR1osTUE4Qk1DLEVBQWtCQyxNQUFPQyxFQUFNQyxL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QUFPNUcsaUJBRWpCK0IsRUFBdUJOLEVBQXNCUSxHQUFpQjRFLEtBQzVEakUsSUFDQTlDLHNCQUFzQjhDLEVBQVF0QixFQUFjcUIsR0FDNUNELEVBQXFCQyxFQUFXQyxHQUVoQ2pDLEVBQW9CaUUsWUFBWSxLQUMvQmxDLEVBQXFCQyxFQUFXQyxJQUM5QmhDLEdBRUhtRSxFQUFpQm5DLEVBQVFELEVBQVdoQyxHQUNwQ3NGLEVBQXNCdEQsRUFBV0MsTUFmbkNrRSxPQUFPQyxTQUFTQyxLQUFPLEtBdU16QkMsRUFDRCIsImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG5cdGdldERhdGEsXHJcblx0Y3JlYXRlQnJvd3NlUGFnZSxcclxuXHRjcmVhdGVNYWluSGVyb1NlY3Rpb24sXHJcblx0c2hvd0Vycm9yUG9wdXAsXHJcblx0c2hvd0JpZ0xvYWRlcixcclxuXHRoaWRlQmlnTG9hZGVyLFxyXG59IGZyb20gXCIuL2NvbXBvbmVudHMubWluLmpzXCI7XHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcclxuXHQvLyBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL2Rpc2NvdmVyL21vdmllP2xhbmd1YWdlPXBsXHJcblx0Y29uc3QgQ0FST1VTRUxMX0xFTkdUSCA9IDU7XHJcblx0Y29uc3QgRklMTV9BTU9VTlRfUEVSX1BBR0UgPSAyMDtcclxuXHRjb25zdCBvcHRpb25zID0ge1xyXG5cdFx0bWV0aG9kOiBcIkdFVFwiLFxyXG5cdFx0aGVhZGVyczoge1xyXG5cdFx0XHRhY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG5cdFx0XHRBdXRob3JpemF0aW9uOlxyXG5cdFx0XHRcdFwiQmVhcmVyIGV5SmhiR2NpT2lKSVV6STFOaUo5LmV5SmhkV1FpT2lJek5UWXdaak00TWpVM05EUTFaR0UxWkdaa1lUWXhZekUwWVdNNFltTTRNeUlzSW01aVppSTZNVGMxT1RjMk5UQXpPQzQ1TkN3aWMzVmlJam9pTmpobE0yVXlNbVV5TmpZNU56WTRNemhsWXpJM056STVJaXdpYzJOdmNHVnpJanBiSW1Gd2FWOXlaV0ZrSWwwc0luWmxjbk5wYjI0aU9qRjkubnVHZkVqY2xKTGVwbXp6SGkyb21OaHAyOVRIZ3JKZjlOdjZENF9nVGR4QVwiLFxyXG5cdFx0fSxcclxuXHR9O1xyXG5cdGNvbnN0IHByb2dyZXNzQmFySW50ZXJ2YWxzID0gbmV3IE1hcCgpO1xyXG5cdGxldCBjYXJvdXNlbGxTcGVlZCA9IDEwMDAwO1xyXG5cdGxldCBjYXJvdXNlbGxTdHJva2VSYW5nZSA9IDI7XHJcblx0bGV0IGludGVydmFsU3BlZWQgPSAoY2Fyb3VzZWxsU3BlZWQgKiBjYXJvdXNlbGxTdHJva2VSYW5nZSkgLyAxMDA7XHJcblx0bGV0IGNhcm91c2VsbFdpZHRoID0gMTAwO1xyXG5cdGxldCBpbmRleCA9IDA7XHJcblx0bGV0IGNhcm91c2VsbEludGVydmFsO1xyXG5cclxuXHRjb25zdCBjaGVja0F1dGhvcml6YXRpb24gPSAoKSA9PiB7XHJcblx0XHRjb25zdCB1c2VyRGF0YSA9IGdldERhdGEoKTtcclxuXHRcdGNvbnN0IHRyYW5zbGF0aW9ucyA9IHVzZXJEYXRhPy50cmFuc2xhdGlvbnM7XHJcblx0XHRjb25zdCBjdXJyZW50TGFuZ3VhZ2UgPSB1c2VyRGF0YT8ucHJlZmVycmVkTGFuZ3VhZ2U7XHJcblx0XHRjb25zdCBpc0xvZ2dlZEluID0gdXNlckRhdGE/LmxvZ2dlZEluO1xyXG5cclxuXHRcdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGFpbmVyXCIpO1xyXG5cclxuXHRcdGlmICghdXNlckRhdGEgfHwgIWlzTG9nZ2VkSW4pIHtcclxuXHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9cIjtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGNvbnRhaW5lci5wcmVwZW5kKGNyZWF0ZUJyb3dzZVBhZ2UodHJhbnNsYXRpb25zKSk7XHJcblx0XHRcdGNvbnRhaW5lci5hcHBlbmQoc2hvd0JpZ0xvYWRlcigpKTtcclxuXHJcblx0XHRcdGNob29zZUZpbG1zVG9DYXJvdXNlbGwobG9hZEZpbG1zVG9DYXJvdXNlbGwsIGN1cnJlbnRMYW5ndWFnZSkudGhlbihcclxuXHRcdFx0XHQobW92aWVzKSA9PiB7XHJcblx0XHRcdFx0XHRjcmVhdGVNYWluSGVyb1NlY3Rpb24obW92aWVzLCB0cmFuc2xhdGlvbnMsIGNvbnRhaW5lcik7XHJcblx0XHRcdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblxyXG5cdFx0XHRcdFx0Y2Fyb3VzZWxsSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdFx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdFx0XHRcdH0sIGNhcm91c2VsbFNwZWVkKTtcclxuXHJcblx0XHRcdFx0XHRjaGFuZ2VDdXJyZW50SW1nKG1vdmllcywgY29udGFpbmVyLCBjYXJvdXNlbGxJbnRlcnZhbCk7XHJcblx0XHRcdFx0XHRzZXRUb3VjaEV2ZW50TGlzdGVuZXIoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0KTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRjb25zdCBnZXRQb3B1bGFyRmlsbXMgPSBhc3luYyAobGFuZywgcGFnZU51bSkgPT4ge1xyXG5cdFx0Y29uc3QgVVJMID0gYGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvcG9wdWxhcj9sYW5ndWFnZT0ke2xhbmd9JnBhZ2U9JHtwYWdlTnVtfWA7XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChVUkwsIG9wdGlvbnMpO1xyXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG5cclxuXHRcdFx0cmV0dXJuIGRhdGE7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fVxyXG5cdH07XHJcblx0Y29uc3QgbG9hZEZpbG1zVG9DYXJvdXNlbGwgPSBhc3luYyAobGFuZywgcGFnZU51bSkgPT4ge1xyXG5cdFx0Y29uc3QgcmVxdWVzdHMgPSBbXTtcclxuXHJcblx0XHRmb3IgKGxldCBpID0gMTsgaSA8PSBwYWdlTnVtOyBpKyspIHtcclxuXHRcdFx0cmVxdWVzdHMucHVzaChnZXRQb3B1bGFyRmlsbXMobGFuZywgaSkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IFByb21pc2UuYWxsKHJlcXVlc3RzKTtcclxuXHRcdFx0cmV0dXJuIHJlc3BvbnNlcztcclxuXHRcdH0gY2F0Y2gge1xyXG5cdFx0XHRzaG93RXJyb3JQb3B1cCh0cmFuc2xhdGlvbnMuYnJvd3NlUGFnZS5sb2FkaW5nRGF0YUVycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0Y29uc3QgY2hvb3NlRmlsbXNUb0Nhcm91c2VsbCA9IGFzeW5jIChkYXRhLCBjdXJyZW50TGFuZ3VhZ2UpID0+IHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHBhZ2VzRGF0YSA9IGF3YWl0IGRhdGEoY3VycmVudExhbmd1YWdlLCBDQVJPVVNFTExfTEVOR1RIKTtcclxuXHRcdFx0Y29uc3QgcmFuZG9tTnVtYmVyID0gTWF0aC50cnVuYyhNYXRoLnJhbmRvbSgpICogRklMTV9BTU9VTlRfUEVSX1BBR0UpO1xyXG5cdFx0XHRjb25zdCBjaG9vc2VuTW92aWVzID0gcGFnZXNEYXRhLm1hcCgocGFnZSkgPT4gcGFnZS5yZXN1bHRzW3JhbmRvbU51bWJlcl0pO1xyXG5cclxuXHRcdFx0cmV0dXJuIGNob29zZW5Nb3ZpZXM7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fSBmaW5hbGx5IHtcclxuXHRcdFx0aGlkZUJpZ0xvYWRlcigpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8vIENBUk9VU0VMTFxyXG5cclxuXHRjb25zdCBoYW5kbGVGaWxtc0Nhcm91c2VsbCA9IChjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0Y29uc3QgaW1hZ2VTbGlkZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9faW1hZ2VzXCIpO1xyXG5cdFx0Y29uc3QgYWxsSW1hZ2VzID0gaW1hZ2VTbGlkZXIucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2UtbWFpbl9faW1nLWJveFwiKTtcclxuXHRcdGNvbnN0IGNhcm91c2VsbENvbnRyb2xzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRcdFwiLmJyb3dzZS1tYWluX19jYXJvdXNlbGwtY29udHJvbHNcIlxyXG5cdFx0KTtcclxuXHRcdC8vIE9ic8WCdWdhIG9zdGF0bmllZ28gaSBwaWVyd3N6ZWdvIGZpbG11XHJcblx0XHRhbGxJbWFnZXMuZm9yRWFjaCgoaW1nKSA9PiBpbWcuY2xhc3NMaXN0LnJlbW92ZShcImN1cnJlbnRWaXNpYmxlXCIpKTtcclxuXHJcblx0XHRpbWFnZVNsaWRlci5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgkey1pbmRleCAqIGNhcm91c2VsbFdpZHRofSUpYDtcclxuXHRcdGhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUoaW5kZXgsIGNhcm91c2VsbENvbnRyb2xzKTtcclxuXHRcdGFsbEltYWdlc1tpbmRleF0uY2xhc3NMaXN0LmFkZChcImN1cnJlbnRWaXNpYmxlXCIpO1xyXG5cclxuXHRcdGluZGV4Kys7XHJcblxyXG5cdFx0aWYgKGluZGV4ID4gbW92aWVzLmxlbmd0aCAtIDEpIGluZGV4ID0gMDtcclxuXHJcblx0XHRoYW5kbGVCdG5zVmlzaWJpbGl0eShjb250YWluZXIpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUgPSAoaW5kZXgsIGNhcm91c2VsbENvbnRyb2xzQm94KSA9PiB7XHJcblx0XHRjb25zdCBhbGxDb250cm9sQnRucyA9XHJcblx0XHRcdGNhcm91c2VsbENvbnRyb2xzQm94LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLW1haW5fX2J0blwiKTtcclxuXHRcdGNvbnN0IGN1cnJlbnRCdG4gPSBjYXJvdXNlbGxDb250cm9sc0JveC5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRgLmJyb3dzZS1tYWluX19idG5bZGF0YS1pbWc9XCIke2luZGV4fVwiXWBcclxuXHRcdCk7XHJcblx0XHRjb25zdCBwcm9ncmVzc0JhciA9IGN1cnJlbnRCdG4ucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9fcHJvZ3Jlc3MtYmFyXCIpO1xyXG5cdFx0Y29uc3QgYWxsUHJvZ3Jlc3NCYXJzID0gY2Fyb3VzZWxsQ29udHJvbHNCb3gucXVlcnlTZWxlY3RvckFsbChcclxuXHRcdFx0XCIuYnJvd3NlLW1haW5fX3Byb2dyZXNzLWJhclwiXHJcblx0XHQpO1xyXG5cclxuXHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLmZvckVhY2goKGludGVydmFsKSA9PiBjbGVhckludGVydmFsKGludGVydmFsKSk7XHJcblx0XHRwcm9ncmVzc0JhckludGVydmFscy5jbGVhcigpO1xyXG5cclxuXHRcdGFsbFByb2dyZXNzQmFycy5mb3JFYWNoKChiYXIpID0+IChiYXIuc3R5bGUud2lkdGggPSBcIjBcIikpO1xyXG5cclxuXHRcdGNoYW5nZVByb2dyZXNzQmFyKHByb2dyZXNzQmFyLCBpbmRleCk7XHJcblxyXG5cdFx0YWxsQ29udHJvbEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKSk7XHJcblx0XHRjdXJyZW50QnRuLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgY2hhbmdlUHJvZ3Jlc3NCYXIgPSAocHJvZ3Jlc3NCYXIsIGJ0bkluZGV4KSA9PiB7XHJcblx0XHRpZiAocHJvZ3Jlc3NCYXJJbnRlcnZhbHMuaGFzKGJ0bkluZGV4KSkge1xyXG5cdFx0XHRjbGVhckludGVydmFsKHByb2dyZXNzQmFySW50ZXJ2YWxzLmdldChidG5JbmRleCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCB3aWR0aCA9IDA7XHJcblx0XHRjb25zdCBwcm9ncmVzc0JhckludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHR3aWR0aCArPSBjYXJvdXNlbGxTdHJva2VSYW5nZTtcclxuXHRcdFx0cHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHt3aWR0aH0lYDtcclxuXHRcdFx0aWYgKHdpZHRoID49IDEwMCkge1xyXG5cdFx0XHRcdHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gXCIwXCI7XHJcblx0XHRcdFx0Y2xlYXJJbnRlcnZhbChwcm9ncmVzc0JhckludGVydmFsKTtcclxuXHJcblx0XHRcdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuZGVsZXRlKGJ0bkluZGV4KTtcclxuXHRcdFx0fVxyXG5cdFx0fSwgaW50ZXJ2YWxTcGVlZCk7XHJcblxyXG5cdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuc2V0KGJ0bkluZGV4LCBwcm9ncmVzc0JhckludGVydmFsKTtcclxuXHR9O1xyXG5cdGNvbnN0IGNoYW5nZUN1cnJlbnRJbWcgPSAobW92aWVzLCBjb250YWluZXIsIGNhcm91c2VsbEludGVydmFsKSA9PiB7XHJcblx0XHRjb25zdCBjYXJvdXNlbGxDb250cm9scyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRcIi5icm93c2UtbWFpbl9fY2Fyb3VzZWxsLWNvbnRyb2xzXCJcclxuXHRcdCk7XHJcblxyXG5cdFx0Y2Fyb3VzZWxsQ29udHJvbHMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRcdGlmIChlLnRhcmdldC5tYXRjaGVzKFwiLmJyb3dzZS1tYWluX19idG5cIikpIHtcclxuXHRcdFx0XHRpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlXCIpKSByZXR1cm47XHJcblxyXG5cdFx0XHRcdGNsZWFySW50ZXJ2YWwoY2Fyb3VzZWxsSW50ZXJ2YWwpO1xyXG5cclxuXHRcdFx0XHRjb25zdCBjdXJyZW50QnRuID0gZS50YXJnZXQ7XHJcblx0XHRcdFx0Y29uc3QgaW1nRGF0YSA9IHBhcnNlSW50KGN1cnJlbnRCdG4uZGF0YXNldC5pbWcpO1xyXG5cclxuXHRcdFx0XHRpbmRleCA9IGltZ0RhdGE7XHJcblx0XHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cclxuXHRcdFx0XHRjYXJvdXNlbGxJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuXHRcdFx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdFx0XHR9LCBjYXJvdXNlbGxTcGVlZCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZUJ0bnNWaXNpYmlsaXR5ID0gKGNvbnRhaW5lcikgPT4ge1xyXG5cdFx0Y29uc3QgYWxsRmlsbXMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2UtbWFpbl9faW1nLWJveFwiKTtcclxuXHJcblx0XHRhbGxGaWxtcy5mb3JFYWNoKChmaWxtKSA9PiB7XHJcblx0XHRcdGNvbnN0IGlzQWN0aXZlID0gZmlsbS5jbGFzc0xpc3QuY29udGFpbnMoXCJjdXJyZW50VmlzaWJsZVwiKTtcclxuXHRcdFx0Y29uc3QgdGFiaW5kZXggPSBpc0FjdGl2ZSA/IDAgOiAtMTtcclxuXHRcdFx0Z2l2ZUJ0bnNBdHRyaWJ1dGUoZmlsbSwgdGFiaW5kZXgpO1xyXG5cdFx0fSk7XHJcblx0fTtcclxuXHRjb25zdCBnaXZlQnRuc0F0dHJpYnV0ZSA9IChmaWxtLCB0YWJpbmRleCkgPT4ge1xyXG5cdFx0Y29uc3QgdHJhaWxlckJ0biA9IGZpbG0ucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9fdHJhaWxlci1idG5cIik7XHJcblx0XHRjb25zdCBzZWVNb3JlQnRuID0gZmlsbS5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1tYWluX19zZWUtbW9yZS1idG5cIik7XHJcblxyXG5cdFx0dHJhaWxlckJ0bi5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCB0YWJpbmRleCk7XHJcblx0XHRzZWVNb3JlQnRuLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIHRhYmluZGV4KTtcclxuXHR9O1xyXG5cclxuXHRsZXQgc3RhcnRYO1xyXG5cdGxldCBlbmRYO1xyXG5cdGNvbnN0IGhhbmRsZVRvdWNoU3RhcnRFdmVudCA9IChlKSA9PiB7XHJcblx0XHRzdGFydFggPSBlLnRvdWNoZXNbMF0uY2xpZW50WDtcclxuXHR9O1xyXG5cdGNvbnN0IGhhbmRsZVRvdWNoRW5kRXZlbnQgPSAoZSwgY29udGFpbmVyLCBtb3ZpZXMpID0+IHtcclxuXHRcdGVuZFggPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFg7XHJcblx0XHRoYW5kbGVTd2lwZShjb250YWluZXIsIG1vdmllcyk7XHJcblx0fTtcclxuXHRjb25zdCBoYW5kbGVTd2lwZSA9IChjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0Y29uc3QgcmFuZ2UgPSA1MDtcclxuXHRcdGlmIChzdGFydFggLSBlbmRYID4gcmFuZ2UpIHtcclxuXHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0fSBlbHNlIGlmIChlbmRYIC0gc3RhcnRYID4gNTApIHtcclxuXHRcdFx0aW5kZXggPSAoaW5kZXggLSAyICsgbW92aWVzLmxlbmd0aCkgJSBtb3ZpZXMubGVuZ3RoO1xyXG5cdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblx0XHR9XHJcblx0XHRjbGVhckludGVydmFsKGNhcm91c2VsbEludGVydmFsKTtcclxuXHRcdGNhcm91c2VsbEludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblx0XHR9LCBjYXJvdXNlbGxTcGVlZCk7XHJcblx0fTtcclxuXHRjb25zdCBzZXRUb3VjaEV2ZW50TGlzdGVuZXIgPSAoY29udGFpbmVyLCBtb3ZpZXMpID0+IHtcclxuXHRcdGNvbnN0IGltYWdlU2xpZGVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX2ltYWdlc1wiKTtcclxuXHJcblx0XHRpbWFnZVNsaWRlci5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCAoZSkgPT4ge1xyXG5cdFx0XHRoYW5kbGVUb3VjaFN0YXJ0RXZlbnQoZSk7XHJcblx0XHR9KTtcclxuXHRcdGltYWdlU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCAoZSkgPT4ge1xyXG5cdFx0XHRoYW5kbGVUb3VjaEVuZEV2ZW50KGUsIGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdGNoZWNrQXV0aG9yaXphdGlvbigpO1xyXG59KTtcclxuIl19
