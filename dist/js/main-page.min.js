import{getData,createBrowsePage,createMainHeroSection,showErrorPopup,showBigLoader,hideBigLoader,createFilmSlider}from"./components.min.js";document.addEventListener("DOMContentLoaded",function(){const e={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNTYwZjM4MjU3NDQ1ZGE1ZGZkYTYxYzE0YWM4YmM4MyIsIm5iZiI6MTc1OTc2NTAzOC45NCwic3ViIjoiNjhlM2UyMmUyNjY5NzY4MzhlYzI3NzI5Iiwic2NvcGVzIjpbImFwaV9yZWFkIl0sInZlcnNpb24iOjF9.nuGfEjclJLepmzzHi2omNhp29THgrJf9Nv6D4_gTdxA"}},t=new Map;let r,n=1e4,o=0;const a="&page=",i=async(t,r,...n)=>{const o=[];for await(const i of n){const n=i+t+a+r,s=await fetch(n,e),c=await s.json();o.push(c)}return o},s=async(t,r,n)=>{const o=n+t+a+r;try{const t=await fetch(o,e);return await t.json()}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},c=async(e,t)=>{const r=[];for(let n=1;n<=t;n++)r.push(s(e,n,"https://api.themoviedb.org/3/movie/popular?language="));try{return await Promise.all(r)}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},l=async(e,t)=>{try{const r=await e(t,5),n=Math.trunc(20*Math.random());return r.map(e=>e.results[n])}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}},d=(e,t)=>{const r=e.querySelector(".browse-main__images"),n=r.querySelectorAll(".browse-main__img-box"),a=e.querySelector(".browse-main__carousell-controls");n.forEach(e=>e.classList.remove("currentVisible")),r.style.transform=`translateX(${100*-o}%)`,w(o,a),n[o].classList.add("currentVisible"),o++,o>t.length-1&&(o=0),m(e)},w=(e,r)=>{const n=r.querySelectorAll(".browse-main__btn"),o=r.querySelector(`.browse-main__btn[data-img="${e}"]`),a=o.querySelector(".browse-main__progress-bar"),i=r.querySelectorAll(".browse-main__progress-bar");t.forEach(e=>clearInterval(e)),t.clear(),i.forEach(e=>e.style.width="0"),h(a,e),n.forEach(e=>e.classList.remove("active")),o.classList.add("active")},h=(e,r)=>{t.has(r)&&clearInterval(t.get(r));let n=0;const o=setInterval(()=>{n+=2,e.style.width=`${n}%`,n>=100&&(e.style.width="0",clearInterval(o),t.delete(r))},200);t.set(r,o)},u=(e,t)=>{t.querySelector(".browse-main__carousell-controls").addEventListener("click",a=>{if(a.target.matches(".browse-main__btn")){if(a.target.classList.contains("active"))return;clearInterval(r);const i=a.target,s=parseInt(i.dataset.img);o=s,d(t,e),r=setInterval(()=>{d(t,e)},n)}})},m=e=>{e.querySelectorAll(".browse-main__img-box").forEach(e=>{const t=e.classList.contains("currentVisible")?0:-1;b(e,t,0===t?"visible":"hidden")})},b=(e,t,r)=>{const n=e.querySelector(".browse-main__trailer-btn"),o=e.querySelector(".browse-main__see-more-btn");n.setAttribute("tabindex",t),o.setAttribute("tabindex",t),n.style.visibility=r,o.style.visibility=r};let g,p,y,_;const v=(e,t)=>{const a=Math.abs(g-p),i=Math.abs(y-_);a<50||i>30||(p-g>50?(o=(o-2+t.length)%t.length,d(e,t)):g-p>50&&d(e,t),clearInterval(r),r=setInterval(()=>{d(e,t)},n))},f=(e,t)=>{const r=e.querySelector(".browse-main__images");r.addEventListener("touchstart",e=>{(e=>{g=e.touches[0].clientX,y=e.touches[0].clientY})(e)}),r.addEventListener("touchend",r=>{((e,t,r)=>{p=e.changedTouches[0].clientX,_=e.changedTouches[0].clientY,v(t,r)})(r,e,t)})};let E=0;const I=(e,t)=>{const r=S();t.toggleAttribute("disabled",0===E),e.toggleAttribute("disabled",E>=r)},S=()=>{let e;return window.innerWidth<576&&(e=9),window.innerWidth>=576&&window.innerWidth<992&&(e=17),window.innerWidth>=992&&window.innerWidth<1200&&(e=4),window.innerWidth>=1200&&(e=7),e},L=e=>{const t=(()=>{let e=2;return window.innerWidth>576&&window.innerWidth<992&&(e=1),window.innerWidth>=992&&window.innerWidth<1200&&(e=4),e})();document.querySelectorAll(".browse-section__slider-box").forEach(r=>{const n=r.offsetWidth;e.style.transform=`translateX(${-E*n*t}px)`})},q=e=>{const t=e.querySelector(".browse-section__slider-images"),r=e.querySelector(".browse-section__slider-next-btn"),n=e.querySelector(".browse-section__slider-prev-btn");r.addEventListener("click",()=>((e,t,r)=>{const n=S();E>=n||(E++,L(e),I(t,r))})(t,r,n)),n.addEventListener("click",()=>((e,t,r)=>{E<=0||(E--,L(e),I(t,r))})(t,r,n)),I(r,n)};(async()=>{const e=getData(),t=e?.translations,o=e?.preferredLanguage,a=e?.loggedIn,s=document.querySelector(".container");if(e&&a){s.prepend(createBrowsePage(t)),s.append(showBigLoader());try{const e=await l(c,o);createMainHeroSection(e,t,s),d(s,e),r=setInterval(()=>d(s,e),n),u(e,s),f(s,e);const a=await i(o,1,"https://api.themoviedb.org/3/movie/upcoming?language="),w=document.querySelector("main");w||s.append(createFilmSlider(a,t,0,t.browseSection.sectionNames.upcoming)),w.append(createFilmSlider(a,t,0,t.browseSection.sectionNames.upcoming)),q(s)}catch{showErrorPopup(t.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}}else window.location.href="/"})()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi1wYWdlLm1pbi5qcyIsIm5hbWVzIjpbImdldERhdGEiLCJjcmVhdGVCcm93c2VQYWdlIiwiY3JlYXRlTWFpbkhlcm9TZWN0aW9uIiwic2hvd0Vycm9yUG9wdXAiLCJzaG93QmlnTG9hZGVyIiwiaGlkZUJpZ0xvYWRlciIsImNyZWF0ZUZpbG1TbGlkZXIiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJvcHRpb25zIiwibWV0aG9kIiwiaGVhZGVycyIsImFjY2VwdCIsIkF1dGhvcml6YXRpb24iLCJwcm9ncmVzc0JhckludGVydmFscyIsIk1hcCIsImNhcm91c2VsbEludGVydmFsIiwiY2Fyb3VzZWxsU3BlZWQiLCJpbmRleCIsIkZJTE1TX1BBR0VTX0FNT1VOVCIsImdldEFsbEZpbG1zIiwiYXN5bmMiLCJsYW5nIiwicGFnZU51bSIsInVybHMiLCJyZXNwb25zZXMiLCJ1cmwiLCJVUkwiLCJyZXNwb25zZSIsImZldGNoIiwiZGF0YSIsImpzb24iLCJwdXNoIiwiZ2V0RmlsbXMiLCJ0cmFuc2xhdGlvbnMiLCJicm93c2VQYWdlIiwibG9hZGluZ0RhdGFFcnJvciIsImxvYWRGaWxtc1RvQ2Fyb3VzZWxsIiwicmVxdWVzdHMiLCJpIiwiUHJvbWlzZSIsImFsbCIsImNob29zZUZpbG1zVG9DYXJvdXNlbGwiLCJjdXJyZW50TGFuZ3VhZ2UiLCJwYWdlc0RhdGEiLCJyYW5kb21OdW1iZXIiLCJNYXRoIiwidHJ1bmMiLCJyYW5kb20iLCJtYXAiLCJwYWdlIiwicmVzdWx0cyIsImhhbmRsZUZpbG1zQ2Fyb3VzZWxsIiwiY29udGFpbmVyIiwibW92aWVzIiwiaW1hZ2VTbGlkZXIiLCJxdWVyeVNlbGVjdG9yIiwiYWxsSW1hZ2VzIiwicXVlcnlTZWxlY3RvckFsbCIsImNhcm91c2VsbENvbnRyb2xzIiwiZm9yRWFjaCIsImltZyIsImNsYXNzTGlzdCIsInJlbW92ZSIsInN0eWxlIiwidHJhbnNmb3JtIiwiaGFuZGxlQ2Fyb3VzZWxsQ29udHJvbHNTdGF0ZSIsImFkZCIsImxlbmd0aCIsImhhbmRsZUJ0bnNWaXNpYmlsaXR5IiwiY2Fyb3VzZWxsQ29udHJvbHNCb3giLCJhbGxDb250cm9sQnRucyIsImN1cnJlbnRCdG4iLCJwcm9ncmVzc0JhciIsImFsbFByb2dyZXNzQmFycyIsImludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImNsZWFyIiwiYmFyIiwid2lkdGgiLCJjaGFuZ2VQcm9ncmVzc0JhciIsImJ0biIsImJ0bkluZGV4IiwiaGFzIiwiZ2V0IiwicHJvZ3Jlc3NCYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiZGVsZXRlIiwic2V0IiwiY2hhbmdlQ3VycmVudEltZyIsImUiLCJ0YXJnZXQiLCJtYXRjaGVzIiwiY29udGFpbnMiLCJpbWdEYXRhIiwicGFyc2VJbnQiLCJkYXRhc2V0IiwiZmlsbSIsInRhYmluZGV4IiwiZ2l2ZUJ0bnNBdHRyaWJ1dGUiLCJ2aXNpYmlsaXR5IiwidHJhaWxlckJ0biIsInNlZU1vcmVCdG4iLCJzZXRBdHRyaWJ1dGUiLCJzdGFydFgiLCJlbmRYIiwic3RhcnRZIiwiZW5kWSIsImhhbmRsZVN3aXBlIiwiaG9yaXpvbnRhbERpc3RhbmNlIiwiYWJzIiwidmVydGljYWxEaXN0YW5jZSIsInNldFRvdWNoRXZlbnRMaXN0ZW5lciIsInRvdWNoZXMiLCJjbGllbnRYIiwiY2xpZW50WSIsImhhbmRsZVRvdWNoU3RhcnRFdmVudCIsImNoYW5nZWRUb3VjaGVzIiwiaGFuZGxlVG91Y2hFbmRFdmVudCIsInNtYWxsQ2Fyb3VzZWxsSW5kZXgiLCJ1cGRhdGVCdXR0b25TdGF0ZXMiLCJuZXh0QnRuIiwicHJldkJ0biIsIm1heEluZGV4IiwiZ2V0Q2Fyb3VzZWxDb25maWciLCJ0b2dnbGVBdHRyaWJ1dGUiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwibW92ZVNsaWRlciIsInNsaWRlciIsInRocmVzaG9sZCIsInNldFRocmVzaG9sZCIsInBvc3RlciIsInBvc3RlcldpZHRoIiwib2Zmc2V0V2lkdGgiLCJwcmVwYXJlQ2Fyb3VzZWxJdGVtcyIsInNob3dOZXh0U2xpZGUiLCJzaG93UHJldlNsaWRlIiwidXNlckRhdGEiLCJwcmVmZXJyZWRMYW5ndWFnZSIsImlzTG9nZ2VkSW4iLCJsb2dnZWRJbiIsInByZXBlbmQiLCJhcHBlbmQiLCJmaWxtcyIsIm1haW4iLCJicm93c2VTZWN0aW9uIiwic2VjdGlvbk5hbWVzIiwidXBjb21pbmciLCJsb2NhdGlvbiIsImhyZWYiLCJjaGVja0F1dGhvcml6YXRpb24iXSwic291cmNlcyI6WyJtYWluLXBhZ2UuanMiXSwibWFwcGluZ3MiOiJPQUNDQSxRQUNBQyxpQkFDQUMsc0JBQ0FDLGVBQ0FDLGNBQ0FDLGNBQ0FDLHFCQUNNLHNCQUNQQyxTQUFTQyxpQkFBaUIsbUJBQW9CLFdBRTdDLE1BR01DLEVBQVUsQ0FDZkMsT0FBUSxNQUNSQyxRQUFTLENBQ1JDLE9BQVEsbUJBQ1JDLGNBQ0MseVBBR0dDLEVBQXVCLElBQUlDLElBQ2pDLElBS0lDLEVBTEFDLEVBQWlCLElBSWpCQyxFQUFRLEVBR1osTUFFTUMsRUFBcUIsU0FvRXJCQyxFQUFjQyxNQUFPQyxFQUFNQyxLQUFZQyxLQUM1QyxNQUFNQyxFQUFZLEdBQ2xCLFVBQVcsTUFBTUMsS0FBT0YsRUFBTSxDQUM3QixNQUFNRyxFQUFNRCxFQUFNSixFQUFPSCxFQUFxQkksRUFDeENLLFFBQWlCQyxNQUFNRixFQUFLbEIsR0FDNUJxQixRQUFhRixFQUFTRyxPQUU1Qk4sRUFBVU8sS0FBS0YsRUFDaEIsQ0FDQSxPQUFPTCxHQUdGUSxFQUFXWixNQUFPQyxFQUFNQyxFQUFTRyxLQUN0QyxNQUFNQyxFQUFNRCxFQUFNSixFQUFPSCxFQUFxQkksRUFFOUMsSUFDQyxNQUFNSyxRQUFpQkMsTUFBTUYsRUFBS2xCLEdBR2xDLGFBRm1CbUIsRUFBU0csTUFHN0IsQ0FBRSxNQUNENUIsZUFBZStCLGFBQWFDLFdBQVdDLGlCQUFrQixVQUMxRCxHQUdLQyxFQUF1QmhCLE1BQU9DLEVBQU1DLEtBQ3pDLE1BQU1lLEVBQVcsR0FFakIsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEdBQUto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QUN6QlMsRUFBa0IrRixHQUFVQyxrQkFDNUJDLEVBQWFGLEdBQVVHLFNBRXZCeEYsRUFBWTlDLFNBQVNpRCxjQUFjLGNBRXpDLEdBQUtrRixHQUFhRSxFQUFsQixDQUtBdkYsRUFBVXlGLFFBQVE3SSxpQkFBaUJpQyxJQUNuQ21CLEVBQVUwRixPQUFPM0ksaUJBRWpCLElBQ0MsTUFBTWtELFFBQWVaLEVBQ3BCTCxFQUNBTSxHQUdEekMsc0JBQXNCb0QsRUFBUXBCLEVBQWNtQixHQUM1Q0QsRUFBcUJDLEVBQVdDLEdBRWhDdEMsRUFBb0JzRSxZQUNuQixJQUFNbEMsRUFBcUJDLEVBQVdDLEdBQ3RDckMsR0FHRHdFLEVBQWlCbkMsRUFBUUQsR0FDekIyRCxFQUFzQjNELEVBQVdDLEdBRWpDLE1BQU0wRixRQUFjNUgsRUFDbkJ1QixFQXZEcUIsRUFrQkcseURBMENuQnNHLEVBQU8xSSxTQUFTaUQsY0FBYyxRQUMvQnlGLEdBQ0o1RixFQUFVMEYsT0FDVHpJLGlCQUNDMEksRUFDQTlHLEVBQ0EsRUFDQUEsRUFBYWdILGNBQWNDLGFBQWFDLFdBSTNDSCxFQUFLRixPQUNKekksaUJBQ0MwSSxFQUNBOUcsRUFDQSxFQUNBQSxFQUFhZ0gsY0FBY0MsYUFBYUMsV0FHMUNiLEVBQXFCbEYsRUFDdEIsQ0FBRSxNQUNEbEQsZUFBZStCLEVBQWFDLFdBQVdDLGlCQUFrQixVQUMxRCxDQUFFLFFBQ0QvQixlQUNELENBcERBLE1BRkN5SCxPQUFPdUIsU0FBU0MsS0FBTyxLQTJWekJDLEVBQ0QiLCJpZ25vcmVMaXN0IjpbXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuXHRnZXREYXRhLFxyXG5cdGNyZWF0ZUJyb3dzZVBhZ2UsXHJcblx0Y3JlYXRlTWFpbkhlcm9TZWN0aW9uLFxyXG5cdHNob3dFcnJvclBvcHVwLFxyXG5cdHNob3dCaWdMb2FkZXIsXHJcblx0aGlkZUJpZ0xvYWRlcixcclxuXHRjcmVhdGVGaWxtU2xpZGVyLFxyXG59IGZyb20gXCIuL2NvbXBvbmVudHMubWluLmpzXCI7XHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcclxuXHQvLyBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL2Rpc2NvdmVyL21vdmllP2xhbmd1YWdlPXBsXHJcblx0Y29uc3QgQ0FST1VTRUxMX0xFTkdUSCA9IDU7XHJcblx0Y29uc3QgRklMTV9BTU9VTlRfUEVSX1BBR0UgPSAyMDtcclxuXHRjb25zdCBET1dOTE9BREVEX1BBR0UgPSAxO1xyXG5cdGNvbnN0IG9wdGlvbnMgPSB7XHJcblx0XHRtZXRob2Q6IFwiR0VUXCIsXHJcblx0XHRoZWFkZXJzOiB7XHJcblx0XHRcdGFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcblx0XHRcdEF1dGhvcml6YXRpb246XHJcblx0XHRcdFx0XCJCZWFyZXIgZXlKaGJHY2lPaUpJVXpJMU5pSjkuZXlKaGRXUWlPaUl6TlRZd1pqTTRNalUzTkRRMVpHRTFaR1prWVRZeFl6RTBZV000WW1NNE15SXNJbTVpWmlJNk1UYzFPVGMyTlRBek9DNDVOQ3dpYzNWaUlqb2lOamhsTTJVeU1tVXlOalk1TnpZNE16aGxZekkzTnpJNUlpd2ljMk52Y0dWeklqcGJJbUZ3YVY5eVpXRmtJbDBzSW5abGNuTnBiMjRpT2pGOS5udUdmRWpjbEpMZXBtenpIaTJvbU5ocDI5VEhnckpmOU52NkQ0X2dUZHhBXCIsXHJcblx0XHR9LFxyXG5cdH07XHJcblx0Y29uc3QgcHJvZ3Jlc3NCYXJJbnRlcnZhbHMgPSBuZXcgTWFwKCk7XHJcblx0bGV0IGNhcm91c2VsbFNwZWVkID0gMTAwMDA7XHJcblx0bGV0IGNhcm91c2VsbFN0cm9rZVJhbmdlID0gMjtcclxuXHRsZXQgaW50ZXJ2YWxTcGVlZCA9IChjYXJvdXNlbGxTcGVlZCAqIGNhcm91c2VsbFN0cm9rZVJhbmdlKSAvIDEwMDtcclxuXHRsZXQgY2Fyb3VzZWxsV2lkdGggPSAxMDA7XHJcblx0bGV0IGluZGV4ID0gMDtcclxuXHRsZXQgY2Fyb3VzZWxsSW50ZXJ2YWw7XHJcblxyXG5cdGNvbnN0IFBPUFVMQVJfRklMTVNfVVJMID0gYGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvcG9wdWxhcj9sYW5ndWFnZT1gO1xyXG5cdGNvbnN0IFVQQ09NSU5HX0ZJTE1TX1VSTCA9IGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllL3VwY29taW5nP2xhbmd1YWdlPWA7XHJcblx0Y29uc3QgRklMTVNfUEFHRVNfQU1PVU5UID0gYCZwYWdlPWA7XHJcblxyXG5cdGNvbnN0IGNoZWNrQXV0aG9yaXphdGlvbiA9IGFzeW5jICgpID0+IHtcclxuXHRcdGNvbnN0IHVzZXJEYXRhID0gZ2V0RGF0YSgpO1xyXG5cdFx0Y29uc3QgdHJhbnNsYXRpb25zID0gdXNlckRhdGE/LnRyYW5zbGF0aW9ucztcclxuXHRcdGNvbnN0IGN1cnJlbnRMYW5ndWFnZSA9IHVzZXJEYXRhPy5wcmVmZXJyZWRMYW5ndWFnZTtcclxuXHRcdGNvbnN0IGlzTG9nZ2VkSW4gPSB1c2VyRGF0YT8ubG9nZ2VkSW47XHJcblxyXG5cdFx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250YWluZXJcIik7XHJcblxyXG5cdFx0aWYgKCF1c2VyRGF0YSB8fCAhaXNMb2dnZWRJbikge1xyXG5cdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Y29udGFpbmVyLnByZXBlbmQoY3JlYXRlQnJvd3NlUGFnZSh0cmFuc2xhdGlvbnMpKTtcclxuXHRcdGNvbnRhaW5lci5hcHBlbmQoc2hvd0JpZ0xvYWRlcigpKTtcclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBtb3ZpZXMgPSBhd2FpdCBjaG9vc2VGaWxtc1RvQ2Fyb3VzZWxsKFxyXG5cdFx0XHRcdGxvYWRGaWxtc1RvQ2Fyb3VzZWxsLFxyXG5cdFx0XHRcdGN1cnJlbnRMYW5ndWFnZVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdFx0Y3JlYXRlTWFpbkhlcm9TZWN0aW9uKG1vdmllcywgdHJhbnNsYXRpb25zLCBjb250YWluZXIpO1xyXG5cdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblxyXG5cdFx0XHRjYXJvdXNlbGxJbnRlcnZhbCA9IHNldEludGVydmFsKFxyXG5cdFx0XHRcdCgpID0+IGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKSxcclxuXHRcdFx0XHRjYXJvdXNlbGxTcGVlZFxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdFx0Y2hhbmdlQ3VycmVudEltZyhtb3ZpZXMsIGNvbnRhaW5lcik7XHJcblx0XHRcdHNldFRvdWNoRXZlbnRMaXN0ZW5lcihjb250YWluZXIsIG1vdmllcyk7XHJcblxyXG5cdFx0XHRjb25zdCBmaWxtcyA9IGF3YWl0IGdldEFsbEZpbG1zKFxyXG5cdFx0XHRcdGN1cnJlbnRMYW5ndWFnZSxcclxuXHRcdFx0XHRET1dOTE9BREVEX1BBR0UsXHJcblx0XHRcdFx0VVBDT01JTkdfRklMTVNfVVJMXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XHJcblx0XHRcdGlmICghbWFpbikge1xyXG5cdFx0XHRcdGNvbnRhaW5lci5hcHBlbmQoXHJcblx0XHRcdFx0XHRjcmVhdGVGaWxtU2xpZGVyKFxyXG5cdFx0XHRcdFx0XHRmaWxtcyxcclxuXHRcdFx0XHRcdFx0dHJhbnNsYXRpb25zLFxyXG5cdFx0XHRcdFx0XHQwLFxyXG5cdFx0XHRcdFx0XHR0cmFuc2xhdGlvbnMuYnJvd3NlU2VjdGlvbi5zZWN0aW9uTmFtZXMudXBjb21pbmdcclxuXHRcdFx0XHRcdClcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdG1haW4uYXBwZW5kKFxyXG5cdFx0XHRcdGNyZWF0ZUZpbG1TbGlkZXIoXHJcblx0XHRcdFx0XHRmaWxtcyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucyxcclxuXHRcdFx0XHRcdDAsXHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnMuYnJvd3NlU2VjdGlvbi5zZWN0aW9uTmFtZXMudXBjb21pbmdcclxuXHRcdFx0XHQpXHJcblx0XHRcdCk7XHJcblx0XHRcdHByZXBhcmVDYXJvdXNlbEl0ZW1zKGNvbnRhaW5lcik7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fSBmaW5hbGx5IHtcclxuXHRcdFx0aGlkZUJpZ0xvYWRlcigpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdGNvbnN0IGdldEFsbEZpbG1zID0gYXN5bmMgKGxhbmcsIHBhZ2VOdW0sIC4uLnVybHMpID0+IHtcclxuXHRcdGNvbnN0IHJlc3BvbnNlcyA9IFtdO1xyXG5cdFx0Zm9yIGF3YWl0IChjb25zdCB1cmwgb2YgdXJscykge1xyXG5cdFx0XHRjb25zdCBVUkwgPSB1cmwgKyBsYW5nICsgRklMTVNfUEFHRVNfQU1PVU5UICsgcGFnZU51bTtcclxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChVUkwsIG9wdGlvbnMpO1xyXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG5cclxuXHRcdFx0cmVzcG9uc2VzLnB1c2goZGF0YSk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gcmVzcG9uc2VzO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGdldEZpbG1zID0gYXN5bmMgKGxhbmcsIHBhZ2VOdW0sIHVybCkgPT4ge1xyXG5cdFx0Y29uc3QgVVJMID0gdXJsICsgbGFuZyArIEZJTE1TX1BBR0VTX0FNT1VOVCArIHBhZ2VOdW07XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChVUkwsIG9wdGlvbnMpO1xyXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG5cclxuXHRcdFx0cmV0dXJuIGRhdGE7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdGNvbnN0IGxvYWRGaWxtc1RvQ2Fyb3VzZWxsID0gYXN5bmMgKGxhbmcsIHBhZ2VOdW0pID0+IHtcclxuXHRcdGNvbnN0IHJlcXVlc3RzID0gW107XHJcblxyXG5cdFx0Zm9yIChsZXQgaSA9IDE7IGkgPD0gcGFnZU51bTsgaSsrKSB7XHJcblx0XHRcdHJlcXVlc3RzLnB1c2goZ2V0RmlsbXMobGFuZywgaSwgUE9QVUxBUl9GSUxNU19VUkwpKTtcclxuXHRcdH1cclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCByZXNwb25zZXMgPSBhd2FpdCBQcm9taXNlLmFsbChyZXF1ZXN0cyk7XHJcblx0XHRcdHJldHVybiByZXNwb25zZXM7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdGNvbnN0IGNob29zZUZpbG1zVG9DYXJvdXNlbGwgPSBhc3luYyAoZGF0YSwgY3VycmVudExhbmd1YWdlKSA9PiB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBwYWdlc0RhdGEgPSBhd2FpdCBkYXRhKGN1cnJlbnRMYW5ndWFnZSwgQ0FST1VTRUxMX0xFTkdUSCk7XHJcblx0XHRcdGNvbnN0IHJhbmRvbU51bWJlciA9IE1hdGgudHJ1bmMoTWF0aC5yYW5kb20oKSAqIEZJTE1fQU1PVU5UX1BFUl9QQUdFKTtcclxuXHRcdFx0Y29uc3QgY2hvb3Nlbk1vdmllcyA9IHBhZ2VzRGF0YS5tYXAoKHBhZ2UpID0+IHBhZ2UucmVzdWx0c1tyYW5kb21OdW1iZXJdKTtcclxuXHJcblx0XHRcdHJldHVybiBjaG9vc2VuTW92aWVzO1xyXG5cdFx0fSBjYXRjaCB7XHJcblx0XHRcdHNob3dFcnJvclBvcHVwKHRyYW5zbGF0aW9ucy5icm93c2VQYWdlLmxvYWRpbmdEYXRhRXJyb3IsIFwiI2RjNGEzNFwiKTtcclxuXHRcdH0gZmluYWxseSB7XHJcblx0XHRcdGhpZGVCaWdMb2FkZXIoKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQvLyBDQVJPVVNFTExcclxuXHJcblx0Y29uc3QgaGFuZGxlRmlsbXNDYXJvdXNlbGwgPSAoY29udGFpbmVyLCBtb3ZpZXMpID0+IHtcclxuXHRcdGNvbnN0IGltYWdlU2xpZGVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX2ltYWdlc1wiKTtcclxuXHRcdGNvbnN0IGFsbEltYWdlcyA9IGltYWdlU2xpZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLW1haW5fX2ltZy1ib3hcIik7XHJcblx0XHRjb25zdCBjYXJvdXNlbGxDb250cm9scyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRcIi5icm93c2UtbWFpbl9fY2Fyb3VzZWxsLWNvbnRyb2xzXCJcclxuXHRcdCk7XHJcblx0XHRhbGxJbWFnZXMuZm9yRWFjaCgoaW1nKSA9PiBpbWcuY2xhc3NMaXN0LnJlbW92ZShcImN1cnJlbnRWaXNpYmxlXCIpKTtcclxuXHJcblx0XHRpbWFnZVNsaWRlci5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgkey1pbmRleCAqIGNhcm91c2VsbFdpZHRofSUpYDtcclxuXHRcdGhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUoaW5kZXgsIGNhcm91c2VsbENvbnRyb2xzKTtcclxuXHRcdGFsbEltYWdlc1tpbmRleF0uY2xhc3NMaXN0LmFkZChcImN1cnJlbnRWaXNpYmxlXCIpO1xyXG5cclxuXHRcdGluZGV4Kys7XHJcblxyXG5cdFx0aWYgKGluZGV4ID4gbW92aWVzLmxlbmd0aCAtIDEpIGluZGV4ID0gMDtcclxuXHJcblx0XHRoYW5kbGVCdG5zVmlzaWJpbGl0eShjb250YWluZXIpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUgPSAoaW5kZXgsIGNhcm91c2VsbENvbnRyb2xzQm94KSA9PiB7XHJcblx0XHRjb25zdCBhbGxDb250cm9sQnRucyA9XHJcblx0XHRcdGNhcm91c2VsbENvbnRyb2xzQm94LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLW1haW5fX2J0blwiKTtcclxuXHRcdGNvbnN0IGN1cnJlbnRCdG4gPSBjYXJvdXNlbGxDb250cm9sc0JveC5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRgLmJyb3dzZS1tYWluX19idG5bZGF0YS1pbWc9XCIke2luZGV4fVwiXWBcclxuXHRcdCk7XHJcblx0XHRjb25zdCBwcm9ncmVzc0JhciA9IGN1cnJlbnRCdG4ucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9fcHJvZ3Jlc3MtYmFyXCIpO1xyXG5cdFx0Y29uc3QgYWxsUHJvZ3Jlc3NCYXJzID0gY2Fyb3VzZWxsQ29udHJvbHNCb3gucXVlcnlTZWxlY3RvckFsbChcclxuXHRcdFx0XCIuYnJvd3NlLW1haW5fX3Byb2dyZXNzLWJhclwiXHJcblx0XHQpO1xyXG5cclxuXHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLmZvckVhY2goKGludGVydmFsKSA9PiBjbGVhckludGVydmFsKGludGVydmFsKSk7XHJcblx0XHRwcm9ncmVzc0JhckludGVydmFscy5jbGVhcigpO1xyXG5cclxuXHRcdGFsbFByb2dyZXNzQmFycy5mb3JFYWNoKChiYXIpID0+IChiYXIuc3R5bGUud2lkdGggPSBcIjBcIikpO1xyXG5cclxuXHRcdGNoYW5nZVByb2dyZXNzQmFyKHByb2dyZXNzQmFyLCBpbmRleCk7XHJcblxyXG5cdFx0YWxsQ29udHJvbEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKSk7XHJcblx0XHRjdXJyZW50QnRuLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgY2hhbmdlUHJvZ3Jlc3NCYXIgPSAocHJvZ3Jlc3NCYXIsIGJ0bkluZGV4KSA9PiB7XHJcblx0XHRpZiAocHJvZ3Jlc3NCYXJJbnRlcnZhbHMuaGFzKGJ0bkluZGV4KSkge1xyXG5cdFx0XHRjbGVhckludGVydmFsKHByb2dyZXNzQmFySW50ZXJ2YWxzLmdldChidG5JbmRleCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCB3aWR0aCA9IDA7XHJcblx0XHRjb25zdCBwcm9ncmVzc0JhckludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHR3aWR0aCArPSBjYXJvdXNlbGxTdHJva2VSYW5nZTtcclxuXHRcdFx0cHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHt3aWR0aH0lYDtcclxuXHRcdFx0aWYgKHdpZHRoID49IDEwMCkge1xyXG5cdFx0XHRcdHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gXCIwXCI7XHJcblx0XHRcdFx0Y2xlYXJJbnRlcnZhbChwcm9ncmVzc0JhckludGVydmFsKTtcclxuXHJcblx0XHRcdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuZGVsZXRlKGJ0bkluZGV4KTtcclxuXHRcdFx0fVxyXG5cdFx0fSwgaW50ZXJ2YWxTcGVlZCk7XHJcblxyXG5cdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuc2V0KGJ0bkluZGV4LCBwcm9ncmVzc0JhckludGVydmFsKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBjaGFuZ2VDdXJyZW50SW1nID0gKG1vdmllcywgY29udGFpbmVyKSA9PiB7XHJcblx0XHRjb25zdCBjYXJvdXNlbGxDb250cm9scyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRcIi5icm93c2UtbWFpbl9fY2Fyb3VzZWxsLWNvbnRyb2xzXCJcclxuXHRcdCk7XHJcblxyXG5cdFx0Y2Fyb3VzZWxsQ29udHJvbHMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRcdGlmIChlLnRhcmdldC5tYXRjaGVzKFwiLmJyb3dzZS1tYWluX19idG5cIikpIHtcclxuXHRcdFx0XHRpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlXCIpKSByZXR1cm47XHJcblxyXG5cdFx0XHRcdGNsZWFySW50ZXJ2YWwoY2Fyb3VzZWxsSW50ZXJ2YWwpO1xyXG5cclxuXHRcdFx0XHRjb25zdCBjdXJyZW50QnRuID0gZS50YXJnZXQ7XHJcblx0XHRcdFx0Y29uc3QgaW1nRGF0YSA9IHBhcnNlSW50KGN1cnJlbnRCdG4uZGF0YXNldC5pbWcpO1xyXG5cclxuXHRcdFx0XHRpbmRleCA9IGltZ0RhdGE7XHJcblx0XHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cclxuXHRcdFx0XHRjYXJvdXNlbGxJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuXHRcdFx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdFx0XHR9LCBjYXJvdXNlbGxTcGVlZCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZUJ0bnNWaXNpYmlsaXR5ID0gKGNvbnRhaW5lcikgPT4ge1xyXG5cdFx0Y29uc3QgYWxsRmlsbXMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2UtbWFpbl9faW1nLWJveFwiKTtcclxuXHJcblx0XHRhbGxGaWxtcy5mb3JFYWNoKChmaWxtKSA9PiB7XHJcblx0XHRcdGNvbnN0IGlzQWN0aXZlID0gZmlsbS5jbGFzc0xpc3QuY29udGFpbnMoXCJjdXJyZW50VmlzaWJsZVwiKTtcclxuXHRcdFx0Y29uc3QgdGFiaW5kZXggPSBpc0FjdGl2ZSA/IDAgOiAtMTtcclxuXHRcdFx0Y29uc3QgdmlzaWJpbGl0eSA9IHRhYmluZGV4ID09PSAwID8gXCJ2aXNpYmxlXCIgOiBcImhpZGRlblwiO1xyXG5cdFx0XHRnaXZlQnRuc0F0dHJpYnV0ZShmaWxtLCB0YWJpbmRleCwgdmlzaWJpbGl0eSk7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cdGNvbnN0IGdpdmVCdG5zQXR0cmlidXRlID0gKGZpbG0sIHRhYmluZGV4LCB2aXNpYmlsaXR5KSA9PiB7XHJcblx0XHRjb25zdCB0cmFpbGVyQnRuID0gZmlsbS5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1tYWluX190cmFpbGVyLWJ0blwiKTtcclxuXHRcdGNvbnN0IHNlZU1vcmVCdG4gPSBmaWxtLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX3NlZS1tb3JlLWJ0blwiKTtcclxuXHJcblx0XHR0cmFpbGVyQnRuLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIHRhYmluZGV4KTtcclxuXHRcdHNlZU1vcmVCdG4uc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgdGFiaW5kZXgpO1xyXG5cdFx0dHJhaWxlckJ0bi5zdHlsZS52aXNpYmlsaXR5ID0gdmlzaWJpbGl0eTtcclxuXHRcdHNlZU1vcmVCdG4uc3R5bGUudmlzaWJpbGl0eSA9IHZpc2liaWxpdHk7XHJcblx0fTtcclxuXHJcblx0bGV0IHN0YXJ0WDtcclxuXHRsZXQgZW5kWDtcclxuXHRsZXQgc3RhcnRZO1xyXG5cdGxldCBlbmRZO1xyXG5cclxuXHRjb25zdCBoYW5kbGVUb3VjaFN0YXJ0RXZlbnQgPSAoZSkgPT4ge1xyXG5cdFx0c3RhcnRYID0gZS50b3VjaGVzWzBdLmNsaWVudFg7XHJcblx0XHRzdGFydFkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVUb3VjaEVuZEV2ZW50ID0gKGUsIGNvbnRhaW5lciwgbW92aWVzKSA9PiB7XHJcblx0XHRlbmRYID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRYO1xyXG5cdFx0ZW5kWSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WTtcclxuXHRcdGhhbmRsZVN3aXBlKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVTd2lwZSA9IChjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0Y29uc3QgSE9SSVpPTlRBTF9SQU5HRSA9IDUwO1xyXG5cdFx0Y29uc3QgVkVSVElDQUxfUkFOR0UgPSAzMDtcclxuXHJcblx0XHRjb25zdCBob3Jpem9udGFsRGlzdGFuY2UgPSBNYXRoLmFicyhzdGFydFggLSBlbmRYKTtcclxuXHRcdGNvbnN0IHZlcnRpY2FsRGlzdGFuY2UgPSBNYXRoLmFicyhzdGFydFkgLSBlbmRZKTtcclxuXHJcblx0XHRpZiAoXHJcblx0XHRcdGhvcml6b250YWxEaXN0YW5jZSA8IEhPUklaT05UQUxfUkFOR0UgfHxcclxuXHRcdFx0dmVydGljYWxEaXN0YW5jZSA+IFZFUlRJQ0FMX1JBTkdFXHJcblx0XHQpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGVuZFggLSBzdGFydFggPiBIT1JJWk9OVEFMX1JBTkdFKSB7XHJcblx0XHRcdGluZGV4ID0gKGluZGV4IC0gMiArIG1vdmllcy5sZW5ndGgpICUgbW92aWVzLmxlbmd0aDtcclxuXHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0fSBlbHNlIGlmIChzdGFydFggLSBlbmRYID4gSE9SSVpPTlRBTF9SQU5HRSkge1xyXG5cdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y2xlYXJJbnRlcnZhbChjYXJvdXNlbGxJbnRlcnZhbCk7XHJcblx0XHRjYXJvdXNlbGxJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuXHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0fSwgY2Fyb3VzZWxsU3BlZWQpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IHNldFRvdWNoRXZlbnRMaXN0ZW5lciA9IChjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0Y29uc3QgaW1hZ2VTbGlkZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9faW1hZ2VzXCIpO1xyXG5cclxuXHRcdGltYWdlU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIChlKSA9PiB7XHJcblx0XHRcdGhhbmRsZVRvdWNoU3RhcnRFdmVudChlKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGltYWdlU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCAoZSkgPT4ge1xyXG5cdFx0XHRoYW5kbGVUb3VjaEVuZEV2ZW50KGUsIGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdGxldCBzbWFsbENhcm91c2VsbEluZGV4ID0gMDtcclxuXHJcblx0Y29uc3QgdXBkYXRlQnV0dG9uU3RhdGVzID0gKG5leHRCdG4sIHByZXZCdG4pID0+IHtcclxuXHRcdGNvbnN0IG1heEluZGV4ID0gZ2V0Q2Fyb3VzZWxDb25maWcoKTtcclxuXHJcblx0XHRwcmV2QnRuLnRvZ2dsZUF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHNtYWxsQ2Fyb3VzZWxsSW5kZXggPT09IDApO1xyXG5cdFx0bmV4dEJ0bi50b2dnbGVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBzbWFsbENhcm91c2VsbEluZGV4ID49IG1heEluZGV4KTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBnZXRDYXJvdXNlbENvbmZpZyA9ICgpID0+IHtcclxuXHRcdGxldCBtYXhJbmRleDtcclxuXHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPCA1NzYpIG1heEluZGV4ID0gOTtcclxuXHRcdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSA1NzYgJiYgd2luZG93LmlubmVyV2lkdGggPCA5OTIpIG1heEluZGV4ID0gMTc7XHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPj0gOTkyICYmIHdpbmRvdy5pbm5lcldpZHRoIDwgMTIwMCkgbWF4SW5kZXggPSA0O1xyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoID49IDEyMDApIG1heEluZGV4ID0gNztcclxuXHJcblx0XHRyZXR1cm4gbWF4SW5kZXg7XHJcblx0fTtcclxuXHJcblx0Y29uc3Qgc2V0VGhyZXNob2xkID0gKCkgPT4ge1xyXG5cdFx0bGV0IHRocmVzaG9sZCA9IDI7XHJcblxyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoID4gNTc2ICYmIHdpbmRvdy5pbm5lcldpZHRoIDwgOTkyKSB0aHJlc2hvbGQgPSAxO1xyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoID49IDk5MiAmJiB3aW5kb3cuaW5uZXJXaWR0aCA8IDEyMDApIHRocmVzaG9sZCA9IDQ7XHJcblxyXG5cdFx0cmV0dXJuIHRocmVzaG9sZDtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBtb3ZlU2xpZGVyID0gKHNsaWRlcikgPT4ge1xyXG5cdFx0Y29uc3QgdGhyZXNob2xkID0gc2V0VGhyZXNob2xkKCk7XHJcblxyXG5cdFx0Y29uc3QgYWxsUG9zdGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlci1ib3hcIik7XHJcblxyXG5cdFx0YWxsUG9zdGVycy5mb3JFYWNoKChwb3N0ZXIpID0+IHtcclxuXHRcdFx0Y29uc3QgcG9zdGVyV2lkdGggPSBwb3N0ZXIub2Zmc2V0V2lkdGg7XHJcblxyXG5cdFx0XHRzbGlkZXIuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHtcclxuXHRcdFx0XHQtc21hbGxDYXJvdXNlbGxJbmRleCAqIHBvc3RlcldpZHRoICogdGhyZXNob2xkXHJcblx0XHRcdH1weClgO1xyXG5cdFx0fSk7XHJcblx0fTtcclxuXHJcblx0Y29uc3Qgc2hvd05leHRTbGlkZSA9IChzbGlkZXIsIG5leHRCdG4sIHByZXZCdG4pID0+IHtcclxuXHRcdGNvbnN0IG1heEluZGV4ID0gZ2V0Q2Fyb3VzZWxDb25maWcoKTtcclxuXHJcblx0XHRpZiAoc21hbGxDYXJvdXNlbGxJbmRleCA+PSBtYXhJbmRleCkgcmV0dXJuO1xyXG5cclxuXHRcdHNtYWxsQ2Fyb3VzZWxsSW5kZXgrKztcclxuXHRcdG1vdmVTbGlkZXIoc2xpZGVyKTtcclxuXHRcdHVwZGF0ZUJ1dHRvblN0YXRlcyhuZXh0QnRuLCBwcmV2QnRuKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBzaG93UHJldlNsaWRlID0gKHNsaWRlciwgbmV4dEJ0biwgcHJldkJ0bikgPT4ge1xyXG5cdFx0aWYgKHNtYWxsQ2Fyb3VzZWxsSW5kZXggPD0gMCkgcmV0dXJuO1xyXG5cclxuXHRcdHNtYWxsQ2Fyb3VzZWxsSW5kZXgtLTtcclxuXHRcdG1vdmVTbGlkZXIoc2xpZGVyKTtcclxuXHRcdHVwZGF0ZUJ1dHRvblN0YXRlcyhuZXh0QnRuLCBwcmV2QnRuKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBwcmVwYXJlQ2Fyb3VzZWxJdGVtcyA9IChjb250YWluZXIpID0+IHtcclxuXHRcdGNvbnN0IHNsaWRlciA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXItaW1hZ2VzXCIpO1xyXG5cdFx0Y29uc3QgbmV4dEJ0biA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXItbmV4dC1idG5cIik7XHJcblx0XHRjb25zdCBwcmV2QnRuID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlci1wcmV2LWJ0blwiKTtcclxuXHJcblx0XHRuZXh0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG5cdFx0XHRzaG93TmV4dFNsaWRlKHNsaWRlciwgbmV4dEJ0biwgcHJldkJ0bilcclxuXHRcdCk7XHJcblx0XHRwcmV2QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG5cdFx0XHRzaG93UHJldlNsaWRlKHNsaWRlciwgbmV4dEJ0biwgcHJldkJ0bilcclxuXHRcdCk7XHJcblxyXG5cdFx0dXBkYXRlQnV0dG9uU3RhdGVzKG5leHRCdG4sIHByZXZCdG4pO1xyXG5cdH07XHJcblx0Y2hlY2tBdXRob3JpemF0aW9uKCk7XHJcbn0pO1xyXG4iXX0=
