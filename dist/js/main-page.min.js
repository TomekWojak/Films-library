import{getData,createBrowsePage,createMainHeroSection,showErrorPopup,showBigLoader,hideBigLoader,createFilmSlider,createFooter,closeAllNotClicked}from"./components.min.js";document.addEventListener("DOMContentLoaded",function(){const e={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNTYwZjM4MjU3NDQ1ZGE1ZGZkYTYxYzE0YWM4YmM4MyIsIm5iZiI6MTc1OTc2NTAzOC45NCwic3ViIjoiNjhlM2UyMmUyNjY5NzY4MzhlYzI3NzI5Iiwic2NvcGVzIjpbImFwaV9yZWFkIl0sInZlcnNpb24iOjF9.nuGfEjclJLepmzzHi2omNhp29THgrJf9Nv6D4_gTdxA"}},t=new Map;let r,o=1e4,n=0;const a=new Date,i=`https://api.themoviedb.org/3/discover/movie?primary_release_year=2025&primary_release_date.gte=${a.getFullYear()}-${a.getMonth()+1}-${a.getDate()}&sort_by=popularity.desc\n`,s="&page=",c=async(t,...r)=>{const o=[];for await(const n of r){const r=n+t+s+1,a=await fetch(r,e),i=await a.json();o.push(i)}return o},l=async(t,r,o)=>{const n=o+t+s+r;try{const t=await fetch(n,e);return await t.json()}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},d=async(e,t)=>{const r=[];for(let o=1;o<=t;o++)r.push(l(e,o,"https://api.themoviedb.org/3/movie/popular?with_origin_country=US|GB|CA&language="));try{return await Promise.all(r)}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},w=async(e,t)=>{try{const r=await e(t,5),o=Math.trunc(20*Math.random());return r.map(e=>e.results[o])}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}},h=(e,t)=>{const r=e.querySelector(".browse-main__images"),o=r.querySelectorAll(".browse-main__img-box"),a=e.querySelector(".browse-main__carousell-controls");o.forEach(e=>e.classList.remove("currentVisible")),r.style.transform=`translateX(${100*-n}%)`,u(n,a),o[n].classList.add("currentVisible"),n++,n>t.length-1&&(n=0),b(e)},u=(e,r)=>{const o=r.querySelectorAll(".browse-main__btn"),n=r.querySelector(`.browse-main__btn[data-img="${e}"]`),a=n.querySelector(".browse-main__progress-bar"),i=r.querySelectorAll(".browse-main__progress-bar");t.forEach(e=>clearInterval(e)),t.clear(),i.forEach(e=>e.style.width="0"),g(a,e),o.forEach(e=>e.classList.remove("active")),n.classList.add("active")},g=(e,r)=>{t.has(r)&&clearInterval(t.get(r));let o=0;const n=setInterval(()=>{o+=2,e.style.width=`${o}%`,o>=100&&(e.style.width="0",clearInterval(n),t.delete(r))},200);t.set(r,n)},m=(e,t)=>{t.querySelector(".browse-main__carousell-controls").addEventListener("click",a=>{if(a.target.matches(".browse-main__btn")){if(a.target.classList.contains("active"))return;clearInterval(r);const i=a.target,s=parseInt(i.dataset.img);n=s,h(t,e),r=setInterval(()=>{h(t,e)},o)}})},b=e=>{e.querySelectorAll(".browse-main__img-box").forEach(e=>{const t=e.classList.contains("currentVisible")?0:-1;p(e,t,0===t?"visible":"hidden")})},p=(e,t,r)=>{const o=e.querySelector(".browse-main__trailer-btn"),n=e.querySelector(".browse-main__see-more-btn");o.setAttribute("tabindex",t),n.setAttribute("tabindex",t),o.style.visibility=r,n.style.visibility=r};let y,_,v,f;const S=(e,t)=>{const a=Math.abs(y-_),i=Math.abs(v-f);a<30||i>30||(_-y>30?(n=(n-2+t.length)%t.length,h(e,t)):y-_>30&&h(e,t),clearInterval(r),r=setInterval(()=>{h(e,t)},o))},E=(e,t)=>{const r=e.querySelector(".browse-main__images");r.addEventListener("touchstart",e=>{(e=>{y=e.touches[0].clientX,v=e.touches[0].clientY})(e)}),r.addEventListener("touchend",r=>{((e,t,r)=>{_=e.changedTouches[0].clientX,f=e.changedTouches[0].clientY,S(t,r)})(r,e,t)})},I=(e,t)=>{e.dataset.index=t},L=e=>{const t=(()=>{let e=2;return window.innerWidth>576&&window.innerWidth<992&&(e=1),window.innerWidth>=992&&window.innerWidth<1200&&(e=4),e})();let r=e.dataset.index;const o=e.querySelector(".browse-section__slider-images"),n=e.querySelector(".browse-section__slider-box");if(!n)return;const a=n.offsetWidth;o.style.transform=`translateX(${-r*a*t}px)`},q=(e,t)=>{let r=0===t?parseInt(e.dataset.index):0;r>=(()=>{let e;return window.innerWidth<576&&(e=9),window.innerWidth>=576&&window.innerWidth<992&&(e=17),window.innerWidth>=992&&window.innerWidth<1200&&(e=4),window.innerWidth>=1200&&(e=7),e})()||(r++,I(e,r),L(e))},N=e=>{e.querySelectorAll(".browse-section__slider").forEach(e=>e.addEventListener("click",t=>{t.target.matches(".browse-section__slider-next-btn")?q(e,0):t.target.matches(".browse-section__slider-prev-btn")&&((e,t)=>{let r=0===t?parseInt(e.dataset.index):0;r<=0||(r--,I(e,r),L(e))})(e,0)}))};let M=window.innerWidth;window.addEventListener("resize",()=>{if(window.innerWidth===M)return;M=window.innerWidth;document.querySelectorAll(".browse-section__slider").forEach(e=>{const t=e.querySelector(".browse-section__slider-images");I(e,0),t.style.transform="translateX(0)"})}),window.addEventListener("unload",()=>{clearInterval(r),t.forEach(e=>clearInterval(e)),t.clear()}),window.addEventListener("click",e=>{closeAllNotClicked(e)}),(async()=>{const e=getData(),t=e?.translations,n=e?.preferredLanguage,a=e?.loggedIn,s=document.querySelector(".container"),l=e?.currentProfile,u=e?.userProfiles;if(!u)return void(window.location.href="/");const g=Object.keys(u);if(e&&a&&l&&0!==g.length){s.prepend(createBrowsePage(t)),s.append(showBigLoader());try{const e=await w(d,n);createMainHeroSection(e,t,s),h(s,e),r=setInterval(()=>h(s,e),o),m(e,s),E(s,e);const a=await c(n,"https://api.themoviedb.org/3/movie/upcoming?language=","https://api.themoviedb.org/3/trending/all/week?language=","https://api.themoviedb.org/3/discover/tv?with_origin_country=US|GB&language=&sort_by=popularity.desc\n",i),l=document.querySelector("main");l||showErrorPopup(t.browsePage.loadingDataError,"#dc4a34"),l.append(createFilmSlider(a,t,1,t.browseSection.sectionNames.trending),createFilmSlider(a,t,0,t.browseSection.sectionNames.upcoming),createFilmSlider(a,t,2,t.browseSection.sectionNames.topRatedSeries),createFilmSlider(a,t,3,t.browseSection.sectionNames.futureFilms)),N(s),s.append(createFooter(t))}catch{showErrorPopup(t.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}}else window.location.href="/"})()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi1wYWdlLm1pbi5qcyIsIm5hbWVzIjpbImdldERhdGEiLCJjcmVhdGVCcm93c2VQYWdlIiwiY3JlYXRlTWFpbkhlcm9TZWN0aW9uIiwic2hvd0Vycm9yUG9wdXAiLCJzaG93QmlnTG9hZGVyIiwiaGlkZUJpZ0xvYWRlciIsImNyZWF0ZUZpbG1TbGlkZXIiLCJjcmVhdGVGb290ZXIiLCJjbG9zZUFsbE5vdENsaWNrZWQiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJvcHRpb25zIiwibWV0aG9kIiwiaGVhZGVycyIsImFjY2VwdCIsIkF1dGhvcml6YXRpb24iLCJwcm9ncmVzc0JhckludGVydmFscyIsIk1hcCIsImNhcm91c2VsbEludGVydmFsIiwiY2Fyb3VzZWxsU3BlZWQiLCJpbmRleCIsImN1cnJlbnREYXRlIiwiRGF0ZSIsIlVQQ09NSU5HX0ZJTE1TIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJGSUxNU19QQUdFU19BTU9VTlQiLCJnZXRBbGxGaWxtcyIsImFzeW5jIiwibGFuZyIsInVybHMiLCJmaWxtc0FyciIsInVybCIsIlVSTCIsInJlc3BvbnNlIiwiZmV0Y2giLCJkYXRhIiwianNvbiIsInB1c2giLCJnZXRGaWxtcyIsInBhZ2VOdW0iLCJ0cmFuc2xhdGlvbnMiLCJicm93c2VQYWdlIiwibG9hZGluZ0RhdGFFcnJvciIsImxvYWRGaWxtc1RvQ2Fyb3VzZWxsIiwicmVxdWVzdHMiLCJpIiwiUHJvbWlzZSIsImFsbCIsImNob29zZUZpbG1zVG9DYXJvdXNlbGwiLCJjdXJyZW50TGFuZ3VhZ2UiLCJwYWdlc0RhdGEiLCJyYW5kb21OdW1iZXIiLCJNYXRoIiwidHJ1bmMiLCJyYW5kb20iLCJtYXAiLCJwYWdlIiwicmVzdWx0cyIsImhhbmRsZUZpbG1zQ2Fyb3VzZWxsIiwiY29udGFpbmVyIiwibW92aWVzIiwiaW1hZ2VTbGlkZXIiLCJxdWVyeVNlbGVjdG9yIiwiYWxsSW1hZ2VzIiwicXVlcnlTZWxlY3RvckFsbCIsImNhcm91c2VsbENvbnRyb2xzIiwiZm9yRWFjaCIsImltZyIsImNsYXNzTGlzdCIsInJlbW92ZSIsInN0eWxlIiwidHJhbnNmb3JtIiwiaGFuZGxlQ2Fyb3VzZWxsQ29udHJvbHNTdGF0ZSIsImFkZCIsImxlbmd0aCIsImhhbmRsZUJ0bnNWaXNpYmlsaXR5IiwiY2Fyb3VzZWxsQ29udHJvbHNCb3giLCJhbGxDb250cm9sQnRucyIsImN1cnJlbnRCdG4iLCJwcm9ncmVzc0JhciIsImFsbFByb2dyZXNzQmFycyIsImludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImNsZWFyIiwiYmFyIiwid2lkdGgiLCJjaGFuZ2VQcm9ncmVzc0JhciIsImJ0biIsImJ0bkluZGV4IiwiaGFzIiwiZ2V0IiwicHJvZ3Jlc3NCYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiZGVsZXRlIiwic2V0IiwiY2hhbmdlQ3VycmVudEltZyIsImUiLCJ0YXJnZXQiLCJtYXRjaGVzIiwiY29udGFpbnMiLCJpbWdEYXRhIiwicGFyc2VJbnQiLCJkYXRhc2V0IiwiZmlsbSIsInRhYmluZGV4IiwiZ2l2ZUJ0bnNBdHRyaWJ1dGUiLCJ2aXNpYmlsaXR5IiwidHJhaWxlckJ0biIsInNlZU1vcmVCdG4iLCJzZXRBdHRyaWJ1dGUiLCJzdGFydFgiLCJlbmRYIiwic3RhcnRZIiwiZW5kWSIsImhhbmRsZVN3aXBlIiwiaG9yaXpvbnRhbERpc3RhbmNlIiwiYWJzIiwidmVydGljYWxEaXN0YW5jZSIsInNldFRvdWNoRXZlbnRMaXN0ZW5lciIsInRvdWNoZXMiLCJjbGllbnRYIiwiY2xpZW50WSIsImhhbmRsZVRvdWNoU3RhcnRFdmVudCIsImNoYW5nZWRUb3VjaGVzIiwiaGFuZGxlVG91Y2hFbmRFdmVudCIsImNoYW5nZUNhcm91c2VsbERhdGFJbmRleCIsInNsaWRlciIsIm1vdmVTbGlkZXIiLCJ0aHJlc2hvbGQiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwic2V0VGhyZXNob2xkIiwic2xpZGVyRGF0YXNldCIsInNsaWRlckNhcm91c2VsbCIsInBvc3RlciIsInBvc3RlcldpZHRoIiwib2Zmc2V0V2lkdGgiLCJzaG93TmV4dFNsaWRlIiwiaW5pdGlhbEluZGV4IiwibWF4SW5kZXgiLCJnZXRDYXJvdXNlbENvbmZpZyIsInByZXBhcmVDYXJvdXNlbEl0ZW1zIiwic2hvd1ByZXZTbGlkZSIsImxhc3RXaWR0aCIsInVzZXJEYXRhIiwicHJlZmVycmVkTGFuZ3VhZ2UiLCJpc0xvZ2dlZEluIiwibG9nZ2VkSW4iLCJjdXJyZW50UHJvZmlsZSIsInVzZXJQcm9maWxlcyIsImxvY2F0aW9uIiwiaHJlZiIsInVzZXJQcm9maWxlc0FyciIsIk9iamVjdCIsImtleXMiLCJwcmVwZW5kIiwiYXBwZW5kIiwiZmlsbXMiLCJtYWluIiwiYnJvd3NlU2VjdGlvbiIsInNlY3Rpb25OYW1lcyIsInRyZW5kaW5nIiwidXBjb21pbmciLCJ0b3BSYXRlZFNlcmllcyIsImZ1dHVyZUZpbG1zIiwiY2hlY2tBdXRob3JpemF0aW9uIl0sInNvdXJjZXMiOlsibWFpbi1wYWdlLmpzIl0sIm1hcHBpbmdzIjoiT0FDQ0EsUUFDQUMsaUJBQ0FDLHNCQUNBQyxlQUNBQyxjQUNBQyxjQUNBQyxpQkFDQUMsYUFDQUMsdUJBQ00sc0JBQ1BDLFNBQVNDLGlCQUFpQixtQkFBb0IsV0FDN0MsTUFHTUMsRUFBVSxDQUNmQyxPQUFRLE1BQ1JDLFFBQVMsQ0FDUkMsT0FBUSxtQkFDUkMsY0FDQyx5UEFHR0MsRUFBdUIsSUFBSUMsSUFDakMsSUFLSUMsRUFMQUMsRUFBaUIsSUFJakJDLEVBQVEsRUFHWixNQUtNQyxFQUFjLElBQUlDLEtBQ2xCQyxFQUFpQixrR0FBa0dGLEVBQVlHLGlCQUNwSUgsRUFBWUksV0FBYSxLQUN0QkosRUFBWUssc0NBR1ZDLEVBQXFCLFNBa0dyQkMsRUFBY0MsTUFBT0MsS0FBU0MsS0FDbkMsTUFBTUMsRUFBVyxHQUNqQixVQUFXLE1BQU1DLEtBQU9GLEVBQU0sQ0FDN0IsTUFBTUcsRUFDTEQsRUFBTUgsRUFBT0gsRUFsSXdCLEVBbUloQ1EsUUFBaUJDLE1BQU1GLEVBQUt2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QUEzQkksRUFBZ0I5RSxPQUpqQixDQVVBZixFQUFVZ0csUUFBUTVKLGlCQUFpQnlDLElBQ25DbUIsRUFBVWlHLE9BQU8xSixpQkFFakIsSUFDQyxNQUFNMEQsUUFBZVosRUFDcEJMLEVBQ0FNLEdBR0RqRCxzQkFBc0I0RCxFQUFRcEIsRUFBY21CLEdBQzVDRCxFQUFxQkMsRUFBV0MsR0FFaEM1QyxFQUFvQjRFLFlBQ25CLElBQU1sQyxFQUFxQkMsRUFBV0MsR0FDdEMzQyxHQUdEOEUsRUFBaUJuQyxFQUFRRCxHQUN6QjJELEVBQXNCM0QsRUFBV0MsR0FFakMsTUFBTWlHLFFBQWNuSSxFQUNuQnVCLEVBNUR5Qix3REFDRCwyREFDSyx5R0E4RDdCNUIsR0FHS3lJLEVBQU92SixTQUFTdUQsY0FBYyxRQUUvQmdHLEdBQ0o3SixlQUFldUMsRUFBYUMsV0FBV0MsaUJBQWtCLFdBRzFEb0gsRUFBS0YsT0FDSnhKLGlCQUNDeUosRUFDQXJILEVBQ0EsRUFDQUEsRUFBYXVILGNBQWNDLGFBQWFDLFVBRXpDN0osaUJBQ0N5SixFQUNBckgsRUFDQSxFQUNBQSxFQUFhdUgsY0FBY0MsYUFBYUUsVUFFekM5SixpQkFDQ3lKLEVBQ0FySCxFQUNBLEVBQ0FBLEVBQWF1SCxjQUFjQyxhQUFhRyxnQkFFekMvSixpQkFDQ3lKLEVBQ0FySCxFQUNBLEVBQ0FBLEVBQWF1SCxjQUFjQyxhQUFhSSxjQUcxQ3ZCLEVBQXFCbEYsR0FDckJBLEVBQVVpRyxPQUFPdkosYUFBYW1DLEdBQy9CLENBQUUsTUFDRHZDLGVBQWV1QyxFQUFhQyxXQUFXQyxpQkFBa0IsVUFDMUQsQ0FBRSxRQUNEdkMsZUFDRCxDQXBFQSxNQUZDOEgsT0FBT3FCLFNBQVNDLEtBQU8sS0FvWXpCYyxFQUNEIiwiaWdub3JlTGlzdCI6W10sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcblx0Z2V0RGF0YSxcclxuXHRjcmVhdGVCcm93c2VQYWdlLFxyXG5cdGNyZWF0ZU1haW5IZXJvU2VjdGlvbixcclxuXHRzaG93RXJyb3JQb3B1cCxcclxuXHRzaG93QmlnTG9hZGVyLFxyXG5cdGhpZGVCaWdMb2FkZXIsXHJcblx0Y3JlYXRlRmlsbVNsaWRlcixcclxuXHRjcmVhdGVGb290ZXIsXHJcblx0Y2xvc2VBbGxOb3RDbGlja2VkLFxyXG59IGZyb20gXCIuL2NvbXBvbmVudHMubWluLmpzXCI7XHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcclxuXHRjb25zdCBDQVJPVVNFTExfTEVOR1RIID0gNTtcclxuXHRjb25zdCBGSUxNX0FNT1VOVF9QRVJfUEFHRSA9IDIwO1xyXG5cdGNvbnN0IFBBR0VfVE9fU0hPV19PTl9TTUFMTF9DQVJPVVNFTFMgPSAxO1xyXG5cdGNvbnN0IG9wdGlvbnMgPSB7XHJcblx0XHRtZXRob2Q6IFwiR0VUXCIsXHJcblx0XHRoZWFkZXJzOiB7XHJcblx0XHRcdGFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcblx0XHRcdEF1dGhvcml6YXRpb246XHJcblx0XHRcdFx0XCJCZWFyZXIgZXlKaGJHY2lPaUpJVXpJMU5pSjkuZXlKaGRXUWlPaUl6TlRZd1pqTTRNalUzTkRRMVpHRTFaR1prWVRZeFl6RTBZV000WW1NNE15SXNJbTVpWmlJNk1UYzFPVGMyTlRBek9DNDVOQ3dpYzNWaUlqb2lOamhsTTJVeU1tVXlOalk1TnpZNE16aGxZekkzTnpJNUlpd2ljMk52Y0dWeklqcGJJbUZ3YVY5eVpXRmtJbDBzSW5abGNuTnBiMjRpT2pGOS5udUdmRWpjbEpMZXBtenpIaTJvbU5ocDI5VEhnckpmOU52NkQ0X2dUZHhBXCIsXHJcblx0XHR9LFxyXG5cdH07XHJcblx0Y29uc3QgcHJvZ3Jlc3NCYXJJbnRlcnZhbHMgPSBuZXcgTWFwKCk7XHJcblx0bGV0IGNhcm91c2VsbFNwZWVkID0gMTAwMDA7XHJcblx0bGV0IGNhcm91c2VsbFN0cm9rZVJhbmdlID0gMjtcclxuXHRsZXQgaW50ZXJ2YWxTcGVlZCA9IChjYXJvdXNlbGxTcGVlZCAqIGNhcm91c2VsbFN0cm9rZVJhbmdlKSAvIDEwMDtcclxuXHRsZXQgY2Fyb3VzZWxsV2lkdGggPSAxMDA7XHJcblx0bGV0IGluZGV4ID0gMDtcclxuXHRsZXQgY2Fyb3VzZWxsSW50ZXJ2YWw7XHJcblxyXG5cdGNvbnN0IFBPUFVMQVJfRklMTVNfVVJMID0gYGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvcG9wdWxhcj93aXRoX29yaWdpbl9jb3VudHJ5PVVTfEdCfENBJmxhbmd1YWdlPWA7XHJcblx0Y29uc3QgSE9UX1JBVEVEX0ZJTE1TX1VSTCA9IGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllL3VwY29taW5nP2xhbmd1YWdlPWA7XHJcblx0Y29uc3QgVFJFTkRJTkdfRklMTVNfVVJMID0gYGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvdHJlbmRpbmcvYWxsL3dlZWs/bGFuZ3VhZ2U9YDtcclxuXHRjb25zdCBUT1BfUkFURURfVFZfU0VSSUVTX1VSTCA9IGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL2Rpc2NvdmVyL3R2P3dpdGhfb3JpZ2luX2NvdW50cnk9VVN8R0ImbGFuZ3VhZ2U9JnNvcnRfYnk9cG9wdWxhcml0eS5kZXNjXHJcbmA7XHJcblx0Y29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xyXG5cdGNvbnN0IFVQQ09NSU5HX0ZJTE1TID0gYGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvZGlzY292ZXIvbW92aWU/cHJpbWFyeV9yZWxlYXNlX3llYXI9MjAyNSZwcmltYXJ5X3JlbGVhc2VfZGF0ZS5ndGU9JHtjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpfS0ke1xyXG5cdFx0Y3VycmVudERhdGUuZ2V0TW9udGgoKSArIDFcclxuXHR9LSR7Y3VycmVudERhdGUuZ2V0RGF0ZSgpfSZzb3J0X2J5PXBvcHVsYXJpdHkuZGVzY1xyXG5gO1xyXG5cclxuXHRjb25zdCBGSUxNU19QQUdFU19BTU9VTlQgPSBgJnBhZ2U9YDtcclxuXHJcblx0Y29uc3QgY2hlY2tBdXRob3JpemF0aW9uID0gYXN5bmMgKCkgPT4ge1xyXG5cdFx0Y29uc3QgdXNlckRhdGEgPSBnZXREYXRhKCk7XHJcblx0XHRjb25zdCB0cmFuc2xhdGlvbnMgPSB1c2VyRGF0YT8udHJhbnNsYXRpb25zO1xyXG5cdFx0Y29uc3QgY3VycmVudExhbmd1YWdlID0gdXNlckRhdGE/LnByZWZlcnJlZExhbmd1YWdlO1xyXG5cdFx0Y29uc3QgaXNMb2dnZWRJbiA9IHVzZXJEYXRhPy5sb2dnZWRJbjtcclxuXHRcdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGFpbmVyXCIpO1xyXG5cdFx0Y29uc3QgY3VycmVudFByb2ZpbGUgPSB1c2VyRGF0YT8uY3VycmVudFByb2ZpbGU7XHJcblxyXG5cdFx0Y29uc3QgdXNlclByb2ZpbGVzID0gdXNlckRhdGE/LnVzZXJQcm9maWxlcztcclxuXHJcblx0XHRpZiAoIXVzZXJQcm9maWxlcykge1xyXG5cdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgdXNlclByb2ZpbGVzQXJyID0gT2JqZWN0LmtleXModXNlclByb2ZpbGVzKTtcclxuXHJcblx0XHRpZiAoXHJcblx0XHRcdCF1c2VyRGF0YSB8fFxyXG5cdFx0XHQhaXNMb2dnZWRJbiB8fFxyXG5cdFx0XHQhY3VycmVudFByb2ZpbGUgfHxcclxuXHRcdFx0dXNlclByb2ZpbGVzQXJyLmxlbmd0aCA9PT0gMFxyXG5cdFx0KSB7XHJcblx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvXCI7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRjb250YWluZXIucHJlcGVuZChjcmVhdGVCcm93c2VQYWdlKHRyYW5zbGF0aW9ucykpO1xyXG5cdFx0Y29udGFpbmVyLmFwcGVuZChzaG93QmlnTG9hZGVyKCkpO1xyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IG1vdmllcyA9IGF3YWl0IGNob29zZUZpbG1zVG9DYXJvdXNlbGwoXHJcblx0XHRcdFx0bG9hZEZpbG1zVG9DYXJvdXNlbGwsXHJcblx0XHRcdFx0Y3VycmVudExhbmd1YWdlXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRjcmVhdGVNYWluSGVyb1NlY3Rpb24obW92aWVzLCB0cmFuc2xhdGlvbnMsIGNvbnRhaW5lcik7XHJcblx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHJcblx0XHRcdGNhcm91c2VsbEludGVydmFsID0gc2V0SW50ZXJ2YWwoXHJcblx0XHRcdFx0KCkgPT4gaGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpLFxyXG5cdFx0XHRcdGNhcm91c2VsbFNwZWVkXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRjaGFuZ2VDdXJyZW50SW1nKG1vdmllcywgY29udGFpbmVyKTtcclxuXHRcdFx0c2V0VG91Y2hFdmVudExpc3RlbmVyKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHJcblx0XHRcdGNvbnN0IGZpbG1zID0gYXdhaXQgZ2V0QWxsRmlsbXMoXHJcblx0XHRcdFx0Y3VycmVudExhbmd1YWdlLFxyXG5cdFx0XHRcdEhPVF9SQVRFRF9GSUxNU19VUkwsXHJcblx0XHRcdFx0VFJFTkRJTkdfRklMTVNfVVJMLFxyXG5cdFx0XHRcdFRPUF9SQVRFRF9UVl9TRVJJRVNfVVJMLFxyXG5cdFx0XHRcdFVQQ09NSU5HX0ZJTE1TXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0XHRjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XHJcblxyXG5cdFx0XHRpZiAoIW1haW4pIHtcclxuXHRcdFx0XHRzaG93RXJyb3JQb3B1cCh0cmFuc2xhdGlvbnMuYnJvd3NlUGFnZS5sb2FkaW5nRGF0YUVycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdG1haW4uYXBwZW5kKFxyXG5cdFx0XHRcdGNyZWF0ZUZpbG1TbGlkZXIoXHJcblx0XHRcdFx0XHRmaWxtcyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucyxcclxuXHRcdFx0XHRcdDEsXHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnMuYnJvd3NlU2VjdGlvbi5zZWN0aW9uTmFtZXMudHJlbmRpbmdcclxuXHRcdFx0XHQpLFxyXG5cdFx0XHRcdGNyZWF0ZUZpbG1TbGlkZXIoXHJcblx0XHRcdFx0XHRmaWxtcyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucyxcclxuXHRcdFx0XHRcdDAsXHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnMuYnJvd3NlU2VjdGlvbi5zZWN0aW9uTmFtZXMudXBjb21pbmdcclxuXHRcdFx0XHQpLFxyXG5cdFx0XHRcdGNyZWF0ZUZpbG1TbGlkZXIoXHJcblx0XHRcdFx0XHRmaWxtcyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucyxcclxuXHRcdFx0XHRcdDIsXHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnMuYnJvd3NlU2VjdGlvbi5zZWN0aW9uTmFtZXMudG9wUmF0ZWRTZXJpZXNcclxuXHRcdFx0XHQpLFxyXG5cdFx0XHRcdGNyZWF0ZUZpbG1TbGlkZXIoXHJcblx0XHRcdFx0XHRmaWxtcyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucyxcclxuXHRcdFx0XHRcdDMsXHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnMuYnJvd3NlU2VjdGlvbi5zZWN0aW9uTmFtZXMuZnV0dXJlRmlsbXNcclxuXHRcdFx0XHQpXHJcblx0XHRcdCk7XHJcblx0XHRcdHByZXBhcmVDYXJvdXNlbEl0ZW1zKGNvbnRhaW5lcik7XHJcblx0XHRcdGNvbnRhaW5lci5hcHBlbmQoY3JlYXRlRm9vdGVyKHRyYW5zbGF0aW9ucykpO1xyXG5cdFx0fSBjYXRjaCB7XHJcblx0XHRcdHNob3dFcnJvclBvcHVwKHRyYW5zbGF0aW9ucy5icm93c2VQYWdlLmxvYWRpbmdEYXRhRXJyb3IsIFwiI2RjNGEzNFwiKTtcclxuXHRcdH0gZmluYWxseSB7XHJcblx0XHRcdGhpZGVCaWdMb2FkZXIoKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRjb25zdCBnZXRBbGxGaWxtcyA9IGFzeW5jIChsYW5nLCAuLi51cmxzKSA9PiB7XHJcblx0XHRjb25zdCBmaWxtc0FyciA9IFtdO1xyXG5cdFx0Zm9yIGF3YWl0IChjb25zdCB1cmwgb2YgdXJscykge1xyXG5cdFx0XHRjb25zdCBVUkwgPVxyXG5cdFx0XHRcdHVybCArIGxhbmcgKyBGSUxNU19QQUdFU19BTU9VTlQgKyBQQUdFX1RPX1NIT1dfT05fU01BTExfQ0FST1VTRUxTO1xyXG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFVSTCwgb3B0aW9ucyk7XHJcblx0XHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcblxyXG5cdFx0XHRmaWxtc0Fyci5wdXNoKGRhdGEpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBmaWxtc0FycjtcclxuXHR9O1xyXG5cdGNvbnN0IGdldEZpbG1zID0gYXN5bmMgKGxhbmcsIHBhZ2VOdW0sIHVybCkgPT4ge1xyXG5cdFx0Y29uc3QgVVJMID0gdXJsICsgbGFuZyArIEZJTE1TX1BBR0VTX0FNT1VOVCArIHBhZ2VOdW07XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChVUkwsIG9wdGlvbnMpO1xyXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG5cclxuXHRcdFx0cmV0dXJuIGRhdGE7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdGNvbnN0IGxvYWRGaWxtc1RvQ2Fyb3VzZWxsID0gYXN5bmMgKGxhbmcsIHBhZ2VOdW0pID0+IHtcclxuXHRcdGNvbnN0IHJlcXVlc3RzID0gW107XHJcblxyXG5cdFx0Zm9yIChsZXQgaSA9IDE7IGkgPD0gcGFnZU51bTsgaSsrKSB7XHJcblx0XHRcdHJlcXVlc3RzLnB1c2goZ2V0RmlsbXMobGFuZywgaSwgUE9QVUxBUl9GSUxNU19VUkwpKTtcclxuXHRcdH1cclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCByZXNwb25zZXMgPSBhd2FpdCBQcm9taXNlLmFsbChyZXF1ZXN0cyk7XHJcblx0XHRcdHJldHVybiByZXNwb25zZXM7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdGNvbnN0IGNob29zZUZpbG1zVG9DYXJvdXNlbGwgPSBhc3luYyAoZGF0YSwgY3VycmVudExhbmd1YWdlKSA9PiB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBwYWdlc0RhdGEgPSBhd2FpdCBkYXRhKGN1cnJlbnRMYW5ndWFnZSwgQ0FST1VTRUxMX0xFTkdUSCk7XHJcblx0XHRcdGNvbnN0IHJhbmRvbU51bWJlciA9IE1hdGgudHJ1bmMoTWF0aC5yYW5kb20oKSAqIEZJTE1fQU1PVU5UX1BFUl9QQUdFKTtcclxuXHRcdFx0Y29uc3QgY2hvb3Nlbk1vdmllcyA9IHBhZ2VzRGF0YS5tYXAoKHBhZ2UpID0+IHBhZ2UucmVzdWx0c1tyYW5kb21OdW1iZXJdKTtcclxuXHJcblx0XHRcdHJldHVybiBjaG9vc2VuTW92aWVzO1xyXG5cdFx0fSBjYXRjaCB7XHJcblx0XHRcdHNob3dFcnJvclBvcHVwKHRyYW5zbGF0aW9ucy5icm93c2VQYWdlLmxvYWRpbmdEYXRhRXJyb3IsIFwiI2RjNGEzNFwiKTtcclxuXHRcdH0gZmluYWxseSB7XHJcblx0XHRcdGhpZGVCaWdMb2FkZXIoKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQvLyBDQVJPVVNFTExcclxuXHJcblx0Y29uc3QgaGFuZGxlRmlsbXNDYXJvdXNlbGwgPSAoY29udGFpbmVyLCBtb3ZpZXMpID0+IHtcclxuXHRcdGNvbnN0IGltYWdlU2xpZGVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX2ltYWdlc1wiKTtcclxuXHRcdGNvbnN0IGFsbEltYWdlcyA9IGltYWdlU2xpZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLW1haW5fX2ltZy1ib3hcIik7XHJcblx0XHRjb25zdCBjYXJvdXNlbGxDb250cm9scyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRcIi5icm93c2UtbWFpbl9fY2Fyb3VzZWxsLWNvbnRyb2xzXCJcclxuXHRcdCk7XHJcblx0XHRhbGxJbWFnZXMuZm9yRWFjaCgoaW1nKSA9PiBpbWcuY2xhc3NMaXN0LnJlbW92ZShcImN1cnJlbnRWaXNpYmxlXCIpKTtcclxuXHJcblx0XHRpbWFnZVNsaWRlci5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgkey1pbmRleCAqIGNhcm91c2VsbFdpZHRofSUpYDtcclxuXHRcdGhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUoaW5kZXgsIGNhcm91c2VsbENvbnRyb2xzKTtcclxuXHRcdGFsbEltYWdlc1tpbmRleF0uY2xhc3NMaXN0LmFkZChcImN1cnJlbnRWaXNpYmxlXCIpO1xyXG5cclxuXHRcdGluZGV4Kys7XHJcblxyXG5cdFx0aWYgKGluZGV4ID4gbW92aWVzLmxlbmd0aCAtIDEpIGluZGV4ID0gMDtcclxuXHJcblx0XHRoYW5kbGVCdG5zVmlzaWJpbGl0eShjb250YWluZXIpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUgPSAoaW5kZXgsIGNhcm91c2VsbENvbnRyb2xzQm94KSA9PiB7XHJcblx0XHRjb25zdCBhbGxDb250cm9sQnRucyA9XHJcblx0XHRcdGNhcm91c2VsbENvbnRyb2xzQm94LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLW1haW5fX2J0blwiKTtcclxuXHRcdGNvbnN0IGN1cnJlbnRCdG4gPSBjYXJvdXNlbGxDb250cm9sc0JveC5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRgLmJyb3dzZS1tYWluX19idG5bZGF0YS1pbWc9XCIke2luZGV4fVwiXWBcclxuXHRcdCk7XHJcblx0XHRjb25zdCBwcm9ncmVzc0JhciA9IGN1cnJlbnRCdG4ucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9fcHJvZ3Jlc3MtYmFyXCIpO1xyXG5cdFx0Y29uc3QgYWxsUHJvZ3Jlc3NCYXJzID0gY2Fyb3VzZWxsQ29udHJvbHNCb3gucXVlcnlTZWxlY3RvckFsbChcclxuXHRcdFx0XCIuYnJvd3NlLW1haW5fX3Byb2dyZXNzLWJhclwiXHJcblx0XHQpO1xyXG5cclxuXHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLmZvckVhY2goKGludGVydmFsKSA9PiBjbGVhckludGVydmFsKGludGVydmFsKSk7XHJcblx0XHRwcm9ncmVzc0JhckludGVydmFscy5jbGVhcigpO1xyXG5cclxuXHRcdGFsbFByb2dyZXNzQmFycy5mb3JFYWNoKChiYXIpID0+IChiYXIuc3R5bGUud2lkdGggPSBcIjBcIikpO1xyXG5cclxuXHRcdGNoYW5nZVByb2dyZXNzQmFyKHByb2dyZXNzQmFyLCBpbmRleCk7XHJcblxyXG5cdFx0YWxsQ29udHJvbEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKSk7XHJcblx0XHRjdXJyZW50QnRuLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgY2hhbmdlUHJvZ3Jlc3NCYXIgPSAocHJvZ3Jlc3NCYXIsIGJ0bkluZGV4KSA9PiB7XHJcblx0XHRpZiAocHJvZ3Jlc3NCYXJJbnRlcnZhbHMuaGFzKGJ0bkluZGV4KSkge1xyXG5cdFx0XHRjbGVhckludGVydmFsKHByb2dyZXNzQmFySW50ZXJ2YWxzLmdldChidG5JbmRleCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCB3aWR0aCA9IDA7XHJcblx0XHRjb25zdCBwcm9ncmVzc0JhckludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHR3aWR0aCArPSBjYXJvdXNlbGxTdHJva2VSYW5nZTtcclxuXHRcdFx0cHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHt3aWR0aH0lYDtcclxuXHRcdFx0aWYgKHdpZHRoID49IDEwMCkge1xyXG5cdFx0XHRcdHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gXCIwXCI7XHJcblx0XHRcdFx0Y2xlYXJJbnRlcnZhbChwcm9ncmVzc0JhckludGVydmFsKTtcclxuXHJcblx0XHRcdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuZGVsZXRlKGJ0bkluZGV4KTtcclxuXHRcdFx0fVxyXG5cdFx0fSwgaW50ZXJ2YWxTcGVlZCk7XHJcblxyXG5cdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuc2V0KGJ0bkluZGV4LCBwcm9ncmVzc0JhckludGVydmFsKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBjaGFuZ2VDdXJyZW50SW1nID0gKG1vdmllcywgY29udGFpbmVyKSA9PiB7XHJcblx0XHRjb25zdCBjYXJvdXNlbGxDb250cm9scyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRcIi5icm93c2UtbWFpbl9fY2Fyb3VzZWxsLWNvbnRyb2xzXCJcclxuXHRcdCk7XHJcblxyXG5cdFx0Y2Fyb3VzZWxsQ29udHJvbHMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRcdGlmIChlLnRhcmdldC5tYXRjaGVzKFwiLmJyb3dzZS1tYWluX19idG5cIikpIHtcclxuXHRcdFx0XHRpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlXCIpKSByZXR1cm47XHJcblxyXG5cdFx0XHRcdGNsZWFySW50ZXJ2YWwoY2Fyb3VzZWxsSW50ZXJ2YWwpO1xyXG5cclxuXHRcdFx0XHRjb25zdCBjdXJyZW50QnRuID0gZS50YXJnZXQ7XHJcblx0XHRcdFx0Y29uc3QgaW1nRGF0YSA9IHBhcnNlSW50KGN1cnJlbnRCdG4uZGF0YXNldC5pbWcpO1xyXG5cclxuXHRcdFx0XHRpbmRleCA9IGltZ0RhdGE7XHJcblx0XHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cclxuXHRcdFx0XHRjYXJvdXNlbGxJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuXHRcdFx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdFx0XHR9LCBjYXJvdXNlbGxTcGVlZCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZUJ0bnNWaXNpYmlsaXR5ID0gKGNvbnRhaW5lcikgPT4ge1xyXG5cdFx0Y29uc3QgYWxsRmlsbXMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2UtbWFpbl9faW1nLWJveFwiKTtcclxuXHJcblx0XHRhbGxGaWxtcy5mb3JFYWNoKChmaWxtKSA9PiB7XHJcblx0XHRcdGNvbnN0IGlzQWN0aXZlID0gZmlsbS5jbGFzc0xpc3QuY29udGFpbnMoXCJjdXJyZW50VmlzaWJsZVwiKTtcclxuXHRcdFx0Y29uc3QgdGFiaW5kZXggPSBpc0FjdGl2ZSA/IDAgOiAtMTtcclxuXHRcdFx0Y29uc3QgdmlzaWJpbGl0eSA9IHRhYmluZGV4ID09PSAwID8gXCJ2aXNpYmxlXCIgOiBcImhpZGRlblwiO1xyXG5cdFx0XHRnaXZlQnRuc0F0dHJpYnV0ZShmaWxtLCB0YWJpbmRleCwgdmlzaWJpbGl0eSk7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cdGNvbnN0IGdpdmVCdG5zQXR0cmlidXRlID0gKGZpbG0sIHRhYmluZGV4LCB2aXNpYmlsaXR5KSA9PiB7XHJcblx0XHRjb25zdCB0cmFpbGVyQnRuID0gZmlsbS5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1tYWluX190cmFpbGVyLWJ0blwiKTtcclxuXHRcdGNvbnN0IHNlZU1vcmVCdG4gPSBmaWxtLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX3NlZS1tb3JlLWJ0blwiKTtcclxuXHJcblx0XHR0cmFpbGVyQnRuLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIHRhYmluZGV4KTtcclxuXHRcdHNlZU1vcmVCdG4uc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgdGFiaW5kZXgpO1xyXG5cdFx0dHJhaWxlckJ0bi5zdHlsZS52aXNpYmlsaXR5ID0gdmlzaWJpbGl0eTtcclxuXHRcdHNlZU1vcmVCdG4uc3R5bGUudmlzaWJpbGl0eSA9IHZpc2liaWxpdHk7XHJcblx0fTtcclxuXHJcblx0bGV0IHN0YXJ0WDtcclxuXHRsZXQgZW5kWDtcclxuXHRsZXQgc3RhcnRZO1xyXG5cdGxldCBlbmRZO1xyXG5cclxuXHRjb25zdCBoYW5kbGVUb3VjaFN0YXJ0RXZlbnQgPSAoZSkgPT4ge1xyXG5cdFx0c3RhcnRYID0gZS50b3VjaGVzWzBdLmNsaWVudFg7XHJcblx0XHRzdGFydFkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVUb3VjaEVuZEV2ZW50ID0gKGUsIGNvbnRhaW5lciwgbW92aWVzKSA9PiB7XHJcblx0XHRlbmRYID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRYO1xyXG5cdFx0ZW5kWSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WTtcclxuXHRcdGhhbmRsZVN3aXBlKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVTd2lwZSA9IChjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0Y29uc3QgSE9SSVpPTlRBTF9SQU5HRSA9IDMwO1xyXG5cdFx0Y29uc3QgVkVSVElDQUxfUkFOR0UgPSAzMDtcclxuXHJcblx0XHRjb25zdCBob3Jpem9udGFsRGlzdGFuY2UgPSBNYXRoLmFicyhzdGFydFggLSBlbmRYKTtcclxuXHRcdGNvbnN0IHZlcnRpY2FsRGlzdGFuY2UgPSBNYXRoLmFicyhzdGFydFkgLSBlbmRZKTtcclxuXHJcblx0XHRpZiAoXHJcblx0XHRcdGhvcml6b250YWxEaXN0YW5jZSA8IEhPUklaT05UQUxfUkFOR0UgfHxcclxuXHRcdFx0dmVydGljYWxEaXN0YW5jZSA+IFZFUlRJQ0FMX1JBTkdFXHJcblx0XHQpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGVuZFggLSBzdGFydFggPiBIT1JJWk9OVEFMX1JBTkdFKSB7XHJcblx0XHRcdGluZGV4ID0gKGluZGV4IC0gMiArIG1vdmllcy5sZW5ndGgpICUgbW92aWVzLmxlbmd0aDtcclxuXHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0fSBlbHNlIGlmIChzdGFydFggLSBlbmRYID4gSE9SSVpPTlRBTF9SQU5HRSkge1xyXG5cdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y2xlYXJJbnRlcnZhbChjYXJvdXNlbGxJbnRlcnZhbCk7XHJcblx0XHRjYXJvdXNlbGxJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuXHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0fSwgY2Fyb3VzZWxsU3BlZWQpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IHNldFRvdWNoRXZlbnRMaXN0ZW5lciA9IChjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0Y29uc3QgaW1hZ2VTbGlkZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9faW1hZ2VzXCIpO1xyXG5cclxuXHRcdGltYWdlU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIChlKSA9PiB7XHJcblx0XHRcdGhhbmRsZVRvdWNoU3RhcnRFdmVudChlKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGltYWdlU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCAoZSkgPT4ge1xyXG5cdFx0XHRoYW5kbGVUb3VjaEVuZEV2ZW50KGUsIGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGNoYW5nZUNhcm91c2VsbERhdGFJbmRleCA9IChzbGlkZXIsIGluZGV4KSA9PiB7XHJcblx0XHRzbGlkZXIuZGF0YXNldC5pbmRleCA9IGluZGV4O1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGdldENhcm91c2VsQ29uZmlnID0gKCkgPT4ge1xyXG5cdFx0bGV0IG1heEluZGV4O1xyXG5cclxuXHRcdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IDU3NikgbWF4SW5kZXggPSA5O1xyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoID49IDU3NiAmJiB3aW5kb3cuaW5uZXJXaWR0aCA8IDk5MikgbWF4SW5kZXggPSAxNztcclxuXHRcdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSA5OTIgJiYgd2luZG93LmlubmVyV2lkdGggPCAxMjAwKSBtYXhJbmRleCA9IDQ7XHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPj0gMTIwMCkgbWF4SW5kZXggPSA3O1xyXG5cclxuXHRcdHJldHVybiBtYXhJbmRleDtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBzZXRUaHJlc2hvbGQgPSAoKSA9PiB7XHJcblx0XHRsZXQgdGhyZXNob2xkID0gMjtcclxuXHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPiA1NzYgJiYgd2luZG93LmlubmVyV2lkdGggPCA5OTIpIHRocmVzaG9sZCA9IDE7XHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPj0gOTkyICYmIHdpbmRvdy5pbm5lcldpZHRoIDwgMTIwMCkgdGhyZXNob2xkID0gNDtcclxuXHJcblx0XHRyZXR1cm4gdGhyZXNob2xkO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IG1vdmVTbGlkZXIgPSAoc2xpZGVyKSA9PiB7XHJcblx0XHRjb25zdCB0aHJlc2hvbGQgPSBzZXRUaHJlc2hvbGQoKTtcclxuXHRcdGxldCBzbGlkZXJEYXRhc2V0ID0gc2xpZGVyLmRhdGFzZXQuaW5kZXg7XHJcblx0XHRjb25zdCBzbGlkZXJDYXJvdXNlbGwgPSBzbGlkZXIucXVlcnlTZWxlY3RvcihcclxuXHRcdFx0XCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlci1pbWFnZXNcIlxyXG5cdFx0KTtcclxuXHJcblx0XHRjb25zdCBwb3N0ZXIgPSBzbGlkZXIucXVlcnlTZWxlY3RvcihcIi5icm93c2Utc2VjdGlvbl9fc2xpZGVyLWJveFwiKTtcclxuXHRcdGlmICghcG9zdGVyKSByZXR1cm47XHJcblxyXG5cdFx0Y29uc3QgcG9zdGVyV2lkdGggPSBwb3N0ZXIub2Zmc2V0V2lkdGg7XHJcblx0XHRzbGlkZXJDYXJvdXNlbGwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHtcclxuXHRcdFx0LXNsaWRlckRhdGFzZXQgKiBwb3N0ZXJXaWR0aCAqIHRocmVzaG9sZFxyXG5cdFx0fXB4KWA7XHJcblx0fTtcclxuXHJcblx0Y29uc3Qgc2hvd05leHRTbGlkZSA9IChzbGlkZXIsIGluZGV4KSA9PiB7XHJcblx0XHRsZXQgaW5pdGlhbEluZGV4ID0gaW5kZXggPT09IDAgPyBwYXJzZUludChzbGlkZXIuZGF0YXNldC5pbmRleCkgOiAwO1xyXG5cdFx0Y29uc3QgbWF4SW5kZXggPSBnZXRDYXJvdXNlbENvbmZpZygpO1xyXG5cclxuXHRcdGlmIChpbml0aWFsSW5kZXggPj0gbWF4SW5kZXgpIHJldHVybjtcclxuXHJcblx0XHRpbml0aWFsSW5kZXgrKztcclxuXHRcdGNoYW5nZUNhcm91c2VsbERhdGFJbmRleChzbGlkZXIsIGluaXRpYWxJbmRleCk7XHJcblx0XHRtb3ZlU2xpZGVyKHNsaWRlcik7XHJcblx0fTtcclxuXHJcblx0Y29uc3Qgc2hvd1ByZXZTbGlkZSA9IChzbGlkZXIsIGluZGV4KSA9PiB7XHJcblx0XHRsZXQgaW5pdGlhbEluZGV4ID0gaW5kZXggPT09IDAgPyBwYXJzZUludChzbGlkZXIuZGF0YXNldC5pbmRleCkgOiAwO1xyXG5cclxuXHRcdGlmIChpbml0aWFsSW5kZXggPD0gMCkgcmV0dXJuO1xyXG5cclxuXHRcdGluaXRpYWxJbmRleC0tO1xyXG5cdFx0Y2hhbmdlQ2Fyb3VzZWxsRGF0YUluZGV4KHNsaWRlciwgaW5pdGlhbEluZGV4KTtcclxuXHRcdG1vdmVTbGlkZXIoc2xpZGVyKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBwcmVwYXJlQ2Fyb3VzZWxJdGVtcyA9IChjb250YWluZXIpID0+IHtcclxuXHRcdGNvbnN0IHNsaWRlcnMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2Utc2VjdGlvbl9fc2xpZGVyXCIpO1xyXG5cclxuXHRcdHNsaWRlcnMuZm9yRWFjaCgoc2xpZGVyKSA9PlxyXG5cdFx0XHRzbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRcdFx0bGV0IHNtYWxsQ2Fyb3VzZWxsSW5kZXggPSAwO1xyXG5cclxuXHRcdFx0XHRpZiAoZS50YXJnZXQubWF0Y2hlcyhcIi5icm93c2Utc2VjdGlvbl9fc2xpZGVyLW5leHQtYnRuXCIpKSB7XHJcblx0XHRcdFx0XHRzaG93TmV4dFNsaWRlKHNsaWRlciwgc21hbGxDYXJvdXNlbGxJbmRleCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmIChlLnRhcmdldC5tYXRjaGVzKFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXItcHJldi1idG5cIikpIHtcclxuXHRcdFx0XHRcdHNob3dQcmV2U2xpZGUoc2xpZGVyLCBzbWFsbENhcm91c2VsbEluZGV4KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pXHJcblx0XHQpO1xyXG5cdH07XHJcblxyXG5cdGxldCBsYXN0V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCAoKSA9PiB7XHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPT09IGxhc3RXaWR0aCkgcmV0dXJuO1xyXG5cdFx0bGFzdFdpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XHJcblxyXG5cdFx0Y29uc3QgYWxsU2xpZGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlclwiKTtcclxuXHRcdGFsbFNsaWRlcnMuZm9yRWFjaCgoc2xpZGVyKSA9PiB7XHJcblx0XHRcdGNvbnN0IHNsaWRlckNhcm91c2VsbCA9IHNsaWRlci5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRcdFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXItaW1hZ2VzXCJcclxuXHRcdFx0KTtcclxuXHRcdFx0Y2hhbmdlQ2Fyb3VzZWxsRGF0YUluZGV4KHNsaWRlciwgMCk7XHJcblx0XHRcdHNsaWRlckNhcm91c2VsbC5zdHlsZS50cmFuc2Zvcm0gPSBcInRyYW5zbGF0ZVgoMClcIjtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidW5sb2FkXCIsICgpID0+IHtcclxuXHRcdGNsZWFySW50ZXJ2YWwoY2Fyb3VzZWxsSW50ZXJ2YWwpO1xyXG5cdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuZm9yRWFjaCgoaW50ZXJ2YWwpID0+IGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpKTtcclxuXHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLmNsZWFyKCk7XHJcblx0fSk7XHJcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0Y2xvc2VBbGxOb3RDbGlja2VkKGUpO1xyXG5cdH0pO1xyXG5cdGNoZWNrQXV0aG9yaXphdGlvbigpO1xyXG59KTtcclxuIl19
