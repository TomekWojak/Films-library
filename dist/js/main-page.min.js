import{getData,createBrowsePage,createMainHeroSection,showErrorPopup,showBigLoader,hideBigLoader,createFilmSlider,createFooter,closeAllNotClicked,createFourCategories}from"./components.min.js";document.addEventListener("DOMContentLoaded",function(){const e={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNTYwZjM4MjU3NDQ1ZGE1ZGZkYTYxYzE0YWM4YmM4MyIsIm5iZiI6MTc1OTc2NTAzOC45NCwic3ViIjoiNjhlM2UyMmUyNjY5NzY4MzhlYzI3NzI5Iiwic2NvcGVzIjpbImFwaV9yZWFkIl0sInZlcnNpb24iOjF9.nuGfEjclJLepmzzHi2omNhp29THgrJf9Nv6D4_gTdxA"}},t=new Map;let r,a=1e4,o=0;const n=new Date,i=`https://api.themoviedb.org/3/discover/movie?primary_release_year=2025&primary_release_date.gte=${n.getFullYear()}-${n.getMonth()+1}-${n.getDate()}&sort_by=popularity.desc\n`,s="&page=",c=async(t,...r)=>{const a=[];for await(const o of r){const r=o+t+s+1,n=await fetch(r,e),i=await n.json();a.push(i)}return a},l=async(t,r,a)=>{const o=a+t+s+r;try{const t=await fetch(o,e);return await t.json()}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},d=async(e,t)=>{const r=[];for(let a=1;a<=t;a++)r.push(l(e,a,"https://api.themoviedb.org/3/movie/popular?with_origin_country=US|GB|CA&language="));try{return await Promise.all(r)}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}},w=async(e,t)=>{try{const r=await e(t,5),a=Math.trunc(20*Math.random()),o=r.map(e=>e.results[a]);return console.log(o),o}catch{showErrorPopup(translations.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}},h=(e,t)=>{const r=e.querySelector(".browse-main__images"),a=r.querySelectorAll(".browse-main__img-box"),n=e.querySelector(".browse-main__carousell-controls");a.forEach(e=>e.classList.remove("currentVisible")),r.style.transform=`translateX(${100*-o}%)`,u(o,n),a[o].classList.add("currentVisible"),o++,o>t.length-1&&(o=0),b(e)},u=(e,r)=>{const a=r.querySelectorAll(".browse-main__btn"),o=r.querySelector(`.browse-main__btn[data-img="${e}"]`),n=o.querySelector(".browse-main__progress-bar"),i=r.querySelectorAll(".browse-main__progress-bar");t.forEach(e=>clearInterval(e)),t.clear(),i.forEach(e=>e.style.width="0"),g(n,e),a.forEach(e=>e.classList.remove("active")),o.classList.add("active")},g=(e,r)=>{t.has(r)&&clearInterval(t.get(r));let a=0;const o=setInterval(()=>{a+=2,e.style.width=`${a}%`,a>=100&&(e.style.width="0",clearInterval(o),t.delete(r))},200);t.set(r,o)},m=(e,t)=>{t.querySelector(".browse-main__carousell-controls").addEventListener("click",n=>{if(n.target.matches(".browse-main__btn")){if(n.target.classList.contains("active"))return;clearInterval(r);const i=n.target,s=parseInt(i.dataset.img);o=s,h(t,e),r=setInterval(()=>{h(t,e)},a)}})},b=e=>{e.querySelectorAll(".browse-main__img-box").forEach(e=>{const t=e.classList.contains("currentVisible")?0:-1;p(e,t,0===t?"visible":"hidden")})},p=(e,t,r)=>{const a=e.querySelector(".browse-main__trailer-btn"),o=e.querySelector(".browse-main__see-more-btn");a.setAttribute("tabindex",t),o.setAttribute("tabindex",t),a.style.visibility=r,o.style.visibility=r};let y,_,v,f;const S=(e,t)=>{const n=Math.abs(y-_),i=Math.abs(v-f);n<30||i>30||(_-y>30?(o=(o-2+t.length)%t.length,h(e,t)):y-_>30&&h(e,t),clearInterval(r),r=setInterval(()=>{h(e,t)},a))},E=(e,t)=>{const r=e.querySelector(".browse-main__images");r.addEventListener("touchstart",e=>{(e=>{y=e.touches[0].clientX,v=e.touches[0].clientY})(e)}),r.addEventListener("touchend",r=>{((e,t,r)=>{_=e.changedTouches[0].clientX,f=e.changedTouches[0].clientY,S(t,r)})(r,e,t)})},I=(e,t)=>{e.dataset.index=t},L=e=>{const t=(()=>{let e=2;return window.innerWidth>576&&window.innerWidth<992&&(e=1),window.innerWidth>=992&&window.innerWidth<1200&&(e=4),e})();let r=e.dataset.index;const a=e.querySelector(".browse-section__slider-images"),o=e.querySelector(".browse-section__slider-box");if(!o)return;const n=o.offsetWidth;a.style.transform=`translateX(${-r*n*t}px)`},q=(e,t)=>{let r=0===t?parseInt(e.dataset.index):0;r>=(()=>{let e;return window.innerWidth<576&&(e=9),window.innerWidth>=576&&window.innerWidth<992&&(e=17),window.innerWidth>=992&&window.innerWidth<1200&&(e=4),window.innerWidth>=1200&&(e=7),e})()||(r++,I(e,r),L(e))},N=e=>{e.querySelectorAll(".browse-section__slider").forEach(e=>e.addEventListener("click",t=>{t.target.matches(".browse-section__slider-next-btn")?q(e,0):t.target.matches(".browse-section__slider-prev-btn")&&((e,t)=>{let r=0===t?parseInt(e.dataset.index):0;r<=0||(r--,I(e,r),L(e))})(e,0)}))};let M=window.innerWidth;window.addEventListener("resize",()=>{if(window.innerWidth===M)return;M=window.innerWidth;document.querySelectorAll(".browse-section__slider").forEach(e=>{const t=e.querySelector(".browse-section__slider-images");I(e,0),t.style.transform="translateX(0)"})}),window.addEventListener("unload",()=>{clearInterval(r),t.forEach(e=>clearInterval(e)),t.clear()}),window.addEventListener("click",e=>{closeAllNotClicked(e)}),(async()=>{const e=getData(),t=e?.translations,o=e?.preferredLanguage,n=e?.loggedIn,s=document.querySelector(".container"),l=e?.currentProfile;if(e&&n&&l){s.prepend(createBrowsePage(t)),s.append(showBigLoader());try{const e=await w(d,o);createMainHeroSection(e,t,s),h(s,e),r=setInterval(()=>h(s,e),a),m(e,s),E(s,e);const n=await c(o,"https://api.themoviedb.org/3/movie/upcoming?language=","https://api.themoviedb.org/3/trending/all/week?language=","https://api.themoviedb.org/3/discover/tv?with_origin_country=US|GB&language=&sort_by=popularity.desc\n",i),l=document.querySelector("main");l||showErrorPopup(t.browsePage.loadingDataError,"#dc4a34"),l.append(createFourCategories(t),createFilmSlider(n,t,1,t.browseSection.sectionNames.trending),createFilmSlider(n,t,0,t.browseSection.sectionNames.upcoming),createFilmSlider(n,t,2,t.browseSection.sectionNames.topRatedSeries),createFilmSlider(n,t,3,t.browseSection.sectionNames.futureFilms)),N(s),s.append(createFooter(t))}catch{showErrorPopup(t.browsePage.loadingDataError,"#dc4a34")}finally{hideBigLoader()}}else window.location.href="/"})()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi1wYWdlLm1pbi5qcyIsIm5hbWVzIjpbImdldERhdGEiLCJjcmVhdGVCcm93c2VQYWdlIiwiY3JlYXRlTWFpbkhlcm9TZWN0aW9uIiwic2hvd0Vycm9yUG9wdXAiLCJzaG93QmlnTG9hZGVyIiwiaGlkZUJpZ0xvYWRlciIsImNyZWF0ZUZpbG1TbGlkZXIiLCJjcmVhdGVGb290ZXIiLCJjbG9zZUFsbE5vdENsaWNrZWQiLCJjcmVhdGVGb3VyQ2F0ZWdvcmllcyIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9wdGlvbnMiLCJtZXRob2QiLCJoZWFkZXJzIiwiYWNjZXB0IiwiQXV0aG9yaXphdGlvbiIsInByb2dyZXNzQmFySW50ZXJ2YWxzIiwiTWFwIiwiY2Fyb3VzZWxsSW50ZXJ2YWwiLCJjYXJvdXNlbGxTcGVlZCIsImluZGV4IiwiY3VycmVudERhdGUiLCJEYXRlIiwiVVBDT01JTkdfRklMTVMiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsIkZJTE1TX1BBR0VTX0FNT1VOVCIsImdldEFsbEZpbG1zIiwiYXN5bmMiLCJsYW5nIiwidXJscyIsImZpbG1zQXJyIiwidXJsIiwiVVJMIiwicmVzcG9uc2UiLCJmZXRjaCIsImRhdGEiLCJqc29uIiwicHVzaCIsImdldEZpbG1zIiwicGFnZU51bSIsInRyYW5zbGF0aW9ucyIsImJyb3dzZVBhZ2UiLCJsb2FkaW5nRGF0YUVycm9yIiwibG9hZEZpbG1zVG9DYXJvdXNlbGwiLCJyZXF1ZXN0cyIsImkiLCJQcm9taXNlIiwiYWxsIiwiY2hvb3NlRmlsbXNUb0Nhcm91c2VsbCIsImN1cnJlbnRMYW5ndWFnZSIsInBhZ2VzRGF0YSIsInJhbmRvbU51bWJlciIsIk1hdGgiLCJ0cnVuYyIsInJhbmRvbSIsImNob29zZW5Nb3ZpZXMiLCJtYXAiLCJwYWdlIiwicmVzdWx0cyIsImNvbnNvbGUiLCJsb2ciLCJoYW5kbGVGaWxtc0Nhcm91c2VsbCIsImNvbnRhaW5lciIsIm1vdmllcyIsImltYWdlU2xpZGVyIiwicXVlcnlTZWxlY3RvciIsImFsbEltYWdlcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjYXJvdXNlbGxDb250cm9scyIsImZvckVhY2giLCJpbWciLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJzdHlsZSIsInRyYW5zZm9ybSIsImhhbmRsZUNhcm91c2VsbENvbnRyb2xzU3RhdGUiLCJhZGQiLCJsZW5ndGgiLCJoYW5kbGVCdG5zVmlzaWJpbGl0eSIsImNhcm91c2VsbENvbnRyb2xzQm94IiwiYWxsQ29udHJvbEJ0bnMiLCJjdXJyZW50QnRuIiwicHJvZ3Jlc3NCYXIiLCJhbGxQcm9ncmVzc0JhcnMiLCJpbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJjbGVhciIsImJhciIsIndpZHRoIiwiY2hhbmdlUHJvZ3Jlc3NCYXIiLCJidG4iLCJidG5JbmRleCIsImhhcyIsImdldCIsInByb2dyZXNzQmFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImRlbGV0ZSIsInNldCIsImNoYW5nZUN1cnJlbnRJbWciLCJlIiwidGFyZ2V0IiwibWF0Y2hlcyIsImNvbnRhaW5zIiwiaW1nRGF0YSIsInBhcnNlSW50IiwiZGF0YXNldCIsImZpbG0iLCJ0YWJpbmRleCIsImdpdmVCdG5zQXR0cmlidXRlIiwidmlzaWJpbGl0eSIsInRyYWlsZXJCdG4iLCJzZWVNb3JlQnRuIiwic2V0QXR0cmlidXRlIiwic3RhcnRYIiwiZW5kWCIsInN0YXJ0WSIsImVuZFkiLCJoYW5kbGVTd2lwZSIsImhvcml6b250YWxEaXN0YW5jZSIsImFicyIsInZlcnRpY2FsRGlzdGFuY2UiLCJzZXRUb3VjaEV2ZW50TGlzdGVuZXIiLCJ0b3VjaGVzIiwiY2xpZW50WCIsImNsaWVudFkiLCJoYW5kbGVUb3VjaFN0YXJ0RXZlbnQiLCJjaGFuZ2VkVG91Y2hlcyIsImhhbmRsZVRvdWNoRW5kRXZlbnQiLCJjaGFuZ2VDYXJvdXNlbGxEYXRhSW5kZXgiLCJzbGlkZXIiLCJtb3ZlU2xpZGVyIiwidGhyZXNob2xkIiwid2luZG93IiwiaW5uZXJXaWR0aCIsInNldFRocmVzaG9sZCIsInNsaWRlckRhdGFzZXQiLCJzbGlkZXJDYXJvdXNlbGwiLCJwb3N0ZXIiLCJwb3N0ZXJXaWR0aCIsIm9mZnNldFdpZHRoIiwic2hvd05leHRTbGlkZSIsImluaXRpYWxJbmRleCIsIm1heEluZGV4IiwiZ2V0Q2Fyb3VzZWxDb25maWciLCJwcmVwYXJlQ2Fyb3VzZWxJdGVtcyIsInNob3dQcmV2U2xpZGUiLCJsYXN0V2lkdGgiLCJ1c2VyRGF0YSIsInByZWZlcnJlZExhbmd1YWdlIiwiaXNMb2dnZWRJbiIsImxvZ2dlZEluIiwiY3VycmVudFByb2ZpbGUiLCJwcmVwZW5kIiwiYXBwZW5kIiwiZmlsbXMiLCJtYWluIiwiYnJvd3NlU2VjdGlvbiIsInNlY3Rpb25OYW1lcyIsInRyZW5kaW5nIiwidXBjb21pbmciLCJ0b3BSYXRlZFNlcmllcyIsImZ1dHVyZUZpbG1zIiwibG9jYXRpb24iLCJocmVmIiwiY2hlY2tBdXRob3JpemF0aW9uIl0sInNvdXJjZXMiOlsibWFpbi1wYWdlLmpzIl0sIm1hcHBpbmdzIjoiT0FDQ0EsUUFDQUMsaUJBQ0FDLHNCQUNBQyxlQUNBQyxjQUNBQyxjQUNBQyxpQkFDQUMsYUFDQUMsbUJBQ0FDLHlCQUNNLHNCQUNQQyxTQUFTQyxpQkFBaUIsbUJBQW9CLFdBQzdDLE1BR01DLEVBQVUsQ0FDZkMsT0FBUSxNQUNSQyxRQUFTLENBQ1JDLE9BQVEsbUJBQ1JDLGNBQ0MseVBBR0dDLEVBQXVCLElBQUlDLElBQ2pDLElBS0lDLEVBTEFDLEVBQWlCLElBSWpCQyxFQUFRLEVBR1osTUFLTUMsRUFBYyxJQUFJQyxLQUNsQkMsRUFBaUIsa0dBQWtHRixFQUFZRyxpQkFDcElILEVBQVlJLFdBQWEsS0FDdEJKLEVBQVlLLHNDQUdWQyxFQUFxQixTQXFGckJDLEVBQWNDLE1BQU9DLEtBQVNDLEtBQ25DLE1BQU1DLEVBQVcsR0FDakIsVUFBVyxNQUFNQyxLQUFPRixFQUFNLENBQzdCLE1BQU1HLEVBQ0xELEVBQU1ILEVBQU9ILEVBckh3QixFQXNIaENRLFFBQWlC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SixpQkFFakIsSUFDQyxNQUFNOEQsUUFBZWYsRUFDcEJMLEVBQ0FNLEdBR0RsRCxzQkFBc0JnRSxFQUFRdkIsRUFBY3NCLEdBQzVDRCxFQUFxQkMsRUFBV0MsR0FFaEMvQyxFQUFvQitFLFlBQ25CLElBQU1sQyxFQUFxQkMsRUFBV0MsR0FDdEM5QyxHQUdEaUYsRUFBaUJuQyxFQUFRRCxHQUN6QjJELEVBQXNCM0QsRUFBV0MsR0FFakMsTUFBTTJGLFFBQWNoSSxFQUNuQnVCLEVBOUN5Qix3REFDRCwyREFDSyx5R0FnRDdCNUIsR0FHS3NJLEVBQU9wSixTQUFTMEQsY0FBYyxRQUUvQjBGLEdBQ0ozSixlQUFld0MsRUFBYUMsV0FBV0MsaUJBQWtCLFdBRzFEaUgsRUFBS0YsT0FDSm5KLHFCQUFxQmtDLEdBQ3JCckMsaUJBQ0N1SixFQUNBbEgsRUFDQSxFQUNBQSxFQUFhb0gsY0FBY0MsYUFBYUMsVUFFekMzSixpQkFDQ3VKLEVBQ0FsSCxFQUNBLEVBQ0FBLEVBQWFvSCxjQUFjQyxhQUFhRSxVQUV6QzVKLGlCQUNDdUosRUFDQWxILEVBQ0EsRUFDQUEsRUFBYW9ILGNBQWNDLGFBQWFHLGdCQUV6QzdKLGlCQUNDdUosRUFDQWxILEVBQ0EsRUFDQUEsRUFBYW9ILGNBQWNDLGFBQWFJLGNBRzFDakIsRUFBcUJsRixHQUNyQkEsRUFBVTJGLE9BQU9ySixhQUFhb0MsR0FDL0IsQ0FBRSxNQUNEeEMsZUFBZXdDLEVBQWFDLFdBQVdDLGlCQUFrQixVQUMxRCxDQUFFLFFBQ0R4QyxlQUNELENBckVBLE1BRkNrSSxPQUFPOEIsU0FBU0MsS0FBTyxLQW9ZekJDLEVBQ0QiLCJpZ25vcmVMaXN0IjpbXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuXHRnZXREYXRhLFxyXG5cdGNyZWF0ZUJyb3dzZVBhZ2UsXHJcblx0Y3JlYXRlTWFpbkhlcm9TZWN0aW9uLFxyXG5cdHNob3dFcnJvclBvcHVwLFxyXG5cdHNob3dCaWdMb2FkZXIsXHJcblx0aGlkZUJpZ0xvYWRlcixcclxuXHRjcmVhdGVGaWxtU2xpZGVyLFxyXG5cdGNyZWF0ZUZvb3RlcixcclxuXHRjbG9zZUFsbE5vdENsaWNrZWQsXHJcblx0Y3JlYXRlRm91ckNhdGVnb3JpZXMsXHJcbn0gZnJvbSBcIi4vY29tcG9uZW50cy5taW4uanNcIjtcclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xyXG5cdGNvbnN0IENBUk9VU0VMTF9MRU5HVEggPSA1O1xyXG5cdGNvbnN0IEZJTE1fQU1PVU5UX1BFUl9QQUdFID0gMjA7XHJcblx0Y29uc3QgUEFHRV9UT19TSE9XX09OX1NNQUxMX0NBUk9VU0VMUyA9IDE7XHJcblx0Y29uc3Qgb3B0aW9ucyA9IHtcclxuXHRcdG1ldGhvZDogXCJHRVRcIixcclxuXHRcdGhlYWRlcnM6IHtcclxuXHRcdFx0YWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuXHRcdFx0QXV0aG9yaXphdGlvbjpcclxuXHRcdFx0XHRcIkJlYXJlciBleUpoYkdjaU9pSklVekkxTmlKOS5leUpoZFdRaU9pSXpOVFl3WmpNNE1qVTNORFExWkdFMVpHWmtZVFl4WXpFMFlXTTRZbU00TXlJc0ltNWlaaUk2TVRjMU9UYzJOVEF6T0M0NU5Dd2ljM1ZpSWpvaU5qaGxNMlV5TW1VeU5qWTVOelk0TXpobFl6STNOekk1SWl3aWMyTnZjR1Z6SWpwYkltRndhVjl5WldGa0lsMHNJblpsY25OcGIyNGlPakY5Lm51R2ZFamNsSkxlcG16ekhpMm9tTmhwMjlUSGdySmY5TnY2RDRfZ1RkeEFcIixcclxuXHRcdH0sXHJcblx0fTtcclxuXHRjb25zdCBwcm9ncmVzc0JhckludGVydmFscyA9IG5ldyBNYXAoKTtcclxuXHRsZXQgY2Fyb3VzZWxsU3BlZWQgPSAxMDAwMDtcclxuXHRsZXQgY2Fyb3VzZWxsU3Ryb2tlUmFuZ2UgPSAyO1xyXG5cdGxldCBpbnRlcnZhbFNwZWVkID0gKGNhcm91c2VsbFNwZWVkICogY2Fyb3VzZWxsU3Ryb2tlUmFuZ2UpIC8gMTAwO1xyXG5cdGxldCBjYXJvdXNlbGxXaWR0aCA9IDEwMDtcclxuXHRsZXQgaW5kZXggPSAwO1xyXG5cdGxldCBjYXJvdXNlbGxJbnRlcnZhbDtcclxuXHJcblx0Y29uc3QgUE9QVUxBUl9GSUxNU19VUkwgPSBgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9tb3ZpZS9wb3B1bGFyP3dpdGhfb3JpZ2luX2NvdW50cnk9VVN8R0J8Q0EmbGFuZ3VhZ2U9YDtcclxuXHRjb25zdCBIT1RfUkFURURfRklMTVNfVVJMID0gYGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvdXBjb21pbmc/bGFuZ3VhZ2U9YDtcclxuXHRjb25zdCBUUkVORElOR19GSUxNU19VUkwgPSBgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy90cmVuZGluZy9hbGwvd2Vlaz9sYW5ndWFnZT1gO1xyXG5cdGNvbnN0IFRPUF9SQVRFRF9UVl9TRVJJRVNfVVJMID0gYGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvZGlzY292ZXIvdHY/d2l0aF9vcmlnaW5fY291bnRyeT1VU3xHQiZsYW5ndWFnZT0mc29ydF9ieT1wb3B1bGFyaXR5LmRlc2NcclxuYDtcclxuXHRjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7XHJcblx0Y29uc3QgVVBDT01JTkdfRklMTVMgPSBgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9kaXNjb3Zlci9tb3ZpZT9wcmltYXJ5X3JlbGVhc2VfeWVhcj0yMDI1JnByaW1hcnlfcmVsZWFzZV9kYXRlLmd0ZT0ke2N1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCl9LSR7XHJcblx0XHRjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMVxyXG5cdH0tJHtjdXJyZW50RGF0ZS5nZXREYXRlKCl9JnNvcnRfYnk9cG9wdWxhcml0eS5kZXNjXHJcbmA7XHJcblxyXG5cdGNvbnN0IEZJTE1TX1BBR0VTX0FNT1VOVCA9IGAmcGFnZT1gO1xyXG5cclxuXHRjb25zdCBjaGVja0F1dGhvcml6YXRpb24gPSBhc3luYyAoKSA9PiB7XHJcblx0XHRjb25zdCB1c2VyRGF0YSA9IGdldERhdGEoKTtcclxuXHRcdGNvbnN0IHRyYW5zbGF0aW9ucyA9IHVzZXJEYXRhPy50cmFuc2xhdGlvbnM7XHJcblx0XHRjb25zdCBjdXJyZW50TGFuZ3VhZ2UgPSB1c2VyRGF0YT8ucHJlZmVycmVkTGFuZ3VhZ2U7XHJcblx0XHRjb25zdCBpc0xvZ2dlZEluID0gdXNlckRhdGE/LmxvZ2dlZEluO1xyXG5cdFx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250YWluZXJcIik7XHJcblx0XHRjb25zdCBjdXJyZW50UHJvZmlsZSA9IHVzZXJEYXRhPy5jdXJyZW50UHJvZmlsZTtcclxuXHJcblx0XHRpZiAoIXVzZXJEYXRhIHx8ICFpc0xvZ2dlZEluIHx8ICFjdXJyZW50UHJvZmlsZSkge1xyXG5cdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Y29udGFpbmVyLnByZXBlbmQoY3JlYXRlQnJvd3NlUGFnZSh0cmFuc2xhdGlvbnMpKTtcclxuXHRcdGNvbnRhaW5lci5hcHBlbmQoc2hvd0JpZ0xvYWRlcigpKTtcclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBtb3ZpZXMgPSBhd2FpdCBjaG9vc2VGaWxtc1RvQ2Fyb3VzZWxsKFxyXG5cdFx0XHRcdGxvYWRGaWxtc1RvQ2Fyb3VzZWxsLFxyXG5cdFx0XHRcdGN1cnJlbnRMYW5ndWFnZVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdFx0Y3JlYXRlTWFpbkhlcm9TZWN0aW9uKG1vdmllcywgdHJhbnNsYXRpb25zLCBjb250YWluZXIpO1xyXG5cdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblxyXG5cdFx0XHRjYXJvdXNlbGxJbnRlcnZhbCA9IHNldEludGVydmFsKFxyXG5cdFx0XHRcdCgpID0+IGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKSxcclxuXHRcdFx0XHRjYXJvdXNlbGxTcGVlZFxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdFx0Y2hhbmdlQ3VycmVudEltZyhtb3ZpZXMsIGNvbnRhaW5lcik7XHJcblx0XHRcdHNldFRvdWNoRXZlbnRMaXN0ZW5lcihjb250YWluZXIsIG1vdmllcyk7XHJcblxyXG5cdFx0XHRjb25zdCBmaWxtcyA9IGF3YWl0IGdldEFsbEZpbG1zKFxyXG5cdFx0XHRcdGN1cnJlbnRMYW5ndWFnZSxcclxuXHRcdFx0XHRIT1RfUkFURURfRklMTVNfVVJMLFxyXG5cdFx0XHRcdFRSRU5ESU5HX0ZJTE1TX1VSTCxcclxuXHRcdFx0XHRUT1BfUkFURURfVFZfU0VSSUVTX1VSTCxcclxuXHRcdFx0XHRVUENPTUlOR19GSUxNU1xyXG5cdFx0XHQpO1xyXG5cclxuXHRcdFx0Y29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xyXG5cclxuXHRcdFx0aWYgKCFtYWluKSB7XHJcblx0XHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRtYWluLmFwcGVuZChcclxuXHRcdFx0XHRjcmVhdGVGb3VyQ2F0ZWdvcmllcyh0cmFuc2xhdGlvbnMpLFxyXG5cdFx0XHRcdGNyZWF0ZUZpbG1TbGlkZXIoXHJcblx0XHRcdFx0XHRmaWxtcyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucyxcclxuXHRcdFx0XHRcdDEsXHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnMuYnJvd3NlU2VjdGlvbi5zZWN0aW9uTmFtZXMudHJlbmRpbmdcclxuXHRcdFx0XHQpLFxyXG5cdFx0XHRcdGNyZWF0ZUZpbG1TbGlkZXIoXHJcblx0XHRcdFx0XHRmaWxtcyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucyxcclxuXHRcdFx0XHRcdDAsXHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnMuYnJvd3NlU2VjdGlvbi5zZWN0aW9uTmFtZXMudXBjb21pbmdcclxuXHRcdFx0XHQpLFxyXG5cdFx0XHRcdGNyZWF0ZUZpbG1TbGlkZXIoXHJcblx0XHRcdFx0XHRmaWxtcyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucyxcclxuXHRcdFx0XHRcdDIsXHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnMuYnJvd3NlU2VjdGlvbi5zZWN0aW9uTmFtZXMudG9wUmF0ZWRTZXJpZXNcclxuXHRcdFx0XHQpLFxyXG5cdFx0XHRcdGNyZWF0ZUZpbG1TbGlkZXIoXHJcblx0XHRcdFx0XHRmaWxtcyxcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9ucyxcclxuXHRcdFx0XHRcdDMsXHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnMuYnJvd3NlU2VjdGlvbi5zZWN0aW9uTmFtZXMuZnV0dXJlRmlsbXNcclxuXHRcdFx0XHQpXHJcblx0XHRcdCk7XHJcblx0XHRcdHByZXBhcmVDYXJvdXNlbEl0ZW1zKGNvbnRhaW5lcik7XHJcblx0XHRcdGNvbnRhaW5lci5hcHBlbmQoY3JlYXRlRm9vdGVyKHRyYW5zbGF0aW9ucykpO1xyXG5cdFx0fSBjYXRjaCB7XHJcblx0XHRcdHNob3dFcnJvclBvcHVwKHRyYW5zbGF0aW9ucy5icm93c2VQYWdlLmxvYWRpbmdEYXRhRXJyb3IsIFwiI2RjNGEzNFwiKTtcclxuXHRcdH0gZmluYWxseSB7XHJcblx0XHRcdGhpZGVCaWdMb2FkZXIoKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRjb25zdCBnZXRBbGxGaWxtcyA9IGFzeW5jIChsYW5nLCAuLi51cmxzKSA9PiB7XHJcblx0XHRjb25zdCBmaWxtc0FyciA9IFtdO1xyXG5cdFx0Zm9yIGF3YWl0IChjb25zdCB1cmwgb2YgdXJscykge1xyXG5cdFx0XHRjb25zdCBVUkwgPVxyXG5cdFx0XHRcdHVybCArIGxhbmcgKyBGSUxNU19QQUdFU19BTU9VTlQgKyBQQUdFX1RPX1NIT1dfT05fU01BTExfQ0FST1VTRUxTO1xyXG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFVSTCwgb3B0aW9ucyk7XHJcblx0XHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcblxyXG5cdFx0XHRmaWxtc0Fyci5wdXNoKGRhdGEpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZpbG1zQXJyO1xyXG5cdH07XHJcblx0Y29uc3QgZ2V0RmlsbXMgPSBhc3luYyAobGFuZywgcGFnZU51bSwgdXJsKSA9PiB7XHJcblx0XHRjb25zdCBVUkwgPSB1cmwgKyBsYW5nICsgRklMTVNfUEFHRVNfQU1PVU5UICsgcGFnZU51bTtcclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFVSTCwgb3B0aW9ucyk7XHJcblx0XHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcblxyXG5cdFx0XHRyZXR1cm4gZGF0YTtcclxuXHRcdH0gY2F0Y2gge1xyXG5cdFx0XHRzaG93RXJyb3JQb3B1cCh0cmFuc2xhdGlvbnMuYnJvd3NlUGFnZS5sb2FkaW5nRGF0YUVycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0Y29uc3QgbG9hZEZpbG1zVG9DYXJvdXNlbGwgPSBhc3luYyAobGFuZywgcGFnZU51bSkgPT4ge1xyXG5cdFx0Y29uc3QgcmVxdWVzdHMgPSBbXTtcclxuXHJcblx0XHRmb3IgKGxldCBpID0gMTsgaSA8PSBwYWdlTnVtOyBpKyspIHtcclxuXHRcdFx0cmVxdWVzdHMucHVzaChnZXRGaWxtcyhsYW5nLCBpLCBQT1BVTEFSX0ZJTE1TX1VSTCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IFByb21pc2UuYWxsKHJlcXVlc3RzKTtcclxuXHRcdFx0cmV0dXJuIHJlc3BvbnNlcztcclxuXHRcdH0gY2F0Y2gge1xyXG5cdFx0XHRzaG93RXJyb3JQb3B1cCh0cmFuc2xhdGlvbnMuYnJvd3NlUGFnZS5sb2FkaW5nRGF0YUVycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0Y29uc3QgY2hvb3NlRmlsbXNUb0Nhcm91c2VsbCA9IGFzeW5jIChkYXRhLCBjdXJyZW50TGFuZ3VhZ2UpID0+IHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHBhZ2VzRGF0YSA9IGF3YWl0IGRhdGEoY3VycmVudExhbmd1YWdlLCBDQVJPVVNFTExfTEVOR1RIKTtcclxuXHRcdFx0Y29uc3QgcmFuZG9tTnVtYmVyID0gTWF0aC50cnVuYyhNYXRoLnJhbmRvbSgpICogRklMTV9BTU9VTlRfUEVSX1BBR0UpO1xyXG5cdFx0XHRjb25zdCBjaG9vc2VuTW92aWVzID0gcGFnZXNEYXRhLm1hcCgocGFnZSkgPT4gcGFnZS5yZXN1bHRzW3JhbmRvbU51bWJlcl0pO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhjaG9vc2VuTW92aWVzKTtcclxuXHRcdFx0cmV0dXJuIGNob29zZW5Nb3ZpZXM7XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAodHJhbnNsYXRpb25zLmJyb3dzZVBhZ2UubG9hZGluZ0RhdGFFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0fSBmaW5hbGx5IHtcclxuXHRcdFx0aGlkZUJpZ0xvYWRlcigpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8vIENBUk9VU0VMTFxyXG5cclxuXHRjb25zdCBoYW5kbGVGaWxtc0Nhcm91c2VsbCA9IChjb250YWluZXIsIG1vdmllcykgPT4ge1xyXG5cdFx0Y29uc3QgaW1hZ2VTbGlkZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9faW1hZ2VzXCIpO1xyXG5cdFx0Y29uc3QgYWxsSW1hZ2VzID0gaW1hZ2VTbGlkZXIucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2UtbWFpbl9faW1nLWJveFwiKTtcclxuXHRcdGNvbnN0IGNhcm91c2VsbENvbnRyb2xzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRcdFwiLmJyb3dzZS1tYWluX19jYXJvdXNlbGwtY29udHJvbHNcIlxyXG5cdFx0KTtcclxuXHRcdGFsbEltYWdlcy5mb3JFYWNoKChpbWcpID0+IGltZy5jbGFzc0xpc3QucmVtb3ZlKFwiY3VycmVudFZpc2libGVcIikpO1xyXG5cclxuXHRcdGltYWdlU2xpZGVyLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKCR7LWluZGV4ICogY2Fyb3VzZWxsV2lkdGh9JSlgO1xyXG5cdFx0aGFuZGxlQ2Fyb3VzZWxsQ29udHJvbHNTdGF0ZShpbmRleCwgY2Fyb3VzZWxsQ29udHJvbHMpO1xyXG5cdFx0YWxsSW1hZ2VzW2luZGV4XS5jbGFzc0xpc3QuYWRkKFwiY3VycmVudFZpc2libGVcIik7XHJcblxyXG5cdFx0aW5kZXgrKztcclxuXHJcblx0XHRpZiAoaW5kZXggPiBtb3ZpZXMubGVuZ3RoIC0gMSkgaW5kZXggPSAwO1xyXG5cclxuXHRcdGhhbmRsZUJ0bnNWaXNpYmlsaXR5KGNvbnRhaW5lcik7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgaGFuZGxlQ2Fyb3VzZWxsQ29udHJvbHNTdGF0ZSA9IChpbmRleCwgY2Fyb3VzZWxsQ29udHJvbHNCb3gpID0+IHtcclxuXHRcdGNvbnN0IGFsbENvbnRyb2xCdG5zID1cclxuXHRcdFx0Y2Fyb3VzZWxsQ29udHJvbHNCb3gucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2UtbWFpbl9fYnRuXCIpO1xyXG5cdFx0Y29uc3QgY3VycmVudEJ0biA9IGNhcm91c2VsbENvbnRyb2xzQm94LnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRcdGAuYnJvd3NlLW1haW5fX2J0bltkYXRhLWltZz1cIiR7aW5kZXh9XCJdYFxyXG5cdFx0KTtcclxuXHRcdGNvbnN0IHByb2dyZXNzQmFyID0gY3VycmVudEJ0bi5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1tYWluX19wcm9ncmVzcy1iYXJcIik7XHJcblx0XHRjb25zdCBhbGxQcm9ncmVzc0JhcnMgPSBjYXJvdXNlbGxDb250cm9sc0JveC5xdWVyeVNlbGVjdG9yQWxsKFxyXG5cdFx0XHRcIi5icm93c2UtbWFpbl9fcHJvZ3Jlc3MtYmFyXCJcclxuXHRcdCk7XHJcblxyXG5cdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuZm9yRWFjaCgoaW50ZXJ2YWwpID0+IGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpKTtcclxuXHRcdHByb2dyZXNzQmFySW50ZXJ2YWxzLmNsZWFyKCk7XHJcblxyXG5cdFx0YWxsUHJvZ3Jlc3NCYXJzLmZvckVhY2goKGJhcikgPT4gKGJhci5zdHlsZS53aWR0aCA9IFwiMFwiKSk7XHJcblxyXG5cdFx0Y2hhbmdlUHJvZ3Jlc3NCYXIocHJvZ3Jlc3NCYXIsIGluZGV4KTtcclxuXHJcblx0XHRhbGxDb250cm9sQnRucy5mb3JFYWNoKChidG4pID0+IGJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpKTtcclxuXHRcdGN1cnJlbnRCdG4uY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBjaGFuZ2VQcm9ncmVzc0JhciA9IChwcm9ncmVzc0JhciwgYnRuSW5kZXgpID0+IHtcclxuXHRcdGlmIChwcm9ncmVzc0JhckludGVydmFscy5oYXMoYnRuSW5kZXgpKSB7XHJcblx0XHRcdGNsZWFySW50ZXJ2YWwocHJvZ3Jlc3NCYXJJbnRlcnZhbHMuZ2V0KGJ0bkluZGV4KSk7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHdpZHRoID0gMDtcclxuXHRcdGNvbnN0IHByb2dyZXNzQmFySW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdHdpZHRoICs9IGNhcm91c2VsbFN0cm9rZVJhbmdlO1xyXG5cdFx0XHRwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IGAke3dpZHRofSVgO1xyXG5cdFx0XHRpZiAod2lkdGggPj0gMTAwKSB7XHJcblx0XHRcdFx0cHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBcIjBcIjtcclxuXHRcdFx0XHRjbGVhckludGVydmFsKHByb2dyZXNzQmFySW50ZXJ2YWwpO1xyXG5cclxuXHRcdFx0XHRwcm9ncmVzc0JhckludGVydmFscy5kZWxldGUoYnRuSW5kZXgpO1xyXG5cdFx0XHR9XHJcblx0XHR9LCBpbnRlcnZhbFNwZWVkKTtcclxuXHJcblx0XHRwcm9ncmVzc0JhckludGVydmFscy5zZXQoYnRuSW5kZXgsIHByb2dyZXNzQmFySW50ZXJ2YWwpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGNoYW5nZUN1cnJlbnRJbWcgPSAobW92aWVzLCBjb250YWluZXIpID0+IHtcclxuXHRcdGNvbnN0IGNhcm91c2VsbENvbnRyb2xzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRcdFwiLmJyb3dzZS1tYWluX19jYXJvdXNlbGwtY29udHJvbHNcIlxyXG5cdFx0KTtcclxuXHJcblx0XHRjYXJvdXNlbGxDb250cm9scy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdFx0aWYgKGUudGFyZ2V0Lm1hdGNoZXMoXCIuYnJvd3NlLW1haW5fX2J0blwiKSkge1xyXG5cdFx0XHRcdGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIikpIHJldHVybjtcclxuXHJcblx0XHRcdFx0Y2xlYXJJbnRlcnZhbChjYXJvdXNlbGxJbnRlcnZhbCk7XHJcblxyXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRCdG4gPSBlLnRhcmdldDtcclxuXHRcdFx0XHRjb25zdCBpbWdEYXRhID0gcGFyc2VJbnQoY3VycmVudEJ0bi5kYXRhc2V0LmltZyk7XHJcblxyXG5cdFx0XHRcdGluZGV4ID0gaW1nRGF0YTtcclxuXHRcdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblxyXG5cdFx0XHRcdGNhcm91c2VsbEludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHRcdFx0aGFuZGxlRmlsbXNDYXJvdXNlbGwoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0XHRcdH0sIGNhcm91c2VsbFNwZWVkKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgaGFuZGxlQnRuc1Zpc2liaWxpdHkgPSAoY29udGFpbmVyKSA9PiB7XHJcblx0XHRjb25zdCBhbGxGaWxtcyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFwiLmJyb3dzZS1tYWluX19pbWctYm94XCIpO1xyXG5cclxuXHRcdGFsbEZpbG1zLmZvckVhY2goKGZpbG0pID0+IHtcclxuXHRcdFx0Y29uc3QgaXNBY3RpdmUgPSBmaWxtLmNsYXNzTGlzdC5jb250YWlucyhcImN1cnJlbnRWaXNpYmxlXCIpO1xyXG5cdFx0XHRjb25zdCB0YWJpbmRleCA9IGlzQWN0aXZlID8gMCA6IC0xO1xyXG5cdFx0XHRjb25zdCB2aXNpYmlsaXR5ID0gdGFiaW5kZXggPT09IDAgPyBcInZpc2libGVcIiA6IFwiaGlkZGVuXCI7XHJcblx0XHRcdGdpdmVCdG5zQXR0cmlidXRlKGZpbG0sIHRhYmluZGV4LCB2aXNpYmlsaXR5KTtcclxuXHRcdH0pO1xyXG5cdH07XHJcblx0Y29uc3QgZ2l2ZUJ0bnNBdHRyaWJ1dGUgPSAoZmlsbSwgdGFiaW5kZXgsIHZpc2liaWxpdHkpID0+IHtcclxuXHRcdGNvbnN0IHRyYWlsZXJCdG4gPSBmaWxtLnF1ZXJ5U2VsZWN0b3IoXCIuYnJvd3NlLW1haW5fX3RyYWlsZXItYnRuXCIpO1xyXG5cdFx0Y29uc3Qgc2VlTW9yZUJ0biA9IGZpbG0ucXVlcnlTZWxlY3RvcihcIi5icm93c2UtbWFpbl9fc2VlLW1vcmUtYnRuXCIpO1xyXG5cclxuXHRcdHRyYWlsZXJCdG4uc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgdGFiaW5kZXgpO1xyXG5cdFx0c2VlTW9yZUJ0bi5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCB0YWJpbmRleCk7XHJcblx0XHR0cmFpbGVyQnRuLnN0eWxlLnZpc2liaWxpdHkgPSB2aXNpYmlsaXR5O1xyXG5cdFx0c2VlTW9yZUJ0bi5zdHlsZS52aXNpYmlsaXR5ID0gdmlzaWJpbGl0eTtcclxuXHR9O1xyXG5cclxuXHRsZXQgc3RhcnRYO1xyXG5cdGxldCBlbmRYO1xyXG5cdGxldCBzdGFydFk7XHJcblx0bGV0IGVuZFk7XHJcblxyXG5cdGNvbnN0IGhhbmRsZVRvdWNoU3RhcnRFdmVudCA9IChlKSA9PiB7XHJcblx0XHRzdGFydFggPSBlLnRvdWNoZXNbMF0uY2xpZW50WDtcclxuXHRcdHN0YXJ0WSA9IGUudG91Y2hlc1swXS5jbGllbnRZO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZVRvdWNoRW5kRXZlbnQgPSAoZSwgY29udGFpbmVyLCBtb3ZpZXMpID0+IHtcclxuXHRcdGVuZFggPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFg7XHJcblx0XHRlbmRZID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZO1xyXG5cdFx0aGFuZGxlU3dpcGUoY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZVN3aXBlID0gKGNvbnRhaW5lciwgbW92aWVzKSA9PiB7XHJcblx0XHRjb25zdCBIT1JJWk9OVEFMX1JBTkdFID0gMzA7XHJcblx0XHRjb25zdCBWRVJUSUNBTF9SQU5HRSA9IDMwO1xyXG5cclxuXHRcdGNvbnN0IGhvcml6b250YWxEaXN0YW5jZSA9IE1hdGguYWJzKHN0YXJ0WCAtIGVuZFgpO1xyXG5cdFx0Y29uc3QgdmVydGljYWxEaXN0YW5jZSA9IE1hdGguYWJzKHN0YXJ0WSAtIGVuZFkpO1xyXG5cclxuXHRcdGlmIChcclxuXHRcdFx0aG9yaXpvbnRhbERpc3RhbmNlIDwgSE9SSVpPTlRBTF9SQU5HRSB8fFxyXG5cdFx0XHR2ZXJ0aWNhbERpc3RhbmNlID4gVkVSVElDQUxfUkFOR0VcclxuXHRcdCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRpZiAoZW5kWCAtIHN0YXJ0WCA+IEhPUklaT05UQUxfUkFOR0UpIHtcclxuXHRcdFx0aW5kZXggPSAoaW5kZXggLSAyICsgbW92aWVzLmxlbmd0aCkgJSBtb3ZpZXMubGVuZ3RoO1xyXG5cdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblx0XHR9IGVsc2UgaWYgKHN0YXJ0WCAtIGVuZFggPiBIT1JJWk9OVEFMX1JBTkdFKSB7XHJcblx0XHRcdGhhbmRsZUZpbG1zQ2Fyb3VzZWxsKGNvbnRhaW5lciwgbW92aWVzKTtcclxuXHRcdH1cclxuXHJcblx0XHRjbGVhckludGVydmFsKGNhcm91c2VsbEludGVydmFsKTtcclxuXHRcdGNhcm91c2VsbEludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHRoYW5kbGVGaWxtc0Nhcm91c2VsbChjb250YWluZXIsIG1vdmllcyk7XHJcblx0XHR9LCBjYXJvdXNlbGxTcGVlZCk7XHJcblx0fTtcclxuXHJcblx0Y29uc3Qgc2V0VG91Y2hFdmVudExpc3RlbmVyID0gKGNvbnRhaW5lciwgbW92aWVzKSA9PiB7XHJcblx0XHRjb25zdCBpbWFnZVNsaWRlciA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1tYWluX19pbWFnZXNcIik7XHJcblxyXG5cdFx0aW1hZ2VTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgKGUpID0+IHtcclxuXHRcdFx0aGFuZGxlVG91Y2hTdGFydEV2ZW50KGUpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0aW1hZ2VTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIChlKSA9PiB7XHJcblx0XHRcdGhhbmRsZVRvdWNoRW5kRXZlbnQoZSwgY29udGFpbmVyLCBtb3ZpZXMpO1xyXG5cdFx0fSk7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgY2hhbmdlQ2Fyb3VzZWxsRGF0YUluZGV4ID0gKHNsaWRlciwgaW5kZXgpID0+IHtcclxuXHRcdHNsaWRlci5kYXRhc2V0LmluZGV4ID0gaW5kZXg7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgZ2V0Q2Fyb3VzZWxDb25maWcgPSAoKSA9PiB7XHJcblx0XHRsZXQgbWF4SW5kZXg7XHJcblxyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoIDwgNTc2KSBtYXhJbmRleCA9IDk7XHJcblx0XHRpZiAod2luZG93LmlubmVyV2lkdGggPj0gNTc2ICYmIHdpbmRvdy5pbm5lcldpZHRoIDwgOTkyKSBtYXhJbmRleCA9IDE3O1xyXG5cdFx0aWYgKHdpbmRvdy5pbm5lcldpZHRoID49IDk5MiAmJiB3aW5kb3cuaW5uZXJXaWR0aCA8IDEyMDApIG1heEluZGV4ID0gNDtcclxuXHRcdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSAxMjAwKSBtYXhJbmRleCA9IDc7XHJcblxyXG5cdFx0cmV0dXJuIG1heEluZGV4O1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IHNldFRocmVzaG9sZCA9ICgpID0+IHtcclxuXHRcdGxldCB0aHJlc2hvbGQgPSAyO1xyXG5cclxuXHRcdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+IDU3NiAmJiB3aW5kb3cuaW5uZXJXaWR0aCA8IDk5MikgdGhyZXNob2xkID0gMTtcclxuXHRcdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSA5OTIgJiYgd2luZG93LmlubmVyV2lkdGggPCAxMjAwKSB0aHJlc2hvbGQgPSA0O1xyXG5cclxuXHRcdHJldHVybiB0aHJlc2hvbGQ7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgbW92ZVNsaWRlciA9IChzbGlkZXIpID0+IHtcclxuXHRcdGNvbnN0IHRocmVzaG9sZCA9IHNldFRocmVzaG9sZCgpO1xyXG5cdFx0bGV0IHNsaWRlckRhdGFzZXQgPSBzbGlkZXIuZGF0YXNldC5pbmRleDtcclxuXHRcdGNvbnN0IHNsaWRlckNhcm91c2VsbCA9IHNsaWRlci5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XHRcIi5icm93c2Utc2VjdGlvbl9fc2xpZGVyLWltYWdlc1wiXHJcblx0XHQpO1xyXG5cclxuXHRcdGNvbnN0IHBvc3RlciA9IHNsaWRlci5xdWVyeVNlbGVjdG9yKFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXItYm94XCIpO1xyXG5cdFx0aWYgKCFwb3N0ZXIpIHJldHVybjtcclxuXHJcblx0XHRjb25zdCBwb3N0ZXJXaWR0aCA9IHBvc3Rlci5vZmZzZXRXaWR0aDtcclxuXHRcdHNsaWRlckNhcm91c2VsbC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgke1xyXG5cdFx0XHQtc2xpZGVyRGF0YXNldCAqIHBvc3RlcldpZHRoICogdGhyZXNob2xkXHJcblx0XHR9cHgpYDtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBzaG93TmV4dFNsaWRlID0gKHNsaWRlciwgaW5kZXgpID0+IHtcclxuXHRcdGxldCBpbml0aWFsSW5kZXggPSBpbmRleCA9PT0gMCA/IHBhcnNlSW50KHNsaWRlci5kYXRhc2V0LmluZGV4KSA6IDA7XHJcblx0XHRjb25zdCBtYXhJbmRleCA9IGdldENhcm91c2VsQ29uZmlnKCk7XHJcblxyXG5cdFx0aWYgKGluaXRpYWxJbmRleCA+PSBtYXhJbmRleCkgcmV0dXJuO1xyXG5cclxuXHRcdGluaXRpYWxJbmRleCsrO1xyXG5cdFx0Y2hhbmdlQ2Fyb3VzZWxsRGF0YUluZGV4KHNsaWRlciwgaW5pdGlhbEluZGV4KTtcclxuXHRcdG1vdmVTbGlkZXIoc2xpZGVyKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBzaG93UHJldlNsaWRlID0gKHNsaWRlciwgaW5kZXgpID0+IHtcclxuXHRcdGxldCBpbml0aWFsSW5kZXggPSBpbmRleCA9PT0gMCA/IHBhcnNlSW50KHNsaWRlci5kYXRhc2V0LmluZGV4KSA6IDA7XHJcblxyXG5cdFx0aWYgKGluaXRpYWxJbmRleCA8PSAwKSByZXR1cm47XHJcblxyXG5cdFx0aW5pdGlhbEluZGV4LS07XHJcblx0XHRjaGFuZ2VDYXJvdXNlbGxEYXRhSW5kZXgoc2xpZGVyLCBpbml0aWFsSW5kZXgpO1xyXG5cdFx0bW92ZVNsaWRlcihzbGlkZXIpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IHByZXBhcmVDYXJvdXNlbEl0ZW1zID0gKGNvbnRhaW5lcikgPT4ge1xyXG5cdFx0Y29uc3Qgc2xpZGVycyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXJcIik7XHJcblxyXG5cdFx0c2xpZGVycy5mb3JFYWNoKChzbGlkZXIpID0+XHJcblx0XHRcdHNsaWRlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdFx0XHRsZXQgc21hbGxDYXJvdXNlbGxJbmRleCA9IDA7XHJcblxyXG5cdFx0XHRcdGlmIChlLnRhcmdldC5tYXRjaGVzKFwiLmJyb3dzZS1zZWN0aW9uX19zbGlkZXItbmV4dC1idG5cIikpIHtcclxuXHRcdFx0XHRcdHNob3dOZXh0U2xpZGUoc2xpZGVyLCBzbWFsbENhcm91c2VsbEluZGV4KTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKGUudGFyZ2V0Lm1hdGNoZXMoXCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlci1wcmV2LWJ0blwiKSkge1xyXG5cdFx0XHRcdFx0c2hvd1ByZXZTbGlkZShzbGlkZXIsIHNtYWxsQ2Fyb3VzZWxsSW5kZXgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSlcclxuXHRcdCk7XHJcblx0fTtcclxuXHJcblx0bGV0IGxhc3RXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsICgpID0+IHtcclxuXHRcdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA9PT0gbGFzdFdpZHRoKSByZXR1cm47XHJcblx0XHRsYXN0V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuXHJcblx0XHRjb25zdCBhbGxTbGlkZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5icm93c2Utc2VjdGlvbl9fc2xpZGVyXCIpO1xyXG5cdFx0YWxsU2xpZGVycy5mb3JFYWNoKChzbGlkZXIpID0+IHtcclxuXHRcdFx0Y29uc3Qgc2xpZGVyQ2Fyb3VzZWxsID0gc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRcdFx0XCIuYnJvd3NlLXNlY3Rpb25fX3NsaWRlci1pbWFnZXNcIlxyXG5cdFx0XHQpO1xyXG5cdFx0XHRjaGFuZ2VDYXJvdXNlbGxEYXRhSW5kZXgoc2xpZGVyLCAwKTtcclxuXHRcdFx0c2xpZGVyQ2Fyb3VzZWxsLnN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlWCgwKVwiO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ1bmxvYWRcIiwgKCkgPT4ge1xyXG5cdFx0Y2xlYXJJbnRlcnZhbChjYXJvdXNlbGxJbnRlcnZhbCk7XHJcblx0XHRwcm9ncmVzc0JhckludGVydmFscy5mb3JFYWNoKChpbnRlcnZhbCkgPT4gY2xlYXJJbnRlcnZhbChpbnRlcnZhbCkpO1xyXG5cdFx0cHJvZ3Jlc3NCYXJJbnRlcnZhbHMuY2xlYXIoKTtcclxuXHR9KTtcclxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRjbG9zZUFsbE5vdENsaWNrZWQoZSk7XHJcblx0fSk7XHJcblx0Y2hlY2tBdXRob3JpemF0aW9uKCk7XHJcbn0pO1xyXG4iXX0=
