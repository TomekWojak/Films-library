import{createElement}from"./helpers.min.js";import{setUserPreference}from"./updateStateFunctions.min.js";const HIDE_LOADER_TIME=3e3,HIDE_POPUP_TIME=2500,getData=()=>{try{const e=localStorage.getItem("userData");if(!e)return null;const t=JSON.parse(e);if("object"!=typeof t||null===t)throw showErrorPopup("An unexpected error occurred","#dc4a34"),new Error("NieprawidÅ‚owa struktura danych");return t}catch{return localStorage.removeItem("userData"),{}}},USERNAME="handsomeUser404",PASSWORD="5jksH9d.";export const createLoginHeader=({header:{alt:{logo:e},aria:{logoLink:t,changeLanguageButton:r}}},a,n,o,i)=>{const l=createElement("header",["header"]),s=createElement("a",["header__logo","login-header__logo"],{href:"/","aria-label":`${t}`}),c=createElement("img",["header__logo-img","login-header__logo-img"],{src:"./src/icons/logo.svg",alt:`${e}`,width:"24",height:"24"}),d=createElement("span",["header__logo-text","login-header__logo-text"]);d.textContent="Stream",s.append(c,d),l.append(s);const p=createElement("button",["login-header__lang-select"],{"aria-label":`${r}`}),m=createElement("span",["login-header__lang-platform-lang"]),u=createElement("img",["login-header__lang-arrow"],{src:"./src/icons/chevron-down.svg",alt:"",width:"24",height:"24"}),f=createElement("ul",["login-header__lang-list"]);for(let e=0;e<a;e++){const t=createElement("li",["login-header__lang-choice"],{tabindex:0}),r=Object.keys(n)[e],a=Object.values(n)[e];t.dataset.lang=r,t.textContent=a,t.style.animationDelay=100*e+"ms",f.append(t)}return m.textContent=n[o],p.addEventListener("click",e=>{i.call(p,e,m)}),p.append(m,u,f),l.append(p),l};export const createLoginPage=({main:{text:{title:e,subtitle:t,description:r,button:a},placeholder:{username:n,password:o}}})=>{const i=createElement("main",["main"]),l=createElement("div",["wrapper"]),s=createElement("h1"),c=createElement("span",["main__title"]),d=createElement("span",["main__subtitle"]),p=createElement("p",["main__text"]),m=createElement("form",["main__form"]),u=createElement("input",["main__form-input","main__form-input--username"],{type:"text",placeholder:n}),f=createElement("input",["main__form-input","main__form-input--password"],{type:"password",placeholder:o}),_=createElement("button",["main__form-button"],{type:"submit"}),g=createElement("span",["main__form-button-text"]),h=createElement("p",["main__form-error-txt"]);return c.textContent=e,d.textContent=t,p.textContent=r,g.textContent=a,s.append(c,d),_.append(g),m.append(u,f,_,h),l.append(s,p,m),i.append(l),_.addEventListener("click",e=>{const t=getData();handleLoginValidation(e,u,f,translations.main.text.errorRequired,translations.main.text.errorInvalid,USERNAME,PASSWORD,h)||(h.classList.remove("visible"),e.target.append(showSmallLoader()),e.target.disabled=!0,setTimeout(()=>{e.target.disabled=!1,hideSmallLoader(),setUserPreference("translations",translations,t),setUserPreference("loggedIn",!0,t),window.location.href="profiles.html"},3e3))}),i};const handleLoginValidation=(e,t,r,a,n,o,i,l)=>(e.preventDefault(),""===t.value.trim()||""===r.value.trim()?(l.classList.add("visible"),l.textContent=a,a):t.value.trim()!==o||r.value.trim()!==i?(e.target.disabled=!0,e.target.append(showSmallLoader()),l.classList.remove("visible"),setTimeout(()=>{l.classList.add("visible"),l.textContent=n,e.target.disabled=!1,hideSmallLoader()},3e3),n):null);export const showBigLoader=()=>{const e=createElement("div",["loading-area"]);return e.innerHTML='            <svg class="loader-big" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="#4da8da" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="#4da8da" stop-opacity="0.4" />\n                        <stop offset="100%" stop-color="#4da8da" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-big" r="35" cx="60" cy="60"></circle>\n            </svg>',e};export const hideBigLoader=()=>{const e=document.querySelector(".loading-area");e?.remove()};export const showSmallLoader=()=>{const e=createElement("div",["loading-area-small"]);return e.innerHTML='<svg class="loader-small" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent-small" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="white" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="white" stop-opacity="0.3" />\n                        <stop offset="100%" stop-color="white" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-small" r="12" cx="60" cy="60"></circle>\n            </svg>',e};export const hideSmallLoader=()=>{document.querySelector(".loading-area-small").remove()};export const createProfilesPage=({profiles:{text:{title:e,addProfileInfo:t},aria:{addProfileBtn:r,userProfileBtn:a,userBtnCustomize:n,removeUserInfo:o}},errorPopup:{text:{maxProfiles:i,emptyField:l}}})=>{const s=getData(),c=s?.userProfiles,d=document.querySelector(".container");d.append(showBigLoader()),setTimeout(()=>{const s=createElement("main",["main-profiles"]),p=createElement("div",["wrapper"]),m=createElement("h1",["main__title","main-profiles__title"]),u=createElement("div",["main-profiles__box"]);if(m.textContent=e,c&&0!==Object.keys(c).length)for(const e in c)u.append(createProfile(a,n,n,l,o,e,c[e]));u.append(createProfileAddBtn(r,t,a,u,n,n,i,l,o)),p.append(m,u),s.append(p),d.append(s),hideBigLoader()},500)};const createProfile=(e,t,r,a,n,o=null,i=null)=>{const l=getData(),s=l?.userProfiles||{};if(null===l)return showErrorPopup("An unexpected error occurred","#dc4a34"),void setTimeout(()=>{window.location.reload()},2500);let c,d,p;const m=["#dc4a34","#062E63","#FAC044"];if(o){d=o,p=i;c=m[parseInt(d.split("-").pop())-1]}else{if(Object.keys(s).length>=3)return;let e=1;for(;s[`user-profile-${e}`];)e++;d=`user-profile-${e}`,p=`Handsome User ${e}`,c=m[e-1]}const u=createElement("div",["main-profiles__profile"]),f=createElement("div",["main-profiles__avatar"]),_=createElement("button",["main-profiles__btn"],{"aria-label":e,"data-id":d}),g=createElement("div",["main-profiles__user-info"]),h=createElement("input",["main-profiles__name"],{type:"text",readonly:!0,value:p}),v=createElement("span",["name-border"]),E=createElement("button",["main-profiles__edit-name"],{"aria-label":t}),b=createElement("button",["main-profiles__remove-user"],{"aria-label":n}),y=createElement("img",["main-profiles__remove-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/remove-profile-icon.svg"}),x=createElement("img",["main-profiles__edit-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/edit.svg"});if(_.innerHTML='<svg class="main-profiles__img" width="150" height="150" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">\n    <circle cx="70" cy="70" r="8" fill="white" />\n    <circle cx="130" cy="70" r="8" fill="white" />\n    <path d="M60 110 Q100 150 140 110" stroke="white" stroke-width="6"\n    fill="transparent" stroke-linecap="round" />\n    </svg>',_.style.backgroundColor=c,f.append(_),E.append(x),b.append(y),g.append(h,v,E,b),u.append(f,g),!o){const e={...s,[d]:p};setUserPreference("userProfiles",e,l)}return E.addEventListener("click",e=>{editUsername(e,g,r,a)}),b.addEventListener("click",e=>{removeUser(e)}),h.addEventListener("keydown",e=>{"Enter"===e.key&&saveUsername(e,a)}),u.classList.add("visible"),u},createProfileAddBtn=(e,t,r,a,n,o,i,l,s)=>{const c=createElement("div",["main-profiles__add-profile"]),d=createElement("div",["main-profiles__avatar"]),p=createElement("button",["main-profiles__btn","main-profiles__btn--add-profile"],{"aria-label":e}),m=createElement("img",["main-profiles__add-img"],{src:"./src/icons/add-profile.svg",loading:"lazy",alt:""}),u=createElement("span",["main-profiles__name"]);return u.textContent=t,p.append(m),d.append(p),c.append(d,u),p.addEventListener("click",()=>{const e=getData(),t=e?.userProfiles||{};if(Object.keys(t).length>=3)return void showErrorPopup(i,"#dc4a34");const d=createProfile(r,n,o,l,s);d&&a.insertBefore(d,c)}),c},editUsername=(e,t,r,a)=>{resetStateOfEditing(e);const n=e.target,o=n.closest(".main-profiles__profile").querySelector(".main-profiles__name"),i=createSaveBtn(r);n.classList.add("hidden"),i.classList.remove("hidden"),t.append(i),o.focus(),o.select(),o.removeAttribute("readonly"),o.classList.add("focused"),i.addEventListener("click",e=>{saveUsername(e,a)})},saveUsername=(e,t)=>{const r=getData(),a=r?.userProfiles||[],n=e.target.closest(".main-profiles__profile"),o=n.querySelector(".main-profiles__btn").dataset.id,i=n.querySelector(".main-profiles__name"),l=document.querySelectorAll(".main-profiles__edit-name");if(l.forEach(e=>e.removeAttribute("disabled")),""===i.value.trim())return l.forEach(e=>e.setAttribute("disabled",!0)),showErrorPopup(t,"#FAC044");const s={...a,[o]:i.value};setUserPreference("userProfiles",s,r),resetStateOfEditing(e)},createSaveBtn=e=>{const t=createElement("button",["main-profiles__save-name","hidden"],{"aria-label":e}),r=createElement("img",["main-profiles__save-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/save.svg"});return t.append(r),t},resetStateOfEditing=e=>{const t=document.querySelectorAll(".focused"),r=document.querySelectorAll(".main-profiles__save-name"),a=document.querySelectorAll(".main-profiles__edit-name");t.forEach(e=>{e.setAttribute("readonly",!0),e.classList.remove("focused"),e.blur()}),r.forEach(e=>e.classList.add("hidden")),a.forEach(e=>e.classList.remove("hidden"))};let popupVisible=!1;const showErrorPopup=(e,t)=>{if(popupVisible)return;popupVisible=!0;const r=document.documentElement,a=document.querySelector(".container"),n=createElement("div",["error-popup"]),o=createElement("p",["error-popup__text"]);o.textContent=e,r.style.setProperty("--errorTxtColor",t),n.append(o),a.append(n),setTimeout(()=>{n.classList.add("hidden")},2e3),setTimeout(()=>{n.remove(),popupVisible=!1},2500)},removeUser=e=>{const t=getData(),r=t?.userProfiles,a=document.querySelectorAll(".main-profiles__edit-name"),n=e.target.closest(".main-profiles__profile"),o=n.querySelector(".main-profiles__btn");a.forEach(e=>e.removeAttribute("disabled")),delete r[o.dataset.id],setUserPreference("userProfiles",r,t),n.classList.add("hidden"),setTimeout(()=>{n.remove()},400)};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50cy5taW4uanMiLCJuYW1lcyI6WyJjcmVhdGVFbGVtZW50Iiwic2V0VXNlclByZWZlcmVuY2UiLCJISURFX0xPQURFUl9USU1FIiwiSElERV9QT1BVUF9USU1FIiwiZ2V0RGF0YSIsImRhdGEiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwicGFyc2VkRGF0YSIsIkpTT04iLCJwYXJzZSIsInNob3dFcnJvclBvcHVwIiwiRXJyb3IiLCJyZW1vdmVJdGVtIiwiVVNFUk5BTUUiLCJQQVNTV09SRCIsImNyZWF0ZUxvZ2luSGVhZGVyIiwiaGVhZGVyIiwiYWx0IiwibG9nbyIsImFyaWEiLCJsb2dvTGluayIsImNoYW5nZUxhbmd1YWdlQnV0dG9uIiwibGFuZ0Ftb3VudCIsImxhbmdOYW1lcyIsImxhbmd1YWdlIiwiaGFuZGxlTGFuZ1NlbGVjdCIsInBhZ2VMb2dvIiwiaHJlZiIsImxvZ29JbWciLCJzcmMiLCJ3aWR0aCIsImhlaWdodCIsImxvZ29UZXh0IiwidGV4dENvbnRlbnQiLCJhcHBlbmQiLCJsYW5nU2VsZWN0IiwibGFuZ1BsYXRmb3JtTGFuZyIsImxhbmdBcnJvdyIsImxhbmdMaXN0IiwiaSIsImxhbmdDaG9pY2UiLCJ0YWJpbmRleCIsIk9iamVjdCIsImtleXMiLCJ0ZXh0IiwidmFsdWVzIiwiZGF0YXNldCIsImxhbmciLCJzdHlsZSIsImFuaW1hdGlvbkRlbGF5IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJjYWxsIiwiY3JlYXRlTG9naW5QYWdlIiwibWFpbiIsInRpdGxlIiwic3VidGl0bGUiLCJkZXNjcmlwdGlvbiIsImJ1dHRvbiIsInBsYWNlaG9sZGVyIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsIm1haW5Db250ZW50Iiwid3JhcHBlciIsImxvZ2luVGl0bGUiLCJsb2dpblRpdGxlVG9wIiwibG9naW5UaXRsZUJvdHRvbSIsImxvZ2luVGV4dCIsImZvcm0iLCJ1c2VybmFtZUlucHV0IiwidHlwZSIsInBhc3N3b3JkSW5wdXQiLCJzdWJtaXRCdG4iLCJidXR0b25UZXh0IiwiZXJyb3JUeHQiLCJ1c2VyRGF0YSIsImhhbmRsZUxvZ2luVmFsaWRhdGlvbiIsInRyYW5zbGF0aW9ucyIsImVycm9yUmVxdWlyZWQiLCJlcnJvckludmFsaWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0YXJnZXQiLCJzaG93U21hbGxMb2FkZXIiLCJkaXNhYmxlZCIsInNldFRpbWVvdXQiLCJoaWRlU21hbGxMb2FkZXIiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlcXVpcmVFcnJvciIsImludmFsaWRFcnJvciIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJ0cmltIiwiYWRkIiwic2hvd0JpZ0xvYWRlciIsImxvYWRpbmdBcmVhIiwiaW5uZXJIVE1MIiwiaGlkZUJpZ0xvYWRlciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNyZWF0ZVByb2ZpbGVzUGFnZSIsInByb2ZpbGVzIiwiYWRkUHJvZmlsZUluZm8iLCJhZGRQcm9maWxlQnRuIiwidXNlclByb2ZpbGVCdG4iLCJ1c2VyQnRuQ3VzdG9taXplIiwicmVtb3ZlVXNlckluZm8iLCJlcnJvclBvcHVwIiwibWF4UHJvZmlsZXMiLCJlbXB0eUZpZWxkIiwidXNlclByb2ZpbGVzTGlzdCIsInVzZXJQcm9maWxlcyIsImNvbnRhaW5lciIsInByb2ZpbGVzUGFnZU1haW4iLCJwcm9maWxlc1RpdGxlIiwicHJvZmlsZXNCb3giLCJsZW5ndGgiLCJrZXkiLCJjcmVhdGVQcm9maWxlIiwiY3JlYXRlUHJvZmlsZUFkZEJ0biIsImFyaWFJbmZvIiwidXNlckJ0bkluZm8iLCJzYXZlQnRuQXJpYSIsImVtcHR5RmllbGRFcnJvciIsInJlbW92ZUFyaWEiLCJleGlzdGluZ1Byb2ZpbGVJZCIsImV4aXN0aW5nUHJvZmlsZU5hbWUiLCJleGlzdGluZ1Byb2ZpbGVzIiwicmVsb2FkIiwiY29sb3IiLCJwcm9maWxlSWQiLCJwcm9maWxlTmFtZSIsImNvbG9ycyIsInBhcnNlSW50Iiwic3BsaXQiLCJwb3AiLCJuZXh0TnVtYmVyIiwidXNlclByb2ZpbGUiLCJ1c2VyQXZhdGFyQm94IiwidXNlclByb2ZpbGVJbmZvQm94IiwidXNlclByb2ZpbGVJbmZvIiwicmVhZG9ubHkiLCJuYW1lQm9yZGVyIiwiZWRpdFVzZXJJbmZvQnRuIiwicmVtb3ZlVXNlckJ0biIsInJlbW92ZVVzZXJJY29uIiwibG9hZGluZyIsImVkaXRVc2VySW5mb0ljb24iLCJiYWNrZ3JvdW5kQ29sb3IiLCJ1cGRhdGVkUHJvZmlsZXMiLCJlZGl0VXNlcm5hbWUiLCJyZW1vdmVVc2VyIiwic2F2ZVVzZXJuYW1lIiwiaW5mbyIsInVzZXJCdG5BcmlhIiwibWF4UHJvZmlsZXNFcnJvciIsImFkZFByb2ZpbGVCb3giLCJhZGRQcm9maWxlQXZhdGFyIiwiYWRkUHJvZmlsZVBsdXNJY29uIiwicHJvZmlsZSIsImluc2VydEJlZm9yZSIsInBhcmVudCIsInJlc2V0U3RhdGVPZkVkaXRpbmciLCJlZGl0QnRuIiwibmFtZVRvRWRpdCIsImNsb3Nlc3QiLCJzYXZlQnRuIiwiY3JlYXRlU2F2ZUJ0biIsImZvY3VzIiwic2VsZWN0IiwicmVtb3ZlQXR0cmlidXRlIiwiY2xvc2VzdFByb2ZpbGUiLCJjbG9zZXN0UHJvZmlsZUlkIiwiaWQiLCJjbG9zZXN0UHJvZmlsZU5hbWUiLCJhbGxFZGl0QnRucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYnRuIiwic2V0QXR0cmlidXRlIiwic2F2ZVVzZXJJbmZvQnRuIiwic2F2ZVVzZXJJbmZvSWNvbiIsImZvY3VzZWROYW1lcyIsImFsbFNhdmVCdG5zIiwiZWwiLCJibHVyIiwicG9wdXBWaXNpYmxlIiwicm9vdCIsImRvY3VtZW50RWxlbWVudCIsInBvcHVwIiwicG9wdXBFcnJvciIsInNldFByb3BlcnR5IiwiY2xvc2VzdFByb2ZpbGVCdG4iXSwic291cmNlcyI6WyJjb21wb25lbnRzLmpzIl0sIm1hcHBpbmdzIjoiT0FBU0Esa0JBQXFCLDBCQUNyQkMsc0JBQXlCLGdDQUNsQyxNQUFNQyxpQkFBbUIsSUFDbkJDLGdCQUFrQixLQUNsQkMsUUFBVSxLQUNmLElBQ0MsTUFBTUMsRUFBT0MsYUFBYUMsUUFBUSxZQUVsQyxJQUFLRixFQUFNLE9BQU8sS0FFbEIsTUFBTUcsRUFBYUMsS0FBS0MsTUFBTUwsR0FFOUIsR0FBMEIsaUJBQWZHLEdBQTBDLE9BQWZBLEVBRXJDLE1BREFHLGVBQWUsK0JBQWdDLFdBQ3pDLElBQUlDLE1BQU0sa0NBR2pCLE9BQU9KLENBQ1IsQ0FBRSxNQUVELE9BREFGLGFBQWFPLFdBQVcsWUFDakIsQ0FBQyxDQUNULEdBSUtDLFNBQVcsa0JBQ1hDLFNBQVcsa0JBRVYsTUFBTUMsa0JBQW9CLEVBRS9CQyxRQUNDQyxLQUFPQyxRQUNQQyxNQUFRQyxXQUFVQywwQkFHcEJDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEtBR0EsTUFBTVQsRUFBU2pCLGNBQWMsU0FBVSxDQUFDLFdBQ2xDMkIsRUFBVzNCLGNBQWMsSUFBSyxDQUFDLGVBQWdCLHNCQUF1QixDQUMzRTRCLEtBQU0sSUFDTixhQUFjLEdBQUdQLE1BRVpRLEVBQVU3QixjQUNmLE1BQ0EsQ0FBQyxtQkFBb0IsMEJBQ3JCLENBQ0M4QixJQUFLLHVCQUNMWixJQUFLLEdBQUdDLElBQ1JZLE1BQU8sS0FDUEMsT0FBUSxPQUdKQyxFQUFXakMsY0FBYyxPQUFRLENBQ3RDLG9CQUNBLDRCQUVEaUMsRUFBU0MsWUFBYyxTQUN2QlAsRUFBU1EsT0FBT04sRUFBU0ksR0FDekJoQixFQUFPa0IsT0FBT1IsR0FJZCxNQUFNUyxFQUFhcEMsY0FBYyxTQUFVLENBQUMsNkJBQThCLENBQ3pFLGFBQWMsR0FBR3NCLE1BRVplLEVBQW1CckMsY0FBYyxPQUFRLENBQzlDLHFDQUVLc0MsRUFBWXRDLGNBQWMsTUFBTyxDQUFDLDRCQUE2QixDQUNwRThCLElBQUssK0JBQ0xaLElBQUssR0FDTGEsTUFBTyxLQUNQQyxPQUFRLE9BRUhPLEVBQVd2QyxjQUFjLEtBQU0sQ0FBQyw0QkFFdEMsSUFBSyxJQUFJd0MsRUFBSSxFQUFHQSxFQUFJakIsRUFBWWlCLElBQUssQ0FDcEMsTUFBTUMsRUFBYXpDLGNBQWMsS0FBTSxDQUFDLDZCQUE4QixDQUNyRTBDLFNBQVUsSUFFTHJDLEVBQU9zQyxPQUFPQyxLQUFLcEIsR0FBV2dCLEdBQzlCSyxFQUFPRixPQUFPRyxPQUFPdEIsR0FBV2dCLEdBRXRDQyxFQUFXTSxRQUFRQyxLQUFPM0MsRUFDMUJvQyxFQUFXUCxZQUFjVyxFQUN6QkosRUFBV1EsTUFBTUMsZUFBcUIsSUFBSlYsRUFBVSxLQUM1Q0QsRUFBU0osT0FBT00sRUFDakIsQ0FXQSxPQVRBSixFQUFpQkgsWUFBY1YsRUFBVUMsR0FFekNXLEVBQVdlLGlCQUFpQixRQUFVQyxJQUNyQzFCLEVBQWlCMkIsS0FBS2pCLEVBQVlnQixFQUFHZixLQUd0Q0QsRUFBV0QsT0FBT0UsRUFBa0JDLEVBQVdDLEdBQy9DdEIsRUFBT2tCLE9BQU9DLEdBRVBuQixVQUlELE1BQU1xQyxnQkFBa0IsRUFDOUJDLE1BQ0NWLE1BQVFXLFFBQU9DLFdBQVVDLGNBQWFDLFVBQ3RDQyxhQUFlQyxXQUFVQyxpQkFHMUIsTUFBTUMsRUFBYy9ELGNBQWMsT0FBUSxDQUFDLFNBQ3JDZ0UsRUFBVWhFLGNBQWMsTUFBTyxDQUFDLFlBQ2hDaUUsRUFBYWpFLGNBQWMsTUFDM0JrRSxFQUFnQmxFLGNBQWMsT0FBUSxDQUFDLGdCQUN2Q21FLEVBQW1CbkUsY0FBYyxPQUFRLENBQUMsbUJBQzFDb0UsRUFBWXBFLGNBQWMsSUFBSyxDQUFDLGVBQ2hDcUUsRUFBT3JFLGNBQWMsT0FBUSxDQUFDLGVBQzlCc0UsRUFBZ0J0RSxjQUNyQixRQUNBLENBQUMsbUJBQW9CLDhCQUNyQixDQUFFdUUsS0FBTSxPQUFRWCxZQUFhQyxJQUV4QlcsRUFBZ0J4RSxjQUNyQixRQUNBLENBQUMsbUJBQW9CLDhCQUNyQixDQUFFdUUsS0FBTSxXQUFZWCxZQUFhRSxJQUU1QlcsRUFBWXpFLGNBQWMsU0FBVSxDQUFDLHFCQUFzQixDQUNoRXVFLEtBQU0sV0FFREcsRUFBYTFFLGNBQWMsT0FBUSxDQUFDLDJCQUVwQzJFLEVBQVczRSxjQUFjLElBQUssQ0FBQyx5QkEyQ3JDLE9BMUNBa0UsRUFBY2hDLFlBQWNzQixFQUM1QlcsRUFBaUJqQyxZQUFjdUIsRUFDL0JXLEVBQVVsQyxZQUFjd0IsRUFDeEJnQixFQUFXeEMsWUFBY3lCLEVBRXpCTSxFQUFXOUIsT0FBTytCLEVBQWVDLEdBQ2pDTSxFQUFVdEMsT0FBT3VDLEdBQ2pCTCxFQUFLbEMsT0FBT21DLEVBQWVFLEVBQWVDLEVBQVdFLEdBRXJEWCxFQUFRN0IsT0FBTzhCLEVBQVlHLEVBQVdDLEdBQ3RDTixFQUFZNUIsT0FBTzZCLEdBRW5CUyxFQUFVdEIsaUJBQWlCLFFBQVVDLElBQ3BDLE1BQU13QixFQUFXeEUsVUFFRHlFLHNCQUNmekIsRUFDQWtCLEVBQ0FFLEVBQ0FNLGFBQWF2QixLQUFLVixLQUFLa0MsY0FDdkJELGFBQWF2QixLQUFLVixLQUFLbUMsYUFDdkJsRSxTQUNBQyxTQUNBNEQsS0FJQUEsRUFBU00sVUFBVUMsT0FBTyxXQUMxQjlCLEVBQUUrQixPQUFPaEQsT0FBT2lELG1CQUNoQmhDLEVBQUUrQixPQUFPRSxVQUFXLEVBRXBCQyxXQUFXLEtBQ1ZsQyxFQUFFK0IsT0FBT0UsVUFBVyxFQUNwQkUsa0JBRUF0RixrQkFBa0IsZUFBZ0I2RSxhQUFjRixHQUNoRDNFLGtCQUFrQixZQUFZLEVBQU0yRSxHQUNwQ1ksT0FBT0MsU0FBUzdELEtBQU8saUJBMUtGLFFBK0tqQm1DLEdBR1IsTUFBTWMsc0JBQXdCLENBQzdCekIsRUFDQWtCLEVBQ0FFLEVBQ0FrQixFQUNBQyxFQUNBOUIsRUFDQUMsRUFDQWEsS0FFQXZCLEVBQUV3QyxpQkFFaUMsS0FBL0J0QixFQUFjdUIsTUFBTUMsUUFBZ0QsS0FBL0J0QixFQUFjcUIsTUFBTUMsUUFDNURuQixFQUFTTSxVQUFVYyxJQUFJLFdBQ3ZCcEIsRUFBU3pDLFlBQWN3RCxFQUNoQkEsR0FFUHBCLEVBQWN1QixNQUFNQyxTQUFXakMsR0FDL0JXLEVBQWNxQixNQUFNQyxTQUFXaEMsR0FFL0JWLEVBQUUrQixPQUFPRSxVQUFXLEVBQ3BCakMsRUFBRStCLE9BQU9oRCxPQUFPaUQsbUJBQ2hCVCxFQUFTTSxVQUFVQyxPQUFPLFdBRTFCSSxXQUFXLEtBQ1ZYLEVBQVNNLFVBQVVjLElBQUksV0FDdkJwQixFQUFTekMsWUFBY3lELEVBRXZCdkMsRUFBRStCLE9BQU9FLFVBQVcsRUFFcEJFLG1CQWhOc0IsS0FrTmhCSSxHQUVBLGFBSUYsTUFBTUssY0FBZ0IsS0FDNUIsTUFBTUMsRUFBY2pHLGNBQWMsTUFBTyxDQUFDLGlCQVcxQyxPQVZBaUcsRUFBWUMsVUFBWSxxbkJBVWpCRCxVQUVELE1BQU1FLGNBQWdCLEtBQzVCLE1BQU1GLEVBQWNHLFNBQVNDLGNBQWMsaUJBQzNDSixHQUFhZixpQkFHUCxNQUFNRSxnQkFBa0IsS0FDOUIsTUFBTWEsRUFBY2pHLGNBQWMsTUFBTyxDQUFDLHVCQVkxQyxPQVhBaUcsRUFBWUMsVUFBWSw2bUJBV2pCRCxVQUVELE1BQU1WLGdCQUFrQixLQUNWYSxTQUFTQyxjQUFjLHVCQUMvQm5CLGlCQUdOLE1BQU1vQixtQkFBcUIsRUFDakNDLFVBQ0MxRCxNQUFRVyxRQUFPZ0Qsa0JBQ2ZwRixNQUFRcUYsZ0JBQWVDLGlCQUFnQkMsbUJBQWtCQyxtQkFFMURDLFlBQ0NoRSxNQUFRaUUsY0FBYUMsbUJBR3RCLE1BQU1uQyxFQUFXeEUsVUFDWDRHLEVBQW1CcEMsR0FBVXFDLGFBRTdCQyxFQUFZZCxTQUFTQyxjQUFjLGNBRXpDYSxFQUFVL0UsT0FBTzZELGlCQUVqQlYsV0FBVyxLQUNWLE1BQU02QixFQUFtQm5ILGNBQWMsT0FBUSxDQUFDLGtCQUMxQ2dFLEVBQVVoRSxjQUFjLE1BQU8sQ0FBQyxZQUNoQ29ILEVBQWdCcEgsY0FBYyxLQUFNLENBQ3pDLGNBQ0EseUJBRUtxSCxFQUFjckgsY0FBYyxNQUFPLENBQUMsdUJBSTFDLEdBRkFvSCxFQUFjbEYsWUFBY3NCLEVBRXhCd0QsR0FBNkQsSUFBekNyRSxPQUFPQyxLQUFLb0UsR0FBa0JNLE9BQ3JELElBQUssTUFBTUMsS0FBT1AsRUFDakJLLEVBQVlsRixPQUNYcUYsY0FDQ2QsRUFDQUMsRUFDQUEsRUFDQUksRUFDQUgsRUFDQVcsRUFDQVAsRUFBaUJPLEtBS3JCRixFQUFZbEYsT0FDWHNGLG9CQUNDaEIsRUFDQUQsRUFDQUUsRUFDQVcsRUFDQVYsRUFDQUEsRUFDQUcsRUFDQUMsRUFDQUgsSUFHRjVDLEVBQVE3QixPQUFPaUYsRUFBZUMsR0FDOUJGLEVBQWlCaEYsT0FBTzZCLEdBRXhCa0QsRUFBVS9FLE9BQU9nRixHQUNqQmhCLGlCQUNFLE1BR0osTUFBTXFCLGNBQWdCLENBQ3JCRSxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUFvQixLQUNwQkMsRUFBc0IsUUFFdEIsTUFBTXBELEVBQVd4RSxVQUNYNkgsRUFBbUJyRCxHQUFVcUMsY0FBZ0IsQ0FBQyxFQUVwRCxHQUFpQixPQUFickMsRUFLSCxPQUpBakUsZUFBZSwrQkFBZ0MsZ0JBQy9DMkUsV0FBVyxLQUNWRSxPQUFPQyxTQUFTeUMsVUE1VUssTUFpVnZCLElBQUlDLEVBQ0FDLEVBQ0FDLEVBRUosTUFBTUMsRUFBUyxDQUFDLFVBQVcsVUFBVyxXQUV0QyxHQUFJUCxFQUFtQixDQUN0QkssRUFBWUwsRUFDWk0sRUFBY0wsRUFFZEcsRUFBUUcsRUFEY0MsU0FBU0gsRUFBVUksTUFBTSxLQUFLQyxPQUNyQixFQUNoQyxLQUFPLENBQ04sR0FBSTlGLE9BQU9DLEtBQUtxRixHQUFrQlgsUUFBVSxFQUFHLE9BRS9DLElBQUlvQixFQUFhLEVBQ2pCLEtBQU9ULEVBQWlCLGdCQUFnQlMsTUFDdkNBLElBR0ROLEVBQVksZ0JBQWdCTSxJQUM1QkwsRUFBYyxpQkFBaUJLLElBQy9CUCxFQUFRRyxFQUFPSSxFQUFhLEVBQzdCLENBRUEsTUFBTUMsRUFBYzNJLGNBQWMsTUFBTyxDQUFDLDJCQUNwQzRJLEVBQWdCNUksY0FBYyxNQUFPLENBQUMsMEJBQ3RDMEcsRUFBaUIxRyxjQUFjLFNBQVUsQ0FBQyxzQkFBdUIsQ0FDdEUsYUFBYzBILEVBQ2QsVUFBV1UsSUFHTlMsRUFBcUI3SSxjQUFjLE1BQU8sQ0FBQyw2QkFDM0M4SSxFQUFrQjlJLGNBQWMsUUFBUyxDQUFDLHVCQUF3QixDQUN2RXVFLEtBQU0sT0FDTndFLFVBQVUsRUFDVmxELE1BQU93QyxJQUVGVyxFQUFhaEosY0FBYyxPQUFRLENBQUMsZ0JBQ3BDaUosRUFBa0JqSixjQUN2QixTQUNBLENBQUMsNEJBQ0QsQ0FBRSxhQUFjMkgsSUFFWHVCLEVBQWdCbEosY0FDckIsU0FDQSxDQUFDLDhCQUNELENBQUUsYUFBYzhILElBRVhxQixFQUFpQm5KLGNBQWMsTUFBTyxDQUFDLDhCQUErQixDQUMzRStCLE1BQU8sS0FDUEMsT0FBUSxLQUNSb0gsUUFBUyxPQUNUbEksSUFBSyxHQUNMWSxJQUFLLHdDQUVBdUgsRUFBbUJySixjQUFjLE1BQU8sQ0FBQyw0QkFBNkIsQ0FDM0UrQixNQUFPLEtBQ1BDLE9BQVEsS0FDUm9ILFFBQVMsT0FDVGxJLElBQUssR0FDTFksSUFBSyx5QkF1Qk4sR0FwQkE0RSxFQUFlUixVQUFZLGtXQU0zQlEsRUFBZXpELE1BQU1xRyxnQkFBa0JuQixFQUV2Q1MsRUFBY3pHLE9BQU91RSxHQUNyQnVDLEVBQWdCOUcsT0FBT2tILEdBQ3ZCSCxFQUFjL0csT0FBT2dILEdBQ3JCTixFQUFtQjFHLE9BQ2xCMkcsRUFDQUUsRUFDQUMsRUFDQUMsR0FFRFAsRUFBWXhHLE9BQU95RyxFQUFlQyxJQUc3QmQsRUFBbUIsQ0FDdkIsTUFBTXdCLEVBQWtCLElBQ3BCdEIsRUFDSEcsQ0FBQ0EsR0FBWUMsR0FFZHBJLGtCQUFrQixlQUFnQnNKLEVBQWlCM0UsRUFDcEQsQ0FnQkEsT0FkQXFFLEVBQWdCOUYsaUJBQWlCLFFBQVVDLElBQzFDb0csYUFBYXBHLEVBQUd5RixFQUFvQmpCLEVBQWFDLEtBRWxEcUIsRUFBYy9GLGlCQUFpQixRQUFVQyxJQUN4Q3FHLFdBQVdyRyxLQUdaMEYsRUFBZ0IzRixpQkFBaUIsVUFBWUMsSUFDOUIsVUFBVkEsRUFBRW1FLEtBQ0xtQyxhQUFhdEcsRUFBR3lFLEtBSWxCYyxFQUFZMUQsVUFBVWMsSUFBSSxXQUNuQjRDLEdBR0ZsQixvQkFBc0IsQ0FDM0JDLEVBQ0FpQyxFQUNBQyxFQUNBdkMsRUFDQU0sRUFDQUMsRUFDQWlDLEVBQ0FoQyxFQUNBQyxLQUVBLE1BQU1nQyxFQUFnQjlKLGNBQWMsTUFBTyxDQUFDLCtCQUN0QytKLEVBQW1CL0osY0FBYyxNQUFPLENBQUMsMEJBQ3pDeUcsRUFBZ0J6RyxjQUNyQixTQUNBLENBQUMscUJBQXNCLG1DQUN2QixDQUFFLGFBQWMwSCxJQUVYc0MsRUFBcUJoSyxjQUFjLE1BQU8sQ0FBQywwQkFBMkIsQ0FDM0U4QixJQUFLLDhCQUNMc0gsUUFBUyxPQUNUbEksSUFBSyxLQUVBc0YsRUFBaUJ4RyxjQUFjLE9BQVEsQ0FBQyx3QkE4QjlDLE9BNUJBd0csRUFBZXRFLFlBQWN5SCxFQUU3QmxELEVBQWN0RSxPQUFPNkgsR0FDckJELEVBQWlCNUgsT0FBT3NFLEdBQ3hCcUQsRUFBYzNILE9BQU80SCxFQUFrQnZELEdBRXZDQyxFQUFjdEQsaUJBQWlCLFFBQVMsS0FDdkMsTUFBTXlCLEVBQVd4RSxVQUNYNkgsRUFBbUJyRCxHQUFVcUMsY0FBZ0IsQ0FBQyxFQUVwRCxHQUFJdEUsT0FBT0MsS0FBS3FGLEdBQWtCWCxRQUFVLEVBRTNDLFlBREEzRyxlQUFla0osRUFBa0IsV0FJbEMsTUFBTUksRUFBVXpDLGNBQ2ZvQyxFQUNBakMsRUFDQUMsRUFDQUMsRUFDQUMsR0FHR21DLEdBQ0g1QyxFQUFZNkMsYUFBYUQsRUFBU0gsS0FJN0JBLEdBR0ZOLGFBQWUsQ0FBQ3BHLEVBQUcrRyxFQUFRdkMsRUFBYUMsS0FDN0N1QyxvQkFBb0JoSCxHQUVwQixNQUFNaUgsRUFBVWpILEVBQUUrQixPQUNabUYsRUFBYUQsRUFDakJFLFFBQVEsMkJBQ1JsRSxjQUFjLHdCQUVWbUUsRUFBVUMsY0FBYzdDLEdBRTlCeUMsRUFBUXBGLFVBQVVjLElBQUksVUFDdEJ5RSxFQUFRdkYsVUFBVUMsT0FBTyxVQUV6QmlGLEVBQU9oSSxPQUFPcUksR0FFZEYsRUFBV0ksUUFDWEosRUFBV0ssU0FDWEwsRUFBV00sZ0JBQWdCLFlBQzNCTixFQUFXckYsVUFBVWMsSUFBSSxXQUV6QnlFLEVBQVFySCxpQkFBaUIsUUFBVUMsSUFDbENzRyxhQUFhdEcsRUFBR3lFLE1BSVo2QixhQUFlLENBQUN0RyxFQUFHeUUsS0FDeEIsTUFBTWpELEVBQVd4RSxVQUNYNkgsRUFBbUJyRCxHQUFVcUMsY0FBZ0IsR0FHN0M0RCxFQURVekgsRUFBRStCLE9BQ2FvRixRQUFRLDJCQUNqQ08sRUFBbUJELEVBQWV4RSxjQUFjLHVCQUNwRHRELFFBQVFnSSxHQUNKQyxFQUFxQkgsRUFBZXhFLGNBQ3pDLHdCQUdLNEUsRUFBYzdFLFNBQVM4RSxpQkFBaUIsNkJBSTlDLEdBRkFELEVBQVlFLFFBQVNDLEdBQVFBLEVBQUlSLGdCQUFnQixhQUVULEtBQXBDSSxFQUFtQm5GLE1BQU1DLE9BRTVCLE9BREFtRixFQUFZRSxRQUFTQyxHQUFRQSxFQUFJQyxhQUFhLFlBQVksSUFDbkQxSyxlQUFla0gsRUFBaUIsV0FHeEMsTUFBTTBCLEVBQWtCLElBQ3BCdEIsRUFDSDZDLENBQUNBLEdBQW1CRSxFQUFtQm5GLE9BRXhDNUYsa0JBQWtCLGVBQWdCc0osRUFBaUIzRSxHQUVuRHdGLG9CQUFvQmhILElBR2ZxSCxjQUFpQjdDLElBQ3RCLE1BQU0wRCxFQUFrQnRMLGNBQ3ZCLFNBQ0EsQ0FBQywyQkFBNEIsVUFDN0IsQ0FBRSxhQUFjNEgsSUFFWDJELEVBQW1CdkwsY0FBYyxNQUFPLENBQUMsNEJBQTZCLENBQzNFK0IsTUFBTyxLQUNQQyxPQUFRLEtBQ1JvSCxRQUFTLE9BQ1RsSSxJQUFLLEdBQ0xZLElBQUsseUJBS04sT0FGQXdKLEVBQWdCbkosT0FBT29KLEdBRWhCRCxHQUdGbEIsb0JBQXVCaEgsSUFDNUIsTUFBTW9JLEVBQWVwRixTQUFTOEUsaUJBQWlCLFlBQ3pDTyxFQUFjckYsU0FBUzhFLGlCQUFpQiw2QkFDeENELEVBQWM3RSxTQUFTOEUsaUJBQWlCLDZCQUU5Q00sRUFBYUwsUUFBU08sSUFDckJBLEVBQUdMLGFBQWEsWUFBWSxHQUM1QkssRUFBR3pHLFVBQVVDLE9BQU8sV0FDcEJ3RyxFQUFHQyxTQUVKRixFQUFZTixRQUFTQyxHQUFRQSxFQUFJbkcsVUFBVWMsSUFBSSxXQUMvQ2tGLEVBQVlFLFFBQVNDLEdBQVFBLEVBQUluRyxVQUFVQyxPQUFPLFlBR25ELElBQUkwRyxjQUFlLEVBQ25CLE1BQU1qTCxlQUFpQixDQUFDa0MsRUFBTXNGLEtBQzdCLEdBQUl5RCxhQUFjLE9BQ2xCQSxjQUFlLEVBRWYsTUFBTUMsRUFBT3pGLFNBQVMwRixnQkFDaEI1RSxFQUFZZCxTQUFTQyxjQUFjLGNBRW5DMEYsRUFBUS9MLGNBQWMsTUFBTyxDQUFDLGdCQUM5QmdNLEVBQWFoTSxjQUFjLElBQUssQ0FBQyxzQkFFdkNnTSxFQUFXOUosWUFBY1csRUFDekJnSixFQUFLNUksTUFBTWdKLFlBQVksa0JBQW1COUQsR0FFMUM0RCxFQUFNNUosT0FBTzZKLEdBQ2I5RSxFQUFVL0UsT0FBTzRKLEdBRWpCekcsV0FBVyxLQUNWeUcsRUFBTTlHLFVBQVVjLElBQUksV0FDbEIsS0FDSFQsV0FBVyxLQUNWeUcsRUFBTTdHLFNBQ04wRyxjQUFlLEdBbm1CTyxPQXVtQmxCbkMsV0FBY3JHLElBQ25CLE1BQU13QixFQUFXeEUsVUFDWDZHLEVBQWVyQyxHQUFVcUMsYUFDekJnRSxFQUFjN0UsU0FBUzhFLGlCQUFpQiw2QkFHeENMLEVBRFl6SCxFQUFFK0IsT0FDYW9GLFFBQVEsMkJBQ25DMkIsRUFBb0JyQixFQUFleEUsY0FBYyx1QkFDdkQ0RSxFQUFZRSxRQUFTQyxHQUFRQSxFQUFJUixnQkFBZ0Isb0JBRTFDM0QsRUFBYWlGLEVBQWtCbkosUUFBUWdJLElBRTlDOUssa0JBQWtCLGVBQWdCZ0gsRUFBY3JDLEdBRWhEaUcsRUFBZTVGLFVBQVVjLElBQUksVUFFN0JULFdBQVcsS0FDVnVGLEVBQWUzRixVQUNiIiwiaWdub3JlTGlzdCI6W10sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUVsZW1lbnQgfSBmcm9tIFwiLi9oZWxwZXJzLm1pbi5qc1wiO1xyXG5pbXBvcnQgeyBzZXRVc2VyUHJlZmVyZW5jZSB9IGZyb20gXCIuL3VwZGF0ZVN0YXRlRnVuY3Rpb25zLm1pbi5qc1wiO1xyXG5jb25zdCBISURFX0xPQURFUl9USU1FID0gMzAwMDtcclxuY29uc3QgSElERV9QT1BVUF9USU1FID0gMjUwMDtcclxuY29uc3QgZ2V0RGF0YSA9ICgpID0+IHtcclxuXHR0cnkge1xyXG5cdFx0Y29uc3QgZGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidXNlckRhdGFcIik7XHJcblxyXG5cdFx0aWYgKCFkYXRhKSByZXR1cm4gbnVsbDtcclxuXHJcblx0XHRjb25zdCBwYXJzZWREYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcclxuXHJcblx0XHRpZiAodHlwZW9mIHBhcnNlZERhdGEgIT09IFwib2JqZWN0XCIgfHwgcGFyc2VkRGF0YSA9PT0gbnVsbCkge1xyXG5cdFx0XHRzaG93RXJyb3JQb3B1cChcIkFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWRcIiwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOaWVwcmF3aWTFgm93YSBzdHJ1a3R1cmEgZGFueWNoXCIpO1xyXG5cdFx0XHQvLyBwcnp5cGFkZWsga2llZHkgdcW8eXRrb3duaWsgdXN1bmllIGRhbmUgeiBsb2NhbCBzdG9yYWdlLCBsdWIgamXFm2xpIHogamFraWVnb8WbIHBvd29kdSB6YW1pYXN0IG9iaWVrdHUgcG9qYXdpIHNpxJkgdGFtIGNva29sd2llayBpbm5lZ29cclxuXHRcdH1cclxuXHRcdHJldHVybiBwYXJzZWREYXRhO1xyXG5cdH0gY2F0Y2gge1xyXG5cdFx0bG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ1c2VyRGF0YVwiKTsgLy8gcG93aW5ubyBzacSZIGN6ecWbY2nEhyB1c3prb2R6b25lIGRhbmUhXHJcblx0XHRyZXR1cm4ge307XHJcblx0fVxyXG59O1xyXG5cclxuLy8gREVNTyBPTkxZIC0gTmV2ZXIgaGFyZGNvZGUgY3JlZGVudGlhbHMgaW4gcHJvZHVjdGlvbiFcclxuY29uc3QgVVNFUk5BTUUgPSBcImhhbmRzb21lVXNlcjQwNFwiO1xyXG5jb25zdCBQQVNTV09SRCA9IFwiNWprc0g5ZC5cIjtcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVMb2dpbkhlYWRlciA9IChcclxuXHR7XHJcblx0XHRoZWFkZXI6IHtcclxuXHRcdFx0YWx0OiB7IGxvZ28gfSxcclxuXHRcdFx0YXJpYTogeyBsb2dvTGluaywgY2hhbmdlTGFuZ3VhZ2VCdXR0b24gfSxcclxuXHRcdH0sXHJcblx0fSxcclxuXHRsYW5nQW1vdW50LFxyXG5cdGxhbmdOYW1lcyxcclxuXHRsYW5ndWFnZSxcclxuXHRoYW5kbGVMYW5nU2VsZWN0XHJcbikgPT4ge1xyXG5cdC8vIGxvZ29cclxuXHRjb25zdCBoZWFkZXIgPSBjcmVhdGVFbGVtZW50KFwiaGVhZGVyXCIsIFtcImhlYWRlclwiXSk7XHJcblx0Y29uc3QgcGFnZUxvZ28gPSBjcmVhdGVFbGVtZW50KFwiYVwiLCBbXCJoZWFkZXJfX2xvZ29cIiwgXCJsb2dpbi1oZWFkZXJfX2xvZ29cIl0sIHtcclxuXHRcdGhyZWY6IFwiL1wiLFxyXG5cdFx0XCJhcmlhLWxhYmVsXCI6IGAke2xvZ29MaW5rfWAsXHJcblx0fSk7XHJcblx0Y29uc3QgbG9nb0ltZyA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImltZ1wiLFxyXG5cdFx0W1wiaGVhZGVyX19sb2dvLWltZ1wiLCBcImxvZ2luLWhlYWRlcl9fbG9nby1pbWdcIl0sXHJcblx0XHR7XHJcblx0XHRcdHNyYzogXCIuL3NyYy9pY29ucy9sb2dvLnN2Z1wiLFxyXG5cdFx0XHRhbHQ6IGAke2xvZ299YCxcclxuXHRcdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdFx0aGVpZ2h0OiBcIjI0XCIsXHJcblx0XHR9XHJcblx0KTtcclxuXHRjb25zdCBsb2dvVGV4dCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcclxuXHRcdFwiaGVhZGVyX19sb2dvLXRleHRcIixcclxuXHRcdFwibG9naW4taGVhZGVyX19sb2dvLXRleHRcIixcclxuXHRdKTtcclxuXHRsb2dvVGV4dC50ZXh0Q29udGVudCA9IFwiU3RyZWFtXCI7XHJcblx0cGFnZUxvZ28uYXBwZW5kKGxvZ29JbWcsIGxvZ29UZXh0KTtcclxuXHRoZWFkZXIuYXBwZW5kKHBhZ2VMb2dvKTtcclxuXHQvLyBlbmQgb2YgbG9nb1xyXG5cclxuXHQvLyBsYW5ndWFnZSBzZWxlY3RvclxyXG5cdGNvbnN0IGxhbmdTZWxlY3QgPSBjcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIFtcImxvZ2luLWhlYWRlcl9fbGFuZy1zZWxlY3RcIl0sIHtcclxuXHRcdFwiYXJpYS1sYWJlbFwiOiBgJHtjaGFuZ2VMYW5ndWFnZUJ1dHRvbn1gLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGxhbmdQbGF0Zm9ybUxhbmcgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXHJcblx0XHRcImxvZ2luLWhlYWRlcl9fbGFuZy1wbGF0Zm9ybS1sYW5nXCIsXHJcblx0XSk7XHJcblx0Y29uc3QgbGFuZ0Fycm93ID0gY3JlYXRlRWxlbWVudChcImltZ1wiLCBbXCJsb2dpbi1oZWFkZXJfX2xhbmctYXJyb3dcIl0sIHtcclxuXHRcdHNyYzogXCIuL3NyYy9pY29ucy9jaGV2cm9uLWRvd24uc3ZnXCIsXHJcblx0XHRhbHQ6IFwiXCIsXHJcblx0XHR3aWR0aDogXCIyNFwiLFxyXG5cdFx0aGVpZ2h0OiBcIjI0XCIsXHJcblx0fSk7XHJcblx0Y29uc3QgbGFuZ0xpc3QgPSBjcmVhdGVFbGVtZW50KFwidWxcIiwgW1wibG9naW4taGVhZGVyX19sYW5nLWxpc3RcIl0pO1xyXG5cclxuXHRmb3IgKGxldCBpID0gMDsgaSA8IGxhbmdBbW91bnQ7IGkrKykge1xyXG5cdFx0Y29uc3QgbGFuZ0Nob2ljZSA9IGNyZWF0ZUVsZW1lbnQoXCJsaVwiLCBbXCJsb2dpbi1oZWFkZXJfX2xhbmctY2hvaWNlXCJdLCB7XHJcblx0XHRcdHRhYmluZGV4OiAwLFxyXG5cdFx0fSk7XHJcblx0XHRjb25zdCBkYXRhID0gT2JqZWN0LmtleXMobGFuZ05hbWVzKVtpXTtcclxuXHRcdGNvbnN0IHRleHQgPSBPYmplY3QudmFsdWVzKGxhbmdOYW1lcylbaV07XHJcblxyXG5cdFx0bGFuZ0Nob2ljZS5kYXRhc2V0LmxhbmcgPSBkYXRhO1xyXG5cdFx0bGFuZ0Nob2ljZS50ZXh0Q29udGVudCA9IHRleHQ7XHJcblx0XHRsYW5nQ2hvaWNlLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gaSAqIDEwMCArIFwibXNcIjtcclxuXHRcdGxhbmdMaXN0LmFwcGVuZChsYW5nQ2hvaWNlKTtcclxuXHR9XHJcblxyXG5cdGxhbmdQbGF0Zm9ybUxhbmcudGV4dENvbnRlbnQgPSBsYW5nTmFtZXNbbGFuZ3VhZ2VdO1xyXG5cclxuXHRsYW5nU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0aGFuZGxlTGFuZ1NlbGVjdC5jYWxsKGxhbmdTZWxlY3QsIGUsIGxhbmdQbGF0Zm9ybUxhbmcpO1xyXG5cdH0pO1xyXG5cclxuXHRsYW5nU2VsZWN0LmFwcGVuZChsYW5nUGxhdGZvcm1MYW5nLCBsYW5nQXJyb3csIGxhbmdMaXN0KTtcclxuXHRoZWFkZXIuYXBwZW5kKGxhbmdTZWxlY3QpO1xyXG5cclxuXHRyZXR1cm4gaGVhZGVyO1xyXG5cdC8vIGVuZCBvZiBsYW5ndWFnZSBzZWxlY3RvclxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZUxvZ2luUGFnZSA9ICh7XHJcblx0bWFpbjoge1xyXG5cdFx0dGV4dDogeyB0aXRsZSwgc3VidGl0bGUsIGRlc2NyaXB0aW9uLCBidXR0b24gfSxcclxuXHRcdHBsYWNlaG9sZGVyOiB7IHVzZXJuYW1lLCBwYXNzd29yZCB9LFxyXG5cdH0sXHJcbn0pID0+IHtcclxuXHRjb25zdCBtYWluQ29udGVudCA9IGNyZWF0ZUVsZW1lbnQoXCJtYWluXCIsIFtcIm1haW5cIl0pO1xyXG5cdGNvbnN0IHdyYXBwZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIndyYXBwZXJcIl0pO1xyXG5cdGNvbnN0IGxvZ2luVGl0bGUgPSBjcmVhdGVFbGVtZW50KFwiaDFcIik7XHJcblx0Y29uc3QgbG9naW5UaXRsZVRvcCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW5fX3RpdGxlXCJdKTtcclxuXHRjb25zdCBsb2dpblRpdGxlQm90dG9tID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1wibWFpbl9fc3VidGl0bGVcIl0pO1xyXG5cdGNvbnN0IGxvZ2luVGV4dCA9IGNyZWF0ZUVsZW1lbnQoXCJwXCIsIFtcIm1haW5fX3RleHRcIl0pO1xyXG5cdGNvbnN0IGZvcm0gPSBjcmVhdGVFbGVtZW50KFwiZm9ybVwiLCBbXCJtYWluX19mb3JtXCJdKTtcclxuXHRjb25zdCB1c2VybmFtZUlucHV0ID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiaW5wdXRcIixcclxuXHRcdFtcIm1haW5fX2Zvcm0taW5wdXRcIiwgXCJtYWluX19mb3JtLWlucHV0LS11c2VybmFtZVwiXSxcclxuXHRcdHsgdHlwZTogXCJ0ZXh0XCIsIHBsYWNlaG9sZGVyOiB1c2VybmFtZSB9XHJcblx0KTtcclxuXHRjb25zdCBwYXNzd29yZElucHV0ID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiaW5wdXRcIixcclxuXHRcdFtcIm1haW5fX2Zvcm0taW5wdXRcIiwgXCJtYWluX19mb3JtLWlucHV0LS1wYXNzd29yZFwiXSxcclxuXHRcdHsgdHlwZTogXCJwYXNzd29yZFwiLCBwbGFjZWhvbGRlcjogcGFzc3dvcmQgfVxyXG5cdCk7XHJcblx0Y29uc3Qgc3VibWl0QnRuID0gY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCBbXCJtYWluX19mb3JtLWJ1dHRvblwiXSwge1xyXG5cdFx0dHlwZTogXCJzdWJtaXRcIixcclxuXHR9KTtcclxuXHRjb25zdCBidXR0b25UZXh0ID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1wibWFpbl9fZm9ybS1idXR0b24tdGV4dFwiXSk7XHJcblxyXG5cdGNvbnN0IGVycm9yVHh0ID0gY3JlYXRlRWxlbWVudChcInBcIiwgW1wibWFpbl9fZm9ybS1lcnJvci10eHRcIl0pO1xyXG5cdGxvZ2luVGl0bGVUb3AudGV4dENvbnRlbnQgPSB0aXRsZTtcclxuXHRsb2dpblRpdGxlQm90dG9tLnRleHRDb250ZW50ID0gc3VidGl0bGU7XHJcblx0bG9naW5UZXh0LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcblx0YnV0dG9uVGV4dC50ZXh0Q29udGVudCA9IGJ1dHRvbjtcclxuXHJcblx0bG9naW5UaXRsZS5hcHBlbmQobG9naW5UaXRsZVRvcCwgbG9naW5UaXRsZUJvdHRvbSk7XHJcblx0c3VibWl0QnRuLmFwcGVuZChidXR0b25UZXh0KTtcclxuXHRmb3JtLmFwcGVuZCh1c2VybmFtZUlucHV0LCBwYXNzd29yZElucHV0LCBzdWJtaXRCdG4sIGVycm9yVHh0KTtcclxuXHJcblx0d3JhcHBlci5hcHBlbmQobG9naW5UaXRsZSwgbG9naW5UZXh0LCBmb3JtKTtcclxuXHRtYWluQ29udGVudC5hcHBlbmQod3JhcHBlcik7XHJcblxyXG5cdHN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdGNvbnN0IHVzZXJEYXRhID0gZ2V0RGF0YSgpO1xyXG5cclxuXHRcdGNvbnN0IHJlc3VsdHMgPSBoYW5kbGVMb2dpblZhbGlkYXRpb24oXHJcblx0XHRcdGUsXHJcblx0XHRcdHVzZXJuYW1lSW5wdXQsXHJcblx0XHRcdHBhc3N3b3JkSW5wdXQsXHJcblx0XHRcdHRyYW5zbGF0aW9ucy5tYWluLnRleHQuZXJyb3JSZXF1aXJlZCxcclxuXHRcdFx0dHJhbnNsYXRpb25zLm1haW4udGV4dC5lcnJvckludmFsaWQsXHJcblx0XHRcdFVTRVJOQU1FLFxyXG5cdFx0XHRQQVNTV09SRCxcclxuXHRcdFx0ZXJyb3JUeHRcclxuXHRcdCk7XHJcblxyXG5cdFx0aWYgKCFyZXN1bHRzKSB7XHJcblx0XHRcdGVycm9yVHh0LmNsYXNzTGlzdC5yZW1vdmUoXCJ2aXNpYmxlXCIpO1xyXG5cdFx0XHRlLnRhcmdldC5hcHBlbmQoc2hvd1NtYWxsTG9hZGVyKCkpO1xyXG5cdFx0XHRlLnRhcmdldC5kaXNhYmxlZCA9IHRydWU7XHJcblxyXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0XHRlLnRhcmdldC5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdGhpZGVTbWFsbExvYWRlcigpO1xyXG5cclxuXHRcdFx0XHRzZXRVc2VyUHJlZmVyZW5jZShcInRyYW5zbGF0aW9uc1wiLCB0cmFuc2xhdGlvbnMsIHVzZXJEYXRhKTtcclxuXHRcdFx0XHRzZXRVc2VyUHJlZmVyZW5jZShcImxvZ2dlZEluXCIsIHRydWUsIHVzZXJEYXRhKTtcclxuXHRcdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwicHJvZmlsZXMuaHRtbFwiOyAvLyBwcnplasWbY2llIG5hIHN0cm9uxJkgeiBwcm9maWxhbWlcclxuXHRcdFx0fSwgSElERV9MT0FERVJfVElNRSk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHJldHVybiBtYWluQ29udGVudDtcclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZUxvZ2luVmFsaWRhdGlvbiA9IChcclxuXHRlLFxyXG5cdHVzZXJuYW1lSW5wdXQsXHJcblx0cGFzc3dvcmRJbnB1dCxcclxuXHRyZXF1aXJlRXJyb3IsXHJcblx0aW52YWxpZEVycm9yLFxyXG5cdHVzZXJuYW1lLFxyXG5cdHBhc3N3b3JkLFxyXG5cdGVycm9yVHh0XHJcbikgPT4ge1xyXG5cdGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcblx0aWYgKHVzZXJuYW1lSW5wdXQudmFsdWUudHJpbSgpID09PSBcIlwiIHx8IHBhc3N3b3JkSW5wdXQudmFsdWUudHJpbSgpID09PSBcIlwiKSB7XHJcblx0XHRlcnJvclR4dC5jbGFzc0xpc3QuYWRkKFwidmlzaWJsZVwiKTtcclxuXHRcdGVycm9yVHh0LnRleHRDb250ZW50ID0gcmVxdWlyZUVycm9yO1xyXG5cdFx0cmV0dXJuIHJlcXVpcmVFcnJvcjtcclxuXHR9IGVsc2UgaWYgKFxyXG5cdFx0dXNlcm5hbWVJbnB1dC52YWx1ZS50cmltKCkgIT09IHVzZXJuYW1lIHx8XHJcblx0XHRwYXNzd29yZElucHV0LnZhbHVlLnRyaW0oKSAhPT0gcGFzc3dvcmRcclxuXHQpIHtcclxuXHRcdGUudGFyZ2V0LmRpc2FibGVkID0gdHJ1ZTtcclxuXHRcdGUudGFyZ2V0LmFwcGVuZChzaG93U21hbGxMb2FkZXIoKSk7XHJcblx0XHRlcnJvclR4dC5jbGFzc0xpc3QucmVtb3ZlKFwidmlzaWJsZVwiKTtcclxuXHJcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LmFkZChcInZpc2libGVcIik7XHJcblx0XHRcdGVycm9yVHh0LnRleHRDb250ZW50ID0gaW52YWxpZEVycm9yO1xyXG5cclxuXHRcdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHJcblx0XHRcdGhpZGVTbWFsbExvYWRlcigpO1xyXG5cdFx0fSwgSElERV9MT0FERVJfVElNRSk7XHJcblx0XHRyZXR1cm4gaW52YWxpZEVycm9yO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc2hvd0JpZ0xvYWRlciA9ICgpID0+IHtcclxuXHRjb25zdCBsb2FkaW5nQXJlYSA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibG9hZGluZy1hcmVhXCJdKTtcclxuXHRsb2FkaW5nQXJlYS5pbm5lckhUTUwgPSBgICAgICAgICAgICAgPHN2ZyBjbGFzcz1cImxvYWRlci1iaWdcIiB2aWV3Qm94PVwiMCAwIDEyMCAxMjBcIiB3aWR0aD1cIjEyMFwiIGhlaWdodD1cIjEyMFwiPlxyXG4gICAgICAgICAgICAgICAgPGRlZnM+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxpbmVhckdyYWRpZW50IGlkPVwibG9hZGVyLWFjY2VudFwiIHgxPVwiMCVcIiB5MT1cIjAlXCIgeDI9XCIxMDAlXCIgeTI9XCIwJVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIwJVwiIHN0b3AtY29sb3I9XCIjNGRhOGRhXCIgc3RvcC1vcGFjaXR5PVwiMC44XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiNzAlXCIgc3RvcC1jb2xvcj1cIiM0ZGE4ZGFcIiBzdG9wLW9wYWNpdHk9XCIwLjRcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIxMDAlXCIgc3RvcC1jb2xvcj1cIiM0ZGE4ZGFcIiBzdG9wLW9wYWNpdHk9XCIwXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICA8L2xpbmVhckdyYWRpZW50PlxyXG4gICAgICAgICAgICAgICAgPC9kZWZzPlxyXG4gICAgICAgICAgICAgICAgPGNpcmNsZSBjbGFzcz1cImxvYWRpbmctY2lyY2xlLWJpZ1wiIHI9XCIzNVwiIGN4PVwiNjBcIiBjeT1cIjYwXCI+PC9jaXJjbGU+XHJcbiAgICAgICAgICAgIDwvc3ZnPmA7XHJcblx0cmV0dXJuIGxvYWRpbmdBcmVhO1xyXG59O1xyXG5leHBvcnQgY29uc3QgaGlkZUJpZ0xvYWRlciA9ICgpID0+IHtcclxuXHRjb25zdCBsb2FkaW5nQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubG9hZGluZy1hcmVhXCIpO1xyXG5cdGxvYWRpbmdBcmVhPy5yZW1vdmUoKTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzaG93U21hbGxMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcImxvYWRpbmctYXJlYS1zbWFsbFwiXSk7XHJcblx0bG9hZGluZ0FyZWEuaW5uZXJIVE1MID0gYDxzdmcgY2xhc3M9XCJsb2FkZXItc21hbGxcIiB2aWV3Qm94PVwiMCAwIDEyMCAxMjBcIiB3aWR0aD1cIjEyMFwiIGhlaWdodD1cIjEyMFwiPlxyXG4gICAgICAgICAgICAgICAgPGRlZnM+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxpbmVhckdyYWRpZW50IGlkPVwibG9hZGVyLWFjY2VudC1zbWFsbFwiIHgxPVwiMCVcIiB5MT1cIjAlXCIgeDI9XCIxMDAlXCIgeTI9XCIwJVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIwJVwiIHN0b3AtY29sb3I9XCJ3aGl0ZVwiIHN0b3Atb3BhY2l0eT1cIjAuOFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjcwJVwiIHN0b3AtY29sb3I9XCJ3aGl0ZVwiIHN0b3Atb3BhY2l0eT1cIjAuM1wiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjEwMCVcIiBzdG9wLWNvbG9yPVwid2hpdGVcIiBzdG9wLW9wYWNpdHk9XCIwXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICA8L2xpbmVhckdyYWRpZW50PlxyXG4gICAgICAgICAgICAgICAgPC9kZWZzPlxyXG4gICAgICAgICAgICAgICAgPGNpcmNsZSBjbGFzcz1cImxvYWRpbmctY2lyY2xlLXNtYWxsXCIgcj1cIjEyXCIgY3g9XCI2MFwiIGN5PVwiNjBcIj48L2NpcmNsZT5cclxuICAgICAgICAgICAgPC9zdmc+YDtcclxuXHJcblx0cmV0dXJuIGxvYWRpbmdBcmVhO1xyXG59O1xyXG5leHBvcnQgY29uc3QgaGlkZVNtYWxsTG9hZGVyID0gKCkgPT4ge1xyXG5cdGNvbnN0IGxvYWRpbmdBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5sb2FkaW5nLWFyZWEtc21hbGxcIik7XHJcblx0bG9hZGluZ0FyZWEucmVtb3ZlKCk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlUHJvZmlsZXNQYWdlID0gKHtcclxuXHRwcm9maWxlczoge1xyXG5cdFx0dGV4dDogeyB0aXRsZSwgYWRkUHJvZmlsZUluZm8gfSxcclxuXHRcdGFyaWE6IHsgYWRkUHJvZmlsZUJ0biwgdXNlclByb2ZpbGVCdG4sIHVzZXJCdG5DdXN0b21pemUsIHJlbW92ZVVzZXJJbmZvIH0sXHJcblx0fSxcclxuXHRlcnJvclBvcHVwOiB7XHJcblx0XHR0ZXh0OiB7IG1heFByb2ZpbGVzLCBlbXB0eUZpZWxkIH0sXHJcblx0fSxcclxufSkgPT4ge1xyXG5cdGNvbnN0IHVzZXJEYXRhID0gZ2V0RGF0YSgpO1xyXG5cdGNvbnN0IHVzZXJQcm9maWxlc0xpc3QgPSB1c2VyRGF0YT8udXNlclByb2ZpbGVzO1xyXG5cclxuXHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhaW5lclwiKTtcclxuXHJcblx0Y29udGFpbmVyLmFwcGVuZChzaG93QmlnTG9hZGVyKCkpO1xyXG5cclxuXHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdGNvbnN0IHByb2ZpbGVzUGFnZU1haW4gPSBjcmVhdGVFbGVtZW50KFwibWFpblwiLCBbXCJtYWluLXByb2ZpbGVzXCJdKTtcclxuXHRcdGNvbnN0IHdyYXBwZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIndyYXBwZXJcIl0pO1xyXG5cdFx0Y29uc3QgcHJvZmlsZXNUaXRsZSA9IGNyZWF0ZUVsZW1lbnQoXCJoMVwiLCBbXHJcblx0XHRcdFwibWFpbl9fdGl0bGVcIixcclxuXHRcdFx0XCJtYWluLXByb2ZpbGVzX190aXRsZVwiLFxyXG5cdFx0XSk7XHJcblx0XHRjb25zdCBwcm9maWxlc0JveCA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fYm94XCJdKTtcclxuXHJcblx0XHRwcm9maWxlc1RpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XHJcblxyXG5cdFx0aWYgKHVzZXJQcm9maWxlc0xpc3QgJiYgT2JqZWN0LmtleXModXNlclByb2ZpbGVzTGlzdCkubGVuZ3RoICE9PSAwKSB7XHJcblx0XHRcdGZvciAoY29uc3Qga2V5IGluIHVzZXJQcm9maWxlc0xpc3QpIHtcclxuXHRcdFx0XHRwcm9maWxlc0JveC5hcHBlbmQoXHJcblx0XHRcdFx0XHRjcmVhdGVQcm9maWxlKFxyXG5cdFx0XHRcdFx0XHR1c2VyUHJvZmlsZUJ0bixcclxuXHRcdFx0XHRcdFx0dXNlckJ0bkN1c3RvbWl6ZSxcclxuXHRcdFx0XHRcdFx0dXNlckJ0bkN1c3RvbWl6ZSxcclxuXHRcdFx0XHRcdFx0ZW1wdHlGaWVsZCxcclxuXHRcdFx0XHRcdFx0cmVtb3ZlVXNlckluZm8sXHJcblx0XHRcdFx0XHRcdGtleSxcclxuXHRcdFx0XHRcdFx0dXNlclByb2ZpbGVzTGlzdFtrZXldXHJcblx0XHRcdFx0XHQpXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cHJvZmlsZXNCb3guYXBwZW5kKFxyXG5cdFx0XHRjcmVhdGVQcm9maWxlQWRkQnRuKFxyXG5cdFx0XHRcdGFkZFByb2ZpbGVCdG4sXHJcblx0XHRcdFx0YWRkUHJvZmlsZUluZm8sXHJcblx0XHRcdFx0dXNlclByb2ZpbGVCdG4sXHJcblx0XHRcdFx0cHJvZmlsZXNCb3gsXHJcblx0XHRcdFx0dXNlckJ0bkN1c3RvbWl6ZSxcclxuXHRcdFx0XHR1c2VyQnRuQ3VzdG9taXplLFxyXG5cdFx0XHRcdG1heFByb2ZpbGVzLFxyXG5cdFx0XHRcdGVtcHR5RmllbGQsXHJcblx0XHRcdFx0cmVtb3ZlVXNlckluZm9cclxuXHRcdFx0KVxyXG5cdFx0KTtcclxuXHRcdHdyYXBwZXIuYXBwZW5kKHByb2ZpbGVzVGl0bGUsIHByb2ZpbGVzQm94KTtcclxuXHRcdHByb2ZpbGVzUGFnZU1haW4uYXBwZW5kKHdyYXBwZXIpO1xyXG5cclxuXHRcdGNvbnRhaW5lci5hcHBlbmQocHJvZmlsZXNQYWdlTWFpbik7XHJcblx0XHRoaWRlQmlnTG9hZGVyKCk7XHJcblx0fSwgNTAwKTtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZVByb2ZpbGUgPSAoXHJcblx0YXJpYUluZm8sXHJcblx0dXNlckJ0bkluZm8sXHJcblx0c2F2ZUJ0bkFyaWEsXHJcblx0ZW1wdHlGaWVsZEVycm9yLFxyXG5cdHJlbW92ZUFyaWEsXHJcblx0ZXhpc3RpbmdQcm9maWxlSWQgPSBudWxsLFxyXG5cdGV4aXN0aW5nUHJvZmlsZU5hbWUgPSBudWxsXHJcbikgPT4ge1xyXG5cdGNvbnN0IHVzZXJEYXRhID0gZ2V0RGF0YSgpO1xyXG5cdGNvbnN0IGV4aXN0aW5nUHJvZmlsZXMgPSB1c2VyRGF0YT8udXNlclByb2ZpbGVzIHx8IHt9O1xyXG5cclxuXHRpZiAodXNlckRhdGEgPT09IG51bGwpIHtcclxuXHRcdHNob3dFcnJvclBvcHVwKFwiQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZFwiLCBcIiNkYzRhMzRcIik7XHJcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0d2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG5cdFx0fSwgSElERV9QT1BVUF9USU1FKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdGxldCBjb2xvcjtcclxuXHRsZXQgcHJvZmlsZUlkO1xyXG5cdGxldCBwcm9maWxlTmFtZTtcclxuXHJcblx0Y29uc3QgY29sb3JzID0gW1wiI2RjNGEzNFwiLCBcIiMwNjJFNjNcIiwgXCIjRkFDMDQ0XCJdO1xyXG5cclxuXHRpZiAoZXhpc3RpbmdQcm9maWxlSWQpIHtcclxuXHRcdHByb2ZpbGVJZCA9IGV4aXN0aW5nUHJvZmlsZUlkO1xyXG5cdFx0cHJvZmlsZU5hbWUgPSBleGlzdGluZ1Byb2ZpbGVOYW1lO1xyXG5cdFx0Y29uc3QgcHJvZmlsZU51bWJlciA9IHBhcnNlSW50KHByb2ZpbGVJZC5zcGxpdChcIi1cIikucG9wKCkpO1xyXG5cdFx0Y29sb3IgPSBjb2xvcnNbcHJvZmlsZU51bWJlciAtIDFdO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRpZiAoT2JqZWN0LmtleXMoZXhpc3RpbmdQcm9maWxlcykubGVuZ3RoID49IDMpIHJldHVybjtcclxuXHJcblx0XHRsZXQgbmV4dE51bWJlciA9IDE7XHJcblx0XHR3aGlsZSAoZXhpc3RpbmdQcm9maWxlc1tgdXNlci1wcm9maWxlLSR7bmV4dE51bWJlcn1gXSkge1xyXG5cdFx0XHRuZXh0TnVtYmVyKys7XHJcblx0XHR9XHJcblxyXG5cdFx0cHJvZmlsZUlkID0gYHVzZXItcHJvZmlsZS0ke25leHROdW1iZXJ9YDtcclxuXHRcdHByb2ZpbGVOYW1lID0gYEhhbmRzb21lIFVzZXIgJHtuZXh0TnVtYmVyfWA7XHJcblx0XHRjb2xvciA9IGNvbG9yc1tuZXh0TnVtYmVyIC0gMV07XHJcblx0fVxyXG5cclxuXHRjb25zdCB1c2VyUHJvZmlsZSA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fcHJvZmlsZVwiXSk7XHJcblx0Y29uc3QgdXNlckF2YXRhckJveCA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fYXZhdGFyXCJdKTtcclxuXHRjb25zdCB1c2VyUHJvZmlsZUJ0biA9IGNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwgW1wibWFpbi1wcm9maWxlc19fYnRuXCJdLCB7XHJcblx0XHRcImFyaWEtbGFiZWxcIjogYXJpYUluZm8sXHJcblx0XHRcImRhdGEtaWRcIjogcHJvZmlsZUlkLFxyXG5cdH0pO1xyXG5cclxuXHRjb25zdCB1c2VyUHJvZmlsZUluZm9Cb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX3VzZXItaW5mb1wiXSk7XHJcblx0Y29uc3QgdXNlclByb2ZpbGVJbmZvID0gY3JlYXRlRWxlbWVudChcImlucHV0XCIsIFtcIm1haW4tcHJvZmlsZXNfX25hbWVcIl0sIHtcclxuXHRcdHR5cGU6IFwidGV4dFwiLFxyXG5cdFx0cmVhZG9ubHk6IHRydWUsXHJcblx0XHR2YWx1ZTogcHJvZmlsZU5hbWUsXHJcblx0fSk7XHJcblx0Y29uc3QgbmFtZUJvcmRlciA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm5hbWUtYm9yZGVyXCJdKTtcclxuXHRjb25zdCBlZGl0VXNlckluZm9CdG4gPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJidXR0b25cIixcclxuXHRcdFtcIm1haW4tcHJvZmlsZXNfX2VkaXQtbmFtZVwiXSxcclxuXHRcdHsgXCJhcmlhLWxhYmVsXCI6IHVzZXJCdG5JbmZvIH1cclxuXHQpO1xyXG5cdGNvbnN0IHJlbW92ZVVzZXJCdG4gPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJidXR0b25cIixcclxuXHRcdFtcIm1haW4tcHJvZmlsZXNfX3JlbW92ZS11c2VyXCJdLFxyXG5cdFx0eyBcImFyaWEtbGFiZWxcIjogcmVtb3ZlQXJpYSB9XHJcblx0KTtcclxuXHRjb25zdCByZW1vdmVVc2VySWNvbiA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibWFpbi1wcm9maWxlc19fcmVtb3ZlLWljb25cIl0sIHtcclxuXHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRoZWlnaHQ6IFwiMjRcIixcclxuXHRcdGxvYWRpbmc6IFwibGF6eVwiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdFx0c3JjOiBcIi4vc3JjL2ljb25zL3JlbW92ZS1wcm9maWxlLWljb24uc3ZnXCIsXHJcblx0fSk7XHJcblx0Y29uc3QgZWRpdFVzZXJJbmZvSWNvbiA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibWFpbi1wcm9maWxlc19fZWRpdC1pY29uXCJdLCB7XHJcblx0XHR3aWR0aDogXCIyNFwiLFxyXG5cdFx0aGVpZ2h0OiBcIjI0XCIsXHJcblx0XHRsb2FkaW5nOiBcImxhenlcIixcclxuXHRcdGFsdDogXCJcIixcclxuXHRcdHNyYzogXCIuL3NyYy9pY29ucy9lZGl0LnN2Z1wiLFxyXG5cdH0pO1xyXG5cclxuXHR1c2VyUHJvZmlsZUJ0bi5pbm5lckhUTUwgPSBgPHN2ZyBjbGFzcz1cIm1haW4tcHJvZmlsZXNfX2ltZ1wiIHdpZHRoPVwiMTUwXCIgaGVpZ2h0PVwiMTUwXCIgdmlld0JveD1cIjAgMCAyMDAgMjAwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxyXG4gICAgPGNpcmNsZSBjeD1cIjcwXCIgY3k9XCI3MFwiIHI9XCI4XCIgZmlsbD1cIndoaXRlXCIgLz5cclxuICAgIDxjaXJjbGUgY3g9XCIxMzBcIiBjeT1cIjcwXCIgcj1cIjhcIiBmaWxsPVwid2hpdGVcIiAvPlxyXG4gICAgPHBhdGggZD1cIk02MCAxMTAgUTEwMCAxNTAgMTQwIDExMFwiIHN0cm9rZT1cIndoaXRlXCIgc3Ryb2tlLXdpZHRoPVwiNlwiXHJcbiAgICBmaWxsPVwidHJhbnNwYXJlbnRcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgLz5cclxuICAgIDwvc3ZnPmA7XHJcblx0dXNlclByb2ZpbGVCdG4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XHJcblxyXG5cdHVzZXJBdmF0YXJCb3guYXBwZW5kKHVzZXJQcm9maWxlQnRuKTtcclxuXHRlZGl0VXNlckluZm9CdG4uYXBwZW5kKGVkaXRVc2VySW5mb0ljb24pO1xyXG5cdHJlbW92ZVVzZXJCdG4uYXBwZW5kKHJlbW92ZVVzZXJJY29uKTtcclxuXHR1c2VyUHJvZmlsZUluZm9Cb3guYXBwZW5kKFxyXG5cdFx0dXNlclByb2ZpbGVJbmZvLFxyXG5cdFx0bmFtZUJvcmRlcixcclxuXHRcdGVkaXRVc2VySW5mb0J0bixcclxuXHRcdHJlbW92ZVVzZXJCdG5cclxuXHQpO1xyXG5cdHVzZXJQcm9maWxlLmFwcGVuZCh1c2VyQXZhdGFyQm94LCB1c2VyUHJvZmlsZUluZm9Cb3gpO1xyXG5cclxuXHJcblx0aWYgKCFleGlzdGluZ1Byb2ZpbGVJZCkge1xyXG5cdFx0Y29uc3QgdXBkYXRlZFByb2ZpbGVzID0ge1xyXG5cdFx0XHQuLi5leGlzdGluZ1Byb2ZpbGVzLFxyXG5cdFx0XHRbcHJvZmlsZUlkXTogcHJvZmlsZU5hbWUsXHJcblx0XHR9O1xyXG5cdFx0c2V0VXNlclByZWZlcmVuY2UoXCJ1c2VyUHJvZmlsZXNcIiwgdXBkYXRlZFByb2ZpbGVzLCB1c2VyRGF0YSk7XHJcblx0fVxyXG5cclxuXHRlZGl0VXNlckluZm9CdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRlZGl0VXNlcm5hbWUoZSwgdXNlclByb2ZpbGVJbmZvQm94LCBzYXZlQnRuQXJpYSwgZW1wdHlGaWVsZEVycm9yKTtcclxuXHR9KTtcclxuXHRyZW1vdmVVc2VyQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0cmVtb3ZlVXNlcihlKTtcclxuXHR9KTtcclxuXHJcblx0dXNlclByb2ZpbGVJbmZvLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcblx0XHRpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xyXG5cdFx0XHRzYXZlVXNlcm5hbWUoZSwgZW1wdHlGaWVsZEVycm9yKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0dXNlclByb2ZpbGUuY2xhc3NMaXN0LmFkZChcInZpc2libGVcIik7XHJcblx0cmV0dXJuIHVzZXJQcm9maWxlO1xyXG59O1xyXG5cclxuY29uc3QgY3JlYXRlUHJvZmlsZUFkZEJ0biA9IChcclxuXHRhcmlhSW5mbyxcclxuXHRpbmZvLFxyXG5cdHVzZXJCdG5BcmlhLFxyXG5cdHByb2ZpbGVzQm94LFxyXG5cdHVzZXJCdG5JbmZvLFxyXG5cdHNhdmVCdG5BcmlhLFxyXG5cdG1heFByb2ZpbGVzRXJyb3IsXHJcblx0ZW1wdHlGaWVsZEVycm9yLFxyXG5cdHJlbW92ZUFyaWFcclxuKSA9PiB7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUJveCA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fYWRkLXByb2ZpbGVcIl0pO1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVBdmF0YXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2F2YXRhclwiXSk7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUJ0biA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImJ1dHRvblwiLFxyXG5cdFx0W1wibWFpbi1wcm9maWxlc19fYnRuXCIsIFwibWFpbi1wcm9maWxlc19fYnRuLS1hZGQtcHJvZmlsZVwiXSxcclxuXHRcdHsgXCJhcmlhLWxhYmVsXCI6IGFyaWFJbmZvIH1cclxuXHQpO1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVQbHVzSWNvbiA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibWFpbi1wcm9maWxlc19fYWRkLWltZ1wiXSwge1xyXG5cdFx0c3JjOiBcIi4vc3JjL2ljb25zL2FkZC1wcm9maWxlLnN2Z1wiLFxyXG5cdFx0bG9hZGluZzogXCJsYXp5XCIsXHJcblx0XHRhbHQ6IFwiXCIsXHJcblx0fSk7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUluZm8gPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXCJtYWluLXByb2ZpbGVzX19uYW1lXCJdKTtcclxuXHJcblx0YWRkUHJvZmlsZUluZm8udGV4dENvbnRlbnQgPSBpbmZvO1xyXG5cclxuXHRhZGRQcm9maWxlQnRuLmFwcGVuZChhZGRQcm9maWxlUGx1c0ljb24pO1xyXG5cdGFkZFByb2ZpbGVBdmF0YXIuYXBwZW5kKGFkZFByb2ZpbGVCdG4pO1xyXG5cdGFkZFByb2ZpbGVCb3guYXBwZW5kKGFkZFByb2ZpbGVBdmF0YXIsIGFkZFByb2ZpbGVJbmZvKTtcclxuXHJcblx0YWRkUHJvZmlsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0Y29uc3QgdXNlckRhdGEgPSBnZXREYXRhKCk7XHJcblx0XHRjb25zdCBleGlzdGluZ1Byb2ZpbGVzID0gdXNlckRhdGE/LnVzZXJQcm9maWxlcyB8fCB7fTtcclxuXHJcblx0XHRpZiAoT2JqZWN0LmtleXMoZXhpc3RpbmdQcm9maWxlcykubGVuZ3RoID49IDMpIHtcclxuXHRcdFx0c2hvd0Vycm9yUG9wdXAobWF4UHJvZmlsZXNFcnJvciwgXCIjZGM0YTM0XCIpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgcHJvZmlsZSA9IGNyZWF0ZVByb2ZpbGUoXHJcblx0XHRcdHVzZXJCdG5BcmlhLFxyXG5cdFx0XHR1c2VyQnRuSW5mbyxcclxuXHRcdFx0c2F2ZUJ0bkFyaWEsXHJcblx0XHRcdGVtcHR5RmllbGRFcnJvcixcclxuXHRcdFx0cmVtb3ZlQXJpYVxyXG5cdFx0KTtcclxuXHJcblx0XHRpZiAocHJvZmlsZSkge1xyXG5cdFx0XHRwcm9maWxlc0JveC5pbnNlcnRCZWZvcmUocHJvZmlsZSwgYWRkUHJvZmlsZUJveCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHJldHVybiBhZGRQcm9maWxlQm94O1xyXG59O1xyXG5cclxuY29uc3QgZWRpdFVzZXJuYW1lID0gKGUsIHBhcmVudCwgc2F2ZUJ0bkFyaWEsIGVtcHR5RmllbGRFcnJvcikgPT4ge1xyXG5cdHJlc2V0U3RhdGVPZkVkaXRpbmcoZSk7XHJcblxyXG5cdGNvbnN0IGVkaXRCdG4gPSBlLnRhcmdldDtcclxuXHRjb25zdCBuYW1lVG9FZGl0ID0gZWRpdEJ0blxyXG5cdFx0LmNsb3Nlc3QoXCIubWFpbi1wcm9maWxlc19fcHJvZmlsZVwiKVxyXG5cdFx0LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1wcm9maWxlc19fbmFtZVwiKTtcclxuXHJcblx0Y29uc3Qgc2F2ZUJ0biA9IGNyZWF0ZVNhdmVCdG4oc2F2ZUJ0bkFyaWEpO1xyXG5cclxuXHRlZGl0QnRuLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XHJcblx0c2F2ZUJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xyXG5cclxuXHRwYXJlbnQuYXBwZW5kKHNhdmVCdG4pO1xyXG5cclxuXHRuYW1lVG9FZGl0LmZvY3VzKCk7XHJcblx0bmFtZVRvRWRpdC5zZWxlY3QoKTtcclxuXHRuYW1lVG9FZGl0LnJlbW92ZUF0dHJpYnV0ZShcInJlYWRvbmx5XCIpO1xyXG5cdG5hbWVUb0VkaXQuY2xhc3NMaXN0LmFkZChcImZvY3VzZWRcIik7XHJcblxyXG5cdHNhdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRzYXZlVXNlcm5hbWUoZSwgZW1wdHlGaWVsZEVycm9yKTtcclxuXHR9KTtcclxufTtcclxuXHJcbmNvbnN0IHNhdmVVc2VybmFtZSA9IChlLCBlbXB0eUZpZWxkRXJyb3IpID0+IHtcclxuXHRjb25zdCB1c2VyRGF0YSA9IGdldERhdGEoKTtcclxuXHRjb25zdCBleGlzdGluZ1Byb2ZpbGVzID0gdXNlckRhdGE/LnVzZXJQcm9maWxlcyB8fCBbXTtcclxuXHJcblx0Y29uc3Qgc2F2ZUJ0biA9IGUudGFyZ2V0O1xyXG5cdGNvbnN0IGNsb3Nlc3RQcm9maWxlID0gc2F2ZUJ0bi5jbG9zZXN0KFwiLm1haW4tcHJvZmlsZXNfX3Byb2ZpbGVcIik7XHJcblx0Y29uc3QgY2xvc2VzdFByb2ZpbGVJZCA9IGNsb3Nlc3RQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1wcm9maWxlc19fYnRuXCIpXHJcblx0XHQuZGF0YXNldC5pZDtcclxuXHRjb25zdCBjbG9zZXN0UHJvZmlsZU5hbWUgPSBjbG9zZXN0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XCIubWFpbi1wcm9maWxlc19fbmFtZVwiXHJcblx0KTtcclxuXHJcblx0Y29uc3QgYWxsRWRpdEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1haW4tcHJvZmlsZXNfX2VkaXQtbmFtZVwiKTtcclxuXHJcblx0YWxsRWRpdEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIikpO1xyXG5cclxuXHRpZiAoY2xvc2VzdFByb2ZpbGVOYW1lLnZhbHVlLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0YWxsRWRpdEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSkpO1xyXG5cdFx0cmV0dXJuIHNob3dFcnJvclBvcHVwKGVtcHR5RmllbGRFcnJvciwgXCIjRkFDMDQ0XCIpO1xyXG5cdH1cclxuXHJcblx0Y29uc3QgdXBkYXRlZFByb2ZpbGVzID0ge1xyXG5cdFx0Li4uZXhpc3RpbmdQcm9maWxlcyxcclxuXHRcdFtjbG9zZXN0UHJvZmlsZUlkXTogY2xvc2VzdFByb2ZpbGVOYW1lLnZhbHVlLFxyXG5cdH07XHJcblx0c2V0VXNlclByZWZlcmVuY2UoXCJ1c2VyUHJvZmlsZXNcIiwgdXBkYXRlZFByb2ZpbGVzLCB1c2VyRGF0YSk7XHJcblxyXG5cdHJlc2V0U3RhdGVPZkVkaXRpbmcoZSk7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVTYXZlQnRuID0gKHNhdmVCdG5BcmlhKSA9PiB7XHJcblx0Y29uc3Qgc2F2ZVVzZXJJbmZvQnRuID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiYnV0dG9uXCIsXHJcblx0XHRbXCJtYWluLXByb2ZpbGVzX19zYXZlLW5hbWVcIiwgXCJoaWRkZW5cIl0sXHJcblx0XHR7IFwiYXJpYS1sYWJlbFwiOiBzYXZlQnRuQXJpYSB9XHJcblx0KTtcclxuXHRjb25zdCBzYXZlVXNlckluZm9JY29uID0gY3JlYXRlRWxlbWVudChcImltZ1wiLCBbXCJtYWluLXByb2ZpbGVzX19zYXZlLWljb25cIl0sIHtcclxuXHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRoZWlnaHQ6IFwiMjRcIixcclxuXHRcdGxvYWRpbmc6IFwibGF6eVwiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdFx0c3JjOiBcIi4vc3JjL2ljb25zL3NhdmUuc3ZnXCIsXHJcblx0fSk7XHJcblxyXG5cdHNhdmVVc2VySW5mb0J0bi5hcHBlbmQoc2F2ZVVzZXJJbmZvSWNvbik7XHJcblxyXG5cdHJldHVybiBzYXZlVXNlckluZm9CdG47XHJcbn07XHJcblxyXG5jb25zdCByZXNldFN0YXRlT2ZFZGl0aW5nID0gKGUpID0+IHtcclxuXHRjb25zdCBmb2N1c2VkTmFtZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvY3VzZWRcIik7XHJcblx0Y29uc3QgYWxsU2F2ZUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1haW4tcHJvZmlsZXNfX3NhdmUtbmFtZVwiKTtcclxuXHRjb25zdCBhbGxFZGl0QnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWFpbi1wcm9maWxlc19fZWRpdC1uYW1lXCIpO1xyXG5cclxuXHRmb2N1c2VkTmFtZXMuZm9yRWFjaCgoZWwpID0+IHtcclxuXHRcdGVsLnNldEF0dHJpYnV0ZShcInJlYWRvbmx5XCIsIHRydWUpO1xyXG5cdFx0ZWwuY2xhc3NMaXN0LnJlbW92ZShcImZvY3VzZWRcIik7XHJcblx0XHRlbC5ibHVyKCk7XHJcblx0fSk7XHJcblx0YWxsU2F2ZUJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKSk7XHJcblx0YWxsRWRpdEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKSk7XHJcbn07XHJcblxyXG5sZXQgcG9wdXBWaXNpYmxlID0gZmFsc2U7XHJcbmNvbnN0IHNob3dFcnJvclBvcHVwID0gKHRleHQsIGNvbG9yKSA9PiB7XHJcblx0aWYgKHBvcHVwVmlzaWJsZSkgcmV0dXJuO1xyXG5cdHBvcHVwVmlzaWJsZSA9IHRydWU7XHJcblxyXG5cdGNvbnN0IHJvb3QgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XHJcblx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250YWluZXJcIik7XHJcblxyXG5cdGNvbnN0IHBvcHVwID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJlcnJvci1wb3B1cFwiXSk7XHJcblx0Y29uc3QgcG9wdXBFcnJvciA9IGNyZWF0ZUVsZW1lbnQoXCJwXCIsIFtcImVycm9yLXBvcHVwX190ZXh0XCJdKTtcclxuXHJcblx0cG9wdXBFcnJvci50ZXh0Q29udGVudCA9IHRleHQ7XHJcblx0cm9vdC5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tZXJyb3JUeHRDb2xvclwiLCBjb2xvcik7XHJcblxyXG5cdHBvcHVwLmFwcGVuZChwb3B1cEVycm9yKTtcclxuXHRjb250YWluZXIuYXBwZW5kKHBvcHVwKTtcclxuXHJcblx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRwb3B1cC5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xyXG5cdH0sIDIwMDApO1xyXG5cdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0cG9wdXAucmVtb3ZlKCk7XHJcblx0XHRwb3B1cFZpc2libGUgPSBmYWxzZTtcclxuXHR9LCBISURFX1BPUFVQX1RJTUUpO1xyXG59O1xyXG5cclxuY29uc3QgcmVtb3ZlVXNlciA9IChlKSA9PiB7XHJcblx0Y29uc3QgdXNlckRhdGEgPSBnZXREYXRhKCk7XHJcblx0Y29uc3QgdXNlclByb2ZpbGVzID0gdXNlckRhdGE/LnVzZXJQcm9maWxlcztcclxuXHRjb25zdCBhbGxFZGl0QnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWFpbi1wcm9maWxlc19fZWRpdC1uYW1lXCIpO1xyXG5cclxuXHRjb25zdCBkZWxldGVCdG4gPSBlLnRhcmdldDtcclxuXHRjb25zdCBjbG9zZXN0UHJvZmlsZSA9IGRlbGV0ZUJ0bi5jbG9zZXN0KFwiLm1haW4tcHJvZmlsZXNfX3Byb2ZpbGVcIik7XHJcblx0Y29uc3QgY2xvc2VzdFByb2ZpbGVCdG4gPSBjbG9zZXN0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLm1haW4tcHJvZmlsZXNfX2J0blwiKTtcclxuXHRhbGxFZGl0QnRucy5mb3JFYWNoKChidG4pID0+IGJ0bi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSk7XHJcblxyXG5cdGRlbGV0ZSB1c2VyUHJvZmlsZXNbY2xvc2VzdFByb2ZpbGVCdG4uZGF0YXNldC5pZF07XHJcblxyXG5cdHNldFVzZXJQcmVmZXJlbmNlKFwidXNlclByb2ZpbGVzXCIsIHVzZXJQcm9maWxlcywgdXNlckRhdGEpO1xyXG5cclxuXHRjbG9zZXN0UHJvZmlsZS5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xyXG5cclxuXHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdGNsb3Nlc3RQcm9maWxlLnJlbW92ZSgpO1xyXG5cdH0sIDQwMCk7XHJcbn07XHJcbiJdfQ==
