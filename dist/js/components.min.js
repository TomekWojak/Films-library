import{createElement}from"./helpers.min.js";import{setUserPreference}from"./updateStateFunctions.min.js";const userData=JSON.parse?.(localStorage.getItem("userData"));let profilesCount=userData?.profilesCount||0;const USERNAME="handsomeUser404",PASSWORD="5jksH9d.";export const createLoginHeader=({header:{alt:{logo:e},aria:{logoLink:t,changeLanguageButton:a}}},r,n,o,i)=>{const l=createElement("header",["header"]),s=createElement("a",["header__logo","login-header__logo"],{href:"/","aria-label":`${t}`}),c=createElement("img",["header__logo-img","login-header__logo-img"],{src:"./src/icons/logo.svg",alt:`${e}`,width:"24",height:"24"}),d=createElement("span",["header__logo-text","login-header__logo-text"]);d.textContent="Stream",s.append(c,d),l.append(s);const p=createElement("button",["login-header__lang-select"],{"aria-label":`${a}`}),m=createElement("span",["login-header__lang-platform-lang"]),u=createElement("img",["login-header__lang-arrow"],{src:"./src/icons/chevron-down.svg",alt:"",width:"24",height:"24"}),f=createElement("ul",["login-header__lang-list"]);for(let e=0;e<r;e++){const t=createElement("li",["login-header__lang-choice"],{tabindex:0}),a=Object.keys(n)[e],r=Object.values(n)[e];t.dataset.lang=a,t.textContent=r,t.style.animationDelay=100*e+"ms",f.append(t)}return m.textContent=n[o],p.addEventListener("click",e=>{i.call(p,e,m)}),p.append(m,u,f),l.append(p),l};export const createLoginPage=({main:{text:{title:e,subtitle:t,description:a,button:r},placeholder:{username:n,password:o}}})=>{const i=createElement("main",["main"]),l=createElement("div",["wrapper"]),s=createElement("h1"),c=createElement("span",["main__title"]),d=createElement("span",["main__subtitle"]),p=createElement("p",["main__text"]),m=createElement("form",["main__form"]),u=createElement("input",["main__form-input","main__form-input--username"],{type:"text",placeholder:n}),f=createElement("input",["main__form-input","main__form-input--password"],{type:"password",placeholder:o}),g=createElement("button",["main__form-button"],{type:"submit"}),_=createElement("span",["main__form-button-text"]),h=createElement("p",["main__form-error-txt"]);return c.textContent=e,d.textContent=t,p.textContent=a,_.textContent=r,s.append(c,d),g.append(_),m.append(u,f,g,h),l.append(s,p,m),i.append(l),g.addEventListener("click",e=>{const t=JSON.parse?.(localStorage.getItem("userData"));handleLoginValidation(e,u,f,translations.main.text.errorRequired,translations.main.text.errorInvalid,USERNAME,PASSWORD,h)||(h.classList.remove("visible"),e.target.append(showSmallLoader()),e.target.disabled=!0,setTimeout(()=>{e.target.disabled=!1,hideSmallLoader(),setUserPreference("translations",translations,t),setUserPreference("loggedIn",!0,t),window.location.href="profiles.html"},3e3))}),i};const handleLoginValidation=(e,t,a,r,n,o,i,l)=>(e.preventDefault(),""===t.value.trim()||""===a.value.trim()?(l.classList.add("visible"),l.textContent=r,r):t.value.trim()!==o||a.value.trim()!==i?(e.target.disabled=!0,e.target.append(showSmallLoader()),l.classList.remove("visible"),setTimeout(()=>{l.classList.add("visible"),l.textContent=n,e.target.disabled=!1,hideSmallLoader()},3e3),n):null);export const showBigLoader=()=>{const e=createElement("div",["loading-area"]);return e.innerHTML='            <svg class="loader-big" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="#4da8da" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="#4da8da" stop-opacity="0.4" />\n                        <stop offset="100%" stop-color="#4da8da" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-big" r="35" cx="60" cy="60"></circle>\n            </svg>',e};export const hideBigLoader=()=>{const e=document.querySelector(".loading-area");e?.remove()};export const showSmallLoader=()=>{const e=createElement("div",["loading-area-small"]);return e.innerHTML='<svg class="loader-small" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent-small" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="white" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="white" stop-opacity="0.3" />\n                        <stop offset="100%" stop-color="white" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-small" r="12" cx="60" cy="60"></circle>\n            </svg>',e};export const hideSmallLoader=()=>{document.querySelector(".loading-area-small").remove()};export const createProfilesPage=({profiles:{text:{title:e,addProfileInfo:t},aria:{addProfileBtn:a,userProfileBtn:r,userBtnCustomize:n}},errorPopup:{text:{maxProfiles:o,emptyField:i}}})=>{const l=JSON.parse?.(localStorage.getItem("userData")),s=l?.userProfiles,c=document.querySelector(".container"),d=createElement("main",["main-profiles"]),p=createElement("div",["wrapper"]),m=createElement("h1",["main__title","main-profiles__title"]),u=createElement("div",["main-profiles__box"]);if(m.textContent=e,s&&0!==Object.keys(s).length)for(const e in s)u.append(createProfile(r,n,n,i));u.append(createProfileAddBtn(a,t,r,u,n,n,o,i)),p.append(m,u),d.append(p),c.append(d)};const createProfile=(e,t,a,r)=>{const n=JSON.parse?.(localStorage.getItem("userData")),o=n?.userProfiles||[];let i;if(3==profilesCount||3===o.length)return;profilesCount++,i=["#dc4a34","#062E63","#FAC044"][profilesCount];const l=createElement("div",["main-profiles__profile"]),s=createElement("div",["main-profiles__avatar"]),c=createElement("button",["main-profiles__btn"],{"aria-label":e,"data-id":`user-profile-${profilesCount}`}),d=createElement("div",["main-profiles__user-info"]),p=createElement("input",["main-profiles__name"],{type:"text",readonly:!0,value:o[`user-profile-${profilesCount}`]||`Handsome User ${profilesCount}`}),m=createElement("button",["main-profiles__edit-name"],{"aria-label":t}),u=createElement("img",["main-profiles__edit-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/edit.svg"});if(c.innerHTML='<svg class="main-profiles__img" width="150" height="150" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">\n\t<circle cx="70" cy="70" r="8" fill="white" />\n\t<circle cx="130" cy="70" r="8" fill="white" />\n\t<path d="M60 110 Q100 150 140 110" stroke="white" stroke-width="6"\n\tfill="transparent" stroke-linecap="round" />\n\t</svg>',c.style.backgroundColor=i,s.append(c),m.append(u),d.append(p,m),l.append(s,d),!o[`user-profile-${profilesCount}`]){const e={...o,[`user-profile-${profilesCount}`]:`Handsome User ${profilesCount}`};setUserPreference("userProfiles",e,n)}return m.addEventListener("click",e=>{editUsername(e,d,a,r)}),p.addEventListener("keydown",e=>{"Enter"===e.key&&saveUsername(e,r)}),l},createProfileAddBtn=(e,t,a,r,n,o,i,l)=>{const s=createElement("div",["main-profiles__add-profile"]),c=createElement("div",["main-profiles__avatar"]),d=createElement("button",["main-profiles__btn","main-profiles__btn--add-profile"],{"aria-label":e}),p=createElement("img",["main-profiles__add-img"],{src:"./src/icons/add-profile.svg",loading:"lazy",alt:""}),m=createElement("span",["main-profiles__name"]);return m.textContent=t,d.append(p),c.append(d),s.append(c,m),d.addEventListener("click",()=>{const e=createProfile(a,n,o,l);e?r.append(e):showErrorPopup(i,"#dc4a34")}),s},editUsername=(e,t,a,r)=>{resetStateOfEditing(e);const n=e.target,o=n.previousElementSibling,i=createSaveBtn(a);n.classList.add("hidden"),i.classList.remove("hidden"),t.append(i),o.focus(),o.select(),o.removeAttribute("readonly"),o.classList.add("focused"),i.addEventListener("click",e=>{saveUsername(e,r)})},saveUsername=(e,t)=>{const a=JSON.parse?.(localStorage.getItem("userData")),r=a?.userProfiles||[],n=e.target.closest(".main-profiles__profile"),o=n.querySelector(".main-profiles__btn").dataset.id,i=n.querySelector(".main-profiles__name"),l=document.querySelectorAll(".main-profiles__edit-name");if(l.forEach(e=>e.removeAttribute("disabled")),""===i.value.trim())return l.forEach(e=>e.setAttribute("disabled",!0)),showErrorPopup(t,"#FAC044");const s={...r,[o]:i.value};setUserPreference("userProfiles",s,a),resetStateOfEditing(e)},createSaveBtn=e=>{const t=createElement("button",["main-profiles__save-name","hidden"],{"aria-label":e}),a=createElement("img",["main-profiles__save-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/save.svg"});return t.append(a),t},resetStateOfEditing=e=>{const t=document.querySelectorAll(".focused"),a=document.querySelectorAll(".main-profiles__save-name"),r=document.querySelectorAll(".main-profiles__edit-name");t.forEach(e=>{e.setAttribute("readonly",!0),e.classList.remove("focused"),e.blur()}),a.forEach(e=>e.classList.add("hidden")),r.forEach(e=>e.classList.remove("hidden"))};let popupVisible=!1;const showErrorPopup=(e,t)=>{if(popupVisible)return;popupVisible=!0;const a=document.documentElement,r=document.querySelector(".container"),n=createElement("div",["error-popup"]),o=createElement("p",["error-popup__text"]);o.textContent=e,a.style.setProperty("--errorTxtColor",t),n.append(o),r.append(n),setTimeout(()=>{n.classList.add("hidden")},2e3),setTimeout(()=>{n.remove(),popupVisible=!1},2500)};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50cy5taW4uanMiLCJuYW1lcyI6WyJjcmVhdGVFbGVtZW50Iiwic2V0VXNlclByZWZlcmVuY2UiLCJ1c2VyRGF0YSIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJwcm9maWxlc0NvdW50IiwiVVNFUk5BTUUiLCJQQVNTV09SRCIsImNyZWF0ZUxvZ2luSGVhZGVyIiwiaGVhZGVyIiwiYWx0IiwibG9nbyIsImFyaWEiLCJsb2dvTGluayIsImNoYW5nZUxhbmd1YWdlQnV0dG9uIiwibGFuZ0Ftb3VudCIsImxhbmdOYW1lcyIsImxhbmd1YWdlIiwiaGFuZGxlTGFuZ1NlbGVjdCIsInBhZ2VMb2dvIiwiaHJlZiIsImxvZ29JbWciLCJzcmMiLCJ3aWR0aCIsImhlaWdodCIsImxvZ29UZXh0IiwidGV4dENvbnRlbnQiLCJhcHBlbmQiLCJsYW5nU2VsZWN0IiwibGFuZ1BsYXRmb3JtTGFuZyIsImxhbmdBcnJvdyIsImxhbmdMaXN0IiwiaSIsImxhbmdDaG9pY2UiLCJ0YWJpbmRleCIsImRhdGEiLCJPYmplY3QiLCJrZXlzIiwidGV4dCIsInZhbHVlcyIsImRhdGFzZXQiLCJsYW5nIiwic3R5bGUiLCJhbmltYXRpb25EZWxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY2FsbCIsImNyZWF0ZUxvZ2luUGFnZSIsIm1haW4iLCJ0aXRsZSIsInN1YnRpdGxlIiwiZGVzY3JpcHRpb24iLCJidXR0b24iLCJwbGFjZWhvbGRlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJtYWluQ29udGVudCIsIndyYXBwZXIiLCJsb2dpblRpdGxlIiwibG9naW5UaXRsZVRvcCIsImxvZ2luVGl0bGVCb3R0b20iLCJsb2dpblRleHQiLCJmb3JtIiwidXNlcm5hbWVJbnB1dCIsInR5cGUiLCJwYXNzd29yZElucHV0Iiwic3VibWl0QnRuIiwiYnV0dG9uVGV4dCIsImVycm9yVHh0IiwiaGFuZGxlTG9naW5WYWxpZGF0aW9uIiwidHJhbnNsYXRpb25zIiwiZXJyb3JSZXF1aXJlZCIsImVycm9ySW52YWxpZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRhcmdldCIsInNob3dTbWFsbExvYWRlciIsImRpc2FibGVkIiwic2V0VGltZW91dCIsImhpZGVTbWFsbExvYWRlciIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVxdWlyZUVycm9yIiwiaW52YWxpZEVycm9yIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsInRyaW0iLCJhZGQiLCJzaG93QmlnTG9hZGVyIiwibG9hZGluZ0FyZWEiLCJpbm5lckhUTUwiLCJoaWRlQmlnTG9hZGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY3JlYXRlUHJvZmlsZXNQYWdlIiwicHJvZmlsZXMiLCJhZGRQcm9maWxlSW5mbyIsImFkZFByb2ZpbGVCdG4iLCJ1c2VyUHJvZmlsZUJ0biIsInVzZXJCdG5DdXN0b21pemUiLCJlcnJvclBvcHVwIiwibWF4UHJvZmlsZXMiLCJlbXB0eUZpZWxkIiwidXNlclByb2ZpbGVzTGlzdCIsInVzZXJQcm9maWxlcyIsImNvbnRhaW5lciIsInByb2ZpbGVzUGFnZU1haW4iLCJwcm9maWxlc1RpdGxlIiwicHJvZmlsZXNCb3giLCJsZW5ndGgiLCJrZXkiLCJjcmVhdGVQcm9maWxlIiwiY3JlYXRlUHJvZmlsZUFkZEJ0biIsImFyaWFJbmZvIiwidXNlckJ0bkluZm8iLCJzYXZlQnRuQXJpYSIsImVtcHR5RmllbGRFcnJvciIsImV4aXN0aW5nUHJvZmlsZXMiLCJjb2xvciIsInVzZXJQcm9maWxlIiwidXNlckF2YXRhckJveCIsInVzZXJQcm9maWxlSW5mb0JveCIsInVzZXJQcm9maWxlSW5mbyIsInJlYWRvbmx5IiwiZWRpdFVzZXJJbmZvQnRuIiwiZWRpdFVzZXJJbmZvSWNvbiIsImxvYWRpbmciLCJiYWNrZ3JvdW5kQ29sb3IiLCJ1cGRhdGVkUHJvZmlsZXMiLCJlZGl0VXNlcm5hbWUiLCJzYXZlVXNlcm5hbWUiLCJpbmZvIiwidXNlckJ0bkFyaWEiLCJtYXhQcm9maWxlc0Vycm9yIiwiYWRkUHJvZmlsZUJveCIsImFkZFByb2ZpbGVBdmF0YXIiLCJhZGRQcm9maWxlUGx1c0ljb24iLCJwcm9maWxlIiwic2hvd0Vycm9yUG9wdXAiLCJwYXJlbnQiLCJyZXNldFN0YXRlT2ZFZGl0aW5nIiwiZWRpdEJ0biIsIm5hbWVUb0VkaXQiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwic2F2ZUJ0biIsImNyZWF0ZVNhdmVCdG4iLCJmb2N1cyIsInNlbGVjdCIsInJlbW92ZUF0dHJpYnV0ZSIsImNsb3Nlc3RQcm9maWxlIiwiY2xvc2VzdCIsImNsb3Nlc3RQcm9maWxlSWQiLCJpZCIsImNsb3Nlc3RQcm9maWxlTmFtZSIsImFsbEVkaXRCdG5zIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJidG4iLCJzZXRBdHRyaWJ1dGUiLCJzYXZlVXNlckluZm9CdG4iLCJzYXZlVXNlckluZm9JY29uIiwiZm9jdXNlZE5hbWVzIiwiYWxsU2F2ZUJ0bnMiLCJlbCIsImJsdXIiLCJwb3B1cFZpc2libGUiLCJyb290IiwiZG9jdW1lbnRFbGVtZW50IiwicG9wdXAiLCJwb3B1cEVycm9yIiwic2V0UHJvcGVydHkiXSwic291cmNlcyI6WyJjb21wb25lbnRzLmpzIl0sIm1hcHBpbmdzIjoiT0FBU0Esa0JBQXFCLDBCQUNyQkMsc0JBQXlCLGdDQUNsQyxNQUFNQyxTQUFXQyxLQUFLQyxRQUFRQyxhQUFhQyxRQUFRLGFBRW5ELElBQUlDLGNBQWdCTCxVQUFVSyxlQUFpQixFQUMvQyxNQUFNQyxTQUFXLGtCQUNYQyxTQUFXLGtCQUVWLE1BQU1DLGtCQUFvQixFQUUvQkMsUUFDQ0MsS0FBT0MsUUFDUEMsTUFBUUMsV0FBVUMsMEJBR3BCQyxFQUNBQyxFQUNBQyxFQUNBQyxLQUdBLE1BQU1ULEVBQVNYLGNBQWMsU0FBVSxDQUFDLFdBQ2xDcUIsRUFBV3JCLGNBQWMsSUFBSyxDQUFDLGVBQWdCLHNCQUF1QixDQUMzRXNCLEtBQU0sSUFDTixhQUFjLEdBQUdQLE1BRVpRLEVBQVV2QixjQUNmLE1BQ0EsQ0FBQyxtQkFBb0IsMEJBQ3JCLENBQ0N3QixJQUFLLHVCQUNMWixJQUFLLEdBQUdDLElBQ1JZLE1BQU8sS0FDUEMsT0FBUSxPQUdKQyxFQUFXM0IsY0FBYyxPQUFRLENBQ3RDLG9CQUNBLDRCQUVEMkIsRUFBU0MsWUFBYyxTQUN2QlAsRUFBU1EsT0FBT04sRUFBU0ksR0FDekJoQixFQUFPa0IsT0FBT1IsR0FJZCxNQUFNUyxFQUFhOUIsY0FBYyxTQUFVLENBQUMsNkJBQThCLENBQ3pFLGFBQWMsR0FBR2dCLE1BRVplLEVBQW1CL0IsY0FBYyxPQUFRLENBQzlDLHFDQUVLZ0MsRUFBWWhDLGNBQWMsTUFBTyxDQUFDLDRCQUE2QixDQUNwRXdCLElBQUssK0JBQ0xaLElBQUssR0FDTGEsTUFBTyxLQUNQQyxPQUFRLE9BRUhPLEVBQVdqQyxjQUFjLEtBQU0sQ0FBQyw0QkFFdEMsSUFBSyxJQUFJa0MsRUFBSSxFQUFHQSxFQUFJakIsRUFBWWlCLElBQUssQ0FDcEMsTUFBTUMsRUFBYW5DLGNBQWMsS0FBTSxDQUFDLDZCQUE4QixDQUNyRW9DLFNBQVUsSUFFTEMsRUFBT0MsT0FBT0MsS0FBS3JCLEdBQVdnQixHQUM5Qk0sRUFBT0YsT0FBT0csT0FBT3ZCLEdBQVdnQixHQUV0Q0MsRUFBV08sUUFBUUMsS0FBT04sRUFDMUJGLEVBQVdQLFlBQWNZLEVBQ3pCTCxFQUFXUyxNQUFNQyxlQUFxQixJQUFKWCxFQUFVLEtBQzVDRCxFQUFTSixPQUFPTSxFQUNqQixDQVdBLE9BVEFKLEVBQWlCSCxZQUFjVixFQUFVQyxHQUV6Q1csRUFBV2dCLGlCQUFpQixRQUFVQyxJQUNyQzNCLEVBQWlCNEIsS0FBS2xCLEVBQVlpQixFQUFHaEIsS0FHdENELEVBQVdELE9BQU9FLEVBQWtCQyxFQUFXQyxHQUMvQ3RCLEVBQU9rQixPQUFPQyxHQUVQbkIsVUFJRCxNQUFNc0MsZ0JBQWtCLEVBQzlCQyxNQUNDVixNQUFRVyxRQUFPQyxXQUFVQyxjQUFhQyxVQUN0Q0MsYUFBZUMsV0FBVUMsaUJBRzFCLE1BQU1DLEVBQWMxRCxjQUFjLE9BQVEsQ0FBQyxTQUNyQzJELEVBQVUzRCxjQUFjLE1BQU8sQ0FBQyxZQUNoQzRELEVBQWE1RCxjQUFjLE1BQzNCNkQsRUFBZ0I3RCxjQUFjLE9BQVEsQ0FBQyxnQkFDdkM4RCxFQUFtQjlELGNBQWMsT0FBUSxDQUFDLG1CQUMxQytELEVBQVkvRCxjQUFjLElBQUssQ0FBQyxlQUNoQ2dFLEVBQU9oRSxjQUFjLE9BQVEsQ0FBQyxlQUM5QmlFLEVBQWdCakUsY0FDckIsUUFDQSxDQUFDLG1CQUFvQiw4QkFDckIsQ0FBRWtFLEtBQU0sT0FBUVgsWUFBYUMsSUFFeEJXLEVBQWdCbkUsY0FDckIsUUFDQSxDQUFDLG1CQUFvQiw4QkFDckIsQ0FBRWtFLEtBQU0sV0FBWVgsWUFBYUUsSUFFNUJXLEVBQVlwRSxjQUFjLFNBQVUsQ0FBQyxxQkFBc0IsQ0FDaEVrRSxLQUFNLFdBRURHLEVBQWFyRSxjQUFjLE9BQVEsQ0FBQywyQkFFcENzRSxFQUFXdEUsY0FBYyxJQUFLLENBQUMseUJBMkNyQyxPQTFDQTZELEVBQWNqQyxZQUFjdUIsRUFDNUJXLEVBQWlCbEMsWUFBY3dCLEVBQy9CVyxFQUFVbkMsWUFBY3lCLEVBQ3hCZ0IsRUFBV3pDLFlBQWMwQixFQUV6Qk0sRUFBVy9CLE9BQU9nQyxFQUFlQyxHQUNqQ00sRUFBVXZDLE9BQU93QyxHQUNqQkwsRUFBS25DLE9BQU9vQyxFQUFlRSxFQUFlQyxFQUFXRSxHQUVyRFgsRUFBUTlCLE9BQU8rQixFQUFZRyxFQUFXQyxHQUN0Q04sRUFBWTdCLE9BQU84QixHQUVuQlMsRUFBVXRCLGlCQUFpQixRQUFVQyxJQUNwQyxNQUFNN0MsRUFBV0MsS0FBS0MsUUFBUUMsYUFBYUMsUUFBUSxhQUVuQ2lFLHNCQUNmeEIsRUFDQWtCLEVBQ0FFLEVBQ0FLLGFBQWF0QixLQUFLVixLQUFLaUMsY0FDdkJELGFBQWF0QixLQUFLVixLQUFLa0MsYUFDdkJsRSxTQUNBQyxTQUNBNkQsS0FJQUEsRUFBU0ssVUFBVUMsT0FBTyxXQUMxQjdCLEVBQUU4QixPQUFPaEQsT0FBT2lELG1CQUNoQi9CLEVBQUU4QixPQUFPRSxVQUFXLEVBRXBCQyxXQUFXLEtBQ1ZqQyxFQUFFOEIsT0FBT0UsVUFBVyxFQUNwQkUsa0JBRUFoRixrQkFBa0IsZUFBZ0J1RSxhQUFjdEUsR0FDaERELGtCQUFrQixZQUFZLEVBQU1DLEdBQ3BDZ0YsT0FBT0MsU0FBUzdELEtBQU8saUJBQ3JCLFFBSUVvQyxHQUdSLE1BQU1hLHNCQUF3QixDQUM3QnhCLEVBQ0FrQixFQUNBRSxFQUNBaUIsRUFDQUMsRUFDQTdCLEVBQ0FDLEVBQ0FhLEtBRUF2QixFQUFFdUMsaUJBRWlDLEtBQS9CckIsRUFBY3NCLE1BQU1DLFFBQWdELEtBQS9CckIsRUFBY29CLE1BQU1DLFFBQzVEbEIsRUFBU0ssVUFBVWMsSUFBSSxXQUN2Qm5CLEVBQVMxQyxZQUFjd0QsRUFDaEJBLEdBRVBuQixFQUFjc0IsTUFBTUMsU0FBV2hDLEdBQy9CVyxFQUFjb0IsTUFBTUMsU0FBVy9CLEdBRS9CVixFQUFFOEIsT0FBT0UsVUFBVyxFQUNwQmhDLEVBQUU4QixPQUFPaEQsT0FBT2lELG1CQUNoQlIsRUFBU0ssVUFBVUMsT0FBTyxXQUUxQkksV0FBVyxLQUNWVixFQUFTSyxVQUFVYyxJQUFJLFdBQ3ZCbkIsRUFBUzFDLFlBQWN5RCxFQUV2QnRDLEVBQUU4QixPQUFPRSxVQUFXLEVBRXBCRSxtQkFDRSxLQUNJSSxHQUVBLGFBSUYsTUFBTUssY0FBZ0IsS0FDNUIsTUFBTUMsRUFBYzNGLGNBQWMsTUFBTyxDQUFDLGlCQVcxQyxPQVZBMkYsRUFBWUMsVUFBWSxxbkJBVWpCRCxVQUVELE1BQU1FLGNBQWdCLEtBQzVCLE1BQU1GLEVBQWNHLFNBQVNDLGNBQWMsaUJBQzNDSixHQUFhZixpQkFHUCxNQUFNRSxnQkFBa0IsS0FDOUIsTUFBTWEsRUFBYzNGLGNBQWMsTUFBTyxDQUFDLHVCQVkxQyxPQVhBMkYsRUFBWUMsVUFBWSw2bUJBV2pCRCxVQUVELE1BQU1WLGdCQUFrQixLQUNWYSxTQUFTQyxjQUFjLHVCQUMvQm5CLGlCQUdOLE1BQU1vQixtQkFBcUIsRUFDakNDLFVBQ0N6RCxNQUFRVyxRQUFPK0Msa0JBQ2ZwRixNQUFRcUYsZ0JBQWVDLGlCQUFnQkMscUJBRXhDQyxZQUNDOUQsTUFBUStELGNBQWFDLG1CQUd0QixNQUFNdEcsRUFBV0MsS0FBS0MsUUFBUUMsYUFBYUMsUUFBUSxhQUM3Q21HLEVBQW1CdkcsR0FBVXdHLGFBRTdCQyxFQUFZYixTQUFTQyxjQUFjLGNBQ25DYSxFQUFtQjVHLGNBQWMsT0FBUSxDQUFDLGtCQUMxQzJELEVBQVUzRCxjQUFjLE1BQU8sQ0FBQyxZQUNoQzZHLEVBQWdCN0csY0FBYyxLQUFNLENBQ3pDLGNBQ0EseUJBRUs4RyxFQUFjOUcsY0FBYyxNQUFPLENBQUMsdUJBSTFDLEdBRkE2RyxFQUFjakYsWUFBY3VCLEVBRXhCc0QsR0FBNkQsSUFBekNuRSxPQUFPQyxLQUFLa0UsR0FBa0JNLE9BQ3JELElBQUssTUFBTUMsS0FBT1AsRUFDakJLLEVBQVlqRixPQUNYb0YsY0FDQ2IsRUFDQUMsRUFDQUEsRUFDQUcsSUFNSk0sRUFBWWpGLE9BQ1hxRixvQkFDQ2YsRUFDQUQsRUFDQUUsRUFDQVUsRUFDQVQsRUFDQUEsRUFDQUUsRUFDQUMsSUFHRjdDLEVBQVE5QixPQUFPZ0YsRUFBZUMsR0FDOUJGLEVBQWlCL0UsT0FBTzhCLEdBRXhCZ0QsRUFBVTlFLE9BQU8rRSxJQUdsQixNQUFNSyxjQUFnQixDQUFDRSxFQUFVQyxFQUFhQyxFQUFhQyxLQUMxRCxNQUFNcEgsRUFBV0MsS0FBS0MsUUFBUUMsYUFBYUMsUUFBUSxhQUM3Q2lILEVBQW1CckgsR0FBVXdHLGNBQWdCLEdBRW5ELElBQUljLEVBSUosR0FBcUIsR0FBakJqSCxlQUFrRCxJQUE1QmdILEVBQWlCUixPQUFjLE9BRXpEeEcsZ0JBQ0FpSCxFQUxlLENBQUMsVUFBVyxVQUFXLFdBS3ZCakgsZUFFZixNQUFNa0gsRUFBY3pILGNBQWMsTUFBTyxDQUFDLDJCQUNwQzBILEVBQWdCMUgsY0FBYyxNQUFPLENBQUMsMEJBQ3RDb0csRUFBaUJwRyxjQUFjLFNBQVUsQ0FBQyxzQkFBdUIsQ0FDdEUsYUFBY21ILEVBQ2QsVUFBVyxnQkFBZ0I1RyxrQkFHdEJvSCxFQUFxQjNILGNBQWMsTUFBTyxDQUFDLDZCQUMzQzRILEVBQWtCNUgsY0FBYyxRQUFTLENBQUMsdUJBQXdCLENBQ3ZFa0UsS0FBTSxPQUNOMkQsVUFBVSxFQUNWdEMsTUFDQ2dDLEVBQWlCLGdCQUFnQmhILGtCQUNqQyxpQkFBaUJBLGtCQUVidUgsRUFBa0I5SCxjQUN2QixTQUNBLENBQUMsNEJBQ0QsQ0FBRSxhQUFjb0gsSUFPWFcsRUFBbUIvSCxjQUFjLE1BQU8sQ0FBQyw0QkFBNkIsQ0FDM0V5QixNQUFPLEtBQ1BDLE9BQVEsS0FDUnNHLFFBQVMsT0FDVHBILElBQUssR0FDTFksSUFBSyx5QkFrQk4sR0FmQTRFLEVBQWVSLFVBQVksd1ZBTTNCUSxFQUFleEQsTUFBTXFGLGdCQUFrQlQsRUFFdkNFLEVBQWM3RixPQUFPdUUsR0FDckIwQixFQUFnQmpHLE9BQU9rRyxHQUN2QkosRUFBbUI5RixPQUFPK0YsRUFBaUJFLEdBQzNDTCxFQUFZNUYsT0FBTzZGLEVBQWVDLElBSTdCSixFQUFpQixnQkFBZ0JoSCxpQkFBa0IsQ0FDdkQsTUFBTTJILEVBQWtCLElBQ3BCWCxFQUNILENBQUMsZ0JBQWdCaEgsaUJBQWtCLGlCQUFpQkEsaUJBRXJETixrQkFBa0IsZUFBZ0JpSSxFQUFpQmhJLEVBQ3BELENBWUEsT0FWQTRILEVBQWdCaEYsaUJBQWlCLFFBQVVDLElBQzFDb0YsYUFBYXBGLEVBQUc0RSxFQUFvQk4sRUFBYUMsS0FHbERNLEVBQWdCOUUsaUJBQWlCLFVBQVlDLElBQzlCLFVBQVZBLEVBQUVpRSxLQUNMb0IsYUFBYXJGLEVBQUd1RSxLQUlYRyxHQUdGUCxvQkFBc0IsQ0FDM0JDLEVBQ0FrQixFQUNBQyxFQUNBeEIsRUFDQU0sRUFDQUMsRUFDQWtCLEVBQ0FqQixLQUVBLE1BQU1rQixFQUFnQnhJLGNBQWMsTUFBTyxDQUFDLCtCQUN0Q3lJLEVBQW1CekksY0FBYyxNQUFPLENBQUMsMEJBQ3pDbUcsRUFBZ0JuRyxjQUNyQixTQUNBLENBQUMscUJBQXNCLG1DQUN2QixDQUFFLGFBQWNtSCxJQUVYdUIsRUFBcUIxSSxjQUFjLE1BQU8sQ0FBQywwQkFBMkIsQ0FDM0V3QixJQUFLLDhCQUNMd0csUUFBUyxPQUNUcEgsSUFBSyxLQUVBc0YsRUFBaUJsRyxjQUFjLE9BQVEsQ0FBQyx3QkF1QjlDLE9BckJBa0csRUFBZXRFLFlBQWN5RyxFQUU3QmxDLEVBQWN0RSxPQUFPNkcsR0FDckJELEVBQWlCNUcsT0FBT3NFLEdBQ3hCcUMsRUFBYzNHLE9BQU80RyxFQUFrQnZDLEdBRXZDQyxFQUFjckQsaUJBQWlCLFFBQVMsS0FDdkMsTUFBTTZGLEVBQVUxQixjQUNmcUIsRUFDQWxCLEVBQ0FDLEVBQ0FDLEdBR0dxQixFQUNIN0IsRUFBWWpGLE9BQU84RyxHQUVuQkMsZUFBZUwsRUFBa0IsYUFJNUJDLEdBR0ZMLGFBQWUsQ0FBQ3BGLEVBQUc4RixFQUFReEIsRUFBYUMsS0FDN0N3QixvQkFBb0IvRixHQUVwQixNQUFNZ0csRUFBVWhHLEVBQUU4QixPQUNabUUsRUFBYUQsRUFBUUUsdUJBQ3JCQyxFQUFVQyxjQUFjOUIsR0FFOUIwQixFQUFRcEUsVUFBVWMsSUFBSSxVQUN0QnlELEVBQVF2RSxVQUFVQyxPQUFPLFVBRXpCaUUsRUFBT2hILE9BQU9xSCxHQUVkRixFQUFXSSxRQUNYSixFQUFXSyxTQUNYTCxFQUFXTSxnQkFBZ0IsWUFDM0JOLEVBQVdyRSxVQUFVYyxJQUFJLFdBRXpCeUQsRUFBUXBHLGlCQUFpQixRQUFVQyxJQUNsQ3FGLGFBQWFyRixFQUFHdUUsTUFJWmMsYUFBZSxDQUFDckYsRUFBR3VFLEtBQ3hCLE1BQU1wSCxFQUFXQyxLQUFLQyxRQUFRQyxhQUFhQyxRQUFRLGFBQzdDaUgsRUFBbUJySCxHQUFVd0csY0FBZ0IsR0FHN0M2QyxFQURVeEcsRUFBRThCLE9BQ2EyRSxRQUFRLDJCQUNqQ0MsRUFBbUJGLEVBQWV4RCxjQUFjLHVCQUNwRHJELFFBQVFnSCxHQUNKQyxFQUFxQkosRUFBZXhELGNBQ3pDLHdCQUdLNkQsRUFBYzlELFNBQVMrRCxpQkFBaUIsNkJBSTlDLEdBRkFELEVBQVlFLFFBQVNDLEdBQVFBLEVBQUlULGdCQUFnQixhQUVULEtBQXBDSyxFQUFtQnBFLE1BQU1DLE9BRTVCLE9BREFvRSxFQUFZRSxRQUFTQyxHQUFRQSxFQUFJQyxhQUFhLFlBQVksSUFDbkRwQixlQUFldEIsRUFBaUIsV0FHeEMsTUFBTVksRUFBa0IsSUFDcEJYLEVBQ0hrQyxDQUFDQSxHQUFtQkUsRUFBbUJwRSxPQUV4Q3RGLGtCQUFrQixlQUFnQmlJLEVBQWlCaEksR0FFbkQ0SSxvQkFBb0IvRixJQUdmb0csY0FBaUI5QixJQUN0QixNQUFNNEMsRUFBa0JqSyxjQUN2QixTQUNBLENBQUMsMkJBQTRCLFVBQzdCLENBQUUsYUFBY3FILElBRVg2QyxFQUFtQmxLLGNBQWMsTUFBTyxDQUFDLDRCQUE2QixDQUMzRXlCLE1BQU8sS0FDUEMsT0FBUSxLQUNSc0csUUFBUyxPQUNUcEgsSUFBSyxHQUNMWSxJQUFLLHlCQUtOLE9BRkF5SSxFQUFnQnBJLE9BQU9xSSxHQUVoQkQsR0FHRm5CLG9CQUF1Qi9GLElBQzVCLE1BQU1vSCxFQUFlckUsU0FBUytELGlCQUFpQixZQUN6Q08sRUFBY3RFLFNBQVMrRCxpQkFBaUIsNkJBQ3hDRCxFQUFjOUQsU0FBUytELGlCQUFpQiw2QkFFOUNNLEVBQWFMLFFBQVNPLElBQ3JCQSxFQUFHTCxhQUFhLFlBQVksR0FDNUJLLEVBQUcxRixVQUFVQyxPQUFPLFdBQ3BCeUYsRUFBR0MsU0FFSkYsRUFBWU4sUUFBU0MsR0FBUUEsRUFBSXBGLFVBQVVjLElBQUksV0FDL0NtRSxFQUFZRSxRQUFTQyxHQUFRQSxFQUFJcEYsVUFBVUMsT0FBTyxZQUduRCxJQUFJMkYsY0FBZSxFQUNuQixNQUFNM0IsZUFBaUIsQ0FBQ3BHLEVBQU1nRixLQUM3QixHQUFJK0MsYUFBYyxPQUNsQkEsY0FBZSxFQUVmLE1BQU1DLEVBQU8xRSxTQUFTMkUsZ0JBQ2hCOUQsRUFBWWIsU0FBU0MsY0FBYyxjQUVuQzJFLEVBQVExSyxjQUFjLE1BQU8sQ0FBQyxnQkFDOUIySyxFQUFhM0ssY0FBYyxJQUFLLENBQUMsc0JBRXZDMkssRUFBVy9JLFlBQWNZLEVBQ3pCZ0ksRUFBSzVILE1BQU1nSSxZQUFZLGtCQUFtQnBELEdBRTFDa0QsRUFBTTdJLE9BQU84SSxHQUNiaEUsRUFBVTlFLE9BQU82SSxHQUVqQjFGLFdBQVcsS0FDVjBGLEVBQU0vRixVQUFVYyxJQUFJLFdBQ2xCLEtBQ0hULFdBQVcsS0FDVjBGLEVBQU05RixTQUNOMkYsY0FBZSxHQUNiIiwiaWdub3JlTGlzdCI6W10sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUVsZW1lbnQgfSBmcm9tIFwiLi9oZWxwZXJzLm1pbi5qc1wiO1xyXG5pbXBvcnQgeyBzZXRVc2VyUHJlZmVyZW5jZSB9IGZyb20gXCIuL3VwZGF0ZVN0YXRlRnVuY3Rpb25zLm1pbi5qc1wiO1xyXG5jb25zdCB1c2VyRGF0YSA9IEpTT04ucGFyc2U/Lihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInVzZXJEYXRhXCIpKTtcclxuXHJcbmxldCBwcm9maWxlc0NvdW50ID0gdXNlckRhdGE/LnByb2ZpbGVzQ291bnQgfHwgMDtcclxuY29uc3QgVVNFUk5BTUUgPSBcImhhbmRzb21lVXNlcjQwNFwiO1xyXG5jb25zdCBQQVNTV09SRCA9IFwiNWprc0g5ZC5cIjtcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVMb2dpbkhlYWRlciA9IChcclxuXHR7XHJcblx0XHRoZWFkZXI6IHtcclxuXHRcdFx0YWx0OiB7IGxvZ28gfSxcclxuXHRcdFx0YXJpYTogeyBsb2dvTGluaywgY2hhbmdlTGFuZ3VhZ2VCdXR0b24gfSxcclxuXHRcdH0sXHJcblx0fSxcclxuXHRsYW5nQW1vdW50LFxyXG5cdGxhbmdOYW1lcyxcclxuXHRsYW5ndWFnZSxcclxuXHRoYW5kbGVMYW5nU2VsZWN0XHJcbikgPT4ge1xyXG5cdC8vIGxvZ29cclxuXHRjb25zdCBoZWFkZXIgPSBjcmVhdGVFbGVtZW50KFwiaGVhZGVyXCIsIFtcImhlYWRlclwiXSk7XHJcblx0Y29uc3QgcGFnZUxvZ28gPSBjcmVhdGVFbGVtZW50KFwiYVwiLCBbXCJoZWFkZXJfX2xvZ29cIiwgXCJsb2dpbi1oZWFkZXJfX2xvZ29cIl0sIHtcclxuXHRcdGhyZWY6IFwiL1wiLFxyXG5cdFx0XCJhcmlhLWxhYmVsXCI6IGAke2xvZ29MaW5rfWAsXHJcblx0fSk7XHJcblx0Y29uc3QgbG9nb0ltZyA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImltZ1wiLFxyXG5cdFx0W1wiaGVhZGVyX19sb2dvLWltZ1wiLCBcImxvZ2luLWhlYWRlcl9fbG9nby1pbWdcIl0sXHJcblx0XHR7XHJcblx0XHRcdHNyYzogXCIuL3NyYy9pY29ucy9sb2dvLnN2Z1wiLFxyXG5cdFx0XHRhbHQ6IGAke2xvZ299YCxcclxuXHRcdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdFx0aGVpZ2h0OiBcIjI0XCIsXHJcblx0XHR9XHJcblx0KTtcclxuXHRjb25zdCBsb2dvVGV4dCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcclxuXHRcdFwiaGVhZGVyX19sb2dvLXRleHRcIixcclxuXHRcdFwibG9naW4taGVhZGVyX19sb2dvLXRleHRcIixcclxuXHRdKTtcclxuXHRsb2dvVGV4dC50ZXh0Q29udGVudCA9IFwiU3RyZWFtXCI7XHJcblx0cGFnZUxvZ28uYXBwZW5kKGxvZ29JbWcsIGxvZ29UZXh0KTtcclxuXHRoZWFkZXIuYXBwZW5kKHBhZ2VMb2dvKTtcclxuXHQvLyBlbmQgb2YgbG9nb1xyXG5cclxuXHQvLyBsYW5ndWFnZSBzZWxlY3RvclxyXG5cdGNvbnN0IGxhbmdTZWxlY3QgPSBjcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIFtcImxvZ2luLWhlYWRlcl9fbGFuZy1zZWxlY3RcIl0sIHtcclxuXHRcdFwiYXJpYS1sYWJlbFwiOiBgJHtjaGFuZ2VMYW5ndWFnZUJ1dHRvbn1gLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGxhbmdQbGF0Zm9ybUxhbmcgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXHJcblx0XHRcImxvZ2luLWhlYWRlcl9fbGFuZy1wbGF0Zm9ybS1sYW5nXCIsXHJcblx0XSk7XHJcblx0Y29uc3QgbGFuZ0Fycm93ID0gY3JlYXRlRWxlbWVudChcImltZ1wiLCBbXCJsb2dpbi1oZWFkZXJfX2xhbmctYXJyb3dcIl0sIHtcclxuXHRcdHNyYzogXCIuL3NyYy9pY29ucy9jaGV2cm9uLWRvd24uc3ZnXCIsXHJcblx0XHRhbHQ6IFwiXCIsXHJcblx0XHR3aWR0aDogXCIyNFwiLFxyXG5cdFx0aGVpZ2h0OiBcIjI0XCIsXHJcblx0fSk7XHJcblx0Y29uc3QgbGFuZ0xpc3QgPSBjcmVhdGVFbGVtZW50KFwidWxcIiwgW1wibG9naW4taGVhZGVyX19sYW5nLWxpc3RcIl0pO1xyXG5cclxuXHRmb3IgKGxldCBpID0gMDsgaSA8IGxhbmdBbW91bnQ7IGkrKykge1xyXG5cdFx0Y29uc3QgbGFuZ0Nob2ljZSA9IGNyZWF0ZUVsZW1lbnQoXCJsaVwiLCBbXCJsb2dpbi1oZWFkZXJfX2xhbmctY2hvaWNlXCJdLCB7XHJcblx0XHRcdHRhYmluZGV4OiAwLFxyXG5cdFx0fSk7XHJcblx0XHRjb25zdCBkYXRhID0gT2JqZWN0LmtleXMobGFuZ05hbWVzKVtpXTtcclxuXHRcdGNvbnN0IHRleHQgPSBPYmplY3QudmFsdWVzKGxhbmdOYW1lcylbaV07XHJcblxyXG5cdFx0bGFuZ0Nob2ljZS5kYXRhc2V0LmxhbmcgPSBkYXRhO1xyXG5cdFx0bGFuZ0Nob2ljZS50ZXh0Q29udGVudCA9IHRleHQ7XHJcblx0XHRsYW5nQ2hvaWNlLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gaSAqIDEwMCArIFwibXNcIjtcclxuXHRcdGxhbmdMaXN0LmFwcGVuZChsYW5nQ2hvaWNlKTtcclxuXHR9XHJcblxyXG5cdGxhbmdQbGF0Zm9ybUxhbmcudGV4dENvbnRlbnQgPSBsYW5nTmFtZXNbbGFuZ3VhZ2VdO1xyXG5cclxuXHRsYW5nU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0aGFuZGxlTGFuZ1NlbGVjdC5jYWxsKGxhbmdTZWxlY3QsIGUsIGxhbmdQbGF0Zm9ybUxhbmcpO1xyXG5cdH0pO1xyXG5cclxuXHRsYW5nU2VsZWN0LmFwcGVuZChsYW5nUGxhdGZvcm1MYW5nLCBsYW5nQXJyb3csIGxhbmdMaXN0KTtcclxuXHRoZWFkZXIuYXBwZW5kKGxhbmdTZWxlY3QpO1xyXG5cclxuXHRyZXR1cm4gaGVhZGVyO1xyXG5cdC8vIGVuZCBvZiBsYW5ndWFnZSBzZWxlY3RvclxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZUxvZ2luUGFnZSA9ICh7XHJcblx0bWFpbjoge1xyXG5cdFx0dGV4dDogeyB0aXRsZSwgc3VidGl0bGUsIGRlc2NyaXB0aW9uLCBidXR0b24gfSxcclxuXHRcdHBsYWNlaG9sZGVyOiB7IHVzZXJuYW1lLCBwYXNzd29yZCB9LFxyXG5cdH0sXHJcbn0pID0+IHtcclxuXHRjb25zdCBtYWluQ29udGVudCA9IGNyZWF0ZUVsZW1lbnQoXCJtYWluXCIsIFtcIm1haW5cIl0pO1xyXG5cdGNvbnN0IHdyYXBwZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIndyYXBwZXJcIl0pO1xyXG5cdGNvbnN0IGxvZ2luVGl0bGUgPSBjcmVhdGVFbGVtZW50KFwiaDFcIik7XHJcblx0Y29uc3QgbG9naW5UaXRsZVRvcCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW5fX3RpdGxlXCJdKTtcclxuXHRjb25zdCBsb2dpblRpdGxlQm90dG9tID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1wibWFpbl9fc3VidGl0bGVcIl0pO1xyXG5cdGNvbnN0IGxvZ2luVGV4dCA9IGNyZWF0ZUVsZW1lbnQoXCJwXCIsIFtcIm1haW5fX3RleHRcIl0pO1xyXG5cdGNvbnN0IGZvcm0gPSBjcmVhdGVFbGVtZW50KFwiZm9ybVwiLCBbXCJtYWluX19mb3JtXCJdKTtcclxuXHRjb25zdCB1c2VybmFtZUlucHV0ID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiaW5wdXRcIixcclxuXHRcdFtcIm1haW5fX2Zvcm0taW5wdXRcIiwgXCJtYWluX19mb3JtLWlucHV0LS11c2VybmFtZVwiXSxcclxuXHRcdHsgdHlwZTogXCJ0ZXh0XCIsIHBsYWNlaG9sZGVyOiB1c2VybmFtZSB9XHJcblx0KTtcclxuXHRjb25zdCBwYXNzd29yZElucHV0ID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiaW5wdXRcIixcclxuXHRcdFtcIm1haW5fX2Zvcm0taW5wdXRcIiwgXCJtYWluX19mb3JtLWlucHV0LS1wYXNzd29yZFwiXSxcclxuXHRcdHsgdHlwZTogXCJwYXNzd29yZFwiLCBwbGFjZWhvbGRlcjogcGFzc3dvcmQgfVxyXG5cdCk7XHJcblx0Y29uc3Qgc3VibWl0QnRuID0gY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCBbXCJtYWluX19mb3JtLWJ1dHRvblwiXSwge1xyXG5cdFx0dHlwZTogXCJzdWJtaXRcIixcclxuXHR9KTtcclxuXHRjb25zdCBidXR0b25UZXh0ID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1wibWFpbl9fZm9ybS1idXR0b24tdGV4dFwiXSk7XHJcblxyXG5cdGNvbnN0IGVycm9yVHh0ID0gY3JlYXRlRWxlbWVudChcInBcIiwgW1wibWFpbl9fZm9ybS1lcnJvci10eHRcIl0pO1xyXG5cdGxvZ2luVGl0bGVUb3AudGV4dENvbnRlbnQgPSB0aXRsZTtcclxuXHRsb2dpblRpdGxlQm90dG9tLnRleHRDb250ZW50ID0gc3VidGl0bGU7XHJcblx0bG9naW5UZXh0LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcblx0YnV0dG9uVGV4dC50ZXh0Q29udGVudCA9IGJ1dHRvbjtcclxuXHJcblx0bG9naW5UaXRsZS5hcHBlbmQobG9naW5UaXRsZVRvcCwgbG9naW5UaXRsZUJvdHRvbSk7XHJcblx0c3VibWl0QnRuLmFwcGVuZChidXR0b25UZXh0KTtcclxuXHRmb3JtLmFwcGVuZCh1c2VybmFtZUlucHV0LCBwYXNzd29yZElucHV0LCBzdWJtaXRCdG4sIGVycm9yVHh0KTtcclxuXHJcblx0d3JhcHBlci5hcHBlbmQobG9naW5UaXRsZSwgbG9naW5UZXh0LCBmb3JtKTtcclxuXHRtYWluQ29udGVudC5hcHBlbmQod3JhcHBlcik7XHJcblxyXG5cdHN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdGNvbnN0IHVzZXJEYXRhID0gSlNPTi5wYXJzZT8uKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidXNlckRhdGFcIikpO1xyXG5cclxuXHRcdGNvbnN0IHJlc3VsdHMgPSBoYW5kbGVMb2dpblZhbGlkYXRpb24oXHJcblx0XHRcdGUsXHJcblx0XHRcdHVzZXJuYW1lSW5wdXQsXHJcblx0XHRcdHBhc3N3b3JkSW5wdXQsXHJcblx0XHRcdHRyYW5zbGF0aW9ucy5tYWluLnRleHQuZXJyb3JSZXF1aXJlZCxcclxuXHRcdFx0dHJhbnNsYXRpb25zLm1haW4udGV4dC5lcnJvckludmFsaWQsXHJcblx0XHRcdFVTRVJOQU1FLFxyXG5cdFx0XHRQQVNTV09SRCxcclxuXHRcdFx0ZXJyb3JUeHRcclxuXHRcdCk7XHJcblxyXG5cdFx0aWYgKCFyZXN1bHRzKSB7XHJcblx0XHRcdGVycm9yVHh0LmNsYXNzTGlzdC5yZW1vdmUoXCJ2aXNpYmxlXCIpO1xyXG5cdFx0XHRlLnRhcmdldC5hcHBlbmQoc2hvd1NtYWxsTG9hZGVyKCkpO1xyXG5cdFx0XHRlLnRhcmdldC5kaXNhYmxlZCA9IHRydWU7XHJcblxyXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0XHRlLnRhcmdldC5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdGhpZGVTbWFsbExvYWRlcigpO1xyXG5cclxuXHRcdFx0XHRzZXRVc2VyUHJlZmVyZW5jZShcInRyYW5zbGF0aW9uc1wiLCB0cmFuc2xhdGlvbnMsIHVzZXJEYXRhKTtcclxuXHRcdFx0XHRzZXRVc2VyUHJlZmVyZW5jZShcImxvZ2dlZEluXCIsIHRydWUsIHVzZXJEYXRhKTtcclxuXHRcdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwicHJvZmlsZXMuaHRtbFwiOyAvLyBwcnplasWbY2llIG5hIHN0cm9uxJkgeiBwcm9maWxhbWlcclxuXHRcdFx0fSwgMzAwMCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHJldHVybiBtYWluQ29udGVudDtcclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZUxvZ2luVmFsaWRhdGlvbiA9IChcclxuXHRlLFxyXG5cdHVzZXJuYW1lSW5wdXQsXHJcblx0cGFzc3dvcmRJbnB1dCxcclxuXHRyZXF1aXJlRXJyb3IsXHJcblx0aW52YWxpZEVycm9yLFxyXG5cdHVzZXJuYW1lLFxyXG5cdHBhc3N3b3JkLFxyXG5cdGVycm9yVHh0XHJcbikgPT4ge1xyXG5cdGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcblx0aWYgKHVzZXJuYW1lSW5wdXQudmFsdWUudHJpbSgpID09PSBcIlwiIHx8IHBhc3N3b3JkSW5wdXQudmFsdWUudHJpbSgpID09PSBcIlwiKSB7XHJcblx0XHRlcnJvclR4dC5jbGFzc0xpc3QuYWRkKFwidmlzaWJsZVwiKTtcclxuXHRcdGVycm9yVHh0LnRleHRDb250ZW50ID0gcmVxdWlyZUVycm9yO1xyXG5cdFx0cmV0dXJuIHJlcXVpcmVFcnJvcjtcclxuXHR9IGVsc2UgaWYgKFxyXG5cdFx0dXNlcm5hbWVJbnB1dC52YWx1ZS50cmltKCkgIT09IHVzZXJuYW1lIHx8XHJcblx0XHRwYXNzd29yZElucHV0LnZhbHVlLnRyaW0oKSAhPT0gcGFzc3dvcmRcclxuXHQpIHtcclxuXHRcdGUudGFyZ2V0LmRpc2FibGVkID0gdHJ1ZTtcclxuXHRcdGUudGFyZ2V0LmFwcGVuZChzaG93U21hbGxMb2FkZXIoKSk7XHJcblx0XHRlcnJvclR4dC5jbGFzc0xpc3QucmVtb3ZlKFwidmlzaWJsZVwiKTtcclxuXHJcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LmFkZChcInZpc2libGVcIik7XHJcblx0XHRcdGVycm9yVHh0LnRleHRDb250ZW50ID0gaW52YWxpZEVycm9yO1xyXG5cclxuXHRcdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHJcblx0XHRcdGhpZGVTbWFsbExvYWRlcigpO1xyXG5cdFx0fSwgMzAwMCk7XHJcblx0XHRyZXR1cm4gaW52YWxpZEVycm9yO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc2hvd0JpZ0xvYWRlciA9ICgpID0+IHtcclxuXHRjb25zdCBsb2FkaW5nQXJlYSA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibG9hZGluZy1hcmVhXCJdKTtcclxuXHRsb2FkaW5nQXJlYS5pbm5lckhUTUwgPSBgICAgICAgICAgICAgPHN2ZyBjbGFzcz1cImxvYWRlci1iaWdcIiB2aWV3Qm94PVwiMCAwIDEyMCAxMjBcIiB3aWR0aD1cIjEyMFwiIGhlaWdodD1cIjEyMFwiPlxyXG4gICAgICAgICAgICAgICAgPGRlZnM+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxpbmVhckdyYWRpZW50IGlkPVwibG9hZGVyLWFjY2VudFwiIHgxPVwiMCVcIiB5MT1cIjAlXCIgeDI9XCIxMDAlXCIgeTI9XCIwJVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIwJVwiIHN0b3AtY29sb3I9XCIjNGRhOGRhXCIgc3RvcC1vcGFjaXR5PVwiMC44XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiNzAlXCIgc3RvcC1jb2xvcj1cIiM0ZGE4ZGFcIiBzdG9wLW9wYWNpdHk9XCIwLjRcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIxMDAlXCIgc3RvcC1jb2xvcj1cIiM0ZGE4ZGFcIiBzdG9wLW9wYWNpdHk9XCIwXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICA8L2xpbmVhckdyYWRpZW50PlxyXG4gICAgICAgICAgICAgICAgPC9kZWZzPlxyXG4gICAgICAgICAgICAgICAgPGNpcmNsZSBjbGFzcz1cImxvYWRpbmctY2lyY2xlLWJpZ1wiIHI9XCIzNVwiIGN4PVwiNjBcIiBjeT1cIjYwXCI+PC9jaXJjbGU+XHJcbiAgICAgICAgICAgIDwvc3ZnPmA7XHJcblx0cmV0dXJuIGxvYWRpbmdBcmVhO1xyXG59O1xyXG5leHBvcnQgY29uc3QgaGlkZUJpZ0xvYWRlciA9ICgpID0+IHtcclxuXHRjb25zdCBsb2FkaW5nQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubG9hZGluZy1hcmVhXCIpO1xyXG5cdGxvYWRpbmdBcmVhPy5yZW1vdmUoKTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzaG93U21hbGxMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcImxvYWRpbmctYXJlYS1zbWFsbFwiXSk7XHJcblx0bG9hZGluZ0FyZWEuaW5uZXJIVE1MID0gYDxzdmcgY2xhc3M9XCJsb2FkZXItc21hbGxcIiB2aWV3Qm94PVwiMCAwIDEyMCAxMjBcIiB3aWR0aD1cIjEyMFwiIGhlaWdodD1cIjEyMFwiPlxyXG4gICAgICAgICAgICAgICAgPGRlZnM+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxpbmVhckdyYWRpZW50IGlkPVwibG9hZGVyLWFjY2VudC1zbWFsbFwiIHgxPVwiMCVcIiB5MT1cIjAlXCIgeDI9XCIxMDAlXCIgeTI9XCIwJVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIwJVwiIHN0b3AtY29sb3I9XCJ3aGl0ZVwiIHN0b3Atb3BhY2l0eT1cIjAuOFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjcwJVwiIHN0b3AtY29sb3I9XCJ3aGl0ZVwiIHN0b3Atb3BhY2l0eT1cIjAuM1wiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjEwMCVcIiBzdG9wLWNvbG9yPVwid2hpdGVcIiBzdG9wLW9wYWNpdHk9XCIwXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICA8L2xpbmVhckdyYWRpZW50PlxyXG4gICAgICAgICAgICAgICAgPC9kZWZzPlxyXG4gICAgICAgICAgICAgICAgPGNpcmNsZSBjbGFzcz1cImxvYWRpbmctY2lyY2xlLXNtYWxsXCIgcj1cIjEyXCIgY3g9XCI2MFwiIGN5PVwiNjBcIj48L2NpcmNsZT5cclxuICAgICAgICAgICAgPC9zdmc+YDtcclxuXHJcblx0cmV0dXJuIGxvYWRpbmdBcmVhO1xyXG59O1xyXG5leHBvcnQgY29uc3QgaGlkZVNtYWxsTG9hZGVyID0gKCkgPT4ge1xyXG5cdGNvbnN0IGxvYWRpbmdBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5sb2FkaW5nLWFyZWEtc21hbGxcIik7XHJcblx0bG9hZGluZ0FyZWEucmVtb3ZlKCk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlUHJvZmlsZXNQYWdlID0gKHtcclxuXHRwcm9maWxlczoge1xyXG5cdFx0dGV4dDogeyB0aXRsZSwgYWRkUHJvZmlsZUluZm8gfSxcclxuXHRcdGFyaWE6IHsgYWRkUHJvZmlsZUJ0biwgdXNlclByb2ZpbGVCdG4sIHVzZXJCdG5DdXN0b21pemUgfSxcclxuXHR9LFxyXG5cdGVycm9yUG9wdXA6IHtcclxuXHRcdHRleHQ6IHsgbWF4UHJvZmlsZXMsIGVtcHR5RmllbGQgfSxcclxuXHR9LFxyXG59KSA9PiB7XHJcblx0Y29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlPy4obG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKSk7XHJcblx0Y29uc3QgdXNlclByb2ZpbGVzTGlzdCA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXM7XHJcblxyXG5cdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGFpbmVyXCIpO1xyXG5cdGNvbnN0IHByb2ZpbGVzUGFnZU1haW4gPSBjcmVhdGVFbGVtZW50KFwibWFpblwiLCBbXCJtYWluLXByb2ZpbGVzXCJdKTtcclxuXHRjb25zdCB3cmFwcGVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJ3cmFwcGVyXCJdKTtcclxuXHRjb25zdCBwcm9maWxlc1RpdGxlID0gY3JlYXRlRWxlbWVudChcImgxXCIsIFtcclxuXHRcdFwibWFpbl9fdGl0bGVcIixcclxuXHRcdFwibWFpbi1wcm9maWxlc19fdGl0bGVcIixcclxuXHRdKTtcclxuXHRjb25zdCBwcm9maWxlc0JveCA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fYm94XCJdKTtcclxuXHJcblx0cHJvZmlsZXNUaXRsZS50ZXh0Q29udGVudCA9IHRpdGxlO1xyXG5cclxuXHRpZiAodXNlclByb2ZpbGVzTGlzdCAmJiBPYmplY3Qua2V5cyh1c2VyUHJvZmlsZXNMaXN0KS5sZW5ndGggIT09IDApIHtcclxuXHRcdGZvciAoY29uc3Qga2V5IGluIHVzZXJQcm9maWxlc0xpc3QpIHtcclxuXHRcdFx0cHJvZmlsZXNCb3guYXBwZW5kKFxyXG5cdFx0XHRcdGNyZWF0ZVByb2ZpbGUoXHJcblx0XHRcdFx0XHR1c2VyUHJvZmlsZUJ0bixcclxuXHRcdFx0XHRcdHVzZXJCdG5DdXN0b21pemUsXHJcblx0XHRcdFx0XHR1c2VyQnRuQ3VzdG9taXplLFxyXG5cdFx0XHRcdFx0ZW1wdHlGaWVsZFxyXG5cdFx0XHRcdClcclxuXHRcdFx0KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHByb2ZpbGVzQm94LmFwcGVuZChcclxuXHRcdGNyZWF0ZVByb2ZpbGVBZGRCdG4oXHJcblx0XHRcdGFkZFByb2ZpbGVCdG4sXHJcblx0XHRcdGFkZFByb2ZpbGVJbmZvLFxyXG5cdFx0XHR1c2VyUHJvZmlsZUJ0bixcclxuXHRcdFx0cHJvZmlsZXNCb3gsXHJcblx0XHRcdHVzZXJCdG5DdXN0b21pemUsXHJcblx0XHRcdHVzZXJCdG5DdXN0b21pemUsXHJcblx0XHRcdG1heFByb2ZpbGVzLFxyXG5cdFx0XHRlbXB0eUZpZWxkXHJcblx0XHQpXHJcblx0KTtcclxuXHR3cmFwcGVyLmFwcGVuZChwcm9maWxlc1RpdGxlLCBwcm9maWxlc0JveCk7XHJcblx0cHJvZmlsZXNQYWdlTWFpbi5hcHBlbmQod3JhcHBlcik7XHJcblxyXG5cdGNvbnRhaW5lci5hcHBlbmQocHJvZmlsZXNQYWdlTWFpbik7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVQcm9maWxlID0gKGFyaWFJbmZvLCB1c2VyQnRuSW5mbywgc2F2ZUJ0bkFyaWEsIGVtcHR5RmllbGRFcnJvcikgPT4ge1xyXG5cdGNvbnN0IHVzZXJEYXRhID0gSlNPTi5wYXJzZT8uKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidXNlckRhdGFcIikpO1xyXG5cdGNvbnN0IGV4aXN0aW5nUHJvZmlsZXMgPSB1c2VyRGF0YT8udXNlclByb2ZpbGVzIHx8IFtdO1xyXG5cclxuXHRsZXQgY29sb3I7XHJcblxyXG5cdGNvbnN0IGNvbG9ycyA9IFtcIiNkYzRhMzRcIiwgXCIjMDYyRTYzXCIsIFwiI0ZBQzA0NFwiXTtcclxuXHJcblx0aWYgKHByb2ZpbGVzQ291bnQgPT0gMyB8fCBleGlzdGluZ1Byb2ZpbGVzLmxlbmd0aCA9PT0gMykgcmV0dXJuO1xyXG5cclxuXHRwcm9maWxlc0NvdW50Kys7XHJcblx0Y29sb3IgPSBjb2xvcnNbcHJvZmlsZXNDb3VudF07XHJcblxyXG5cdGNvbnN0IHVzZXJQcm9maWxlID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX19wcm9maWxlXCJdKTtcclxuXHRjb25zdCB1c2VyQXZhdGFyQm94ID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX19hdmF0YXJcIl0pO1xyXG5cdGNvbnN0IHVzZXJQcm9maWxlQnRuID0gY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCBbXCJtYWluLXByb2ZpbGVzX19idG5cIl0sIHtcclxuXHRcdFwiYXJpYS1sYWJlbFwiOiBhcmlhSW5mbyxcclxuXHRcdFwiZGF0YS1pZFwiOiBgdXNlci1wcm9maWxlLSR7cHJvZmlsZXNDb3VudH1gLFxyXG5cdH0pO1xyXG5cclxuXHRjb25zdCB1c2VyUHJvZmlsZUluZm9Cb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX3VzZXItaW5mb1wiXSk7XHJcblx0Y29uc3QgdXNlclByb2ZpbGVJbmZvID0gY3JlYXRlRWxlbWVudChcImlucHV0XCIsIFtcIm1haW4tcHJvZmlsZXNfX25hbWVcIl0sIHtcclxuXHRcdHR5cGU6IFwidGV4dFwiLFxyXG5cdFx0cmVhZG9ubHk6IHRydWUsXHJcblx0XHR2YWx1ZTpcclxuXHRcdFx0ZXhpc3RpbmdQcm9maWxlc1tgdXNlci1wcm9maWxlLSR7cHJvZmlsZXNDb3VudH1gXSB8fFxyXG5cdFx0XHRgSGFuZHNvbWUgVXNlciAke3Byb2ZpbGVzQ291bnR9YCxcclxuXHR9KTtcclxuXHRjb25zdCBlZGl0VXNlckluZm9CdG4gPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJidXR0b25cIixcclxuXHRcdFtcIm1haW4tcHJvZmlsZXNfX2VkaXQtbmFtZVwiXSxcclxuXHRcdHsgXCJhcmlhLWxhYmVsXCI6IHVzZXJCdG5JbmZvIH1cclxuXHQpO1xyXG5cdC8vIGNvbnN0IHJlbW92ZVVzZXJCdG4gPSBjcmVhdGVFbGVtZW50KFxyXG5cdC8vIFx0XCJidXR0b25cIixcclxuXHQvLyBcdFtcIm1haW4tcHJvZmlsZXNfX3JlbW92ZS11c2VyXCJdLFxyXG5cdC8vIFx0eyBcImFyaWEtbGFiZWxcIjogXCJQcnp5Y2lzayB1bW/FvGxpd2lhasSFY3kgdXN1bmnEmWNpZSB1xbx5dGtvd25pa2FcIiB9XHJcblx0Ly8gKTtcclxuXHRjb25zdCBlZGl0VXNlckluZm9JY29uID0gY3JlYXRlRWxlbWVudChcImltZ1wiLCBbXCJtYWluLXByb2ZpbGVzX19lZGl0LWljb25cIl0sIHtcclxuXHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRoZWlnaHQ6IFwiMjRcIixcclxuXHRcdGxvYWRpbmc6IFwibGF6eVwiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdFx0c3JjOiBcIi4vc3JjL2ljb25zL2VkaXQuc3ZnXCIsXHJcblx0fSk7XHJcblxyXG5cdHVzZXJQcm9maWxlQnRuLmlubmVySFRNTCA9IGA8c3ZnIGNsYXNzPVwibWFpbi1wcm9maWxlc19faW1nXCIgd2lkdGg9XCIxNTBcIiBoZWlnaHQ9XCIxNTBcIiB2aWV3Qm94PVwiMCAwIDIwMCAyMDBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+XHJcblx0PGNpcmNsZSBjeD1cIjcwXCIgY3k9XCI3MFwiIHI9XCI4XCIgZmlsbD1cIndoaXRlXCIgLz5cclxuXHQ8Y2lyY2xlIGN4PVwiMTMwXCIgY3k9XCI3MFwiIHI9XCI4XCIgZmlsbD1cIndoaXRlXCIgLz5cclxuXHQ8cGF0aCBkPVwiTTYwIDExMCBRMTAwIDE1MCAxNDAgMTEwXCIgc3Ryb2tlPVwid2hpdGVcIiBzdHJva2Utd2lkdGg9XCI2XCJcclxuXHRmaWxsPVwidHJhbnNwYXJlbnRcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgLz5cclxuXHQ8L3N2Zz5gO1xyXG5cdHVzZXJQcm9maWxlQnRuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xyXG5cclxuXHR1c2VyQXZhdGFyQm94LmFwcGVuZCh1c2VyUHJvZmlsZUJ0bik7XHJcblx0ZWRpdFVzZXJJbmZvQnRuLmFwcGVuZChlZGl0VXNlckluZm9JY29uKTtcclxuXHR1c2VyUHJvZmlsZUluZm9Cb3guYXBwZW5kKHVzZXJQcm9maWxlSW5mbywgZWRpdFVzZXJJbmZvQnRuKTtcclxuXHR1c2VyUHJvZmlsZS5hcHBlbmQodXNlckF2YXRhckJveCwgdXNlclByb2ZpbGVJbmZvQm94KTtcclxuXHJcblx0Ly8gc2V0VXNlclByZWZlcmVuY2UoXCJwcm9maWxlc0NvdW50XCIsIHByb2ZpbGVzQ291bnQsIHVzZXJEYXRhKVxyXG5cclxuXHRpZiAoIWV4aXN0aW5nUHJvZmlsZXNbYHVzZXItcHJvZmlsZS0ke3Byb2ZpbGVzQ291bnR9YF0pIHtcclxuXHRcdGNvbnN0IHVwZGF0ZWRQcm9maWxlcyA9IHtcclxuXHRcdFx0Li4uZXhpc3RpbmdQcm9maWxlcyxcclxuXHRcdFx0W2B1c2VyLXByb2ZpbGUtJHtwcm9maWxlc0NvdW50fWBdOiBgSGFuZHNvbWUgVXNlciAke3Byb2ZpbGVzQ291bnR9YCxcclxuXHRcdH07XHJcblx0XHRzZXRVc2VyUHJlZmVyZW5jZShcInVzZXJQcm9maWxlc1wiLCB1cGRhdGVkUHJvZmlsZXMsIHVzZXJEYXRhKTtcclxuXHR9XHJcblxyXG5cdGVkaXRVc2VySW5mb0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdGVkaXRVc2VybmFtZShlLCB1c2VyUHJvZmlsZUluZm9Cb3gsIHNhdmVCdG5BcmlhLCBlbXB0eUZpZWxkRXJyb3IpO1xyXG5cdH0pO1xyXG5cclxuXHR1c2VyUHJvZmlsZUluZm8uYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcclxuXHRcdGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB7XHJcblx0XHRcdHNhdmVVc2VybmFtZShlLCBlbXB0eUZpZWxkRXJyb3IpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHRyZXR1cm4gdXNlclByb2ZpbGU7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVQcm9maWxlQWRkQnRuID0gKFxyXG5cdGFyaWFJbmZvLFxyXG5cdGluZm8sXHJcblx0dXNlckJ0bkFyaWEsXHJcblx0cHJvZmlsZXNCb3gsXHJcblx0dXNlckJ0bkluZm8sXHJcblx0c2F2ZUJ0bkFyaWEsXHJcblx0bWF4UHJvZmlsZXNFcnJvcixcclxuXHRlbXB0eUZpZWxkRXJyb3JcclxuKSA9PiB7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUJveCA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fYWRkLXByb2ZpbGVcIl0pO1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVBdmF0YXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2F2YXRhclwiXSk7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUJ0biA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImJ1dHRvblwiLFxyXG5cdFx0W1wibWFpbi1wcm9maWxlc19fYnRuXCIsIFwibWFpbi1wcm9maWxlc19fYnRuLS1hZGQtcHJvZmlsZVwiXSxcclxuXHRcdHsgXCJhcmlhLWxhYmVsXCI6IGFyaWFJbmZvIH1cclxuXHQpO1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVQbHVzSWNvbiA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibWFpbi1wcm9maWxlc19fYWRkLWltZ1wiXSwge1xyXG5cdFx0c3JjOiBcIi4vc3JjL2ljb25zL2FkZC1wcm9maWxlLnN2Z1wiLFxyXG5cdFx0bG9hZGluZzogXCJsYXp5XCIsXHJcblx0XHRhbHQ6IFwiXCIsXHJcblx0fSk7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUluZm8gPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXCJtYWluLXByb2ZpbGVzX19uYW1lXCJdKTtcclxuXHJcblx0YWRkUHJvZmlsZUluZm8udGV4dENvbnRlbnQgPSBpbmZvO1xyXG5cclxuXHRhZGRQcm9maWxlQnRuLmFwcGVuZChhZGRQcm9maWxlUGx1c0ljb24pO1xyXG5cdGFkZFByb2ZpbGVBdmF0YXIuYXBwZW5kKGFkZFByb2ZpbGVCdG4pO1xyXG5cdGFkZFByb2ZpbGVCb3guYXBwZW5kKGFkZFByb2ZpbGVBdmF0YXIsIGFkZFByb2ZpbGVJbmZvKTtcclxuXHJcblx0YWRkUHJvZmlsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0Y29uc3QgcHJvZmlsZSA9IGNyZWF0ZVByb2ZpbGUoXHJcblx0XHRcdHVzZXJCdG5BcmlhLFxyXG5cdFx0XHR1c2VyQnRuSW5mbyxcclxuXHRcdFx0c2F2ZUJ0bkFyaWEsXHJcblx0XHRcdGVtcHR5RmllbGRFcnJvclxyXG5cdFx0KTtcclxuXHJcblx0XHRpZiAocHJvZmlsZSkge1xyXG5cdFx0XHRwcm9maWxlc0JveC5hcHBlbmQocHJvZmlsZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRzaG93RXJyb3JQb3B1cChtYXhQcm9maWxlc0Vycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHJldHVybiBhZGRQcm9maWxlQm94O1xyXG59O1xyXG5cclxuY29uc3QgZWRpdFVzZXJuYW1lID0gKGUsIHBhcmVudCwgc2F2ZUJ0bkFyaWEsIGVtcHR5RmllbGRFcnJvcikgPT4ge1xyXG5cdHJlc2V0U3RhdGVPZkVkaXRpbmcoZSk7XHJcblxyXG5cdGNvbnN0IGVkaXRCdG4gPSBlLnRhcmdldDtcclxuXHRjb25zdCBuYW1lVG9FZGl0ID0gZWRpdEJ0bi5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xyXG5cdGNvbnN0IHNhdmVCdG4gPSBjcmVhdGVTYXZlQnRuKHNhdmVCdG5BcmlhKTtcclxuXHJcblx0ZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xyXG5cdHNhdmVCdG4uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcclxuXHJcblx0cGFyZW50LmFwcGVuZChzYXZlQnRuKTtcclxuXHJcblx0bmFtZVRvRWRpdC5mb2N1cygpO1xyXG5cdG5hbWVUb0VkaXQuc2VsZWN0KCk7XHJcblx0bmFtZVRvRWRpdC5yZW1vdmVBdHRyaWJ1dGUoXCJyZWFkb25seVwiKTtcclxuXHRuYW1lVG9FZGl0LmNsYXNzTGlzdC5hZGQoXCJmb2N1c2VkXCIpO1xyXG5cclxuXHRzYXZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0c2F2ZVVzZXJuYW1lKGUsIGVtcHR5RmllbGRFcnJvcik7XHJcblx0fSk7XHJcbn07XHJcblxyXG5jb25zdCBzYXZlVXNlcm5hbWUgPSAoZSwgZW1wdHlGaWVsZEVycm9yKSA9PiB7XHJcblx0Y29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlPy4obG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKSk7XHJcblx0Y29uc3QgZXhpc3RpbmdQcm9maWxlcyA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXMgfHwgW107XHJcblxyXG5cdGNvbnN0IHNhdmVCdG4gPSBlLnRhcmdldDtcclxuXHRjb25zdCBjbG9zZXN0UHJvZmlsZSA9IHNhdmVCdG4uY2xvc2VzdChcIi5tYWluLXByb2ZpbGVzX19wcm9maWxlXCIpO1xyXG5cdGNvbnN0IGNsb3Nlc3RQcm9maWxlSWQgPSBjbG9zZXN0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLm1haW4tcHJvZmlsZXNfX2J0blwiKVxyXG5cdFx0LmRhdGFzZXQuaWQ7XHJcblx0Y29uc3QgY2xvc2VzdFByb2ZpbGVOYW1lID0gY2xvc2VzdFByb2ZpbGUucXVlcnlTZWxlY3RvcihcclxuXHRcdFwiLm1haW4tcHJvZmlsZXNfX25hbWVcIlxyXG5cdCk7XHJcblxyXG5cdGNvbnN0IGFsbEVkaXRCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tYWluLXByb2ZpbGVzX19lZGl0LW5hbWVcIik7XHJcblxyXG5cdGFsbEVkaXRCdG5zLmZvckVhY2goKGJ0bikgPT4gYnRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKSk7XHJcblxyXG5cdGlmIChjbG9zZXN0UHJvZmlsZU5hbWUudmFsdWUudHJpbSgpID09PSBcIlwiKSB7XHJcblx0XHRhbGxFZGl0QnRucy5mb3JFYWNoKChidG4pID0+IGJ0bi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKSk7XHJcblx0XHRyZXR1cm4gc2hvd0Vycm9yUG9wdXAoZW1wdHlGaWVsZEVycm9yLCBcIiNGQUMwNDRcIik7XHJcblx0fVxyXG5cclxuXHRjb25zdCB1cGRhdGVkUHJvZmlsZXMgPSB7XHJcblx0XHQuLi5leGlzdGluZ1Byb2ZpbGVzLFxyXG5cdFx0W2Nsb3Nlc3RQcm9maWxlSWRdOiBjbG9zZXN0UHJvZmlsZU5hbWUudmFsdWUsXHJcblx0fTtcclxuXHRzZXRVc2VyUHJlZmVyZW5jZShcInVzZXJQcm9maWxlc1wiLCB1cGRhdGVkUHJvZmlsZXMsIHVzZXJEYXRhKTtcclxuXHJcblx0cmVzZXRTdGF0ZU9mRWRpdGluZyhlKTtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZVNhdmVCdG4gPSAoc2F2ZUJ0bkFyaWEpID0+IHtcclxuXHRjb25zdCBzYXZlVXNlckluZm9CdG4gPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJidXR0b25cIixcclxuXHRcdFtcIm1haW4tcHJvZmlsZXNfX3NhdmUtbmFtZVwiLCBcImhpZGRlblwiXSxcclxuXHRcdHsgXCJhcmlhLWxhYmVsXCI6IHNhdmVCdG5BcmlhIH1cclxuXHQpO1xyXG5cdGNvbnN0IHNhdmVVc2VySW5mb0ljb24gPSBjcmVhdGVFbGVtZW50KFwiaW1nXCIsIFtcIm1haW4tcHJvZmlsZXNfX3NhdmUtaWNvblwiXSwge1xyXG5cdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdFx0bG9hZGluZzogXCJsYXp5XCIsXHJcblx0XHRhbHQ6IFwiXCIsXHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvc2F2ZS5zdmdcIixcclxuXHR9KTtcclxuXHJcblx0c2F2ZVVzZXJJbmZvQnRuLmFwcGVuZChzYXZlVXNlckluZm9JY29uKTtcclxuXHJcblx0cmV0dXJuIHNhdmVVc2VySW5mb0J0bjtcclxufTtcclxuXHJcbmNvbnN0IHJlc2V0U3RhdGVPZkVkaXRpbmcgPSAoZSkgPT4ge1xyXG5cdGNvbnN0IGZvY3VzZWROYW1lcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9jdXNlZFwiKTtcclxuXHRjb25zdCBhbGxTYXZlQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWFpbi1wcm9maWxlc19fc2F2ZS1uYW1lXCIpO1xyXG5cdGNvbnN0IGFsbEVkaXRCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tYWluLXByb2ZpbGVzX19lZGl0LW5hbWVcIik7XHJcblxyXG5cdGZvY3VzZWROYW1lcy5mb3JFYWNoKChlbCkgPT4ge1xyXG5cdFx0ZWwuc2V0QXR0cmlidXRlKFwicmVhZG9ubHlcIiwgdHJ1ZSk7XHJcblx0XHRlbC5jbGFzc0xpc3QucmVtb3ZlKFwiZm9jdXNlZFwiKTtcclxuXHRcdGVsLmJsdXIoKTtcclxuXHR9KTtcclxuXHRhbGxTYXZlQnRucy5mb3JFYWNoKChidG4pID0+IGJ0bi5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpKTtcclxuXHRhbGxFZGl0QnRucy5mb3JFYWNoKChidG4pID0+IGJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpKTtcclxufTtcclxuXHJcbmxldCBwb3B1cFZpc2libGUgPSBmYWxzZTtcclxuY29uc3Qgc2hvd0Vycm9yUG9wdXAgPSAodGV4dCwgY29sb3IpID0+IHtcclxuXHRpZiAocG9wdXBWaXNpYmxlKSByZXR1cm47XHJcblx0cG9wdXBWaXNpYmxlID0gdHJ1ZTtcclxuXHJcblx0Y29uc3Qgcm9vdCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcclxuXHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhaW5lclwiKTtcclxuXHJcblx0Y29uc3QgcG9wdXAgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcImVycm9yLXBvcHVwXCJdKTtcclxuXHRjb25zdCBwb3B1cEVycm9yID0gY3JlYXRlRWxlbWVudChcInBcIiwgW1wiZXJyb3ItcG9wdXBfX3RleHRcIl0pO1xyXG5cclxuXHRwb3B1cEVycm9yLnRleHRDb250ZW50ID0gdGV4dDtcclxuXHRyb290LnN0eWxlLnNldFByb3BlcnR5KFwiLS1lcnJvclR4dENvbG9yXCIsIGNvbG9yKTtcclxuXHJcblx0cG9wdXAuYXBwZW5kKHBvcHVwRXJyb3IpO1xyXG5cdGNvbnRhaW5lci5hcHBlbmQocG9wdXApO1xyXG5cclxuXHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XHJcblx0fSwgMjAwMCk7XHJcblx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRwb3B1cC5yZW1vdmUoKTtcclxuXHRcdHBvcHVwVmlzaWJsZSA9IGZhbHNlO1xyXG5cdH0sIDI1MDApO1xyXG59O1xyXG4iXX0=
