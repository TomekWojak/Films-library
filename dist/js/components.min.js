import{createElement}from"./helpers.min.js";import{setUserPreference}from"./updateStateFunctions.min.js";const userData=JSON.parse?.(localStorage.getItem("userData"));let profilesCount=userData?.profilesCount||0;const USERNAME="handsomeUser404",PASSWORD="5jksH9d.";export const createLoginHeader=({header:{alt:{logo:e},aria:{logoLink:t,changeLanguageButton:a}}},n,r,o,i)=>{const l=createElement("header",["header"]),s=createElement("a",["header__logo","login-header__logo"],{href:"/","aria-label":`${t}`}),c=createElement("img",["header__logo-img","login-header__logo-img"],{src:"./src/icons/logo.svg",alt:`${e}`,width:"24",height:"24"}),d=createElement("span",["header__logo-text","login-header__logo-text"]);d.textContent="Stream",s.append(c,d),l.append(s);const p=createElement("button",["login-header__lang-select"],{"aria-label":`${a}`}),m=createElement("span",["login-header__lang-platform-lang"]),f=createElement("img",["login-header__lang-arrow"],{src:"./src/icons/chevron-down.svg",alt:"",width:"24",height:"24"}),g=createElement("ul",["login-header__lang-list"]);for(let e=0;e<n;e++){const t=createElement("li",["login-header__lang-choice"],{tabindex:0}),a=Object.keys(r)[e],n=Object.values(r)[e];t.dataset.lang=a,t.textContent=n,t.style.animationDelay=100*e+"ms",g.append(t)}return m.textContent=r[o],p.addEventListener("click",e=>{i.call(p,e,m)}),p.append(m,f,g),l.append(p),l};export const createLoginPage=({main:{text:{title:e,subtitle:t,description:a,button:n},placeholder:{username:r,password:o}}})=>{const i=createElement("main",["main"]),l=createElement("div",["wrapper"]),s=createElement("h1"),c=createElement("span",["main__title"]),d=createElement("span",["main__subtitle"]),p=createElement("p",["main__text"]),m=createElement("form",["main__form"]),f=createElement("input",["main__form-input","main__form-input--username"],{type:"text",placeholder:r}),g=createElement("input",["main__form-input","main__form-input--password"],{type:"password",placeholder:o}),u=createElement("button",["main__form-button"],{type:"submit"}),_=createElement("span",["main__form-button-text"]),h=createElement("p",["main__form-error-txt"]);return c.textContent=e,d.textContent=t,p.textContent=a,_.textContent=n,s.append(c,d),u.append(_),m.append(f,g,u,h),l.append(s,p,m),i.append(l),u.addEventListener("click",e=>{const t=JSON.parse?.(localStorage.getItem("userData"));handleLoginValidation(e,f,g,translations.main.text.errorRequired,translations.main.text.errorInvalid,USERNAME,PASSWORD,h)||(h.classList.remove("visible"),e.target.append(showSmallLoader()),e.target.disabled=!0,setTimeout(()=>{e.target.disabled=!1,hideSmallLoader(),setUserPreference("translations",translations,t),setUserPreference("loggedIn",!0,t),window.location.href="profiles.html"},3e3))}),i};const handleLoginValidation=(e,t,a,n,r,o,i,l)=>(e.preventDefault(),""===t.value.trim()||""===a.value.trim()?(l.classList.add("visible"),l.textContent=n,n):t.value.trim()!==o||a.value.trim()!==i?(e.target.disabled=!0,e.target.append(showSmallLoader()),l.classList.remove("visible"),setTimeout(()=>{l.classList.add("visible"),l.textContent=r,e.target.disabled=!1,hideSmallLoader()},3e3),r):null);export const showBigLoader=()=>{const e=createElement("div",["loading-area"]);return e.innerHTML='            <svg class="loader-big" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="#4da8da" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="#4da8da" stop-opacity="0.4" />\n                        <stop offset="100%" stop-color="#4da8da" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-big" r="35" cx="60" cy="60"></circle>\n            </svg>',e};export const hideBigLoader=()=>{const e=document.querySelector(".loading-area");e?.remove()};export const showSmallLoader=()=>{const e=createElement("div",["loading-area-small"]);return e.innerHTML='<svg class="loader-small" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent-small" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="white" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="white" stop-opacity="0.3" />\n                        <stop offset="100%" stop-color="white" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-small" r="12" cx="60" cy="60"></circle>\n            </svg>',e};export const hideSmallLoader=()=>{document.querySelector(".loading-area-small").remove()};export const createProfilesPage=({profiles:{text:{title:e,addProfileInfo:t},aria:{addProfileBtn:a,userProfileBtn:n,userBtnCustomize:r}}})=>{const o=JSON.parse?.(localStorage.getItem("userData")),i=o?.userProfiles,l=document.querySelector(".container"),s=createElement("main",["main-profiles"]),c=createElement("div",["wrapper"]),d=createElement("h1",["main__title","main-profiles__title"]),p=createElement("div",["main-profiles__box"]);if(d.textContent=e,i&&0!==Object.keys(i).length)for(const e in i)p.append(createProfile(n,r,r));p.append(createProfileAddBtn(a,t,n,p,r,r)),c.append(d,p),s.append(c),l.append(s)};const createProfile=(e,t,a)=>{const n=JSON.parse?.(localStorage.getItem("userData")),r=n?.userProfiles||[];let o;if(3==profilesCount||3===r.length)return;profilesCount++,o=["#dc4a34","#062E63","#FAC044"][profilesCount];const i=createElement("div",["main-profiles__profile"]),l=createElement("div",["main-profiles__avatar"]),s=createElement("button",["main-profiles__btn"],{"aria-label":e,"data-id":`user-profile-${profilesCount}`}),c=createElement("div",["main-profiles__user-info"]),d=createElement("input",["main-profiles__name"],{type:"text",readonly:!0,value:r[`user-profile-${profilesCount}`]||`Handsome User ${profilesCount}`}),p=createElement("button",["main-profiles__edit-name"],{"aria-label":t}),m=createElement("img",["main-profiles__edit-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/edit.svg"});if(s.innerHTML='<svg class="main-profiles__img" width="150" height="150" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">\n\t<circle cx="70" cy="70" r="8" fill="white" />\n\t<circle cx="130" cy="70" r="8" fill="white" />\n\t<path d="M60 110 Q100 150 140 110" stroke="white" stroke-width="6"\n\tfill="transparent" stroke-linecap="round" />\n\t</svg>',s.style.backgroundColor=o,l.append(s),p.append(m),c.append(d,p),i.append(l,c),!r[`user-profile-${profilesCount}`]){const e={...r,[`user-profile-${profilesCount}`]:`Handsome User ${profilesCount}`};setUserPreference("userProfiles",e,n)}return p.addEventListener("click",e=>{editUsername(e,c,a)}),i},createProfileAddBtn=(e,t,a,n,r,o)=>{const i=createElement("div",["main-profiles__add-profile"]),l=createElement("div",["main-profiles__avatar"]),s=createElement("button",["main-profiles__btn","main-profiles__btn--add-profile"],{"aria-label":e}),c=createElement("img",["main-profiles__add-img"],{src:"./src/icons/add-profile.svg",loading:"lazy",alt:""}),d=createElement("span",["main-profiles__name"]);return d.textContent=t,s.append(c),l.append(s),i.append(l,d),s.addEventListener("click",()=>{const e=createProfile(a,r,o);e?n.append(e):alert("Osiągnięto maksymalną liczbę profilów!")}),i},editUsername=(e,t,a)=>{const n=e.target,r=n.previousElementSibling,o=createSaveBtn(a);n.classList.add("hidden"),o.classList.remove("hidden"),t.append(o),r.focus(),r.select(),r.removeAttribute("readonly"),r.classList.add("focused"),o.addEventListener("click",e=>{saveUsername(e)})},saveUsername=e=>{const t=JSON.parse?.(localStorage.getItem("userData")),a=t?.userProfiles||[],n=e.target.closest(".main-profiles__profile"),r=n.querySelector(".main-profiles__btn").dataset.id,o=n.querySelector(".main-profiles__name"),i={...a,[r]:o.value};setUserPreference("userProfiles",i,t),resetStateOfEditing()},createSaveBtn=e=>{const t=createElement("button",["main-profiles__save-name","hidden"],{"aria-label":e}),a=createElement("img",["main-profiles__save-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/save.svg"});return t.append(a),t},resetStateOfEditing=()=>{const e=document.querySelectorAll(".focused"),t=document.querySelectorAll(".main-profiles__save-name"),a=document.querySelectorAll(".main-profiles__edit-name");e.forEach(e=>{e.setAttribute("readonly",!0),e.classList.remove("focused")}),t.forEach(e=>e.classList.add("hidden")),a.forEach(e=>e.classList.remove("hidden"))};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50cy5taW4uanMiLCJuYW1lcyI6WyJjcmVhdGVFbGVtZW50Iiwic2V0VXNlclByZWZlcmVuY2UiLCJ1c2VyRGF0YSIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJwcm9maWxlc0NvdW50IiwiVVNFUk5BTUUiLCJQQVNTV09SRCIsImNyZWF0ZUxvZ2luSGVhZGVyIiwiaGVhZGVyIiwiYWx0IiwibG9nbyIsImFyaWEiLCJsb2dvTGluayIsImNoYW5nZUxhbmd1YWdlQnV0dG9uIiwibGFuZ0Ftb3VudCIsImxhbmdOYW1lcyIsImxhbmd1YWdlIiwiaGFuZGxlTGFuZ1NlbGVjdCIsInBhZ2VMb2dvIiwiaHJlZiIsImxvZ29JbWciLCJzcmMiLCJ3aWR0aCIsImhlaWdodCIsImxvZ29UZXh0IiwidGV4dENvbnRlbnQiLCJhcHBlbmQiLCJsYW5nU2VsZWN0IiwibGFuZ1BsYXRmb3JtTGFuZyIsImxhbmdBcnJvdyIsImxhbmdMaXN0IiwiaSIsImxhbmdDaG9pY2UiLCJ0YWJpbmRleCIsImRhdGEiLCJPYmplY3QiLCJrZXlzIiwidGV4dCIsInZhbHVlcyIsImRhdGFzZXQiLCJsYW5nIiwic3R5bGUiLCJhbmltYXRpb25EZWxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY2FsbCIsImNyZWF0ZUxvZ2luUGFnZSIsIm1haW4iLCJ0aXRsZSIsInN1YnRpdGxlIiwiZGVzY3JpcHRpb24iLCJidXR0b24iLCJwbGFjZWhvbGRlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJtYWluQ29udGVudCIsIndyYXBwZXIiLCJsb2dpblRpdGxlIiwibG9naW5UaXRsZVRvcCIsImxvZ2luVGl0bGVCb3R0b20iLCJsb2dpblRleHQiLCJmb3JtIiwidXNlcm5hbWVJbnB1dCIsInR5cGUiLCJwYXNzd29yZElucHV0Iiwic3VibWl0QnRuIiwiYnV0dG9uVGV4dCIsImVycm9yVHh0IiwiaGFuZGxlTG9naW5WYWxpZGF0aW9uIiwidHJhbnNsYXRpb25zIiwiZXJyb3JSZXF1aXJlZCIsImVycm9ySW52YWxpZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRhcmdldCIsInNob3dTbWFsbExvYWRlciIsImRpc2FibGVkIiwic2V0VGltZW91dCIsImhpZGVTbWFsbExvYWRlciIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVxdWlyZUVycm9yIiwiaW52YWxpZEVycm9yIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsInRyaW0iLCJhZGQiLCJzaG93QmlnTG9hZGVyIiwibG9hZGluZ0FyZWEiLCJpbm5lckhUTUwiLCJoaWRlQmlnTG9hZGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY3JlYXRlUHJvZmlsZXNQYWdlIiwicHJvZmlsZXMiLCJhZGRQcm9maWxlSW5mbyIsImFkZFByb2ZpbGVCdG4iLCJ1c2VyUHJvZmlsZUJ0biIsInVzZXJCdG5DdXN0b21pemUiLCJ1c2VyUHJvZmlsZXNMaXN0IiwidXNlclByb2ZpbGVzIiwiY29udGFpbmVyIiwicHJvZmlsZXNQYWdlTWFpbiIsInByb2ZpbGVzVGl0bGUiLCJwcm9maWxlc0JveCIsImxlbmd0aCIsImtleSIsImNyZWF0ZVByb2ZpbGUiLCJjcmVhdGVQcm9maWxlQWRkQnRuIiwiYXJpYUluZm8iLCJ1c2VyQnRuSW5mbyIsInNhdmVCdG5BcmlhIiwiZXhpc3RpbmdQcm9maWxlcyIsImNvbG9yIiwidXNlclByb2ZpbGUiLCJ1c2VyQXZhdGFyQm94IiwidXNlclByb2ZpbGVJbmZvQm94IiwidXNlclByb2ZpbGVJbmZvIiwicmVhZG9ubHkiLCJlZGl0VXNlckluZm9CdG4iLCJlZGl0VXNlckluZm9JY29uIiwibG9hZGluZyIsImJhY2tncm91bmRDb2xvciIsInVwZGF0ZWRQcm9maWxlcyIsImVkaXRVc2VybmFtZSIsImluZm8iLCJ1c2VyQnRuQXJpYSIsImFkZFByb2ZpbGVCb3giLCJhZGRQcm9maWxlQXZhdGFyIiwiYWRkUHJvZmlsZVBsdXNJY29uIiwicHJvZmlsZSIsImFsZXJ0IiwicGFyZW50IiwiZWRpdEJ0biIsIm5hbWVUb0VkaXQiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwic2F2ZUJ0biIsImNyZWF0ZVNhdmVCdG4iLCJmb2N1cyIsInNlbGVjdCIsInJlbW92ZUF0dHJpYnV0ZSIsInNhdmVVc2VybmFtZSIsImNsb3Nlc3RQcm9maWxlIiwiY2xvc2VzdCIsImNsb3Nlc3RQcm9maWxlSWQiLCJpZCIsImNsb3Nlc3RQcm9maWxlTmFtZSIsInJlc2V0U3RhdGVPZkVkaXRpbmciLCJzYXZlVXNlckluZm9CdG4iLCJzYXZlVXNlckluZm9JY29uIiwiZm9jdXNlZE5hbWVzIiwicXVlcnlTZWxlY3RvckFsbCIsImFsbFNhdmVCdG5zIiwiYWxsRWRpdEJ0bnMiLCJmb3JFYWNoIiwiZWwiLCJzZXRBdHRyaWJ1dGUiLCJidG4iXSwic291cmNlcyI6WyJjb21wb25lbnRzLmpzIl0sIm1hcHBpbmdzIjoiT0FBU0Esa0JBQXFCLDBCQUNyQkMsc0JBQXlCLGdDQUNsQyxNQUFNQyxTQUFXQyxLQUFLQyxRQUFRQyxhQUFhQyxRQUFRLGFBRW5ELElBQUlDLGNBQWdCTCxVQUFVSyxlQUFpQixFQUMvQyxNQUFNQyxTQUFXLGtCQUNYQyxTQUFXLGtCQUVWLE1BQU1DLGtCQUFvQixFQUUvQkMsUUFDQ0MsS0FBT0MsUUFDUEMsTUFBUUMsV0FBVUMsMEJBR3BCQyxFQUNBQyxFQUNBQyxFQUNBQyxLQUdBLE1BQU1ULEVBQVNYLGNBQWMsU0FBVSxDQUFDLFdBQ2xDcUIsRUFBV3JCLGNBQWMsSUFBSyxDQUFDLGVBQWdCLHNCQUF1QixDQUMzRXNCLEtBQU0sSUFDTixhQUFjLEdBQUdQLE1BRVpRLEVBQVV2QixjQUNmLE1BQ0EsQ0FBQyxtQkFBb0IsMEJBQ3JCLENBQ0N3QixJQUFLLHVCQUNMWixJQUFLLEdBQUdDLElBQ1JZLE1BQU8sS0FDUEMsT0FBUSxPQUdKQyxFQUFXM0IsY0FBYyxPQUFRLENBQ3RDLG9CQUNBLDRCQUVEMkIsRUFBU0MsWUFBYyxTQUN2QlAsRUFBU1EsT0FBT04sRUFBU0ksR0FDekJoQixFQUFPa0IsT0FBT1IsR0FJZCxNQUFNUyxFQUFhOUIsY0FBYyxTQUFVLENBQUMsNkJBQThCLENBQ3pFLGFBQWMsR0FBR2dCLE1BRVplLEVBQW1CL0IsY0FBYyxPQUFRLENBQzlDLHFDQUVLZ0MsRUFBWWhDLGNBQWMsTUFBTyxDQUFDLDRCQUE2QixDQUNwRXdCLElBQUssK0JBQ0xaLElBQUssR0FDTGEsTUFBTyxLQUNQQyxPQUFRLE9BRUhPLEVBQVdqQyxjQUFjLEtBQU0sQ0FBQyw0QkFFdEMsSUFBSyxJQUFJa0MsRUFBSSxFQUFHQSxFQUFJakIsRUFBWWlCLElBQUssQ0FDcEMsTUFBTUMsRUFBYW5DLGNBQWMsS0FBTSxDQUFDLDZCQUE4QixDQUNyRW9DLFNBQVUsSUFFTEMsRUFBT0MsT0FBT0MsS0FBS3JCLEdBQVdnQixHQUM5Qk0sRUFBT0YsT0FBT0csT0FBT3ZCLEdBQVdnQixHQUV0Q0MsRUFBV08sUUFBUUMsS0FBT04sRUFDMUJGLEVBQVdQLFlBQWNZLEVBQ3pCTCxFQUFXUyxNQUFNQyxlQUFxQixJQUFKWCxFQUFVLEtBQzVDRCxFQUFTSixPQUFPTSxFQUNqQixDQVdBLE9BVEFKLEVBQWlCSCxZQUFjVixFQUFVQyxHQUV6Q1csRUFBV2dCLGlCQUFpQixRQUFVQyxJQUNyQzNCLEVBQWlCNEIsS0FBS2xCLEVBQVlpQixFQUFHaEIsS0FHdENELEVBQVdELE9BQU9FLEVBQWtCQyxFQUFXQyxHQUMvQ3RCLEVBQU9rQixPQUFPQyxHQUVQbkIsVUFJRCxNQUFNc0MsZ0JBQWtCLEVBQzlCQyxNQUNDVixNQUFRVyxRQUFPQyxXQUFVQyxjQUFhQyxVQUN0Q0MsYUFBZUMsV0FBVUMsaUJBRzFCLE1BQU1DLEVBQWMxRCxjQUFjLE9BQVEsQ0FBQyxTQUNyQzJELEVBQVUzRCxjQUFjLE1BQU8sQ0FBQyxZQUNoQzRELEVBQWE1RCxjQUFjLE1BQzNCNkQsRUFBZ0I3RCxjQUFjLE9BQVEsQ0FBQyxnQkFDdkM4RCxFQUFtQjlELGNBQWMsT0FBUSxDQUFDLG1CQUMxQytELEVBQVkvRCxjQUFjLElBQUssQ0FBQyxlQUNoQ2dFLEVBQU9oRSxjQUFjLE9BQVEsQ0FBQyxlQUM5QmlFLEVBQWdCakUsY0FDckIsUUFDQSxDQUFDLG1CQUFvQiw4QkFDckIsQ0FBRWtFLEtBQU0sT0FBUVgsWUFBYUMsSUFFeEJXLEVBQWdCbkUsY0FDckIsUUFDQSxDQUFDLG1CQUFvQiw4QkFDckIsQ0FBRWtFLEtBQU0sV0FBWVgsWUFBYUUsSUFFNUJXLEVBQVlwRSxjQUFjLFNBQVUsQ0FBQyxxQkFBc0IsQ0FDaEVrRSxLQUFNLFdBRURHLEVBQWFyRSxjQUFjLE9BQVEsQ0FBQywyQkFFcENzRSxFQUFXdEUsY0FBYyxJQUFLLENBQUMseUJBMkNyQyxPQTFDQTZELEVBQWNqQyxZQUFjdUIsRUFDNUJXLEVBQWlCbEMsWUFBY3dCLEVBQy9CVyxFQUFVbkMsWUFBY3lCLEVBQ3hCZ0IsRUFBV3pDLFlBQWMwQixFQUV6Qk0sRUFBVy9CLE9BQU9nQyxFQUFlQyxHQUNqQ00sRUFBVXZDLE9BQU93QyxHQUNqQkwsRUFBS25DLE9BQU9vQyxFQUFlRSxFQUFlQyxFQUFXRSxHQUVyRFgsRUFBUTlCLE9BQU8rQixFQUFZRyxFQUFXQyxHQUN0Q04sRUFBWTdCLE9BQU84QixHQUVuQlMsRUFBVXRCLGlCQUFpQixRQUFVQyxJQUNwQyxNQUFNN0MsRUFBV0MsS0FBS0MsUUFBUUMsYUFBYUMsUUFBUSxhQUVuQ2lFLHNCQUNmeEIsRUFDQWtCLEVBQ0FFLEVBQ0FLLGFBQWF0QixLQUFLVixLQUFLaUMsY0FDdkJELGFBQWF0QixLQUFLVixLQUFLa0MsYUFDdkJsRSxTQUNBQyxTQUNBNkQsS0FJQUEsRUFBU0ssVUFBVUMsT0FBTyxXQUMxQjdCLEVBQUU4QixPQUFPaEQsT0FBT2lELG1CQUNoQi9CLEVBQUU4QixPQUFPRSxVQUFXLEVBRXBCQyxXQUFXLEtBQ1ZqQyxFQUFFOEIsT0FBT0UsVUFBVyxFQUNwQkUsa0JBRUFoRixrQkFBa0IsZUFBZ0J1RSxhQUFjdEUsR0FDaERELGtCQUFrQixZQUFZLEVBQU1DLEdBQ3BDZ0YsT0FBT0MsU0FBUzdELEtBQU8saUJBQ3JCLFFBSUVvQyxHQUdSLE1BQU1hLHNCQUF3QixDQUM3QnhCLEVBQ0FrQixFQUNBRSxFQUNBaUIsRUFDQUMsRUFDQTdCLEVBQ0FDLEVBQ0FhLEtBRUF2QixFQUFFdUMsaUJBRWlDLEtBQS9CckIsRUFBY3NCLE1BQU1DLFFBQWdELEtBQS9CckIsRUFBY29CLE1BQU1DLFFBQzVEbEIsRUFBU0ssVUFBVWMsSUFBSSxXQUN2Qm5CLEVBQVMxQyxZQUFjd0QsRUFDaEJBLEdBRVBuQixFQUFjc0IsTUFBTUMsU0FBV2hDLEdBQy9CVyxFQUFjb0IsTUFBTUMsU0FBVy9CLEdBRS9CVixFQUFFOEIsT0FBT0UsVUFBVyxFQUNwQmhDLEVBQUU4QixPQUFPaEQsT0FBT2lELG1CQUNoQlIsRUFBU0ssVUFBVUMsT0FBTyxXQUUxQkksV0FBVyxLQUNWVixFQUFTSyxVQUFVYyxJQUFJLFdBQ3ZCbkIsRUFBUzFDLFlBQWN5RCxFQUV2QnRDLEVBQUU4QixPQUFPRSxVQUFXLEVBRXBCRSxtQkFDRSxLQUNJSSxHQUVBLGFBSUYsTUFBTUssY0FBZ0IsS0FDNUIsTUFBTUMsRUFBYzNGLGNBQWMsTUFBTyxDQUFDLGlCQVcxQyxPQVZBMkYsRUFBWUMsVUFBWSxxbkJBVWpCRCxVQUVELE1BQU1FLGNBQWdCLEtBQzVCLE1BQU1GLEVBQWNHLFNBQVNDLGNBQWMsaUJBQzNDSixHQUFhZixpQkFHUCxNQUFNRSxnQkFBa0IsS0FDOUIsTUFBTWEsRUFBYzNGLGNBQWMsTUFBTyxDQUFDLHVCQVkxQyxPQVhBMkYsRUFBWUMsVUFBWSw2bUJBV2pCRCxVQUVELE1BQU1WLGdCQUFrQixLQUNWYSxTQUFTQyxjQUFjLHVCQUMvQm5CLGlCQUdOLE1BQU1vQixtQkFBcUIsRUFDakNDLFVBQ0N6RCxNQUFRVyxRQUFPK0Msa0JBQ2ZwRixNQUFRcUYsZ0JBQWVDLGlCQUFnQkMseUJBR3hDLE1BQU1uRyxFQUFXQyxLQUFLQyxRQUFRQyxhQUFhQyxRQUFRLGFBQzdDZ0csRUFBbUJwRyxHQUFVcUcsYUFFN0JDLEVBQVlWLFNBQVNDLGNBQWMsY0FDbkNVLEVBQW1CekcsY0FBYyxPQUFRLENBQUMsa0JBQzFDMkQsRUFBVTNELGNBQWMsTUFBTyxDQUFDLFlBQ2hDMEcsRUFBZ0IxRyxjQUFjLEtBQU0sQ0FDekMsY0FDQSx5QkFFSzJHLEVBQWMzRyxjQUFjLE1BQU8sQ0FBQyx1QkFJMUMsR0FGQTBHLEVBQWM5RSxZQUFjdUIsRUFFeEJtRCxHQUE2RCxJQUF6Q2hFLE9BQU9DLEtBQUsrRCxHQUFrQk0sT0FDckQsSUFBSyxNQUFNQyxLQUFPUCxFQUNqQkssRUFBWTlFLE9BQ1hpRixjQUFjVixFQUFnQkMsRUFBa0JBLElBS25ETSxFQUFZOUUsT0FDWGtGLG9CQUNDWixFQUNBRCxFQUNBRSxFQUNBTyxFQUNBTixFQUNBQSxJQUdGMUMsRUFBUTlCLE9BQU82RSxFQUFlQyxHQUM5QkYsRUFBaUI1RSxPQUFPOEIsR0FFeEI2QyxFQUFVM0UsT0FBTzRFLElBR2xCLE1BQU1LLGNBQWdCLENBQUNFLEVBQVVDLEVBQWFDLEtBQzdDLE1BQU1oSCxFQUFXQyxLQUFLQyxRQUFRQyxhQUFhQyxRQUFRLGFBQzdDNkcsRUFBbUJqSCxHQUFVcUcsY0FBZ0IsR0FFbkQsSUFBSWEsRUFJSixHQUFxQixHQUFqQjdHLGVBQWtELElBQTVCNEcsRUFBaUJQLE9BQWMsT0FFekRyRyxnQkFDQTZHLEVBTGUsQ0FBQyxVQUFXLFVBQVcsV0FLdkI3RyxlQUVmLE1BQU04RyxFQUFjckgsY0FBYyxNQUFPLENBQUMsMkJBQ3BDc0gsRUFBZ0J0SCxjQUFjLE1BQU8sQ0FBQywwQkFDdENvRyxFQUFpQnBHLGNBQWMsU0FBVSxDQUFDLHNCQUF1QixDQUN0RSxhQUFjZ0gsRUFDZCxVQUFXLGdCQUFnQnpHLGtCQUd0QmdILEVBQXFCdkgsY0FBYyxNQUFPLENBQUMsNkJBQzNDd0gsRUFBa0J4SCxjQUFjLFFBQVMsQ0FBQyx1QkFBd0IsQ0FDdkVrRSxLQUFNLE9BQ051RCxVQUFVLEVBQ1ZsQyxNQUNDNEIsRUFBaUIsZ0JBQWdCNUcsa0JBQ2pDLGlCQUFpQkEsa0JBRWJtSCxFQUFrQjFILGNBQ3ZCLFNBQ0EsQ0FBQyw0QkFDRCxDQUFFLGFBQWNpSCxJQUVYVSxFQUFtQjNILGNBQWMsTUFBTyxDQUFDLDRCQUE2QixDQUMzRXlCLE1BQU8sS0FDUEMsT0FBUSxLQUNSa0csUUFBUyxPQUNUaEgsSUFBSyxHQUNMWSxJQUFLLHlCQWtCTixHQWZBNEUsRUFBZVIsVUFBWSx3VkFNM0JRLEVBQWV4RCxNQUFNaUYsZ0JBQWtCVCxFQUV2Q0UsRUFBY3pGLE9BQU91RSxHQUNyQnNCLEVBQWdCN0YsT0FBTzhGLEdBQ3ZCSixFQUFtQjFGLE9BQU8yRixFQUFpQkUsR0FDM0NMLEVBQVl4RixPQUFPeUYsRUFBZUMsSUFJN0JKLEVBQWlCLGdCQUFnQjVHLGlCQUFrQixDQUN2RCxNQUFNdUgsRUFBa0IsSUFDcEJYLEVBQ0gsQ0FBQyxnQkFBZ0I1RyxpQkFBa0IsaUJBQWlCQSxpQkFFckROLGtCQUFrQixlQUFnQjZILEVBQWlCNUgsRUFDcEQsQ0FLQSxPQUpBd0gsRUFBZ0I1RSxpQkFBaUIsUUFBVUMsSUFDMUNnRixhQUFhaEYsRUFBR3dFLEVBQW9CTCxLQUc5QkcsR0FHRk4sb0JBQXNCLENBQzNCQyxFQUNBZ0IsRUFDQUMsRUFDQXRCLEVBQ0FNLEVBQ0FDLEtBRUEsTUFBTWdCLEVBQWdCbEksY0FBYyxNQUFPLENBQUMsK0JBQ3RDbUksRUFBbUJuSSxjQUFjLE1BQU8sQ0FBQywwQkFDekNtRyxFQUFnQm5HLGNBQ3JCLFNBQ0EsQ0FBQyxxQkFBc0IsbUNBQ3ZCLENBQUUsYUFBY2dILElBRVhvQixFQUFxQnBJLGNBQWMsTUFBTyxDQUFDLDBCQUEyQixDQUMzRXdCLElBQUssOEJBQ0xvRyxRQUFTLE9BQ1RoSCxJQUFLLEtBRUFzRixFQUFpQmxHLGNBQWMsT0FBUSxDQUFDLHdCQWtCOUMsT0FoQkFrRyxFQUFldEUsWUFBY29HLEVBRTdCN0IsRUFBY3RFLE9BQU91RyxHQUNyQkQsRUFBaUJ0RyxPQUFPc0UsR0FDeEIrQixFQUFjckcsT0FBT3NHLEVBQWtCakMsR0FFdkNDLEVBQWNyRCxpQkFBaUIsUUFBUyxLQUN2QyxNQUFNdUYsRUFBVXZCLGNBQWNtQixFQUFhaEIsRUFBYUMsR0FFcERtQixFQUNIMUIsRUFBWTlFLE9BQU93RyxHQUVuQkMsTUFBTSw0Q0FJREosR0FHRkgsYUFBZSxDQUFDaEYsRUFBR3dGLEVBQVFyQixLQUNoQyxNQUFNc0IsRUFBVXpGLEVBQUU4QixPQUNaNEQsRUFBYUQsRUFBUUUsdUJBQ3JCQyxFQUFVQyxjQUFjMUIsR0FFOUJzQixFQUFRN0QsVUFBVWMsSUFBSSxVQUN0QmtELEVBQVFoRSxVQUFVQyxPQUFPLFVBRXpCMkQsRUFBTzFHLE9BQU84RyxHQUVkRixFQUFXSSxRQUNYSixFQUFXSyxTQUNYTCxFQUFXTSxnQkFBZ0IsWUFDM0JOLEVBQVc5RCxVQUFVYyxJQUFJLFdBRXpCa0QsRUFBUTdGLGlCQUFpQixRQUFVQyxJQUNsQ2lHLGFBQWFqRyxNQUlUaUcsYUFBZ0JqRyxJQUNyQixNQUFNN0MsRUFBV0MsS0FBS0MsUUFBUUMsYUFBYUMsUUFBUSxhQUM3QzZHLEVBQW1CakgsR0FBVXFHLGNBQWdCLEdBRzdDMEMsRUFEVWxHLEVBQUU4QixPQUNhcUUsUUFBUSwyQkFDakNDLEVBQW1CRixFQUFlbEQsY0FBYyx1QkFDcERyRCxRQUFRMEcsR0FDSkMsRUFBcUJKLEVBQWVsRCxjQUN6Qyx3QkFHSytCLEVBQWtCLElBQ3BCWCxFQUNIZ0MsQ0FBQ0EsR0FBbUJFLEVBQW1COUQsT0FFeEN0RixrQkFBa0IsZUFBZ0I2SCxFQUFpQjVILEdBRW5Eb0osdUJBR0tWLGNBQWlCMUIsSUFDdEIsTUFBTXFDLEVBQWtCdkosY0FDdkIsU0FDQSxDQUFDLDJCQUE0QixVQUM3QixDQUFFLGFBQWNrSCxJQUVYc0MsRUFBbUJ4SixjQUFjLE1BQU8sQ0FBQyw0QkFBNkIsQ0FDM0V5QixNQUFPLEtBQ1BDLE9BQVEsS0FDUmtHLFFBQVMsT0FDVGhILElBQUssR0FDTFksSUFBSyx5QkFLTixPQUZBK0gsRUFBZ0IxSCxPQUFPMkgsR0FFaEJELEdBR0ZELG9CQUFzQixLQUMzQixNQUFNRyxFQUFlM0QsU0FBUzRELGlCQUFpQixZQUN6Q0MsRUFBYzdELFNBQVM0RCxpQkFBaUIsNkJBQ3hDRSxFQUFjOUQsU0FBUzRELGlCQUFpQiw2QkFFOUNELEVBQWFJLFFBQVNDLElBQ3JCQSxFQUFHQyxhQUFhLFlBQVksR0FDNUJELEVBQUduRixVQUFVQyxPQUFPLGFBRXJCK0UsRUFBWUUsUUFBU0csR0FBUUEsRUFBSXJGLFVBQVVjLElBQUksV0FDL0NtRSxFQUFZQyxRQUFTRyxHQUFRQSxFQUFJckYsVUFBVUMsT0FBTyIsImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVFbGVtZW50IH0gZnJvbSBcIi4vaGVscGVycy5taW4uanNcIjtcclxuaW1wb3J0IHsgc2V0VXNlclByZWZlcmVuY2UgfSBmcm9tIFwiLi91cGRhdGVTdGF0ZUZ1bmN0aW9ucy5taW4uanNcIjtcclxuY29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlPy4obG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKSk7XHJcblxyXG5sZXQgcHJvZmlsZXNDb3VudCA9IHVzZXJEYXRhPy5wcm9maWxlc0NvdW50IHx8IDA7XHJcbmNvbnN0IFVTRVJOQU1FID0gXCJoYW5kc29tZVVzZXI0MDRcIjtcclxuY29uc3QgUEFTU1dPUkQgPSBcIjVqa3NIOWQuXCI7XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTG9naW5IZWFkZXIgPSAoXHJcblx0e1xyXG5cdFx0aGVhZGVyOiB7XHJcblx0XHRcdGFsdDogeyBsb2dvIH0sXHJcblx0XHRcdGFyaWE6IHsgbG9nb0xpbmssIGNoYW5nZUxhbmd1YWdlQnV0dG9uIH0sXHJcblx0XHR9LFxyXG5cdH0sXHJcblx0bGFuZ0Ftb3VudCxcclxuXHRsYW5nTmFtZXMsXHJcblx0bGFuZ3VhZ2UsXHJcblx0aGFuZGxlTGFuZ1NlbGVjdFxyXG4pID0+IHtcclxuXHQvLyBsb2dvXHJcblx0Y29uc3QgaGVhZGVyID0gY3JlYXRlRWxlbWVudChcImhlYWRlclwiLCBbXCJoZWFkZXJcIl0pO1xyXG5cdGNvbnN0IHBhZ2VMb2dvID0gY3JlYXRlRWxlbWVudChcImFcIiwgW1wiaGVhZGVyX19sb2dvXCIsIFwibG9naW4taGVhZGVyX19sb2dvXCJdLCB7XHJcblx0XHRocmVmOiBcIi9cIixcclxuXHRcdFwiYXJpYS1sYWJlbFwiOiBgJHtsb2dvTGlua31gLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGxvZ29JbWcgPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJpbWdcIixcclxuXHRcdFtcImhlYWRlcl9fbG9nby1pbWdcIiwgXCJsb2dpbi1oZWFkZXJfX2xvZ28taW1nXCJdLFxyXG5cdFx0e1xyXG5cdFx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvbG9nby5zdmdcIixcclxuXHRcdFx0YWx0OiBgJHtsb2dvfWAsXHJcblx0XHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdFx0fVxyXG5cdCk7XHJcblx0Y29uc3QgbG9nb1RleHQgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXHJcblx0XHRcImhlYWRlcl9fbG9nby10ZXh0XCIsXHJcblx0XHRcImxvZ2luLWhlYWRlcl9fbG9nby10ZXh0XCIsXHJcblx0XSk7XHJcblx0bG9nb1RleHQudGV4dENvbnRlbnQgPSBcIlN0cmVhbVwiO1xyXG5cdHBhZ2VMb2dvLmFwcGVuZChsb2dvSW1nLCBsb2dvVGV4dCk7XHJcblx0aGVhZGVyLmFwcGVuZChwYWdlTG9nbyk7XHJcblx0Ly8gZW5kIG9mIGxvZ29cclxuXHJcblx0Ly8gbGFuZ3VhZ2Ugc2VsZWN0b3JcclxuXHRjb25zdCBsYW5nU2VsZWN0ID0gY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCBbXCJsb2dpbi1oZWFkZXJfX2xhbmctc2VsZWN0XCJdLCB7XHJcblx0XHRcImFyaWEtbGFiZWxcIjogYCR7Y2hhbmdlTGFuZ3VhZ2VCdXR0b259YCxcclxuXHR9KTtcclxuXHRjb25zdCBsYW5nUGxhdGZvcm1MYW5nID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1xyXG5cdFx0XCJsb2dpbi1oZWFkZXJfX2xhbmctcGxhdGZvcm0tbGFuZ1wiLFxyXG5cdF0pO1xyXG5cdGNvbnN0IGxhbmdBcnJvdyA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibG9naW4taGVhZGVyX19sYW5nLWFycm93XCJdLCB7XHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvY2hldnJvbi1kb3duLnN2Z1wiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGxhbmdMaXN0ID0gY3JlYXRlRWxlbWVudChcInVsXCIsIFtcImxvZ2luLWhlYWRlcl9fbGFuZy1saXN0XCJdKTtcclxuXHJcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsYW5nQW1vdW50OyBpKyspIHtcclxuXHRcdGNvbnN0IGxhbmdDaG9pY2UgPSBjcmVhdGVFbGVtZW50KFwibGlcIiwgW1wibG9naW4taGVhZGVyX19sYW5nLWNob2ljZVwiXSwge1xyXG5cdFx0XHR0YWJpbmRleDogMCxcclxuXHRcdH0pO1xyXG5cdFx0Y29uc3QgZGF0YSA9IE9iamVjdC5rZXlzKGxhbmdOYW1lcylbaV07XHJcblx0XHRjb25zdCB0ZXh0ID0gT2JqZWN0LnZhbHVlcyhsYW5nTmFtZXMpW2ldO1xyXG5cclxuXHRcdGxhbmdDaG9pY2UuZGF0YXNldC5sYW5nID0gZGF0YTtcclxuXHRcdGxhbmdDaG9pY2UudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG5cdFx0bGFuZ0Nob2ljZS5zdHlsZS5hbmltYXRpb25EZWxheSA9IGkgKiAxMDAgKyBcIm1zXCI7XHJcblx0XHRsYW5nTGlzdC5hcHBlbmQobGFuZ0Nob2ljZSk7XHJcblx0fVxyXG5cclxuXHRsYW5nUGxhdGZvcm1MYW5nLnRleHRDb250ZW50ID0gbGFuZ05hbWVzW2xhbmd1YWdlXTtcclxuXHJcblx0bGFuZ1NlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdGhhbmRsZUxhbmdTZWxlY3QuY2FsbChsYW5nU2VsZWN0LCBlLCBsYW5nUGxhdGZvcm1MYW5nKTtcclxuXHR9KTtcclxuXHJcblx0bGFuZ1NlbGVjdC5hcHBlbmQobGFuZ1BsYXRmb3JtTGFuZywgbGFuZ0Fycm93LCBsYW5nTGlzdCk7XHJcblx0aGVhZGVyLmFwcGVuZChsYW5nU2VsZWN0KTtcclxuXHJcblx0cmV0dXJuIGhlYWRlcjtcclxuXHQvLyBlbmQgb2YgbGFuZ3VhZ2Ugc2VsZWN0b3JcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVMb2dpblBhZ2UgPSAoe1xyXG5cdG1haW46IHtcclxuXHRcdHRleHQ6IHsgdGl0bGUsIHN1YnRpdGxlLCBkZXNjcmlwdGlvbiwgYnV0dG9uIH0sXHJcblx0XHRwbGFjZWhvbGRlcjogeyB1c2VybmFtZSwgcGFzc3dvcmQgfSxcclxuXHR9LFxyXG59KSA9PiB7XHJcblx0Y29uc3QgbWFpbkNvbnRlbnQgPSBjcmVhdGVFbGVtZW50KFwibWFpblwiLCBbXCJtYWluXCJdKTtcclxuXHRjb25zdCB3cmFwcGVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJ3cmFwcGVyXCJdKTtcclxuXHRjb25zdCBsb2dpblRpdGxlID0gY3JlYXRlRWxlbWVudChcImgxXCIpO1xyXG5cdGNvbnN0IGxvZ2luVGl0bGVUb3AgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXCJtYWluX190aXRsZVwiXSk7XHJcblx0Y29uc3QgbG9naW5UaXRsZUJvdHRvbSA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW5fX3N1YnRpdGxlXCJdKTtcclxuXHRjb25zdCBsb2dpblRleHQgPSBjcmVhdGVFbGVtZW50KFwicFwiLCBbXCJtYWluX190ZXh0XCJdKTtcclxuXHRjb25zdCBmb3JtID0gY3JlYXRlRWxlbWVudChcImZvcm1cIiwgW1wibWFpbl9fZm9ybVwiXSk7XHJcblx0Y29uc3QgdXNlcm5hbWVJbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImlucHV0XCIsXHJcblx0XHRbXCJtYWluX19mb3JtLWlucHV0XCIsIFwibWFpbl9fZm9ybS1pbnB1dC0tdXNlcm5hbWVcIl0sXHJcblx0XHR7IHR5cGU6IFwidGV4dFwiLCBwbGFjZWhvbGRlcjogdXNlcm5hbWUgfVxyXG5cdCk7XHJcblx0Y29uc3QgcGFzc3dvcmRJbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImlucHV0XCIsXHJcblx0XHRbXCJtYWluX19mb3JtLWlucHV0XCIsIFwibWFpbl9fZm9ybS1pbnB1dC0tcGFzc3dvcmRcIl0sXHJcblx0XHR7IHR5cGU6IFwicGFzc3dvcmRcIiwgcGxhY2Vob2xkZXI6IHBhc3N3b3JkIH1cclxuXHQpO1xyXG5cdGNvbnN0IHN1Ym1pdEJ0biA9IGNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwgW1wibWFpbl9fZm9ybS1idXR0b25cIl0sIHtcclxuXHRcdHR5cGU6IFwic3VibWl0XCIsXHJcblx0fSk7XHJcblx0Y29uc3QgYnV0dG9uVGV4dCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW5fX2Zvcm0tYnV0dG9uLXRleHRcIl0pO1xyXG5cclxuXHRjb25zdCBlcnJvclR4dCA9IGNyZWF0ZUVsZW1lbnQoXCJwXCIsIFtcIm1haW5fX2Zvcm0tZXJyb3ItdHh0XCJdKTtcclxuXHRsb2dpblRpdGxlVG9wLnRleHRDb250ZW50ID0gdGl0bGU7XHJcblx0bG9naW5UaXRsZUJvdHRvbS50ZXh0Q29udGVudCA9IHN1YnRpdGxlO1xyXG5cdGxvZ2luVGV4dC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG5cdGJ1dHRvblRleHQudGV4dENvbnRlbnQgPSBidXR0b247XHJcblxyXG5cdGxvZ2luVGl0bGUuYXBwZW5kKGxvZ2luVGl0bGVUb3AsIGxvZ2luVGl0bGVCb3R0b20pO1xyXG5cdHN1Ym1pdEJ0bi5hcHBlbmQoYnV0dG9uVGV4dCk7XHJcblx0Zm9ybS5hcHBlbmQodXNlcm5hbWVJbnB1dCwgcGFzc3dvcmRJbnB1dCwgc3VibWl0QnRuLCBlcnJvclR4dCk7XHJcblxyXG5cdHdyYXBwZXIuYXBwZW5kKGxvZ2luVGl0bGUsIGxvZ2luVGV4dCwgZm9ybSk7XHJcblx0bWFpbkNvbnRlbnQuYXBwZW5kKHdyYXBwZXIpO1xyXG5cclxuXHRzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRjb25zdCB1c2VyRGF0YSA9IEpTT04ucGFyc2U/Lihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInVzZXJEYXRhXCIpKTtcclxuXHJcblx0XHRjb25zdCByZXN1bHRzID0gaGFuZGxlTG9naW5WYWxpZGF0aW9uKFxyXG5cdFx0XHRlLFxyXG5cdFx0XHR1c2VybmFtZUlucHV0LFxyXG5cdFx0XHRwYXNzd29yZElucHV0LFxyXG5cdFx0XHR0cmFuc2xhdGlvbnMubWFpbi50ZXh0LmVycm9yUmVxdWlyZWQsXHJcblx0XHRcdHRyYW5zbGF0aW9ucy5tYWluLnRleHQuZXJyb3JJbnZhbGlkLFxyXG5cdFx0XHRVU0VSTkFNRSxcclxuXHRcdFx0UEFTU1dPUkQsXHJcblx0XHRcdGVycm9yVHh0XHJcblx0XHQpO1xyXG5cclxuXHRcdGlmICghcmVzdWx0cykge1xyXG5cdFx0XHRlcnJvclR4dC5jbGFzc0xpc3QucmVtb3ZlKFwidmlzaWJsZVwiKTtcclxuXHRcdFx0ZS50YXJnZXQuYXBwZW5kKHNob3dTbWFsbExvYWRlcigpKTtcclxuXHRcdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSB0cnVlO1xyXG5cclxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHRcdFx0XHRoaWRlU21hbGxMb2FkZXIoKTtcclxuXHJcblx0XHRcdFx0c2V0VXNlclByZWZlcmVuY2UoXCJ0cmFuc2xhdGlvbnNcIiwgdHJhbnNsYXRpb25zLCB1c2VyRGF0YSk7XHJcblx0XHRcdFx0c2V0VXNlclByZWZlcmVuY2UoXCJsb2dnZWRJblwiLCB0cnVlLCB1c2VyRGF0YSk7XHJcblx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSBcInByb2ZpbGVzLmh0bWxcIjsgLy8gcHJ6ZWrFm2NpZSBuYSBzdHJvbsSZIHogcHJvZmlsYW1pXHJcblx0XHRcdH0sIDMwMDApO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHRyZXR1cm4gbWFpbkNvbnRlbnQ7XHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVMb2dpblZhbGlkYXRpb24gPSAoXHJcblx0ZSxcclxuXHR1c2VybmFtZUlucHV0LFxyXG5cdHBhc3N3b3JkSW5wdXQsXHJcblx0cmVxdWlyZUVycm9yLFxyXG5cdGludmFsaWRFcnJvcixcclxuXHR1c2VybmFtZSxcclxuXHRwYXNzd29yZCxcclxuXHRlcnJvclR4dFxyXG4pID0+IHtcclxuXHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdGlmICh1c2VybmFtZUlucHV0LnZhbHVlLnRyaW0oKSA9PT0gXCJcIiB8fCBwYXNzd29yZElucHV0LnZhbHVlLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LmFkZChcInZpc2libGVcIik7XHJcblx0XHRlcnJvclR4dC50ZXh0Q29udGVudCA9IHJlcXVpcmVFcnJvcjtcclxuXHRcdHJldHVybiByZXF1aXJlRXJyb3I7XHJcblx0fSBlbHNlIGlmIChcclxuXHRcdHVzZXJuYW1lSW5wdXQudmFsdWUudHJpbSgpICE9PSB1c2VybmFtZSB8fFxyXG5cdFx0cGFzc3dvcmRJbnB1dC52YWx1ZS50cmltKCkgIT09IHBhc3N3b3JkXHJcblx0KSB7XHJcblx0XHRlLnRhcmdldC5kaXNhYmxlZCA9IHRydWU7XHJcblx0XHRlLnRhcmdldC5hcHBlbmQoc2hvd1NtYWxsTG9hZGVyKCkpO1xyXG5cdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LnJlbW92ZShcInZpc2libGVcIik7XHJcblxyXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdGVycm9yVHh0LmNsYXNzTGlzdC5hZGQoXCJ2aXNpYmxlXCIpO1xyXG5cdFx0XHRlcnJvclR4dC50ZXh0Q29udGVudCA9IGludmFsaWRFcnJvcjtcclxuXHJcblx0XHRcdGUudGFyZ2V0LmRpc2FibGVkID0gZmFsc2U7XHJcblxyXG5cdFx0XHRoaWRlU21hbGxMb2FkZXIoKTtcclxuXHRcdH0sIDMwMDApO1xyXG5cdFx0cmV0dXJuIGludmFsaWRFcnJvcjtcclxuXHR9IGVsc2Uge1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHNob3dCaWdMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcImxvYWRpbmctYXJlYVwiXSk7XHJcblx0bG9hZGluZ0FyZWEuaW5uZXJIVE1MID0gYCAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJsb2FkZXItYmlnXCIgdmlld0JveD1cIjAgMCAxMjAgMTIwXCIgd2lkdGg9XCIxMjBcIiBoZWlnaHQ9XCIxMjBcIj5cclxuICAgICAgICAgICAgICAgIDxkZWZzPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsaW5lYXJHcmFkaWVudCBpZD1cImxvYWRlci1hY2NlbnRcIiB4MT1cIjAlXCIgeTE9XCIwJVwiIHgyPVwiMTAwJVwiIHkyPVwiMCVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMCVcIiBzdG9wLWNvbG9yPVwiIzRkYThkYVwiIHN0b3Atb3BhY2l0eT1cIjAuOFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjcwJVwiIHN0b3AtY29sb3I9XCIjNGRhOGRhXCIgc3RvcC1vcGFjaXR5PVwiMC40XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMTAwJVwiIHN0b3AtY29sb3I9XCIjNGRhOGRhXCIgc3RvcC1vcGFjaXR5PVwiMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9saW5lYXJHcmFkaWVudD5cclxuICAgICAgICAgICAgICAgIDwvZGVmcz5cclxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3M9XCJsb2FkaW5nLWNpcmNsZS1iaWdcIiByPVwiMzVcIiBjeD1cIjYwXCIgY3k9XCI2MFwiPjwvY2lyY2xlPlxyXG4gICAgICAgICAgICA8L3N2Zz5gO1xyXG5cdHJldHVybiBsb2FkaW5nQXJlYTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGhpZGVCaWdMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmxvYWRpbmctYXJlYVwiKTtcclxuXHRsb2FkaW5nQXJlYT8ucmVtb3ZlKCk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc2hvd1NtYWxsTG9hZGVyID0gKCkgPT4ge1xyXG5cdGNvbnN0IGxvYWRpbmdBcmVhID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJsb2FkaW5nLWFyZWEtc21hbGxcIl0pO1xyXG5cdGxvYWRpbmdBcmVhLmlubmVySFRNTCA9IGA8c3ZnIGNsYXNzPVwibG9hZGVyLXNtYWxsXCIgdmlld0JveD1cIjAgMCAxMjAgMTIwXCIgd2lkdGg9XCIxMjBcIiBoZWlnaHQ9XCIxMjBcIj5cclxuICAgICAgICAgICAgICAgIDxkZWZzPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsaW5lYXJHcmFkaWVudCBpZD1cImxvYWRlci1hY2NlbnQtc21hbGxcIiB4MT1cIjAlXCIgeTE9XCIwJVwiIHgyPVwiMTAwJVwiIHkyPVwiMCVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMCVcIiBzdG9wLWNvbG9yPVwid2hpdGVcIiBzdG9wLW9wYWNpdHk9XCIwLjhcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCI3MCVcIiBzdG9wLWNvbG9yPVwid2hpdGVcIiBzdG9wLW9wYWNpdHk9XCIwLjNcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIxMDAlXCIgc3RvcC1jb2xvcj1cIndoaXRlXCIgc3RvcC1vcGFjaXR5PVwiMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9saW5lYXJHcmFkaWVudD5cclxuICAgICAgICAgICAgICAgIDwvZGVmcz5cclxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3M9XCJsb2FkaW5nLWNpcmNsZS1zbWFsbFwiIHI9XCIxMlwiIGN4PVwiNjBcIiBjeT1cIjYwXCI+PC9jaXJjbGU+XHJcbiAgICAgICAgICAgIDwvc3ZnPmA7XHJcblxyXG5cdHJldHVybiBsb2FkaW5nQXJlYTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGhpZGVTbWFsbExvYWRlciA9ICgpID0+IHtcclxuXHRjb25zdCBsb2FkaW5nQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubG9hZGluZy1hcmVhLXNtYWxsXCIpO1xyXG5cdGxvYWRpbmdBcmVhLnJlbW92ZSgpO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVByb2ZpbGVzUGFnZSA9ICh7XHJcblx0cHJvZmlsZXM6IHtcclxuXHRcdHRleHQ6IHsgdGl0bGUsIGFkZFByb2ZpbGVJbmZvIH0sXHJcblx0XHRhcmlhOiB7IGFkZFByb2ZpbGVCdG4sIHVzZXJQcm9maWxlQnRuLCB1c2VyQnRuQ3VzdG9taXplIH0sXHJcblx0fSxcclxufSkgPT4ge1xyXG5cdGNvbnN0IHVzZXJEYXRhID0gSlNPTi5wYXJzZT8uKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidXNlckRhdGFcIikpO1xyXG5cdGNvbnN0IHVzZXJQcm9maWxlc0xpc3QgPSB1c2VyRGF0YT8udXNlclByb2ZpbGVzO1xyXG5cclxuXHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhaW5lclwiKTtcclxuXHRjb25zdCBwcm9maWxlc1BhZ2VNYWluID0gY3JlYXRlRWxlbWVudChcIm1haW5cIiwgW1wibWFpbi1wcm9maWxlc1wiXSk7XHJcblx0Y29uc3Qgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wid3JhcHBlclwiXSk7XHJcblx0Y29uc3QgcHJvZmlsZXNUaXRsZSA9IGNyZWF0ZUVsZW1lbnQoXCJoMVwiLCBbXHJcblx0XHRcIm1haW5fX3RpdGxlXCIsXHJcblx0XHRcIm1haW4tcHJvZmlsZXNfX3RpdGxlXCIsXHJcblx0XSk7XHJcblx0Y29uc3QgcHJvZmlsZXNCb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2JveFwiXSk7XHJcblxyXG5cdHByb2ZpbGVzVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcclxuXHJcblx0aWYgKHVzZXJQcm9maWxlc0xpc3QgJiYgT2JqZWN0LmtleXModXNlclByb2ZpbGVzTGlzdCkubGVuZ3RoICE9PSAwKSB7XHJcblx0XHRmb3IgKGNvbnN0IGtleSBpbiB1c2VyUHJvZmlsZXNMaXN0KSB7XHJcblx0XHRcdHByb2ZpbGVzQm94LmFwcGVuZChcclxuXHRcdFx0XHRjcmVhdGVQcm9maWxlKHVzZXJQcm9maWxlQnRuLCB1c2VyQnRuQ3VzdG9taXplLCB1c2VyQnRuQ3VzdG9taXplKVxyXG5cdFx0XHQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHJvZmlsZXNCb3guYXBwZW5kKFxyXG5cdFx0Y3JlYXRlUHJvZmlsZUFkZEJ0bihcclxuXHRcdFx0YWRkUHJvZmlsZUJ0bixcclxuXHRcdFx0YWRkUHJvZmlsZUluZm8sXHJcblx0XHRcdHVzZXJQcm9maWxlQnRuLFxyXG5cdFx0XHRwcm9maWxlc0JveCxcclxuXHRcdFx0dXNlckJ0bkN1c3RvbWl6ZSxcclxuXHRcdFx0dXNlckJ0bkN1c3RvbWl6ZVxyXG5cdFx0KVxyXG5cdCk7XHJcblx0d3JhcHBlci5hcHBlbmQocHJvZmlsZXNUaXRsZSwgcHJvZmlsZXNCb3gpO1xyXG5cdHByb2ZpbGVzUGFnZU1haW4uYXBwZW5kKHdyYXBwZXIpO1xyXG5cclxuXHRjb250YWluZXIuYXBwZW5kKHByb2ZpbGVzUGFnZU1haW4pO1xyXG59O1xyXG5cclxuY29uc3QgY3JlYXRlUHJvZmlsZSA9IChhcmlhSW5mbywgdXNlckJ0bkluZm8sIHNhdmVCdG5BcmlhKSA9PiB7XHJcblx0Y29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlPy4obG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKSk7XHJcblx0Y29uc3QgZXhpc3RpbmdQcm9maWxlcyA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXMgfHwgW107XHJcblxyXG5cdGxldCBjb2xvcjtcclxuXHJcblx0Y29uc3QgY29sb3JzID0gW1wiI2RjNGEzNFwiLCBcIiMwNjJFNjNcIiwgXCIjRkFDMDQ0XCJdO1xyXG5cclxuXHRpZiAocHJvZmlsZXNDb3VudCA9PSAzIHx8IGV4aXN0aW5nUHJvZmlsZXMubGVuZ3RoID09PSAzKSByZXR1cm47XHJcblxyXG5cdHByb2ZpbGVzQ291bnQrKztcclxuXHRjb2xvciA9IGNvbG9yc1twcm9maWxlc0NvdW50XTtcclxuXHJcblx0Y29uc3QgdXNlclByb2ZpbGUgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX3Byb2ZpbGVcIl0pO1xyXG5cdGNvbnN0IHVzZXJBdmF0YXJCb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2F2YXRhclwiXSk7XHJcblx0Y29uc3QgdXNlclByb2ZpbGVCdG4gPSBjcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIFtcIm1haW4tcHJvZmlsZXNfX2J0blwiXSwge1xyXG5cdFx0XCJhcmlhLWxhYmVsXCI6IGFyaWFJbmZvLFxyXG5cdFx0XCJkYXRhLWlkXCI6IGB1c2VyLXByb2ZpbGUtJHtwcm9maWxlc0NvdW50fWAsXHJcblx0fSk7XHJcblxyXG5cdGNvbnN0IHVzZXJQcm9maWxlSW5mb0JveCA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fdXNlci1pbmZvXCJdKTtcclxuXHRjb25zdCB1c2VyUHJvZmlsZUluZm8gPSBjcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwgW1wibWFpbi1wcm9maWxlc19fbmFtZVwiXSwge1xyXG5cdFx0dHlwZTogXCJ0ZXh0XCIsXHJcblx0XHRyZWFkb25seTogdHJ1ZSxcclxuXHRcdHZhbHVlOlxyXG5cdFx0XHRleGlzdGluZ1Byb2ZpbGVzW2B1c2VyLXByb2ZpbGUtJHtwcm9maWxlc0NvdW50fWBdIHx8XHJcblx0XHRcdGBIYW5kc29tZSBVc2VyICR7cHJvZmlsZXNDb3VudH1gLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGVkaXRVc2VySW5mb0J0biA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImJ1dHRvblwiLFxyXG5cdFx0W1wibWFpbi1wcm9maWxlc19fZWRpdC1uYW1lXCJdLFxyXG5cdFx0eyBcImFyaWEtbGFiZWxcIjogdXNlckJ0bkluZm8gfVxyXG5cdCk7XHJcblx0Y29uc3QgZWRpdFVzZXJJbmZvSWNvbiA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibWFpbi1wcm9maWxlc19fZWRpdC1pY29uXCJdLCB7XHJcblx0XHR3aWR0aDogXCIyNFwiLFxyXG5cdFx0aGVpZ2h0OiBcIjI0XCIsXHJcblx0XHRsb2FkaW5nOiBcImxhenlcIixcclxuXHRcdGFsdDogXCJcIixcclxuXHRcdHNyYzogXCIuL3NyYy9pY29ucy9lZGl0LnN2Z1wiLFxyXG5cdH0pO1xyXG5cclxuXHR1c2VyUHJvZmlsZUJ0bi5pbm5lckhUTUwgPSBgPHN2ZyBjbGFzcz1cIm1haW4tcHJvZmlsZXNfX2ltZ1wiIHdpZHRoPVwiMTUwXCIgaGVpZ2h0PVwiMTUwXCIgdmlld0JveD1cIjAgMCAyMDAgMjAwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxyXG5cdDxjaXJjbGUgY3g9XCI3MFwiIGN5PVwiNzBcIiByPVwiOFwiIGZpbGw9XCJ3aGl0ZVwiIC8+XHJcblx0PGNpcmNsZSBjeD1cIjEzMFwiIGN5PVwiNzBcIiByPVwiOFwiIGZpbGw9XCJ3aGl0ZVwiIC8+XHJcblx0PHBhdGggZD1cIk02MCAxMTAgUTEwMCAxNTAgMTQwIDExMFwiIHN0cm9rZT1cIndoaXRlXCIgc3Ryb2tlLXdpZHRoPVwiNlwiXHJcblx0ZmlsbD1cInRyYW5zcGFyZW50XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIC8+XHJcblx0PC9zdmc+YDtcclxuXHR1c2VyUHJvZmlsZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcclxuXHJcblx0dXNlckF2YXRhckJveC5hcHBlbmQodXNlclByb2ZpbGVCdG4pO1xyXG5cdGVkaXRVc2VySW5mb0J0bi5hcHBlbmQoZWRpdFVzZXJJbmZvSWNvbik7XHJcblx0dXNlclByb2ZpbGVJbmZvQm94LmFwcGVuZCh1c2VyUHJvZmlsZUluZm8sIGVkaXRVc2VySW5mb0J0bik7XHJcblx0dXNlclByb2ZpbGUuYXBwZW5kKHVzZXJBdmF0YXJCb3gsIHVzZXJQcm9maWxlSW5mb0JveCk7XHJcblxyXG5cdC8vIHNldFVzZXJQcmVmZXJlbmNlKFwicHJvZmlsZXNDb3VudFwiLCBwcm9maWxlc0NvdW50LCB1c2VyRGF0YSlcclxuXHJcblx0aWYgKCFleGlzdGluZ1Byb2ZpbGVzW2B1c2VyLXByb2ZpbGUtJHtwcm9maWxlc0NvdW50fWBdKSB7XHJcblx0XHRjb25zdCB1cGRhdGVkUHJvZmlsZXMgPSB7XHJcblx0XHRcdC4uLmV4aXN0aW5nUHJvZmlsZXMsXHJcblx0XHRcdFtgdXNlci1wcm9maWxlLSR7cHJvZmlsZXNDb3VudH1gXTogYEhhbmRzb21lIFVzZXIgJHtwcm9maWxlc0NvdW50fWAsXHJcblx0XHR9O1xyXG5cdFx0c2V0VXNlclByZWZlcmVuY2UoXCJ1c2VyUHJvZmlsZXNcIiwgdXBkYXRlZFByb2ZpbGVzLCB1c2VyRGF0YSk7XHJcblx0fVxyXG5cdGVkaXRVc2VySW5mb0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdGVkaXRVc2VybmFtZShlLCB1c2VyUHJvZmlsZUluZm9Cb3gsIHNhdmVCdG5BcmlhKTtcclxuXHR9KTtcclxuXHJcblx0cmV0dXJuIHVzZXJQcm9maWxlO1xyXG59O1xyXG5cclxuY29uc3QgY3JlYXRlUHJvZmlsZUFkZEJ0biA9IChcclxuXHRhcmlhSW5mbyxcclxuXHRpbmZvLFxyXG5cdHVzZXJCdG5BcmlhLFxyXG5cdHByb2ZpbGVzQm94LFxyXG5cdHVzZXJCdG5JbmZvLFxyXG5cdHNhdmVCdG5BcmlhXHJcbikgPT4ge1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVCb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2FkZC1wcm9maWxlXCJdKTtcclxuXHRjb25zdCBhZGRQcm9maWxlQXZhdGFyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX19hdmF0YXJcIl0pO1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVCdG4gPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJidXR0b25cIixcclxuXHRcdFtcIm1haW4tcHJvZmlsZXNfX2J0blwiLCBcIm1haW4tcHJvZmlsZXNfX2J0bi0tYWRkLXByb2ZpbGVcIl0sXHJcblx0XHR7IFwiYXJpYS1sYWJlbFwiOiBhcmlhSW5mbyB9XHJcblx0KTtcclxuXHRjb25zdCBhZGRQcm9maWxlUGx1c0ljb24gPSBjcmVhdGVFbGVtZW50KFwiaW1nXCIsIFtcIm1haW4tcHJvZmlsZXNfX2FkZC1pbWdcIl0sIHtcclxuXHRcdHNyYzogXCIuL3NyYy9pY29ucy9hZGQtcHJvZmlsZS5zdmdcIixcclxuXHRcdGxvYWRpbmc6IFwibGF6eVwiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVJbmZvID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1wibWFpbi1wcm9maWxlc19fbmFtZVwiXSk7XHJcblxyXG5cdGFkZFByb2ZpbGVJbmZvLnRleHRDb250ZW50ID0gaW5mbztcclxuXHJcblx0YWRkUHJvZmlsZUJ0bi5hcHBlbmQoYWRkUHJvZmlsZVBsdXNJY29uKTtcclxuXHRhZGRQcm9maWxlQXZhdGFyLmFwcGVuZChhZGRQcm9maWxlQnRuKTtcclxuXHRhZGRQcm9maWxlQm94LmFwcGVuZChhZGRQcm9maWxlQXZhdGFyLCBhZGRQcm9maWxlSW5mbyk7XHJcblxyXG5cdGFkZFByb2ZpbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuXHRcdGNvbnN0IHByb2ZpbGUgPSBjcmVhdGVQcm9maWxlKHVzZXJCdG5BcmlhLCB1c2VyQnRuSW5mbywgc2F2ZUJ0bkFyaWEpO1xyXG5cclxuXHRcdGlmIChwcm9maWxlKSB7XHJcblx0XHRcdHByb2ZpbGVzQm94LmFwcGVuZChwcm9maWxlKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGFsZXJ0KFwiT3NpxIVnbmnEmXRvIG1ha3N5bWFsbsSFIGxpY3pixJkgcHJvZmlsw7N3IVwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0cmV0dXJuIGFkZFByb2ZpbGVCb3g7XHJcbn07XHJcblxyXG5jb25zdCBlZGl0VXNlcm5hbWUgPSAoZSwgcGFyZW50LCBzYXZlQnRuQXJpYSkgPT4ge1xyXG5cdGNvbnN0IGVkaXRCdG4gPSBlLnRhcmdldDtcclxuXHRjb25zdCBuYW1lVG9FZGl0ID0gZWRpdEJ0bi5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xyXG5cdGNvbnN0IHNhdmVCdG4gPSBjcmVhdGVTYXZlQnRuKHNhdmVCdG5BcmlhKTtcclxuXHJcblx0ZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xyXG5cdHNhdmVCdG4uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcclxuXHJcblx0cGFyZW50LmFwcGVuZChzYXZlQnRuKTtcclxuXHJcblx0bmFtZVRvRWRpdC5mb2N1cygpO1xyXG5cdG5hbWVUb0VkaXQuc2VsZWN0KCk7XHJcblx0bmFtZVRvRWRpdC5yZW1vdmVBdHRyaWJ1dGUoXCJyZWFkb25seVwiKTtcclxuXHRuYW1lVG9FZGl0LmNsYXNzTGlzdC5hZGQoXCJmb2N1c2VkXCIpO1xyXG5cclxuXHRzYXZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0c2F2ZVVzZXJuYW1lKGUpO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuY29uc3Qgc2F2ZVVzZXJuYW1lID0gKGUpID0+IHtcclxuXHRjb25zdCB1c2VyRGF0YSA9IEpTT04ucGFyc2U/Lihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInVzZXJEYXRhXCIpKTtcclxuXHRjb25zdCBleGlzdGluZ1Byb2ZpbGVzID0gdXNlckRhdGE/LnVzZXJQcm9maWxlcyB8fCBbXTtcclxuXHJcblx0Y29uc3Qgc2F2ZUJ0biA9IGUudGFyZ2V0O1xyXG5cdGNvbnN0IGNsb3Nlc3RQcm9maWxlID0gc2F2ZUJ0bi5jbG9zZXN0KFwiLm1haW4tcHJvZmlsZXNfX3Byb2ZpbGVcIik7XHJcblx0Y29uc3QgY2xvc2VzdFByb2ZpbGVJZCA9IGNsb3Nlc3RQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1wcm9maWxlc19fYnRuXCIpXHJcblx0XHQuZGF0YXNldC5pZDtcclxuXHRjb25zdCBjbG9zZXN0UHJvZmlsZU5hbWUgPSBjbG9zZXN0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XCIubWFpbi1wcm9maWxlc19fbmFtZVwiXHJcblx0KTtcclxuXHJcblx0Y29uc3QgdXBkYXRlZFByb2ZpbGVzID0ge1xyXG5cdFx0Li4uZXhpc3RpbmdQcm9maWxlcyxcclxuXHRcdFtjbG9zZXN0UHJvZmlsZUlkXTogY2xvc2VzdFByb2ZpbGVOYW1lLnZhbHVlLFxyXG5cdH07XHJcblx0c2V0VXNlclByZWZlcmVuY2UoXCJ1c2VyUHJvZmlsZXNcIiwgdXBkYXRlZFByb2ZpbGVzLCB1c2VyRGF0YSk7XHJcblxyXG5cdHJlc2V0U3RhdGVPZkVkaXRpbmcoKTtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZVNhdmVCdG4gPSAoc2F2ZUJ0bkFyaWEpID0+IHtcclxuXHRjb25zdCBzYXZlVXNlckluZm9CdG4gPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJidXR0b25cIixcclxuXHRcdFtcIm1haW4tcHJvZmlsZXNfX3NhdmUtbmFtZVwiLCBcImhpZGRlblwiXSxcclxuXHRcdHsgXCJhcmlhLWxhYmVsXCI6IHNhdmVCdG5BcmlhIH1cclxuXHQpO1xyXG5cdGNvbnN0IHNhdmVVc2VySW5mb0ljb24gPSBjcmVhdGVFbGVtZW50KFwiaW1nXCIsIFtcIm1haW4tcHJvZmlsZXNfX3NhdmUtaWNvblwiXSwge1xyXG5cdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdFx0bG9hZGluZzogXCJsYXp5XCIsXHJcblx0XHRhbHQ6IFwiXCIsXHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvc2F2ZS5zdmdcIixcclxuXHR9KTtcclxuXHJcblx0c2F2ZVVzZXJJbmZvQnRuLmFwcGVuZChzYXZlVXNlckluZm9JY29uKTtcclxuXHJcblx0cmV0dXJuIHNhdmVVc2VySW5mb0J0bjtcclxufTtcclxuXHJcbmNvbnN0IHJlc2V0U3RhdGVPZkVkaXRpbmcgPSAoKSA9PiB7XHJcblx0Y29uc3QgZm9jdXNlZE5hbWVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb2N1c2VkXCIpO1xyXG5cdGNvbnN0IGFsbFNhdmVCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tYWluLXByb2ZpbGVzX19zYXZlLW5hbWVcIik7XHJcblx0Y29uc3QgYWxsRWRpdEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1haW4tcHJvZmlsZXNfX2VkaXQtbmFtZVwiKTtcclxuXHJcblx0Zm9jdXNlZE5hbWVzLmZvckVhY2goKGVsKSA9PiB7XHJcblx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJyZWFkb25seVwiLCB0cnVlKTtcclxuXHRcdGVsLmNsYXNzTGlzdC5yZW1vdmUoXCJmb2N1c2VkXCIpO1xyXG5cdH0pO1xyXG5cdGFsbFNhdmVCdG5zLmZvckVhY2goKGJ0bikgPT4gYnRuLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIikpO1xyXG5cdGFsbEVkaXRCdG5zLmZvckVhY2goKGJ0bikgPT4gYnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIikpO1xyXG59O1xyXG4iXX0=
