import{createElement}from"./helpers.min.js";import{setUserPreference}from"./updateStateFunctions.min.js";const HIDE_LOADER_TIME=3e3,HIDE_POPUP_TIME=2500;export const getData=()=>{try{const e=localStorage.getItem("userData");if(!e)return null;const t=JSON.parse(e);if("object"!=typeof t||null===t)throw showErrorPopup("An unexpected error occurred","#dc4a34"),new Error("NieprawidÅ‚owa struktura danych");return t}catch{return localStorage.removeItem("userData"),{}}};const USERNAME="handsomeUser404",PASSWORD="5jksH9d.";export const createLoginHeader=({header:{alt:{logo:e},aria:{logoLink:t,changeLanguageButton:r}}},a,n,o,i)=>{const l=createElement("header",["header"]),s=createElement("a",["header__logo","login-header__logo"],{href:"/","aria-label":`${t}`}),c=createElement("img",["header__logo-img","login-header__logo-img"],{src:"./src/icons/logo.svg",alt:`${e}`,width:"24",height:"24"}),d=createElement("span",["header__logo-text","login-header__logo-text"]);d.textContent="Stream",s.append(c,d),l.append(s);const p=createElement("button",["login-header__lang-select"],{"aria-label":`${r}`}),m=createElement("span",["login-header__lang-platform-lang"]),u=createElement("img",["login-header__lang-arrow"],{src:"./src/icons/chevron-down.svg",alt:"",width:"24",height:"24"}),f=createElement("ul",["login-header__lang-list"]);for(let e=0;e<a;e++){const t=createElement("li",["login-header__lang-choice"],{tabindex:0}),r=Object.keys(n)[e],a=Object.values(n)[e];t.dataset.lang=r,t.textContent=a,t.style.animationDelay=100*e+"ms",f.append(t)}return m.textContent=n[o],p.addEventListener("click",e=>{i.call(p,e,m)}),p.append(m,u,f),l.append(p),l};export const createLoginPage=({main:{text:{title:e,subtitle:t,description:r,button:a},placeholder:{username:n,password:o}}})=>{const i=createElement("main",["main"]),l=createElement("div",["wrapper"]),s=createElement("h1"),c=createElement("span",["main__title"]),d=createElement("span",["main__subtitle"]),p=createElement("p",["main__text"]),m=createElement("form",["main__form"]),u=createElement("input",["main__form-input","main__form-input--username"],{type:"text",placeholder:n}),f=createElement("input",["main__form-input","main__form-input--password"],{type:"password",placeholder:o}),_=createElement("button",["main__form-button"],{type:"submit"}),g=createElement("span",["main__form-button-text"]),h=createElement("p",["main__form-error-txt"]);return c.textContent=e,d.textContent=t,p.textContent=r,g.textContent=a,s.append(c,d),_.append(g),m.append(u,f,_,h),l.append(s,p,m),i.append(l),_.addEventListener("click",e=>{const t=getData();handleLoginValidation(e,u,f,translations.main.text.errorRequired,translations.main.text.errorInvalid,USERNAME,PASSWORD,h)||(h.classList.remove("visible"),e.target.append(showSmallLoader()),e.target.disabled=!0,setTimeout(()=>{e.target.disabled=!1,hideSmallLoader(),setUserPreference("translations",translations,t),setUserPreference("loggedIn",!0,t),window.location.href="profiles.html"},3e3))}),i};const handleLoginValidation=(e,t,r,a,n,o,i,l)=>(e.preventDefault(),""===t.value.trim()||""===r.value.trim()?(l.classList.add("visible"),l.textContent=a,a):t.value.trim()!==o||r.value.trim()!==i?(e.target.disabled=!0,e.target.append(showSmallLoader()),l.classList.remove("visible"),setTimeout(()=>{l.classList.add("visible"),l.textContent=n,e.target.disabled=!1,hideSmallLoader()},3e3),n):null);export const showBigLoader=()=>{const e=createElement("div",["loading-area"]);return e.innerHTML='            <svg class="loader-big" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="#4da8da" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="#4da8da" stop-opacity="0.4" />\n                        <stop offset="100%" stop-color="#4da8da" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-big" r="35" cx="60" cy="60"></circle>\n            </svg>',e};export const hideBigLoader=()=>{const e=document.querySelector(".loading-area");e?.remove()};export const showSmallLoader=()=>{const e=createElement("div",["loading-area-small"]);return e.innerHTML='<svg class="loader-small" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent-small" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="white" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="white" stop-opacity="0.3" />\n                        <stop offset="100%" stop-color="white" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-small" r="12" cx="60" cy="60"></circle>\n            </svg>',e};export const hideSmallLoader=()=>{document.querySelector(".loading-area-small").remove()};export const createProfilesPage=({profiles:{text:{title:e,addProfileInfo:t},aria:{addProfileBtn:r,userProfileBtn:a,userBtnCustomize:n,removeUserInfo:o}},errorPopup:{text:{maxProfiles:i,emptyField:l}}})=>{const s=getData(),c=s?.userProfiles,d=document.querySelector(".container");d.append(showBigLoader()),setTimeout(()=>{const s=createElement("main",["main-profiles"]),p=createElement("div",["wrapper"]),m=createElement("h1",["main__title","main-profiles__title"]),u=createElement("div",["main-profiles__box"]);if(m.textContent=e,c&&0!==Object.keys(c).length)for(const e in c)u.append(createProfile(a,n,n,l,o,e,c[e]));u.append(createProfileAddBtn(r,t,a,u,n,n,i,l,o)),p.append(m,u),s.append(p),d.append(s),hideBigLoader()},500)};const createProfile=(e,t,r,a,n,o=null,i=null)=>{const l=getData(),s=l?.userProfiles||{};if(null===l)return showErrorPopup("An unexpected error occurred","#dc4a34"),void setTimeout(()=>{window.location.reload()},2500);let c,d,p;const m=["#dc4a34","#062E63","#FAC044"];if(o){d=o,p=i.name;c=m[parseInt(d.split("-").pop())-1]}else{if(Object.keys(s).length>=3)return;let e=1;for(;s[`user-profile-${e}`];)e++;d=`user-profile-${e}`,p=`Handsome User ${e}`,c=m[e-1]}const u=createElement("div",["main-profiles__profile"]),f=createElement("div",["main-profiles__avatar"]),_=createElement("button",["main-profiles__btn"],{"aria-label":e,"data-id":d}),g=createElement("div",["main-profiles__user-info"]),h=createElement("input",["main-profiles__name"],{type:"text",readonly:!0,value:p}),v=createElement("span",["name-border"]),E=createElement("button",["main-profiles__edit-name"],{"aria-label":t}),b=createElement("button",["main-profiles__remove-user"],{"aria-label":n}),y=createElement("img",["main-profiles__remove-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/remove-profile-icon.svg"}),x=createElement("img",["main-profiles__edit-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/edit.svg"});if(_.innerHTML='<svg class="main-profiles__img" width="150" height="150" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">\n    <circle cx="70" cy="70" r="8" fill="white" />\n    <circle cx="130" cy="70" r="8" fill="white" />\n    <path d="M60 110 Q100 150 140 110" stroke="white" stroke-width="6"\n    fill="transparent" stroke-linecap="round" />\n    </svg>',_.style.backgroundColor=c,f.append(_),E.append(x),b.append(y),g.append(h,v,E,b),u.append(f,g),!o){const e={...s,[d]:{name:p}};setUserPreference("userProfiles",e,l)}return E.addEventListener("click",e=>{editUsername(e,g,r,a)}),b.addEventListener("click",e=>{removeUser(e)}),h.addEventListener("keydown",e=>{"Enter"===e.key&&saveUsername(e,a)}),u.classList.add("visible"),u},createProfileAddBtn=(e,t,r,a,n,o,i,l,s)=>{const c=createElement("div",["main-profiles__add-profile"]),d=createElement("div",["main-profiles__avatar"]),p=createElement("button",["main-profiles__btn","main-profiles__btn--add-profile"],{"aria-label":e}),m=createElement("img",["main-profiles__add-img"],{src:"./src/icons/add-profile.svg",loading:"lazy",alt:""}),u=createElement("span",["main-profiles__name"]);return u.textContent=t,p.append(m),d.append(p),c.append(d,u),p.addEventListener("click",()=>{const e=getData(),t=e?.userProfiles||{};if(Object.keys(t).length>=3)return void showErrorPopup(i,"#dc4a34");const d=createProfile(r,n,o,l,s);d&&a.insertBefore(d,c)}),c},editUsername=(e,t,r,a)=>{resetStateOfEditing(e);const n=e.target,o=n.closest(".main-profiles__profile").querySelector(".main-profiles__name"),i=createSaveBtn(r);n.classList.add("hidden"),i.classList.remove("hidden"),t.append(i),o.focus(),o.select(),o.removeAttribute("readonly"),o.classList.add("focused"),i.addEventListener("click",e=>{saveUsername(e,a)})},saveUsername=(e,t)=>{const r=getData(),a=r?.userProfiles||[],n=e.target.closest(".main-profiles__profile"),o=n.querySelector(".main-profiles__btn").dataset.id,i=n.querySelector(".main-profiles__name"),l=document.querySelectorAll(".main-profiles__edit-name");if(l.forEach(e=>e.removeAttribute("disabled")),""===i.value.trim())return l.forEach(e=>e.setAttribute("disabled",!0)),showErrorPopup(t,"#FAC044");const s={...a,[o]:{...a[o],name:i.value}};setUserPreference("userProfiles",s,r),resetStateOfEditing(e)},createSaveBtn=e=>{const t=createElement("button",["main-profiles__save-name","hidden"],{"aria-label":e}),r=createElement("img",["main-profiles__save-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/save.svg"});return t.append(r),t},resetStateOfEditing=e=>{const t=document.querySelectorAll(".focused"),r=document.querySelectorAll(".main-profiles__save-name"),a=document.querySelectorAll(".main-profiles__edit-name");t.forEach(e=>{e.setAttribute("readonly",!0),e.classList.remove("focused"),e.blur()}),r.forEach(e=>e.classList.add("hidden")),a.forEach(e=>e.classList.remove("hidden"))};let popupVisible=!1;const showErrorPopup=(e,t)=>{if(popupVisible)return;popupVisible=!0;const r=document.documentElement,a=document.querySelector(".container"),n=createElement("div",["error-popup"]),o=createElement("p",["error-popup__text"]);o.textContent=e,r.style.setProperty("--errorTxtColor",t),n.append(o),a.append(n),setTimeout(()=>{n.classList.add("hidden")},2e3),setTimeout(()=>{n.remove(),popupVisible=!1},2500)},removeUser=e=>{const t=getData(),r=t?.userProfiles,a=document.querySelectorAll(".main-profiles__edit-name"),n=e.target.closest(".main-profiles__profile"),o=n.querySelector(".main-profiles__btn");a.forEach(e=>e.removeAttribute("disabled")),delete r[o.dataset.id],setUserPreference("userProfiles",r,t),n.classList.add("hidden"),setTimeout(()=>{n.remove()},400)};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50cy5taW4uanMiLCJuYW1lcyI6WyJjcmVhdGVFbGVtZW50Iiwic2V0VXNlclByZWZlcmVuY2UiLCJISURFX0xPQURFUl9USU1FIiwiSElERV9QT1BVUF9USU1FIiwiZ2V0RGF0YSIsImRhdGEiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwicGFyc2VkRGF0YSIsIkpTT04iLCJwYXJzZSIsInNob3dFcnJvclBvcHVwIiwiRXJyb3IiLCJyZW1vdmVJdGVtIiwiVVNFUk5BTUUiLCJQQVNTV09SRCIsImNyZWF0ZUxvZ2luSGVhZGVyIiwiaGVhZGVyIiwiYWx0IiwibG9nbyIsImFyaWEiLCJsb2dvTGluayIsImNoYW5nZUxhbmd1YWdlQnV0dG9uIiwibGFuZ0Ftb3VudCIsImxhbmdOYW1lcyIsImxhbmd1YWdlIiwiaGFuZGxlTGFuZ1NlbGVjdCIsInBhZ2VMb2dvIiwiaHJlZiIsImxvZ29JbWciLCJzcmMiLCJ3aWR0aCIsImhlaWdodCIsImxvZ29UZXh0IiwidGV4dENvbnRlbnQiLCJhcHBlbmQiLCJsYW5nU2VsZWN0IiwibGFuZ1BsYXRmb3JtTGFuZyIsImxhbmdBcnJvdyIsImxhbmdMaXN0IiwiaSIsImxhbmdDaG9pY2UiLCJ0YWJpbmRleCIsIk9iamVjdCIsImtleXMiLCJ0ZXh0IiwidmFsdWVzIiwiZGF0YXNldCIsImxhbmciLCJzdHlsZSIsImFuaW1hdGlvbkRlbGF5IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJjYWxsIiwiY3JlYXRlTG9naW5QYWdlIiwibWFpbiIsInRpdGxlIiwic3VidGl0bGUiLCJkZXNjcmlwdGlvbiIsImJ1dHRvbiIsInBsYWNlaG9sZGVyIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsIm1haW5Db250ZW50Iiwid3JhcHBlciIsImxvZ2luVGl0bGUiLCJsb2dpblRpdGxlVG9wIiwibG9naW5UaXRsZUJvdHRvbSIsImxvZ2luVGV4dCIsImZvcm0iLCJ1c2VybmFtZUlucHV0IiwidHlwZSIsInBhc3N3b3JkSW5wdXQiLCJzdWJtaXRCdG4iLCJidXR0b25UZXh0IiwiZXJyb3JUeHQiLCJ1c2VyRGF0YSIsImhhbmRsZUxvZ2luVmFsaWRhdGlvbiIsInRyYW5zbGF0aW9ucyIsImVycm9yUmVxdWlyZWQiLCJlcnJvckludmFsaWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0YXJnZXQiLCJzaG93U21hbGxMb2FkZXIiLCJkaXNhYmxlZCIsInNldFRpbWVvdXQiLCJoaWRlU21hbGxMb2FkZXIiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlcXVpcmVFcnJvciIsImludmFsaWRFcnJvciIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJ0cmltIiwiYWRkIiwic2hvd0JpZ0xvYWRlciIsImxvYWRpbmdBcmVhIiwiaW5uZXJIVE1MIiwiaGlkZUJpZ0xvYWRlciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNyZWF0ZVByb2ZpbGVzUGFnZSIsInByb2ZpbGVzIiwiYWRkUHJvZmlsZUluZm8iLCJhZGRQcm9maWxlQnRuIiwidXNlclByb2ZpbGVCdG4iLCJ1c2VyQnRuQ3VzdG9taXplIiwicmVtb3ZlVXNlckluZm8iLCJlcnJvclBvcHVwIiwibWF4UHJvZmlsZXMiLCJlbXB0eUZpZWxkIiwidXNlclByb2ZpbGVzTGlzdCIsInVzZXJQcm9maWxlcyIsImNvbnRhaW5lciIsInByb2ZpbGVzUGFnZU1haW4iLCJwcm9maWxlc1RpdGxlIiwicHJvZmlsZXNCb3giLCJsZW5ndGgiLCJrZXkiLCJjcmVhdGVQcm9maWxlIiwiY3JlYXRlUHJvZmlsZUFkZEJ0biIsImFyaWFJbmZvIiwidXNlckJ0bkluZm8iLCJzYXZlQnRuQXJpYSIsImVtcHR5RmllbGRFcnJvciIsInJlbW92ZUFyaWEiLCJleGlzdGluZ1Byb2ZpbGVJZCIsImV4aXN0aW5nUHJvZmlsZU5hbWUiLCJleGlzdGluZ1Byb2ZpbGVzIiwicmVsb2FkIiwiY29sb3IiLCJwcm9maWxlSWQiLCJwcm9maWxlTmFtZSIsImNvbG9ycyIsIm5hbWUiLCJwYXJzZUludCIsInNwbGl0IiwicG9wIiwibmV4dE51bWJlciIsInVzZXJQcm9maWxlIiwidXNlckF2YXRhckJveCIsInVzZXJQcm9maWxlSW5mb0JveCIsInVzZXJQcm9maWxlSW5mbyIsInJlYWRvbmx5IiwibmFtZUJvcmRlciIsImVkaXRVc2VySW5mb0J0biIsInJlbW92ZVVzZXJCdG4iLCJyZW1vdmVVc2VySWNvbiIsImxvYWRpbmciLCJlZGl0VXNlckluZm9JY29uIiwiYmFja2dyb3VuZENvbG9yIiwidXBkYXRlZFByb2ZpbGVzIiwiZWRpdFVzZXJuYW1lIiwicmVtb3ZlVXNlciIsInNhdmVVc2VybmFtZSIsImluZm8iLCJ1c2VyQnRuQXJpYSIsIm1heFByb2ZpbGVzRXJyb3IiLCJhZGRQcm9maWxlQm94IiwiYWRkUHJvZmlsZUF2YXRhciIsImFkZFByb2ZpbGVQbHVzSWNvbiIsInByb2ZpbGUiLCJpbnNlcnRCZWZvcmUiLCJwYXJlbnQiLCJyZXNldFN0YXRlT2ZFZGl0aW5nIiwiZWRpdEJ0biIsIm5hbWVUb0VkaXQiLCJjbG9zZXN0Iiwic2F2ZUJ0biIsImNyZWF0ZVNhdmVCdG4iLCJmb2N1cyIsInNlbGVjdCIsInJlbW92ZUF0dHJpYnV0ZSIsImNsb3Nlc3RQcm9maWxlIiwiY2xvc2VzdFByb2ZpbGVJZCIsImlkIiwiY2xvc2VzdFByb2ZpbGVOYW1lIiwiYWxsRWRpdEJ0bnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImJ0biIsInNldEF0dHJpYnV0ZSIsInNhdmVVc2VySW5mb0J0biIsInNhdmVVc2VySW5mb0ljb24iLCJmb2N1c2VkTmFtZXMiLCJhbGxTYXZlQnRucyIsImVsIiwiYmx1ciIsInBvcHVwVmlzaWJsZSIsInJvb3QiLCJkb2N1bWVudEVsZW1lbnQiLCJwb3B1cCIsInBvcHVwRXJyb3IiLCJzZXRQcm9wZXJ0eSIsImNsb3Nlc3RQcm9maWxlQnRuIl0sInNvdXJjZXMiOlsiY29tcG9uZW50cy5qcyJdLCJtYXBwaW5ncyI6Ik9BQVNBLGtCQUFxQiwwQkFDckJDLHNCQUF5QixnQ0FDbEMsTUFBTUMsaUJBQW1CLElBQ25C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aGVscGVycy5taW4uanNcIjtcclxuaW1wb3J0IHsgc2V0VXNlclByZWZlcmVuY2UgfSBmcm9tIFwiLi91cGRhdGVTdGF0ZUZ1bmN0aW9ucy5taW4uanNcIjtcclxuY29uc3QgSElERV9MT0FERVJfVElNRSA9IDMwMDA7XHJcbmNvbnN0IEhJREVfUE9QVVBfVElNRSA9IDI1MDA7XHJcbmV4cG9ydCBjb25zdCBnZXREYXRhID0gKCkgPT4ge1xyXG5cdHRyeSB7XHJcblx0XHRjb25zdCBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKTtcclxuXHJcblx0XHRpZiAoIWRhdGEpIHJldHVybiBudWxsO1xyXG5cclxuXHRcdGNvbnN0IHBhcnNlZERhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xyXG5cclxuXHRcdGlmICh0eXBlb2YgcGFyc2VkRGF0YSAhPT0gXCJvYmplY3RcIiB8fCBwYXJzZWREYXRhID09PSBudWxsKSB7XHJcblx0XHRcdHNob3dFcnJvclBvcHVwKFwiQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZFwiLCBcIiNkYzRhMzRcIik7XHJcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIk5pZXByYXdpZMWCb3dhIHN0cnVrdHVyYSBkYW55Y2hcIik7XHJcblx0XHRcdC8vIHByenlwYWRlayBraWVkeSB1xbx5dGtvd25payB1c3VuaWUgZGFuZSB6IGxvY2FsIHN0b3JhZ2UsIGx1YiBqZcWbbGkgeiBqYWtpZWdvxZsgcG93b2R1IHphbWlhc3Qgb2JpZWt0dSBwb2phd2kgc2nEmSB0YW0gY29rb2x3aWVrIGlubmVnb1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHBhcnNlZERhdGE7XHJcblx0fSBjYXRjaCB7XHJcblx0XHRsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInVzZXJEYXRhXCIpOyAvLyBwb3dpbm5vIHNpxJkgY3p5xZtjacSHIHVzemtvZHpvbmUgZGFuZSFcclxuXHRcdHJldHVybiB7fTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyBERU1PIE9OTFkgLSBOZXZlciBoYXJkY29kZSBjcmVkZW50aWFscyBpbiBwcm9kdWN0aW9uIVxyXG5jb25zdCBVU0VSTkFNRSA9IFwiaGFuZHNvbWVVc2VyNDA0XCI7XHJcbmNvbnN0IFBBU1NXT1JEID0gXCI1amtzSDlkLlwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZUxvZ2luSGVhZGVyID0gKFxyXG5cdHtcclxuXHRcdGhlYWRlcjoge1xyXG5cdFx0XHRhbHQ6IHsgbG9nbyB9LFxyXG5cdFx0XHRhcmlhOiB7IGxvZ29MaW5rLCBjaGFuZ2VMYW5ndWFnZUJ1dHRvbiB9LFxyXG5cdFx0fSxcclxuXHR9LFxyXG5cdGxhbmdBbW91bnQsXHJcblx0bGFuZ05hbWVzLFxyXG5cdGxhbmd1YWdlLFxyXG5cdGhhbmRsZUxhbmdTZWxlY3RcclxuKSA9PiB7XHJcblx0Ly8gbG9nb1xyXG5cdGNvbnN0IGhlYWRlciA9IGNyZWF0ZUVsZW1lbnQoXCJoZWFkZXJcIiwgW1wiaGVhZGVyXCJdKTtcclxuXHRjb25zdCBwYWdlTG9nbyA9IGNyZWF0ZUVsZW1lbnQoXCJhXCIsIFtcImhlYWRlcl9fbG9nb1wiLCBcImxvZ2luLWhlYWRlcl9fbG9nb1wiXSwge1xyXG5cdFx0aHJlZjogXCIvXCIsXHJcblx0XHRcImFyaWEtbGFiZWxcIjogYCR7bG9nb0xpbmt9YCxcclxuXHR9KTtcclxuXHRjb25zdCBsb2dvSW1nID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiaW1nXCIsXHJcblx0XHRbXCJoZWFkZXJfX2xvZ28taW1nXCIsIFwibG9naW4taGVhZGVyX19sb2dvLWltZ1wiXSxcclxuXHRcdHtcclxuXHRcdFx0c3JjOiBcIi4vc3JjL2ljb25zL2xvZ28uc3ZnXCIsXHJcblx0XHRcdGFsdDogYCR7bG9nb31gLFxyXG5cdFx0XHR3aWR0aDogXCIyNFwiLFxyXG5cdFx0XHRoZWlnaHQ6IFwiMjRcIixcclxuXHRcdH1cclxuXHQpO1xyXG5cdGNvbnN0IGxvZ29UZXh0ID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1xyXG5cdFx0XCJoZWFkZXJfX2xvZ28tdGV4dFwiLFxyXG5cdFx0XCJsb2dpbi1oZWFkZXJfX2xvZ28tdGV4dFwiLFxyXG5cdF0pO1xyXG5cdGxvZ29UZXh0LnRleHRDb250ZW50ID0gXCJTdHJlYW1cIjtcclxuXHRwYWdlTG9nby5hcHBlbmQobG9nb0ltZywgbG9nb1RleHQpO1xyXG5cdGhlYWRlci5hcHBlbmQocGFnZUxvZ28pO1xyXG5cdC8vIGVuZCBvZiBsb2dvXHJcblxyXG5cdC8vIGxhbmd1YWdlIHNlbGVjdG9yXHJcblx0Y29uc3QgbGFuZ1NlbGVjdCA9IGNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwgW1wibG9naW4taGVhZGVyX19sYW5nLXNlbGVjdFwiXSwge1xyXG5cdFx0XCJhcmlhLWxhYmVsXCI6IGAke2NoYW5nZUxhbmd1YWdlQnV0dG9ufWAsXHJcblx0fSk7XHJcblx0Y29uc3QgbGFuZ1BsYXRmb3JtTGFuZyA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcclxuXHRcdFwibG9naW4taGVhZGVyX19sYW5nLXBsYXRmb3JtLWxhbmdcIixcclxuXHRdKTtcclxuXHRjb25zdCBsYW5nQXJyb3cgPSBjcmVhdGVFbGVtZW50KFwiaW1nXCIsIFtcImxvZ2luLWhlYWRlcl9fbGFuZy1hcnJvd1wiXSwge1xyXG5cdFx0c3JjOiBcIi4vc3JjL2ljb25zL2NoZXZyb24tZG93bi5zdmdcIixcclxuXHRcdGFsdDogXCJcIixcclxuXHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRoZWlnaHQ6IFwiMjRcIixcclxuXHR9KTtcclxuXHRjb25zdCBsYW5nTGlzdCA9IGNyZWF0ZUVsZW1lbnQoXCJ1bFwiLCBbXCJsb2dpbi1oZWFkZXJfX2xhbmctbGlzdFwiXSk7XHJcblxyXG5cdGZvciAobGV0IGkgPSAwOyBpIDwgbGFuZ0Ftb3VudDsgaSsrKSB7XHJcblx0XHRjb25zdCBsYW5nQ2hvaWNlID0gY3JlYXRlRWxlbWVudChcImxpXCIsIFtcImxvZ2luLWhlYWRlcl9fbGFuZy1jaG9pY2VcIl0sIHtcclxuXHRcdFx0dGFiaW5kZXg6IDAsXHJcblx0XHR9KTtcclxuXHRcdGNvbnN0IGRhdGEgPSBPYmplY3Qua2V5cyhsYW5nTmFtZXMpW2ldO1xyXG5cdFx0Y29uc3QgdGV4dCA9IE9iamVjdC52YWx1ZXMobGFuZ05hbWVzKVtpXTtcclxuXHJcblx0XHRsYW5nQ2hvaWNlLmRhdGFzZXQubGFuZyA9IGRhdGE7XHJcblx0XHRsYW5nQ2hvaWNlLnRleHRDb250ZW50ID0gdGV4dDtcclxuXHRcdGxhbmdDaG9pY2Uuc3R5bGUuYW5pbWF0aW9uRGVsYXkgPSBpICogMTAwICsgXCJtc1wiO1xyXG5cdFx0bGFuZ0xpc3QuYXBwZW5kKGxhbmdDaG9pY2UpO1xyXG5cdH1cclxuXHJcblx0bGFuZ1BsYXRmb3JtTGFuZy50ZXh0Q29udGVudCA9IGxhbmdOYW1lc1tsYW5ndWFnZV07XHJcblxyXG5cdGxhbmdTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRoYW5kbGVMYW5nU2VsZWN0LmNhbGwobGFuZ1NlbGVjdCwgZSwgbGFuZ1BsYXRmb3JtTGFuZyk7XHJcblx0fSk7XHJcblxyXG5cdGxhbmdTZWxlY3QuYXBwZW5kKGxhbmdQbGF0Zm9ybUxhbmcsIGxhbmdBcnJvdywgbGFuZ0xpc3QpO1xyXG5cdGhlYWRlci5hcHBlbmQobGFuZ1NlbGVjdCk7XHJcblxyXG5cdHJldHVybiBoZWFkZXI7XHJcblx0Ly8gZW5kIG9mIGxhbmd1YWdlIHNlbGVjdG9yXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTG9naW5QYWdlID0gKHtcclxuXHRtYWluOiB7XHJcblx0XHR0ZXh0OiB7IHRpdGxlLCBzdWJ0aXRsZSwgZGVzY3JpcHRpb24sIGJ1dHRvbiB9LFxyXG5cdFx0cGxhY2Vob2xkZXI6IHsgdXNlcm5hbWUsIHBhc3N3b3JkIH0sXHJcblx0fSxcclxufSkgPT4ge1xyXG5cdGNvbnN0IG1haW5Db250ZW50ID0gY3JlYXRlRWxlbWVudChcIm1haW5cIiwgW1wibWFpblwiXSk7XHJcblx0Y29uc3Qgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wid3JhcHBlclwiXSk7XHJcblx0Y29uc3QgbG9naW5UaXRsZSA9IGNyZWF0ZUVsZW1lbnQoXCJoMVwiKTtcclxuXHRjb25zdCBsb2dpblRpdGxlVG9wID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1wibWFpbl9fdGl0bGVcIl0pO1xyXG5cdGNvbnN0IGxvZ2luVGl0bGVCb3R0b20gPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXCJtYWluX19zdWJ0aXRsZVwiXSk7XHJcblx0Y29uc3QgbG9naW5UZXh0ID0gY3JlYXRlRWxlbWVudChcInBcIiwgW1wibWFpbl9fdGV4dFwiXSk7XHJcblx0Y29uc3QgZm9ybSA9IGNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIsIFtcIm1haW5fX2Zvcm1cIl0pO1xyXG5cdGNvbnN0IHVzZXJuYW1lSW5wdXQgPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJpbnB1dFwiLFxyXG5cdFx0W1wibWFpbl9fZm9ybS1pbnB1dFwiLCBcIm1haW5fX2Zvcm0taW5wdXQtLXVzZXJuYW1lXCJdLFxyXG5cdFx0eyB0eXBlOiBcInRleHRcIiwgcGxhY2Vob2xkZXI6IHVzZXJuYW1lIH1cclxuXHQpO1xyXG5cdGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJpbnB1dFwiLFxyXG5cdFx0W1wibWFpbl9fZm9ybS1pbnB1dFwiLCBcIm1haW5fX2Zvcm0taW5wdXQtLXBhc3N3b3JkXCJdLFxyXG5cdFx0eyB0eXBlOiBcInBhc3N3b3JkXCIsIHBsYWNlaG9sZGVyOiBwYXNzd29yZCB9XHJcblx0KTtcclxuXHRjb25zdCBzdWJtaXRCdG4gPSBjcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIFtcIm1haW5fX2Zvcm0tYnV0dG9uXCJdLCB7XHJcblx0XHR0eXBlOiBcInN1Ym1pdFwiLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGJ1dHRvblRleHQgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXCJtYWluX19mb3JtLWJ1dHRvbi10ZXh0XCJdKTtcclxuXHJcblx0Y29uc3QgZXJyb3JUeHQgPSBjcmVhdGVFbGVtZW50KFwicFwiLCBbXCJtYWluX19mb3JtLWVycm9yLXR4dFwiXSk7XHJcblx0bG9naW5UaXRsZVRvcC50ZXh0Q29udGVudCA9IHRpdGxlO1xyXG5cdGxvZ2luVGl0bGVCb3R0b20udGV4dENvbnRlbnQgPSBzdWJ0aXRsZTtcclxuXHRsb2dpblRleHQudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcclxuXHRidXR0b25UZXh0LnRleHRDb250ZW50ID0gYnV0dG9uO1xyXG5cclxuXHRsb2dpblRpdGxlLmFwcGVuZChsb2dpblRpdGxlVG9wLCBsb2dpblRpdGxlQm90dG9tKTtcclxuXHRzdWJtaXRCdG4uYXBwZW5kKGJ1dHRvblRleHQpO1xyXG5cdGZvcm0uYXBwZW5kKHVzZXJuYW1lSW5wdXQsIHBhc3N3b3JkSW5wdXQsIHN1Ym1pdEJ0biwgZXJyb3JUeHQpO1xyXG5cclxuXHR3cmFwcGVyLmFwcGVuZChsb2dpblRpdGxlLCBsb2dpblRleHQsIGZvcm0pO1xyXG5cdG1haW5Db250ZW50LmFwcGVuZCh3cmFwcGVyKTtcclxuXHJcblx0c3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0Y29uc3QgdXNlckRhdGEgPSBnZXREYXRhKCk7XHJcblxyXG5cdFx0Y29uc3QgcmVzdWx0cyA9IGhhbmRsZUxvZ2luVmFsaWRhdGlvbihcclxuXHRcdFx0ZSxcclxuXHRcdFx0dXNlcm5hbWVJbnB1dCxcclxuXHRcdFx0cGFzc3dvcmRJbnB1dCxcclxuXHRcdFx0dHJhbnNsYXRpb25zLm1haW4udGV4dC5lcnJvclJlcXVpcmVkLFxyXG5cdFx0XHR0cmFuc2xhdGlvbnMubWFpbi50ZXh0LmVycm9ySW52YWxpZCxcclxuXHRcdFx0VVNFUk5BTUUsXHJcblx0XHRcdFBBU1NXT1JELFxyXG5cdFx0XHRlcnJvclR4dFxyXG5cdFx0KTtcclxuXHJcblx0XHRpZiAoIXJlc3VsdHMpIHtcclxuXHRcdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LnJlbW92ZShcInZpc2libGVcIik7XHJcblx0XHRcdGUudGFyZ2V0LmFwcGVuZChzaG93U21hbGxMb2FkZXIoKSk7XHJcblx0XHRcdGUudGFyZ2V0LmRpc2FibGVkID0gdHJ1ZTtcclxuXHJcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHRcdGUudGFyZ2V0LmRpc2FibGVkID0gZmFsc2U7XHJcblx0XHRcdFx0aGlkZVNtYWxsTG9hZGVyKCk7XHJcblxyXG5cdFx0XHRcdHNldFVzZXJQcmVmZXJlbmNlKFwidHJhbnNsYXRpb25zXCIsIHRyYW5zbGF0aW9ucywgdXNlckRhdGEpO1xyXG5cdFx0XHRcdHNldFVzZXJQcmVmZXJlbmNlKFwibG9nZ2VkSW5cIiwgdHJ1ZSwgdXNlckRhdGEpO1xyXG5cdFx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCJwcm9maWxlcy5odG1sXCI7IC8vIHByemVqxZtjaWUgbmEgc3Ryb27EmSB6IHByb2ZpbGFtaVxyXG5cdFx0XHR9LCBISURFX0xPQURFUl9USU1FKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0cmV0dXJuIG1haW5Db250ZW50O1xyXG59O1xyXG5cclxuY29uc3QgaGFuZGxlTG9naW5WYWxpZGF0aW9uID0gKFxyXG5cdGUsXHJcblx0dXNlcm5hbWVJbnB1dCxcclxuXHRwYXNzd29yZElucHV0LFxyXG5cdHJlcXVpcmVFcnJvcixcclxuXHRpbnZhbGlkRXJyb3IsXHJcblx0dXNlcm5hbWUsXHJcblx0cGFzc3dvcmQsXHJcblx0ZXJyb3JUeHRcclxuKSA9PiB7XHJcblx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuXHRpZiAodXNlcm5hbWVJbnB1dC52YWx1ZS50cmltKCkgPT09IFwiXCIgfHwgcGFzc3dvcmRJbnB1dC52YWx1ZS50cmltKCkgPT09IFwiXCIpIHtcclxuXHRcdGVycm9yVHh0LmNsYXNzTGlzdC5hZGQoXCJ2aXNpYmxlXCIpO1xyXG5cdFx0ZXJyb3JUeHQudGV4dENvbnRlbnQgPSByZXF1aXJlRXJyb3I7XHJcblx0XHRyZXR1cm4gcmVxdWlyZUVycm9yO1xyXG5cdH0gZWxzZSBpZiAoXHJcblx0XHR1c2VybmFtZUlucHV0LnZhbHVlLnRyaW0oKSAhPT0gdXNlcm5hbWUgfHxcclxuXHRcdHBhc3N3b3JkSW5wdXQudmFsdWUudHJpbSgpICE9PSBwYXNzd29yZFxyXG5cdCkge1xyXG5cdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSB0cnVlO1xyXG5cdFx0ZS50YXJnZXQuYXBwZW5kKHNob3dTbWFsbExvYWRlcigpKTtcclxuXHRcdGVycm9yVHh0LmNsYXNzTGlzdC5yZW1vdmUoXCJ2aXNpYmxlXCIpO1xyXG5cclxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHRlcnJvclR4dC5jbGFzc0xpc3QuYWRkKFwidmlzaWJsZVwiKTtcclxuXHRcdFx0ZXJyb3JUeHQudGV4dENvbnRlbnQgPSBpbnZhbGlkRXJyb3I7XHJcblxyXG5cdFx0XHRlLnRhcmdldC5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuXHRcdFx0aGlkZVNtYWxsTG9hZGVyKCk7XHJcblx0XHR9LCBISURFX0xPQURFUl9USU1FKTtcclxuXHRcdHJldHVybiBpbnZhbGlkRXJyb3I7XHJcblx0fSBlbHNlIHtcclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzaG93QmlnTG9hZGVyID0gKCkgPT4ge1xyXG5cdGNvbnN0IGxvYWRpbmdBcmVhID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJsb2FkaW5nLWFyZWFcIl0pO1xyXG5cdGxvYWRpbmdBcmVhLmlubmVySFRNTCA9IGAgICAgICAgICAgICA8c3ZnIGNsYXNzPVwibG9hZGVyLWJpZ1wiIHZpZXdCb3g9XCIwIDAgMTIwIDEyMFwiIHdpZHRoPVwiMTIwXCIgaGVpZ2h0PVwiMTIwXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGVmcz5cclxuICAgICAgICAgICAgICAgICAgICA8bGluZWFyR3JhZGllbnQgaWQ9XCJsb2FkZXItYWNjZW50XCIgeDE9XCIwJVwiIHkxPVwiMCVcIiB4Mj1cIjEwMCVcIiB5Mj1cIjAlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjAlXCIgc3RvcC1jb2xvcj1cIiM0ZGE4ZGFcIiBzdG9wLW9wYWNpdHk9XCIwLjhcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCI3MCVcIiBzdG9wLWNvbG9yPVwiIzRkYThkYVwiIHN0b3Atb3BhY2l0eT1cIjAuNFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjEwMCVcIiBzdG9wLWNvbG9yPVwiIzRkYThkYVwiIHN0b3Atb3BhY2l0eT1cIjBcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvbGluZWFyR3JhZGllbnQ+XHJcbiAgICAgICAgICAgICAgICA8L2RlZnM+XHJcbiAgICAgICAgICAgICAgICA8Y2lyY2xlIGNsYXNzPVwibG9hZGluZy1jaXJjbGUtYmlnXCIgcj1cIjM1XCIgY3g9XCI2MFwiIGN5PVwiNjBcIj48L2NpcmNsZT5cclxuICAgICAgICAgICAgPC9zdmc+YDtcclxuXHRyZXR1cm4gbG9hZGluZ0FyZWE7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBoaWRlQmlnTG9hZGVyID0gKCkgPT4ge1xyXG5cdGNvbnN0IGxvYWRpbmdBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5sb2FkaW5nLWFyZWFcIik7XHJcblx0bG9hZGluZ0FyZWE/LnJlbW92ZSgpO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHNob3dTbWFsbExvYWRlciA9ICgpID0+IHtcclxuXHRjb25zdCBsb2FkaW5nQXJlYSA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibG9hZGluZy1hcmVhLXNtYWxsXCJdKTtcclxuXHRsb2FkaW5nQXJlYS5pbm5lckhUTUwgPSBgPHN2ZyBjbGFzcz1cImxvYWRlci1zbWFsbFwiIHZpZXdCb3g9XCIwIDAgMTIwIDEyMFwiIHdpZHRoPVwiMTIwXCIgaGVpZ2h0PVwiMTIwXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGVmcz5cclxuICAgICAgICAgICAgICAgICAgICA8bGluZWFyR3JhZGllbnQgaWQ9XCJsb2FkZXItYWNjZW50LXNtYWxsXCIgeDE9XCIwJVwiIHkxPVwiMCVcIiB4Mj1cIjEwMCVcIiB5Mj1cIjAlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjAlXCIgc3RvcC1jb2xvcj1cIndoaXRlXCIgc3RvcC1vcGFjaXR5PVwiMC44XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiNzAlXCIgc3RvcC1jb2xvcj1cIndoaXRlXCIgc3RvcC1vcGFjaXR5PVwiMC4zXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMTAwJVwiIHN0b3AtY29sb3I9XCJ3aGl0ZVwiIHN0b3Atb3BhY2l0eT1cIjBcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvbGluZWFyR3JhZGllbnQ+XHJcbiAgICAgICAgICAgICAgICA8L2RlZnM+XHJcbiAgICAgICAgICAgICAgICA8Y2lyY2xlIGNsYXNzPVwibG9hZGluZy1jaXJjbGUtc21hbGxcIiByPVwiMTJcIiBjeD1cIjYwXCIgY3k9XCI2MFwiPjwvY2lyY2xlPlxyXG4gICAgICAgICAgICA8L3N2Zz5gO1xyXG5cclxuXHRyZXR1cm4gbG9hZGluZ0FyZWE7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBoaWRlU21hbGxMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmxvYWRpbmctYXJlYS1zbWFsbFwiKTtcclxuXHRsb2FkaW5nQXJlYS5yZW1vdmUoKTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVQcm9maWxlc1BhZ2UgPSAoe1xyXG5cdHByb2ZpbGVzOiB7XHJcblx0XHR0ZXh0OiB7IHRpdGxlLCBhZGRQcm9maWxlSW5mbyB9LFxyXG5cdFx0YXJpYTogeyBhZGRQcm9maWxlQnRuLCB1c2VyUHJvZmlsZUJ0biwgdXNlckJ0bkN1c3RvbWl6ZSwgcmVtb3ZlVXNlckluZm8gfSxcclxuXHR9LFxyXG5cdGVycm9yUG9wdXA6IHtcclxuXHRcdHRleHQ6IHsgbWF4UHJvZmlsZXMsIGVtcHR5RmllbGQgfSxcclxuXHR9LFxyXG59KSA9PiB7XHJcblx0Y29uc3QgdXNlckRhdGEgPSBnZXREYXRhKCk7XHJcblx0Y29uc3QgdXNlclByb2ZpbGVzTGlzdCA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXM7XHJcblxyXG5cdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGFpbmVyXCIpO1xyXG5cclxuXHRjb250YWluZXIuYXBwZW5kKHNob3dCaWdMb2FkZXIoKSk7XHJcblxyXG5cdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0Y29uc3QgcHJvZmlsZXNQYWdlTWFpbiA9IGNyZWF0ZUVsZW1lbnQoXCJtYWluXCIsIFtcIm1haW4tcHJvZmlsZXNcIl0pO1xyXG5cdFx0Y29uc3Qgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wid3JhcHBlclwiXSk7XHJcblx0XHRjb25zdCBwcm9maWxlc1RpdGxlID0gY3JlYXRlRWxlbWVudChcImgxXCIsIFtcclxuXHRcdFx0XCJtYWluX190aXRsZVwiLFxyXG5cdFx0XHRcIm1haW4tcHJvZmlsZXNfX3RpdGxlXCIsXHJcblx0XHRdKTtcclxuXHRcdGNvbnN0IHByb2ZpbGVzQm94ID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX19ib3hcIl0pO1xyXG5cclxuXHRcdHByb2ZpbGVzVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcclxuXHJcblx0XHRpZiAodXNlclByb2ZpbGVzTGlzdCAmJiBPYmplY3Qua2V5cyh1c2VyUHJvZmlsZXNMaXN0KS5sZW5ndGggIT09IDApIHtcclxuXHRcdFx0Zm9yIChjb25zdCBrZXkgaW4gdXNlclByb2ZpbGVzTGlzdCkge1xyXG5cdFx0XHRcdHByb2ZpbGVzQm94LmFwcGVuZChcclxuXHRcdFx0XHRcdGNyZWF0ZVByb2ZpbGUoXHJcblx0XHRcdFx0XHRcdHVzZXJQcm9maWxlQnRuLFxyXG5cdFx0XHRcdFx0XHR1c2VyQnRuQ3VzdG9taXplLFxyXG5cdFx0XHRcdFx0XHR1c2VyQnRuQ3VzdG9taXplLFxyXG5cdFx0XHRcdFx0XHRlbXB0eUZpZWxkLFxyXG5cdFx0XHRcdFx0XHRyZW1vdmVVc2VySW5mbyxcclxuXHRcdFx0XHRcdFx0a2V5LFxyXG5cdFx0XHRcdFx0XHR1c2VyUHJvZmlsZXNMaXN0W2tleV1cclxuXHRcdFx0XHRcdClcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRwcm9maWxlc0JveC5hcHBlbmQoXHJcblx0XHRcdGNyZWF0ZVByb2ZpbGVBZGRCdG4oXHJcblx0XHRcdFx0YWRkUHJvZmlsZUJ0bixcclxuXHRcdFx0XHRhZGRQcm9maWxlSW5mbyxcclxuXHRcdFx0XHR1c2VyUHJvZmlsZUJ0bixcclxuXHRcdFx0XHRwcm9maWxlc0JveCxcclxuXHRcdFx0XHR1c2VyQnRuQ3VzdG9taXplLFxyXG5cdFx0XHRcdHVzZXJCdG5DdXN0b21pemUsXHJcblx0XHRcdFx0bWF4UHJvZmlsZXMsXHJcblx0XHRcdFx0ZW1wdHlGaWVsZCxcclxuXHRcdFx0XHRyZW1vdmVVc2VySW5mb1xyXG5cdFx0XHQpXHJcblx0XHQpO1xyXG5cdFx0d3JhcHBlci5hcHBlbmQocHJvZmlsZXNUaXRsZSwgcHJvZmlsZXNCb3gpO1xyXG5cdFx0cHJvZmlsZXNQYWdlTWFpbi5hcHBlbmQod3JhcHBlcik7XHJcblxyXG5cdFx0Y29udGFpbmVyLmFwcGVuZChwcm9maWxlc1BhZ2VNYWluKTtcclxuXHRcdGhpZGVCaWdMb2FkZXIoKTtcclxuXHR9LCA1MDApO1xyXG59O1xyXG5cclxuY29uc3QgY3JlYXRlUHJvZmlsZSA9IChcclxuXHRhcmlhSW5mbyxcclxuXHR1c2VyQnRuSW5mbyxcclxuXHRzYXZlQnRuQXJpYSxcclxuXHRlbXB0eUZpZWxkRXJyb3IsXHJcblx0cmVtb3ZlQXJpYSxcclxuXHRleGlzdGluZ1Byb2ZpbGVJZCA9IG51bGwsXHJcblx0ZXhpc3RpbmdQcm9maWxlTmFtZSA9IG51bGxcclxuKSA9PiB7XHJcblx0Y29uc3QgdXNlckRhdGEgPSBnZXREYXRhKCk7XHJcblx0Y29uc3QgZXhpc3RpbmdQcm9maWxlcyA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXMgfHwge307XHJcblxyXG5cdGlmICh1c2VyRGF0YSA9PT0gbnVsbCkge1xyXG5cdFx0c2hvd0Vycm9yUG9wdXAoXCJBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkXCIsIFwiI2RjNGEzNFwiKTtcclxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHR3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcblx0XHR9LCBISURFX1BPUFVQX1RJTUUpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0bGV0IGNvbG9yO1xyXG5cdGxldCBwcm9maWxlSWQ7XHJcblx0bGV0IHByb2ZpbGVOYW1lO1xyXG5cclxuXHRjb25zdCBjb2xvcnMgPSBbXCIjZGM0YTM0XCIsIFwiIzA2MkU2M1wiLCBcIiNGQUMwNDRcIl07XHJcblxyXG5cdGlmIChleGlzdGluZ1Byb2ZpbGVJZCkge1xyXG5cdFx0cHJvZmlsZUlkID0gZXhpc3RpbmdQcm9maWxlSWQ7XHJcblx0XHRwcm9maWxlTmFtZSA9IGV4aXN0aW5nUHJvZmlsZU5hbWUubmFtZTtcclxuXHRcdGNvbnN0IHByb2ZpbGVOdW1iZXIgPSBwYXJzZUludChwcm9maWxlSWQuc3BsaXQoXCItXCIpLnBvcCgpKTtcclxuXHRcdGNvbG9yID0gY29sb3JzW3Byb2ZpbGVOdW1iZXIgLSAxXTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0aWYgKE9iamVjdC5rZXlzKGV4aXN0aW5nUHJvZmlsZXMpLmxlbmd0aCA+PSAzKSByZXR1cm47XHJcblxyXG5cdFx0bGV0IG5leHROdW1iZXIgPSAxO1xyXG5cdFx0d2hpbGUgKGV4aXN0aW5nUHJvZmlsZXNbYHVzZXItcHJvZmlsZS0ke25leHROdW1iZXJ9YF0pIHtcclxuXHRcdFx0bmV4dE51bWJlcisrO1xyXG5cdFx0fVxyXG5cclxuXHRcdHByb2ZpbGVJZCA9IGB1c2VyLXByb2ZpbGUtJHtuZXh0TnVtYmVyfWA7XHJcblx0XHRwcm9maWxlTmFtZSA9IGBIYW5kc29tZSBVc2VyICR7bmV4dE51bWJlcn1gO1xyXG5cdFx0Y29sb3IgPSBjb2xvcnNbbmV4dE51bWJlciAtIDFdO1xyXG5cdH1cclxuXHJcblx0Y29uc3QgdXNlclByb2ZpbGUgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX3Byb2ZpbGVcIl0pO1xyXG5cdGNvbnN0IHVzZXJBdmF0YXJCb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2F2YXRhclwiXSk7XHJcblx0Y29uc3QgdXNlclByb2ZpbGVCdG4gPSBjcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIFtcIm1haW4tcHJvZmlsZXNfX2J0blwiXSwge1xyXG5cdFx0XCJhcmlhLWxhYmVsXCI6IGFyaWFJbmZvLFxyXG5cdFx0XCJkYXRhLWlkXCI6IHByb2ZpbGVJZCxcclxuXHR9KTtcclxuXHJcblx0Y29uc3QgdXNlclByb2ZpbGVJbmZvQm94ID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX191c2VyLWluZm9cIl0pO1xyXG5cdGNvbnN0IHVzZXJQcm9maWxlSW5mbyA9IGNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCBbXCJtYWluLXByb2ZpbGVzX19uYW1lXCJdLCB7XHJcblx0XHR0eXBlOiBcInRleHRcIixcclxuXHRcdHJlYWRvbmx5OiB0cnVlLFxyXG5cdFx0dmFsdWU6IHByb2ZpbGVOYW1lLFxyXG5cdH0pO1xyXG5cdGNvbnN0IG5hbWVCb3JkZXIgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXCJuYW1lLWJvcmRlclwiXSk7XHJcblx0Y29uc3QgZWRpdFVzZXJJbmZvQnRuID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiYnV0dG9uXCIsXHJcblx0XHRbXCJtYWluLXByb2ZpbGVzX19lZGl0LW5hbWVcIl0sXHJcblx0XHR7IFwiYXJpYS1sYWJlbFwiOiB1c2VyQnRuSW5mbyB9XHJcblx0KTtcclxuXHRjb25zdCByZW1vdmVVc2VyQnRuID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiYnV0dG9uXCIsXHJcblx0XHRbXCJtYWluLXByb2ZpbGVzX19yZW1vdmUtdXNlclwiXSxcclxuXHRcdHsgXCJhcmlhLWxhYmVsXCI6IHJlbW92ZUFyaWEgfVxyXG5cdCk7XHJcblx0Y29uc3QgcmVtb3ZlVXNlckljb24gPSBjcmVhdGVFbGVtZW50KFwiaW1nXCIsIFtcIm1haW4tcHJvZmlsZXNfX3JlbW92ZS1pY29uXCJdLCB7XHJcblx0XHR3aWR0aDogXCIyNFwiLFxyXG5cdFx0aGVpZ2h0OiBcIjI0XCIsXHJcblx0XHRsb2FkaW5nOiBcImxhenlcIixcclxuXHRcdGFsdDogXCJcIixcclxuXHRcdHNyYzogXCIuL3NyYy9pY29ucy9yZW1vdmUtcHJvZmlsZS1pY29uLnN2Z1wiLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGVkaXRVc2VySW5mb0ljb24gPSBjcmVhdGVFbGVtZW50KFwiaW1nXCIsIFtcIm1haW4tcHJvZmlsZXNfX2VkaXQtaWNvblwiXSwge1xyXG5cdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdFx0bG9hZGluZzogXCJsYXp5XCIsXHJcblx0XHRhbHQ6IFwiXCIsXHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvZWRpdC5zdmdcIixcclxuXHR9KTtcclxuXHJcblx0dXNlclByb2ZpbGVCdG4uaW5uZXJIVE1MID0gYDxzdmcgY2xhc3M9XCJtYWluLXByb2ZpbGVzX19pbWdcIiB3aWR0aD1cIjE1MFwiIGhlaWdodD1cIjE1MFwiIHZpZXdCb3g9XCIwIDAgMjAwIDIwMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj5cclxuICAgIDxjaXJjbGUgY3g9XCI3MFwiIGN5PVwiNzBcIiByPVwiOFwiIGZpbGw9XCJ3aGl0ZVwiIC8+XHJcbiAgICA8Y2lyY2xlIGN4PVwiMTMwXCIgY3k9XCI3MFwiIHI9XCI4XCIgZmlsbD1cIndoaXRlXCIgLz5cclxuICAgIDxwYXRoIGQ9XCJNNjAgMTEwIFExMDAgMTUwIDE0MCAxMTBcIiBzdHJva2U9XCJ3aGl0ZVwiIHN0cm9rZS13aWR0aD1cIjZcIlxyXG4gICAgZmlsbD1cInRyYW5zcGFyZW50XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIC8+XHJcbiAgICA8L3N2Zz5gO1xyXG5cdHVzZXJQcm9maWxlQnRuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xyXG5cclxuXHR1c2VyQXZhdGFyQm94LmFwcGVuZCh1c2VyUHJvZmlsZUJ0bik7XHJcblx0ZWRpdFVzZXJJbmZvQnRuLmFwcGVuZChlZGl0VXNlckluZm9JY29uKTtcclxuXHRyZW1vdmVVc2VyQnRuLmFwcGVuZChyZW1vdmVVc2VySWNvbik7XHJcblx0dXNlclByb2ZpbGVJbmZvQm94LmFwcGVuZChcclxuXHRcdHVzZXJQcm9maWxlSW5mbyxcclxuXHRcdG5hbWVCb3JkZXIsXHJcblx0XHRlZGl0VXNlckluZm9CdG4sXHJcblx0XHRyZW1vdmVVc2VyQnRuXHJcblx0KTtcclxuXHR1c2VyUHJvZmlsZS5hcHBlbmQodXNlckF2YXRhckJveCwgdXNlclByb2ZpbGVJbmZvQm94KTtcclxuXHJcblx0aWYgKCFleGlzdGluZ1Byb2ZpbGVJZCkge1xyXG5cdFx0Y29uc3QgdXBkYXRlZFByb2ZpbGVzID0ge1xyXG5cdFx0XHQuLi5leGlzdGluZ1Byb2ZpbGVzLFxyXG5cdFx0XHRbcHJvZmlsZUlkXToge1xyXG5cdFx0XHRcdG5hbWU6IHByb2ZpbGVOYW1lLFxyXG5cdFx0XHR9LFxyXG5cdFx0fTtcclxuXHRcdHNldFVzZXJQcmVmZXJlbmNlKFwidXNlclByb2ZpbGVzXCIsIHVwZGF0ZWRQcm9maWxlcywgdXNlckRhdGEpO1xyXG5cdH1cclxuXHJcblx0ZWRpdFVzZXJJbmZvQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0ZWRpdFVzZXJuYW1lKGUsIHVzZXJQcm9maWxlSW5mb0JveCwgc2F2ZUJ0bkFyaWEsIGVtcHR5RmllbGRFcnJvcik7XHJcblx0fSk7XHJcblx0cmVtb3ZlVXNlckJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdHJlbW92ZVVzZXIoZSk7XHJcblx0fSk7XHJcblxyXG5cdHVzZXJQcm9maWxlSW5mby5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG5cdFx0aWYgKGUua2V5ID09PSBcIkVudGVyXCIpIHtcclxuXHRcdFx0c2F2ZVVzZXJuYW1lKGUsIGVtcHR5RmllbGRFcnJvcik7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHVzZXJQcm9maWxlLmNsYXNzTGlzdC5hZGQoXCJ2aXNpYmxlXCIpO1xyXG5cdHJldHVybiB1c2VyUHJvZmlsZTtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZVByb2ZpbGVBZGRCdG4gPSAoXHJcblx0YXJpYUluZm8sXHJcblx0aW5mbyxcclxuXHR1c2VyQnRuQXJpYSxcclxuXHRwcm9maWxlc0JveCxcclxuXHR1c2VyQnRuSW5mbyxcclxuXHRzYXZlQnRuQXJpYSxcclxuXHRtYXhQcm9maWxlc0Vycm9yLFxyXG5cdGVtcHR5RmllbGRFcnJvcixcclxuXHRyZW1vdmVBcmlhXHJcbikgPT4ge1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVCb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2FkZC1wcm9maWxlXCJdKTtcclxuXHRjb25zdCBhZGRQcm9maWxlQXZhdGFyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX19hdmF0YXJcIl0pO1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVCdG4gPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJidXR0b25cIixcclxuXHRcdFtcIm1haW4tcHJvZmlsZXNfX2J0blwiLCBcIm1haW4tcHJvZmlsZXNfX2J0bi0tYWRkLXByb2ZpbGVcIl0sXHJcblx0XHR7IFwiYXJpYS1sYWJlbFwiOiBhcmlhSW5mbyB9XHJcblx0KTtcclxuXHRjb25zdCBhZGRQcm9maWxlUGx1c0ljb24gPSBjcmVhdGVFbGVtZW50KFwiaW1nXCIsIFtcIm1haW4tcHJvZmlsZXNfX2FkZC1pbWdcIl0sIHtcclxuXHRcdHNyYzogXCIuL3NyYy9pY29ucy9hZGQtcHJvZmlsZS5zdmdcIixcclxuXHRcdGxvYWRpbmc6IFwibGF6eVwiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVJbmZvID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1wibWFpbi1wcm9maWxlc19fbmFtZVwiXSk7XHJcblxyXG5cdGFkZFByb2ZpbGVJbmZvLnRleHRDb250ZW50ID0gaW5mbztcclxuXHJcblx0YWRkUHJvZmlsZUJ0bi5hcHBlbmQoYWRkUHJvZmlsZVBsdXNJY29uKTtcclxuXHRhZGRQcm9maWxlQXZhdGFyLmFwcGVuZChhZGRQcm9maWxlQnRuKTtcclxuXHRhZGRQcm9maWxlQm94LmFwcGVuZChhZGRQcm9maWxlQXZhdGFyLCBhZGRQcm9maWxlSW5mbyk7XHJcblxyXG5cdGFkZFByb2ZpbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuXHRcdGNvbnN0IHVzZXJEYXRhID0gZ2V0RGF0YSgpO1xyXG5cdFx0Y29uc3QgZXhpc3RpbmdQcm9maWxlcyA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXMgfHwge307XHJcblxyXG5cdFx0aWYgKE9iamVjdC5rZXlzKGV4aXN0aW5nUHJvZmlsZXMpLmxlbmd0aCA+PSAzKSB7XHJcblx0XHRcdHNob3dFcnJvclBvcHVwKG1heFByb2ZpbGVzRXJyb3IsIFwiI2RjNGEzNFwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IHByb2ZpbGUgPSBjcmVhdGVQcm9maWxlKFxyXG5cdFx0XHR1c2VyQnRuQXJpYSxcclxuXHRcdFx0dXNlckJ0bkluZm8sXHJcblx0XHRcdHNhdmVCdG5BcmlhLFxyXG5cdFx0XHRlbXB0eUZpZWxkRXJyb3IsXHJcblx0XHRcdHJlbW92ZUFyaWFcclxuXHRcdCk7XHJcblxyXG5cdFx0aWYgKHByb2ZpbGUpIHtcclxuXHRcdFx0cHJvZmlsZXNCb3guaW5zZXJ0QmVmb3JlKHByb2ZpbGUsIGFkZFByb2ZpbGVCb3gpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHRyZXR1cm4gYWRkUHJvZmlsZUJveDtcclxufTtcclxuXHJcbmNvbnN0IGVkaXRVc2VybmFtZSA9IChlLCBwYXJlbnQsIHNhdmVCdG5BcmlhLCBlbXB0eUZpZWxkRXJyb3IpID0+IHtcclxuXHRyZXNldFN0YXRlT2ZFZGl0aW5nKGUpO1xyXG5cclxuXHRjb25zdCBlZGl0QnRuID0gZS50YXJnZXQ7XHJcblx0Y29uc3QgbmFtZVRvRWRpdCA9IGVkaXRCdG5cclxuXHRcdC5jbG9zZXN0KFwiLm1haW4tcHJvZmlsZXNfX3Byb2ZpbGVcIilcclxuXHRcdC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tcHJvZmlsZXNfX25hbWVcIik7XHJcblxyXG5cdGNvbnN0IHNhdmVCdG4gPSBjcmVhdGVTYXZlQnRuKHNhdmVCdG5BcmlhKTtcclxuXHJcblx0ZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xyXG5cdHNhdmVCdG4uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcclxuXHJcblx0cGFyZW50LmFwcGVuZChzYXZlQnRuKTtcclxuXHJcblx0bmFtZVRvRWRpdC5mb2N1cygpO1xyXG5cdG5hbWVUb0VkaXQuc2VsZWN0KCk7XHJcblx0bmFtZVRvRWRpdC5yZW1vdmVBdHRyaWJ1dGUoXCJyZWFkb25seVwiKTtcclxuXHRuYW1lVG9FZGl0LmNsYXNzTGlzdC5hZGQoXCJmb2N1c2VkXCIpO1xyXG5cclxuXHRzYXZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0c2F2ZVVzZXJuYW1lKGUsIGVtcHR5RmllbGRFcnJvcik7XHJcblx0fSk7XHJcbn07XHJcblxyXG5jb25zdCBzYXZlVXNlcm5hbWUgPSAoZSwgZW1wdHlGaWVsZEVycm9yKSA9PiB7XHJcblx0Y29uc3QgdXNlckRhdGEgPSBnZXREYXRhKCk7XHJcblx0Y29uc3QgZXhpc3RpbmdQcm9maWxlcyA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXMgfHwgW107XHJcblxyXG5cdGNvbnN0IHNhdmVCdG4gPSBlLnRhcmdldDtcclxuXHRjb25zdCBjbG9zZXN0UHJvZmlsZSA9IHNhdmVCdG4uY2xvc2VzdChcIi5tYWluLXByb2ZpbGVzX19wcm9maWxlXCIpO1xyXG5cdGNvbnN0IGNsb3Nlc3RQcm9maWxlSWQgPSBjbG9zZXN0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLm1haW4tcHJvZmlsZXNfX2J0blwiKVxyXG5cdFx0LmRhdGFzZXQuaWQ7XHJcblx0Y29uc3QgY2xvc2VzdFByb2ZpbGVOYW1lID0gY2xvc2VzdFByb2ZpbGUucXVlcnlTZWxlY3RvcihcclxuXHRcdFwiLm1haW4tcHJvZmlsZXNfX25hbWVcIlxyXG5cdCk7XHJcblxyXG5cdGNvbnN0IGFsbEVkaXRCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tYWluLXByb2ZpbGVzX19lZGl0LW5hbWVcIik7XHJcblxyXG5cdGFsbEVkaXRCdG5zLmZvckVhY2goKGJ0bikgPT4gYnRuLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpKTtcclxuXHJcblx0aWYgKGNsb3Nlc3RQcm9maWxlTmFtZS52YWx1ZS50cmltKCkgPT09IFwiXCIpIHtcclxuXHRcdGFsbEVkaXRCdG5zLmZvckVhY2goKGJ0bikgPT4gYnRuLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpKTtcclxuXHRcdHJldHVybiBzaG93RXJyb3JQb3B1cChlbXB0eUZpZWxkRXJyb3IsIFwiI0ZBQzA0NFwiKTtcclxuXHR9XHJcblxyXG5cdGNvbnN0IHVwZGF0ZWRQcm9maWxlcyA9IHtcclxuXHRcdC4uLmV4aXN0aW5nUHJvZmlsZXMsXHJcblx0XHRbY2xvc2VzdFByb2ZpbGVJZF06IHtcclxuXHRcdFx0Li4uZXhpc3RpbmdQcm9maWxlc1tjbG9zZXN0UHJvZmlsZUlkXSxcclxuXHRcdFx0bmFtZTogY2xvc2VzdFByb2ZpbGVOYW1lLnZhbHVlLFxyXG5cdFx0fSxcclxuXHR9O1xyXG5cclxuXHRzZXRVc2VyUHJlZmVyZW5jZShcInVzZXJQcm9maWxlc1wiLCB1cGRhdGVkUHJvZmlsZXMsIHVzZXJEYXRhKTtcclxuXHJcblx0cmVzZXRTdGF0ZU9mRWRpdGluZyhlKTtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZVNhdmVCdG4gPSAoc2F2ZUJ0bkFyaWEpID0+IHtcclxuXHRjb25zdCBzYXZlVXNlckluZm9CdG4gPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJidXR0b25cIixcclxuXHRcdFtcIm1haW4tcHJvZmlsZXNfX3NhdmUtbmFtZVwiLCBcImhpZGRlblwiXSxcclxuXHRcdHsgXCJhcmlhLWxhYmVsXCI6IHNhdmVCdG5BcmlhIH1cclxuXHQpO1xyXG5cdGNvbnN0IHNhdmVVc2VySW5mb0ljb24gPSBjcmVhdGVFbGVtZW50KFwiaW1nXCIsIFtcIm1haW4tcHJvZmlsZXNfX3NhdmUtaWNvblwiXSwge1xyXG5cdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdFx0bG9hZGluZzogXCJsYXp5XCIsXHJcblx0XHRhbHQ6IFwiXCIsXHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvc2F2ZS5zdmdcIixcclxuXHR9KTtcclxuXHJcblx0c2F2ZVVzZXJJbmZvQnRuLmFwcGVuZChzYXZlVXNlckluZm9JY29uKTtcclxuXHJcblx0cmV0dXJuIHNhdmVVc2VySW5mb0J0bjtcclxufTtcclxuXHJcbmNvbnN0IHJlc2V0U3RhdGVPZkVkaXRpbmcgPSAoZSkgPT4ge1xyXG5cdGNvbnN0IGZvY3VzZWROYW1lcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9jdXNlZFwiKTtcclxuXHRjb25zdCBhbGxTYXZlQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWFpbi1wcm9maWxlc19fc2F2ZS1uYW1lXCIpO1xyXG5cdGNvbnN0IGFsbEVkaXRCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tYWluLXByb2ZpbGVzX19lZGl0LW5hbWVcIik7XHJcblxyXG5cdGZvY3VzZWROYW1lcy5mb3JFYWNoKChlbCkgPT4ge1xyXG5cdFx0ZWwuc2V0QXR0cmlidXRlKFwicmVhZG9ubHlcIiwgdHJ1ZSk7XHJcblx0XHRlbC5jbGFzc0xpc3QucmVtb3ZlKFwiZm9jdXNlZFwiKTtcclxuXHRcdGVsLmJsdXIoKTtcclxuXHR9KTtcclxuXHRhbGxTYXZlQnRucy5mb3JFYWNoKChidG4pID0+IGJ0bi5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpKTtcclxuXHRhbGxFZGl0QnRucy5mb3JFYWNoKChidG4pID0+IGJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpKTtcclxufTtcclxuXHJcbmxldCBwb3B1cFZpc2libGUgPSBmYWxzZTtcclxuY29uc3Qgc2hvd0Vycm9yUG9wdXAgPSAodGV4dCwgY29sb3IpID0+IHtcclxuXHRpZiAocG9wdXBWaXNpYmxlKSByZXR1cm47XHJcblx0cG9wdXBWaXNpYmxlID0gdHJ1ZTtcclxuXHJcblx0Y29uc3Qgcm9vdCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcclxuXHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhaW5lclwiKTtcclxuXHJcblx0Y29uc3QgcG9wdXAgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcImVycm9yLXBvcHVwXCJdKTtcclxuXHRjb25zdCBwb3B1cEVycm9yID0gY3JlYXRlRWxlbWVudChcInBcIiwgW1wiZXJyb3ItcG9wdXBfX3RleHRcIl0pO1xyXG5cclxuXHRwb3B1cEVycm9yLnRleHRDb250ZW50ID0gdGV4dDtcclxuXHRyb290LnN0eWxlLnNldFByb3BlcnR5KFwiLS1lcnJvclR4dENvbG9yXCIsIGNvbG9yKTtcclxuXHJcblx0cG9wdXAuYXBwZW5kKHBvcHVwRXJyb3IpO1xyXG5cdGNvbnRhaW5lci5hcHBlbmQocG9wdXApO1xyXG5cclxuXHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XHJcblx0fSwgMjAwMCk7XHJcblx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRwb3B1cC5yZW1vdmUoKTtcclxuXHRcdHBvcHVwVmlzaWJsZSA9IGZhbHNlO1xyXG5cdH0sIEhJREVfUE9QVVBfVElNRSk7XHJcbn07XHJcblxyXG5jb25zdCByZW1vdmVVc2VyID0gKGUpID0+IHtcclxuXHRjb25zdCB1c2VyRGF0YSA9IGdldERhdGEoKTtcclxuXHRjb25zdCB1c2VyUHJvZmlsZXMgPSB1c2VyRGF0YT8udXNlclByb2ZpbGVzO1xyXG5cdGNvbnN0IGFsbEVkaXRCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tYWluLXByb2ZpbGVzX19lZGl0LW5hbWVcIik7XHJcblxyXG5cdGNvbnN0IGRlbGV0ZUJ0biA9IGUudGFyZ2V0O1xyXG5cdGNvbnN0IGNsb3Nlc3RQcm9maWxlID0gZGVsZXRlQnRuLmNsb3Nlc3QoXCIubWFpbi1wcm9maWxlc19fcHJvZmlsZVwiKTtcclxuXHRjb25zdCBjbG9zZXN0UHJvZmlsZUJ0biA9IGNsb3Nlc3RQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1wcm9maWxlc19fYnRuXCIpO1xyXG5cdGFsbEVkaXRCdG5zLmZvckVhY2goKGJ0bikgPT4gYnRuLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpKTtcclxuXHJcblx0ZGVsZXRlIHVzZXJQcm9maWxlc1tjbG9zZXN0UHJvZmlsZUJ0bi5kYXRhc2V0LmlkXTtcclxuXHJcblx0c2V0VXNlclByZWZlcmVuY2UoXCJ1c2VyUHJvZmlsZXNcIiwgdXNlclByb2ZpbGVzLCB1c2VyRGF0YSk7XHJcblxyXG5cdGNsb3Nlc3RQcm9maWxlLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XHJcblxyXG5cdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0Y2xvc2VzdFByb2ZpbGUucmVtb3ZlKCk7XHJcblx0fSwgNDAwKTtcclxufTtcclxuIl19
