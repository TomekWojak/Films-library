import{createElement}from"./helpers.min.js";import{setUserPreference}from"./updateStateFunctions.min.js";const getData=()=>{try{const e=localStorage.getItem("userData");if(!e)return{};const t=JSON.parse(e);if("object"!=typeof t||null===t)throw new Error("Nieprawidłowa struktura danych");return t}catch{return console.log("Błąd pobierania danych z local storage"),localStorage.removeItem("userData"),{}}},USERNAME="handsomeUser404",PASSWORD="5jksH9d.";export const createLoginHeader=({header:{alt:{logo:e},aria:{logoLink:t,changeLanguageButton:r}}},a,n,o,i)=>{const l=createElement("header",["header"]),s=createElement("a",["header__logo","login-header__logo"],{href:"/","aria-label":`${t}`}),c=createElement("img",["header__logo-img","login-header__logo-img"],{src:"./src/icons/logo.svg",alt:`${e}`,width:"24",height:"24"}),d=createElement("span",["header__logo-text","login-header__logo-text"]);d.textContent="Stream",s.append(c,d),l.append(s);const p=createElement("button",["login-header__lang-select"],{"aria-label":`${r}`}),m=createElement("span",["login-header__lang-platform-lang"]),f=createElement("img",["login-header__lang-arrow"],{src:"./src/icons/chevron-down.svg",alt:"",width:"24",height:"24"}),u=createElement("ul",["login-header__lang-list"]);for(let e=0;e<a;e++){const t=createElement("li",["login-header__lang-choice"],{tabindex:0}),r=Object.keys(n)[e],a=Object.values(n)[e];t.dataset.lang=r,t.textContent=a,t.style.animationDelay=100*e+"ms",u.append(t)}return m.textContent=n[o],p.addEventListener("click",e=>{i.call(p,e,m)}),p.append(m,f,u),l.append(p),l};export const createLoginPage=({main:{text:{title:e,subtitle:t,description:r,button:a},placeholder:{username:n,password:o}}})=>{const i=createElement("main",["main"]),l=createElement("div",["wrapper"]),s=createElement("h1"),c=createElement("span",["main__title"]),d=createElement("span",["main__subtitle"]),p=createElement("p",["main__text"]),m=createElement("form",["main__form"]),f=createElement("input",["main__form-input","main__form-input--username"],{type:"text",placeholder:n}),u=createElement("input",["main__form-input","main__form-input--password"],{type:"password",placeholder:o}),g=createElement("button",["main__form-button"],{type:"submit"}),_=createElement("span",["main__form-button-text"]),h=createElement("p",["main__form-error-txt"]);return c.textContent=e,d.textContent=t,p.textContent=r,_.textContent=a,s.append(c,d),g.append(_),m.append(f,u,g,h),l.append(s,p,m),i.append(l),g.addEventListener("click",e=>{const t=getData();handleLoginValidation(e,f,u,translations.main.text.errorRequired,translations.main.text.errorInvalid,USERNAME,PASSWORD,h)||(h.classList.remove("visible"),e.target.append(showSmallLoader()),e.target.disabled=!0,setTimeout(()=>{e.target.disabled=!1,hideSmallLoader(),setUserPreference("translations",translations,t),setUserPreference("loggedIn",!0,t),window.location.href="profiles.html"},3e3))}),i};const handleLoginValidation=(e,t,r,a,n,o,i,l)=>(e.preventDefault(),""===t.value.trim()||""===r.value.trim()?(l.classList.add("visible"),l.textContent=a,a):t.value.trim()!==o||r.value.trim()!==i?(e.target.disabled=!0,e.target.append(showSmallLoader()),l.classList.remove("visible"),setTimeout(()=>{l.classList.add("visible"),l.textContent=n,e.target.disabled=!1,hideSmallLoader()},3e3),n):null);export const showBigLoader=()=>{const e=createElement("div",["loading-area"]);return e.innerHTML='            <svg class="loader-big" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="#4da8da" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="#4da8da" stop-opacity="0.4" />\n                        <stop offset="100%" stop-color="#4da8da" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-big" r="35" cx="60" cy="60"></circle>\n            </svg>',e};export const hideBigLoader=()=>{const e=document.querySelector(".loading-area");e?.remove()};export const showSmallLoader=()=>{const e=createElement("div",["loading-area-small"]);return e.innerHTML='<svg class="loader-small" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent-small" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="white" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="white" stop-opacity="0.3" />\n                        <stop offset="100%" stop-color="white" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-small" r="12" cx="60" cy="60"></circle>\n            </svg>',e};export const hideSmallLoader=()=>{document.querySelector(".loading-area-small").remove()};export const createProfilesPage=({profiles:{text:{title:e,addProfileInfo:t},aria:{addProfileBtn:r,userProfileBtn:a,userBtnCustomize:n}},errorPopup:{text:{maxProfiles:o,emptyField:i}}})=>{const l=getData(),s=l?.userProfiles,c=document.querySelector(".container"),d=createElement("main",["main-profiles"]),p=createElement("div",["wrapper"]),m=createElement("h1",["main__title","main-profiles__title"]),f=createElement("div",["main-profiles__box"]);if(m.textContent=e,s&&0!==Object.keys(s).length)for(const e in s)f.append(createProfile(a,n,n,i,e,s[e]));f.append(createProfileAddBtn(r,t,a,f,n,n,o,i)),p.append(m,f),d.append(p),c.append(d)};const createProfile=(e,t,r,a,n=null,o=null)=>{const i=getData(),l=i?.userProfiles||{};let s,c,d;const p=["#dc4a34","#062E63","#FAC044"];if(n){c=n,d=o;s=p[parseInt(c.split("-").pop())-1]}else{if(Object.keys(l).length>=3)return;let e=1;for(;l[`user-profile-${e}`];)e++;c=`user-profile-${e}`,d=`Handsome User ${e}`,s=p[e-1]}const m=createElement("div",["main-profiles__profile"]),f=createElement("div",["main-profiles__avatar"]),u=createElement("button",["main-profiles__btn"],{"aria-label":e,"data-id":c}),g=createElement("div",["main-profiles__user-info"]),_=createElement("input",["main-profiles__name"],{type:"text",readonly:!0,value:d}),h=createElement("button",["main-profiles__edit-name"],{"aria-label":t}),v=createElement("button",["main-profiles__remove-user"],{"aria-label":"Przycisk umożliwiający usunięcie użytkownika"}),E=createElement("img",["main-profiles__remove-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/remove-profile-icon.svg"}),b=createElement("img",["main-profiles__edit-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/edit.svg"});if(u.innerHTML='<svg class="main-profiles__img" width="150" height="150" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">\n    <circle cx="70" cy="70" r="8" fill="white" />\n    <circle cx="130" cy="70" r="8" fill="white" />\n    <path d="M60 110 Q100 150 140 110" stroke="white" stroke-width="6"\n    fill="transparent" stroke-linecap="round" />\n    </svg>',u.style.backgroundColor=s,f.append(u),h.append(b),v.append(E),g.append(_,h,v),m.append(f,g),!n){const e={...l,[c]:d};setUserPreference("userProfiles",e,i)}return h.addEventListener("click",e=>{editUsername(e,g,r,a)}),v.addEventListener("click",e=>{removeUser(e)}),_.addEventListener("keydown",e=>{"Enter"===e.key&&saveUsername(e,a)}),m},createProfileAddBtn=(e,t,r,a,n,o,i,l)=>{const s=createElement("div",["main-profiles__add-profile"]),c=createElement("div",["main-profiles__avatar"]),d=createElement("button",["main-profiles__btn","main-profiles__btn--add-profile"],{"aria-label":e}),p=createElement("img",["main-profiles__add-img"],{src:"./src/icons/add-profile.svg",loading:"lazy",alt:""}),m=createElement("span",["main-profiles__name"]);return m.textContent=t,d.append(p),c.append(d),s.append(c,m),d.addEventListener("click",()=>{const e=getData(),t=e?.userProfiles||{};if(Object.keys(t).length>=3)return void showErrorPopup(i,"#dc4a34");const c=createProfile(r,n,o,l);c&&a.insertBefore(c,s)}),s},editUsername=(e,t,r,a)=>{resetStateOfEditing(e);const n=e.target,o=n.previousElementSibling,i=createSaveBtn(r);n.classList.add("hidden"),i.classList.remove("hidden"),t.append(i),o.focus(),o.select(),o.removeAttribute("readonly"),o.classList.add("focused"),i.addEventListener("click",e=>{saveUsername(e,a)})},saveUsername=(e,t)=>{const r=getData(),a=r?.userProfiles||[],n=e.target.closest(".main-profiles__profile"),o=n.querySelector(".main-profiles__btn").dataset.id,i=n.querySelector(".main-profiles__name"),l=document.querySelectorAll(".main-profiles__edit-name");if(l.forEach(e=>e.removeAttribute("disabled")),""===i.value.trim())return l.forEach(e=>e.setAttribute("disabled",!0)),showErrorPopup(t,"#FAC044");const s={...a,[o]:i.value};setUserPreference("userProfiles",s,r),resetStateOfEditing(e)},createSaveBtn=e=>{const t=createElement("button",["main-profiles__save-name","hidden"],{"aria-label":e}),r=createElement("img",["main-profiles__save-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/save.svg"});return t.append(r),t},resetStateOfEditing=e=>{const t=document.querySelectorAll(".focused"),r=document.querySelectorAll(".main-profiles__save-name"),a=document.querySelectorAll(".main-profiles__edit-name");t.forEach(e=>{e.setAttribute("readonly",!0),e.classList.remove("focused"),e.blur()}),r.forEach(e=>e.classList.add("hidden")),a.forEach(e=>e.classList.remove("hidden"))};let popupVisible=!1;const showErrorPopup=(e,t)=>{if(popupVisible)return;popupVisible=!0;const r=document.documentElement,a=document.querySelector(".container"),n=createElement("div",["error-popup"]),o=createElement("p",["error-popup__text"]);o.textContent=e,r.style.setProperty("--errorTxtColor",t),n.append(o),a.append(n),setTimeout(()=>{n.classList.add("hidden")},2e3),setTimeout(()=>{n.remove(),popupVisible=!1},2500)},removeUser=e=>{const t=getData(),r=t?.userProfiles,a=document.querySelectorAll(".main-profiles__edit-name"),n=e.target.closest(".main-profiles__profile"),o=n.querySelector(".main-profiles__btn");a.forEach(e=>e.removeAttribute("disabled")),delete r[o.dataset.id],setUserPreference("userProfiles",r,t),n.remove()};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50cy5taW4uanMiLCJuYW1lcyI6WyJjcmVhdGVFbGVtZW50Iiwic2V0VXNlclByZWZlcmVuY2UiLCJnZXREYXRhIiwiZGF0YSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJwYXJzZWREYXRhIiwiSlNPTiIsInBhcnNlIiwiRXJyb3IiLCJjb25zb2xlIiwibG9nIiwicmVtb3ZlSXRlbSIsIlVTRVJOQU1FIiwiUEFTU1dPUkQiLCJjcmVhdGVMb2dpbkhlYWRlciIsImhlYWRlciIsImFsdCIsImxvZ28iLCJhcmlhIiwibG9nb0xpbmsiLCJjaGFuZ2VMYW5ndWFnZUJ1dHRvbiIsImxhbmdBbW91bnQiLCJsYW5nTmFtZXMiLCJsYW5ndWFnZSIsImhhbmRsZUxhbmdTZWxlY3QiLCJwYWdlTG9nbyIsImhyZWYiLCJsb2dvSW1nIiwic3JjIiwid2lkdGgiLCJoZWlnaHQiLCJsb2dvVGV4dCIsInRleHRDb250ZW50IiwiYXBwZW5kIiwibGFuZ1NlbGVjdCIsImxhbmdQbGF0Zm9ybUxhbmciLCJsYW5nQXJyb3ciLCJsYW5nTGlzdCIsImkiLCJsYW5nQ2hvaWNlIiwidGFiaW5kZXgiLCJPYmplY3QiLCJrZXlzIiwidGV4dCIsInZhbHVlcyIsImRhdGFzZXQiLCJsYW5nIiwic3R5bGUiLCJhbmltYXRpb25EZWxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY2FsbCIsImNyZWF0ZUxvZ2luUGFnZSIsIm1haW4iLCJ0aXRsZSIsInN1YnRpdGxlIiwiZGVzY3JpcHRpb24iLCJidXR0b24iLCJwbGFjZWhvbGRlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJtYWluQ29udGVudCIsIndyYXBwZXIiLCJsb2dpblRpdGxlIiwibG9naW5UaXRsZVRvcCIsImxvZ2luVGl0bGVCb3R0b20iLCJsb2dpblRleHQiLCJmb3JtIiwidXNlcm5hbWVJbnB1dCIsInR5cGUiLCJwYXNzd29yZElucHV0Iiwic3VibWl0QnRuIiwiYnV0dG9uVGV4dCIsImVycm9yVHh0IiwidXNlckRhdGEiLCJoYW5kbGVMb2dpblZhbGlkYXRpb24iLCJ0cmFuc2xhdGlvbnMiLCJlcnJvclJlcXVpcmVkIiwiZXJyb3JJbnZhbGlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGFyZ2V0Iiwic2hvd1NtYWxsTG9hZGVyIiwiZGlzYWJsZWQiLCJzZXRUaW1lb3V0IiwiaGlkZVNtYWxsTG9hZGVyIiwid2luZG93IiwibG9jYXRpb24iLCJyZXF1aXJlRXJyb3IiLCJpbnZhbGlkRXJyb3IiLCJwcmV2ZW50RGVmYXVsdCIsInZhbHVlIiwidHJpbSIsImFkZCIsInNob3dCaWdMb2FkZXIiLCJsb2FkaW5nQXJlYSIsImlubmVySFRNTCIsImhpZGVCaWdMb2FkZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjcmVhdGVQcm9maWxlc1BhZ2UiLCJwcm9maWxlcyIsImFkZFByb2ZpbGVJbmZvIiwiYWRkUHJvZmlsZUJ0biIsInVzZXJQcm9maWxlQnRuIiwidXNlckJ0bkN1c3RvbWl6ZSIsImVycm9yUG9wdXAiLCJtYXhQcm9maWxlcyIsImVtcHR5RmllbGQiLCJ1c2VyUHJvZmlsZXNMaXN0IiwidXNlclByb2ZpbGVzIiwiY29udGFpbmVyIiwicHJvZmlsZXNQYWdlTWFpbiIsInByb2ZpbGVzVGl0bGUiLCJwcm9maWxlc0JveCIsImxlbmd0aCIsImtleSIsImNyZWF0ZVByb2ZpbGUiLCJjcmVhdGVQcm9maWxlQWRkQnRuIiwiYXJpYUluZm8iLCJ1c2VyQnRuSW5mbyIsInNhdmVCdG5BcmlhIiwiZW1wdHlGaWVsZEVycm9yIiwiZXhpc3RpbmdQcm9maWxlSWQiLCJleGlzdGluZ1Byb2ZpbGVOYW1lIiwiZXhpc3RpbmdQcm9maWxlcyIsImNvbG9yIiwicHJvZmlsZUlkIiwicHJvZmlsZU5hbWUiLCJjb2xvcnMiLCJwYXJzZUludCIsInNwbGl0IiwicG9wIiwibmV4dE51bWJlciIsInVzZXJQcm9maWxlIiwidXNlckF2YXRhckJveCIsInVzZXJQcm9maWxlSW5mb0JveCIsInVzZXJQcm9maWxlSW5mbyIsInJlYWRvbmx5IiwiZWRpdFVzZXJJbmZvQnRuIiwicmVtb3ZlVXNlckJ0biIsInJlbW92ZVVzZXJJY29uIiwibG9hZGluZyIsImVkaXRVc2VySW5mb0ljb24iLCJiYWNrZ3JvdW5kQ29sb3IiLCJ1cGRhdGVkUHJvZmlsZXMiLCJlZGl0VXNlcm5hbWUiLCJyZW1vdmVVc2VyIiwic2F2ZVVzZXJuYW1lIiwiaW5mbyIsInVzZXJCdG5BcmlhIiwibWF4UHJvZmlsZXNFcnJvciIsImFkZFByb2ZpbGVCb3giLCJhZGRQcm9maWxlQXZhdGFyIiwiYWRkUHJvZmlsZVBsdXNJY29uIiwic2hvd0Vycm9yUG9wdXAiLCJwcm9maWxlIiwiaW5zZXJ0QmVmb3JlIiwicGFyZW50IiwicmVzZXRTdGF0ZU9mRWRpdGluZyIsImVkaXRCdG4iLCJuYW1lVG9FZGl0IiwicHJldmlvdXNFbGVtZW50U2libGluZyIsInNhdmVCdG4iLCJjcmVhdGVTYXZlQnRuIiwiZm9jdXMiLCJzZWxlY3QiLCJyZW1vdmVBdHRyaWJ1dGUiLCJjbG9zZXN0UHJvZmlsZSIsImNsb3Nlc3QiLCJjbG9zZXN0UHJvZmlsZUlkIiwiaWQiLCJjbG9zZXN0UHJvZmlsZU5hbWUiLCJhbGxFZGl0QnRucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYnRuIiwic2V0QXR0cmlidXRlIiwic2F2ZVVzZXJJbmZvQnRuIiwic2F2ZVVzZXJJbmZvSWNvbiIsImZvY3VzZWROYW1lcyIsImFsbFNhdmVCdG5zIiwiZWwiLCJibHVyIiwicG9wdXBWaXNpYmxlIiwicm9vdCIsImRvY3VtZW50RWxlbWVudCIsInBvcHVwIiwicG9wdXBFcnJvciIsInNldFByb3BlcnR5IiwiY2xvc2VzdFByb2ZpbGVCdG4iXSwic291cmNlcyI6WyJjb21wb25lbnRzLmpzIl0sIm1hcHBpbmdzIjoiT0FBU0Esa0JBQXFCLDBCQUNyQkMsc0JBQXlCLGdDQUVsQyxNQUFNQyxRQUFVLEtBQ2YsSUFDQyxNQUFNQyxFQUFPQyxhQUFhQyxRQUFRLFlBRWxDLElBQUtGLEVBQU0sTUFBTyxDQUFDLEVB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LE9BQU8ySixHQUNiN0UsRUFBVTlFLE9BQU8wSixHQUVqQnZHLFdBQVcsS0FDVnVHLEVBQU01RyxVQUFVYyxJQUFJLFdBQ2xCLEtBQ0hULFdBQVcsS0FDVnVHLEVBQU0zRyxTQUNOd0csY0FBZSxHQUNiLE9BR0VyQyxXQUFjakcsSUFDbkIsTUFBTXdCLEVBQVd6RSxVQUNYNkcsRUFBZXBDLEdBQVVvQyxhQUN6QitELEVBQWMzRSxTQUFTNEUsaUJBQWlCLDZCQUd4Q04sRUFEWXRILEVBQUUrQixPQUNhd0YsUUFBUSwyQkFDbkNxQixFQUFvQnRCLEVBQWVyRSxjQUFjLHVCQUN2RDBFLEVBQVlFLFFBQVNDLEdBQVFBLEVBQUlULGdCQUFnQixvQkFFMUN6RCxFQUFhZ0YsRUFBa0JqSixRQUFROEgsSUFFOUMzSyxrQkFBa0IsZUFBZ0I4RyxFQUFjcEMsR0FFaEQ4RixFQUFleEYiLCJpZ25vcmVMaXN0IjpbXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlRWxlbWVudCB9IGZyb20gXCIuL2hlbHBlcnMubWluLmpzXCI7XHJcbmltcG9ydCB7IHNldFVzZXJQcmVmZXJlbmNlIH0gZnJvbSBcIi4vdXBkYXRlU3RhdGVGdW5jdGlvbnMubWluLmpzXCI7XHJcblxyXG5jb25zdCBnZXREYXRhID0gKCkgPT4ge1xyXG5cdHRyeSB7XHJcblx0XHRjb25zdCBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKTtcclxuXHJcblx0XHRpZiAoIWRhdGEpIHJldHVybiB7fTtcclxuXHJcblx0XHRjb25zdCBwYXJzZWREYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcclxuXHJcblx0XHRpZiAodHlwZW9mIHBhcnNlZERhdGEgIT09IFwib2JqZWN0XCIgfHwgcGFyc2VkRGF0YSA9PT0gbnVsbCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOaWVwcmF3aWTFgm93YSBzdHJ1a3R1cmEgZGFueWNoXCIpO1xyXG5cdFx0XHQvLyBwcnp5cGFkZWsga2llZHkgdcW8eXRrb3duaWsgdXN1bmllIGRhbmUgeiBsb2NhbCBzdG9yYWdlLCBsdWIgamXFm2xpIHogamFraWVnb8WbIHBvd29kdSB6YW1pYXN0IG9iaWVrdHUgcG9qYXdpIHNpxJkgdGFtIGNva29sd2llayBpbm5lZ29cclxuXHRcdH1cclxuXHRcdHJldHVybiBwYXJzZWREYXRhO1xyXG5cdH0gY2F0Y2gge1xyXG5cdFx0Y29uc29sZS5sb2coXCJCxYLEhWQgcG9iaWVyYW5pYSBkYW55Y2ggeiBsb2NhbCBzdG9yYWdlXCIpO1xyXG5cdFx0bG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ1c2VyRGF0YVwiKTsgLy8gcG93aW5ubyBzacSZIGN6ecWbY2nEhyB1c3prb2R6b25lIGRhbmUhIVxyXG5cdFx0cmV0dXJuIHt9O1xyXG5cdH1cclxufTtcclxuXHJcbmNvbnN0IFVTRVJOQU1FID0gXCJoYW5kc29tZVVzZXI0MDRcIjtcclxuY29uc3QgUEFTU1dPUkQgPSBcIjVqa3NIOWQuXCI7XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTG9naW5IZWFkZXIgPSAoXHJcblx0e1xyXG5cdFx0aGVhZGVyOiB7XHJcblx0XHRcdGFsdDogeyBsb2dvIH0sXHJcblx0XHRcdGFyaWE6IHsgbG9nb0xpbmssIGNoYW5nZUxhbmd1YWdlQnV0dG9uIH0sXHJcblx0XHR9LFxyXG5cdH0sXHJcblx0bGFuZ0Ftb3VudCxcclxuXHRsYW5nTmFtZXMsXHJcblx0bGFuZ3VhZ2UsXHJcblx0aGFuZGxlTGFuZ1NlbGVjdFxyXG4pID0+IHtcclxuXHQvLyBsb2dvXHJcblx0Y29uc3QgaGVhZGVyID0gY3JlYXRlRWxlbWVudChcImhlYWRlclwiLCBbXCJoZWFkZXJcIl0pO1xyXG5cdGNvbnN0IHBhZ2VMb2dvID0gY3JlYXRlRWxlbWVudChcImFcIiwgW1wiaGVhZGVyX19sb2dvXCIsIFwibG9naW4taGVhZGVyX19sb2dvXCJdLCB7XHJcblx0XHRocmVmOiBcIi9cIixcclxuXHRcdFwiYXJpYS1sYWJlbFwiOiBgJHtsb2dvTGlua31gLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGxvZ29JbWcgPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJpbWdcIixcclxuXHRcdFtcImhlYWRlcl9fbG9nby1pbWdcIiwgXCJsb2dpbi1oZWFkZXJfX2xvZ28taW1nXCJdLFxyXG5cdFx0e1xyXG5cdFx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvbG9nby5zdmdcIixcclxuXHRcdFx0YWx0OiBgJHtsb2dvfWAsXHJcblx0XHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdFx0fVxyXG5cdCk7XHJcblx0Y29uc3QgbG9nb1RleHQgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXHJcblx0XHRcImhlYWRlcl9fbG9nby10ZXh0XCIsXHJcblx0XHRcImxvZ2luLWhlYWRlcl9fbG9nby10ZXh0XCIsXHJcblx0XSk7XHJcblx0bG9nb1RleHQudGV4dENvbnRlbnQgPSBcIlN0cmVhbVwiO1xyXG5cdHBhZ2VMb2dvLmFwcGVuZChsb2dvSW1nLCBsb2dvVGV4dCk7XHJcblx0aGVhZGVyLmFwcGVuZChwYWdlTG9nbyk7XHJcblx0Ly8gZW5kIG9mIGxvZ29cclxuXHJcblx0Ly8gbGFuZ3VhZ2Ugc2VsZWN0b3JcclxuXHRjb25zdCBsYW5nU2VsZWN0ID0gY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCBbXCJsb2dpbi1oZWFkZXJfX2xhbmctc2VsZWN0XCJdLCB7XHJcblx0XHRcImFyaWEtbGFiZWxcIjogYCR7Y2hhbmdlTGFuZ3VhZ2VCdXR0b259YCxcclxuXHR9KTtcclxuXHRjb25zdCBsYW5nUGxhdGZvcm1MYW5nID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1xyXG5cdFx0XCJsb2dpbi1oZWFkZXJfX2xhbmctcGxhdGZvcm0tbGFuZ1wiLFxyXG5cdF0pO1xyXG5cdGNvbnN0IGxhbmdBcnJvdyA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibG9naW4taGVhZGVyX19sYW5nLWFycm93XCJdLCB7XHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvY2hldnJvbi1kb3duLnN2Z1wiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGxhbmdMaXN0ID0gY3JlYXRlRWxlbWVudChcInVsXCIsIFtcImxvZ2luLWhlYWRlcl9fbGFuZy1saXN0XCJdKTtcclxuXHJcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsYW5nQW1vdW50OyBpKyspIHtcclxuXHRcdGNvbnN0IGxhbmdDaG9pY2UgPSBjcmVhdGVFbGVtZW50KFwibGlcIiwgW1wibG9naW4taGVhZGVyX19sYW5nLWNob2ljZVwiXSwge1xyXG5cdFx0XHR0YWJpbmRleDogMCxcclxuXHRcdH0pO1xyXG5cdFx0Y29uc3QgZGF0YSA9IE9iamVjdC5rZXlzKGxhbmdOYW1lcylbaV07XHJcblx0XHRjb25zdCB0ZXh0ID0gT2JqZWN0LnZhbHVlcyhsYW5nTmFtZXMpW2ldO1xyXG5cclxuXHRcdGxhbmdDaG9pY2UuZGF0YXNldC5sYW5nID0gZGF0YTtcclxuXHRcdGxhbmdDaG9pY2UudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG5cdFx0bGFuZ0Nob2ljZS5zdHlsZS5hbmltYXRpb25EZWxheSA9IGkgKiAxMDAgKyBcIm1zXCI7XHJcblx0XHRsYW5nTGlzdC5hcHBlbmQobGFuZ0Nob2ljZSk7XHJcblx0fVxyXG5cclxuXHRsYW5nUGxhdGZvcm1MYW5nLnRleHRDb250ZW50ID0gbGFuZ05hbWVzW2xhbmd1YWdlXTtcclxuXHJcblx0bGFuZ1NlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdGhhbmRsZUxhbmdTZWxlY3QuY2FsbChsYW5nU2VsZWN0LCBlLCBsYW5nUGxhdGZvcm1MYW5nKTtcclxuXHR9KTtcclxuXHJcblx0bGFuZ1NlbGVjdC5hcHBlbmQobGFuZ1BsYXRmb3JtTGFuZywgbGFuZ0Fycm93LCBsYW5nTGlzdCk7XHJcblx0aGVhZGVyLmFwcGVuZChsYW5nU2VsZWN0KTtcclxuXHJcblx0cmV0dXJuIGhlYWRlcjtcclxuXHQvLyBlbmQgb2YgbGFuZ3VhZ2Ugc2VsZWN0b3JcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVMb2dpblBhZ2UgPSAoe1xyXG5cdG1haW46IHtcclxuXHRcdHRleHQ6IHsgdGl0bGUsIHN1YnRpdGxlLCBkZXNjcmlwdGlvbiwgYnV0dG9uIH0sXHJcblx0XHRwbGFjZWhvbGRlcjogeyB1c2VybmFtZSwgcGFzc3dvcmQgfSxcclxuXHR9LFxyXG59KSA9PiB7XHJcblx0Y29uc3QgbWFpbkNvbnRlbnQgPSBjcmVhdGVFbGVtZW50KFwibWFpblwiLCBbXCJtYWluXCJdKTtcclxuXHRjb25zdCB3cmFwcGVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJ3cmFwcGVyXCJdKTtcclxuXHRjb25zdCBsb2dpblRpdGxlID0gY3JlYXRlRWxlbWVudChcImgxXCIpO1xyXG5cdGNvbnN0IGxvZ2luVGl0bGVUb3AgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXCJtYWluX190aXRsZVwiXSk7XHJcblx0Y29uc3QgbG9naW5UaXRsZUJvdHRvbSA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW5fX3N1YnRpdGxlXCJdKTtcclxuXHRjb25zdCBsb2dpblRleHQgPSBjcmVhdGVFbGVtZW50KFwicFwiLCBbXCJtYWluX190ZXh0XCJdKTtcclxuXHRjb25zdCBmb3JtID0gY3JlYXRlRWxlbWVudChcImZvcm1cIiwgW1wibWFpbl9fZm9ybVwiXSk7XHJcblx0Y29uc3QgdXNlcm5hbWVJbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImlucHV0XCIsXHJcblx0XHRbXCJtYWluX19mb3JtLWlucHV0XCIsIFwibWFpbl9fZm9ybS1pbnB1dC0tdXNlcm5hbWVcIl0sXHJcblx0XHR7IHR5cGU6IFwidGV4dFwiLCBwbGFjZWhvbGRlcjogdXNlcm5hbWUgfVxyXG5cdCk7XHJcblx0Y29uc3QgcGFzc3dvcmRJbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImlucHV0XCIsXHJcblx0XHRbXCJtYWluX19mb3JtLWlucHV0XCIsIFwibWFpbl9fZm9ybS1pbnB1dC0tcGFzc3dvcmRcIl0sXHJcblx0XHR7IHR5cGU6IFwicGFzc3dvcmRcIiwgcGxhY2Vob2xkZXI6IHBhc3N3b3JkIH1cclxuXHQpO1xyXG5cdGNvbnN0IHN1Ym1pdEJ0biA9IGNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwgW1wibWFpbl9fZm9ybS1idXR0b25cIl0sIHtcclxuXHRcdHR5cGU6IFwic3VibWl0XCIsXHJcblx0fSk7XHJcblx0Y29uc3QgYnV0dG9uVGV4dCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW5fX2Zvcm0tYnV0dG9uLXRleHRcIl0pO1xyXG5cclxuXHRjb25zdCBlcnJvclR4dCA9IGNyZWF0ZUVsZW1lbnQoXCJwXCIsIFtcIm1haW5fX2Zvcm0tZXJyb3ItdHh0XCJdKTtcclxuXHRsb2dpblRpdGxlVG9wLnRleHRDb250ZW50ID0gdGl0bGU7XHJcblx0bG9naW5UaXRsZUJvdHRvbS50ZXh0Q29udGVudCA9IHN1YnRpdGxlO1xyXG5cdGxvZ2luVGV4dC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG5cdGJ1dHRvblRleHQudGV4dENvbnRlbnQgPSBidXR0b247XHJcblxyXG5cdGxvZ2luVGl0bGUuYXBwZW5kKGxvZ2luVGl0bGVUb3AsIGxvZ2luVGl0bGVCb3R0b20pO1xyXG5cdHN1Ym1pdEJ0bi5hcHBlbmQoYnV0dG9uVGV4dCk7XHJcblx0Zm9ybS5hcHBlbmQodXNlcm5hbWVJbnB1dCwgcGFzc3dvcmRJbnB1dCwgc3VibWl0QnRuLCBlcnJvclR4dCk7XHJcblxyXG5cdHdyYXBwZXIuYXBwZW5kKGxvZ2luVGl0bGUsIGxvZ2luVGV4dCwgZm9ybSk7XHJcblx0bWFpbkNvbnRlbnQuYXBwZW5kKHdyYXBwZXIpO1xyXG5cclxuXHRzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRjb25zdCB1c2VyRGF0YSA9IGdldERhdGEoKTtcclxuXHJcblx0XHRjb25zdCByZXN1bHRzID0gaGFuZGxlTG9naW5WYWxpZGF0aW9uKFxyXG5cdFx0XHRlLFxyXG5cdFx0XHR1c2VybmFtZUlucHV0LFxyXG5cdFx0XHRwYXNzd29yZElucHV0LFxyXG5cdFx0XHR0cmFuc2xhdGlvbnMubWFpbi50ZXh0LmVycm9yUmVxdWlyZWQsXHJcblx0XHRcdHRyYW5zbGF0aW9ucy5tYWluLnRleHQuZXJyb3JJbnZhbGlkLFxyXG5cdFx0XHRVU0VSTkFNRSxcclxuXHRcdFx0UEFTU1dPUkQsXHJcblx0XHRcdGVycm9yVHh0XHJcblx0XHQpO1xyXG5cclxuXHRcdGlmICghcmVzdWx0cykge1xyXG5cdFx0XHRlcnJvclR4dC5jbGFzc0xpc3QucmVtb3ZlKFwidmlzaWJsZVwiKTtcclxuXHRcdFx0ZS50YXJnZXQuYXBwZW5kKHNob3dTbWFsbExvYWRlcigpKTtcclxuXHRcdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSB0cnVlO1xyXG5cclxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHRcdFx0XHRoaWRlU21hbGxMb2FkZXIoKTtcclxuXHJcblx0XHRcdFx0c2V0VXNlclByZWZlcmVuY2UoXCJ0cmFuc2xhdGlvbnNcIiwgdHJhbnNsYXRpb25zLCB1c2VyRGF0YSk7XHJcblx0XHRcdFx0c2V0VXNlclByZWZlcmVuY2UoXCJsb2dnZWRJblwiLCB0cnVlLCB1c2VyRGF0YSk7XHJcblx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSBcInByb2ZpbGVzLmh0bWxcIjsgLy8gcHJ6ZWrFm2NpZSBuYSBzdHJvbsSZIHogcHJvZmlsYW1pXHJcblx0XHRcdH0sIDMwMDApO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHRyZXR1cm4gbWFpbkNvbnRlbnQ7XHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVMb2dpblZhbGlkYXRpb24gPSAoXHJcblx0ZSxcclxuXHR1c2VybmFtZUlucHV0LFxyXG5cdHBhc3N3b3JkSW5wdXQsXHJcblx0cmVxdWlyZUVycm9yLFxyXG5cdGludmFsaWRFcnJvcixcclxuXHR1c2VybmFtZSxcclxuXHRwYXNzd29yZCxcclxuXHRlcnJvclR4dFxyXG4pID0+IHtcclxuXHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdGlmICh1c2VybmFtZUlucHV0LnZhbHVlLnRyaW0oKSA9PT0gXCJcIiB8fCBwYXNzd29yZElucHV0LnZhbHVlLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LmFkZChcInZpc2libGVcIik7XHJcblx0XHRlcnJvclR4dC50ZXh0Q29udGVudCA9IHJlcXVpcmVFcnJvcjtcclxuXHRcdHJldHVybiByZXF1aXJlRXJyb3I7XHJcblx0fSBlbHNlIGlmIChcclxuXHRcdHVzZXJuYW1lSW5wdXQudmFsdWUudHJpbSgpICE9PSB1c2VybmFtZSB8fFxyXG5cdFx0cGFzc3dvcmRJbnB1dC52YWx1ZS50cmltKCkgIT09IHBhc3N3b3JkXHJcblx0KSB7XHJcblx0XHRlLnRhcmdldC5kaXNhYmxlZCA9IHRydWU7XHJcblx0XHRlLnRhcmdldC5hcHBlbmQoc2hvd1NtYWxsTG9hZGVyKCkpO1xyXG5cdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LnJlbW92ZShcInZpc2libGVcIik7XHJcblxyXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdGVycm9yVHh0LmNsYXNzTGlzdC5hZGQoXCJ2aXNpYmxlXCIpO1xyXG5cdFx0XHRlcnJvclR4dC50ZXh0Q29udGVudCA9IGludmFsaWRFcnJvcjtcclxuXHJcblx0XHRcdGUudGFyZ2V0LmRpc2FibGVkID0gZmFsc2U7XHJcblxyXG5cdFx0XHRoaWRlU21hbGxMb2FkZXIoKTtcclxuXHRcdH0sIDMwMDApO1xyXG5cdFx0cmV0dXJuIGludmFsaWRFcnJvcjtcclxuXHR9IGVsc2Uge1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHNob3dCaWdMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcImxvYWRpbmctYXJlYVwiXSk7XHJcblx0bG9hZGluZ0FyZWEuaW5uZXJIVE1MID0gYCAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJsb2FkZXItYmlnXCIgdmlld0JveD1cIjAgMCAxMjAgMTIwXCIgd2lkdGg9XCIxMjBcIiBoZWlnaHQ9XCIxMjBcIj5cclxuICAgICAgICAgICAgICAgIDxkZWZzPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsaW5lYXJHcmFkaWVudCBpZD1cImxvYWRlci1hY2NlbnRcIiB4MT1cIjAlXCIgeTE9XCIwJVwiIHgyPVwiMTAwJVwiIHkyPVwiMCVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMCVcIiBzdG9wLWNvbG9yPVwiIzRkYThkYVwiIHN0b3Atb3BhY2l0eT1cIjAuOFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjcwJVwiIHN0b3AtY29sb3I9XCIjNGRhOGRhXCIgc3RvcC1vcGFjaXR5PVwiMC40XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMTAwJVwiIHN0b3AtY29sb3I9XCIjNGRhOGRhXCIgc3RvcC1vcGFjaXR5PVwiMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9saW5lYXJHcmFkaWVudD5cclxuICAgICAgICAgICAgICAgIDwvZGVmcz5cclxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3M9XCJsb2FkaW5nLWNpcmNsZS1iaWdcIiByPVwiMzVcIiBjeD1cIjYwXCIgY3k9XCI2MFwiPjwvY2lyY2xlPlxyXG4gICAgICAgICAgICA8L3N2Zz5gO1xyXG5cdHJldHVybiBsb2FkaW5nQXJlYTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGhpZGVCaWdMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmxvYWRpbmctYXJlYVwiKTtcclxuXHRsb2FkaW5nQXJlYT8ucmVtb3ZlKCk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc2hvd1NtYWxsTG9hZGVyID0gKCkgPT4ge1xyXG5cdGNvbnN0IGxvYWRpbmdBcmVhID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJsb2FkaW5nLWFyZWEtc21hbGxcIl0pO1xyXG5cdGxvYWRpbmdBcmVhLmlubmVySFRNTCA9IGA8c3ZnIGNsYXNzPVwibG9hZGVyLXNtYWxsXCIgdmlld0JveD1cIjAgMCAxMjAgMTIwXCIgd2lkdGg9XCIxMjBcIiBoZWlnaHQ9XCIxMjBcIj5cclxuICAgICAgICAgICAgICAgIDxkZWZzPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsaW5lYXJHcmFkaWVudCBpZD1cImxvYWRlci1hY2NlbnQtc21hbGxcIiB4MT1cIjAlXCIgeTE9XCIwJVwiIHgyPVwiMTAwJVwiIHkyPVwiMCVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMCVcIiBzdG9wLWNvbG9yPVwid2hpdGVcIiBzdG9wLW9wYWNpdHk9XCIwLjhcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCI3MCVcIiBzdG9wLWNvbG9yPVwid2hpdGVcIiBzdG9wLW9wYWNpdHk9XCIwLjNcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIxMDAlXCIgc3RvcC1jb2xvcj1cIndoaXRlXCIgc3RvcC1vcGFjaXR5PVwiMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9saW5lYXJHcmFkaWVudD5cclxuICAgICAgICAgICAgICAgIDwvZGVmcz5cclxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3M9XCJsb2FkaW5nLWNpcmNsZS1zbWFsbFwiIHI9XCIxMlwiIGN4PVwiNjBcIiBjeT1cIjYwXCI+PC9jaXJjbGU+XHJcbiAgICAgICAgICAgIDwvc3ZnPmA7XHJcblxyXG5cdHJldHVybiBsb2FkaW5nQXJlYTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGhpZGVTbWFsbExvYWRlciA9ICgpID0+IHtcclxuXHRjb25zdCBsb2FkaW5nQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubG9hZGluZy1hcmVhLXNtYWxsXCIpO1xyXG5cdGxvYWRpbmdBcmVhLnJlbW92ZSgpO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVByb2ZpbGVzUGFnZSA9ICh7XHJcblx0cHJvZmlsZXM6IHtcclxuXHRcdHRleHQ6IHsgdGl0bGUsIGFkZFByb2ZpbGVJbmZvIH0sXHJcblx0XHRhcmlhOiB7IGFkZFByb2ZpbGVCdG4sIHVzZXJQcm9maWxlQnRuLCB1c2VyQnRuQ3VzdG9taXplIH0sXHJcblx0fSxcclxuXHRlcnJvclBvcHVwOiB7XHJcblx0XHR0ZXh0OiB7IG1heFByb2ZpbGVzLCBlbXB0eUZpZWxkIH0sXHJcblx0fSxcclxufSkgPT4ge1xyXG5cdGNvbnN0IHVzZXJEYXRhID0gZ2V0RGF0YSgpO1xyXG5cdGNvbnN0IHVzZXJQcm9maWxlc0xpc3QgPSB1c2VyRGF0YT8udXNlclByb2ZpbGVzO1xyXG5cclxuXHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhaW5lclwiKTtcclxuXHRjb25zdCBwcm9maWxlc1BhZ2VNYWluID0gY3JlYXRlRWxlbWVudChcIm1haW5cIiwgW1wibWFpbi1wcm9maWxlc1wiXSk7XHJcblx0Y29uc3Qgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wid3JhcHBlclwiXSk7XHJcblx0Y29uc3QgcHJvZmlsZXNUaXRsZSA9IGNyZWF0ZUVsZW1lbnQoXCJoMVwiLCBbXHJcblx0XHRcIm1haW5fX3RpdGxlXCIsXHJcblx0XHRcIm1haW4tcHJvZmlsZXNfX3RpdGxlXCIsXHJcblx0XSk7XHJcblx0Y29uc3QgcHJvZmlsZXNCb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2JveFwiXSk7XHJcblxyXG5cdHByb2ZpbGVzVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcclxuXHJcblx0aWYgKHVzZXJQcm9maWxlc0xpc3QgJiYgT2JqZWN0LmtleXModXNlclByb2ZpbGVzTGlzdCkubGVuZ3RoICE9PSAwKSB7XHJcblx0XHRmb3IgKGNvbnN0IGtleSBpbiB1c2VyUHJvZmlsZXNMaXN0KSB7XHJcblx0XHRcdHByb2ZpbGVzQm94LmFwcGVuZChcclxuXHRcdFx0XHRjcmVhdGVQcm9maWxlKFxyXG5cdFx0XHRcdFx0dXNlclByb2ZpbGVCdG4sXHJcblx0XHRcdFx0XHR1c2VyQnRuQ3VzdG9taXplLFxyXG5cdFx0XHRcdFx0dXNlckJ0bkN1c3RvbWl6ZSxcclxuXHRcdFx0XHRcdGVtcHR5RmllbGQsXHJcblx0XHRcdFx0XHRrZXksIC8vIGRvZGFqIGtsdWN6IHByb2ZpbHVcclxuXHRcdFx0XHRcdHVzZXJQcm9maWxlc0xpc3Rba2V5XSAvLyBkb2RhaiBuYXp3xJkgcHJvZmlsdVxyXG5cdFx0XHRcdClcclxuXHRcdFx0KTtcclxuXHRcdH1cclxuXHR9XHJcblx0cHJvZmlsZXNCb3guYXBwZW5kKFxyXG5cdFx0Y3JlYXRlUHJvZmlsZUFkZEJ0bihcclxuXHRcdFx0YWRkUHJvZmlsZUJ0bixcclxuXHRcdFx0YWRkUHJvZmlsZUluZm8sXHJcblx0XHRcdHVzZXJQcm9maWxlQnRuLFxyXG5cdFx0XHRwcm9maWxlc0JveCxcclxuXHRcdFx0dXNlckJ0bkN1c3RvbWl6ZSxcclxuXHRcdFx0dXNlckJ0bkN1c3RvbWl6ZSxcclxuXHRcdFx0bWF4UHJvZmlsZXMsXHJcblx0XHRcdGVtcHR5RmllbGRcclxuXHRcdClcclxuXHQpO1xyXG5cdHdyYXBwZXIuYXBwZW5kKHByb2ZpbGVzVGl0bGUsIHByb2ZpbGVzQm94KTtcclxuXHRwcm9maWxlc1BhZ2VNYWluLmFwcGVuZCh3cmFwcGVyKTtcclxuXHJcblx0Y29udGFpbmVyLmFwcGVuZChwcm9maWxlc1BhZ2VNYWluKTtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZVByb2ZpbGUgPSAoXHJcblx0YXJpYUluZm8sXHJcblx0dXNlckJ0bkluZm8sXHJcblx0c2F2ZUJ0bkFyaWEsXHJcblx0ZW1wdHlGaWVsZEVycm9yLFxyXG5cdGV4aXN0aW5nUHJvZmlsZUlkID0gbnVsbCwgLy8gbm93eSBwYXJhbWV0clxyXG5cdGV4aXN0aW5nUHJvZmlsZU5hbWUgPSBudWxsIC8vIG5vd3kgcGFyYW1ldHJcclxuKSA9PiB7XHJcblx0Y29uc3QgdXNlckRhdGEgPSBnZXREYXRhKCk7XHJcblx0Y29uc3QgZXhpc3RpbmdQcm9maWxlcyA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXMgfHwge307XHJcblxyXG5cdGxldCBjb2xvcjtcclxuXHRsZXQgcHJvZmlsZUlkO1xyXG5cdGxldCBwcm9maWxlTmFtZTtcclxuXHJcblx0Y29uc3QgY29sb3JzID0gW1wiI2RjNGEzNFwiLCBcIiMwNjJFNjNcIiwgXCIjRkFDMDQ0XCJdO1xyXG5cclxuXHQvLyBKZcWbbGkgdG8gaXN0bmllasSFY3kgcHJvZmlsICjFgmFkb3dhbnkgeiBsb2NhbFN0b3JhZ2UpXHJcblx0aWYgKGV4aXN0aW5nUHJvZmlsZUlkKSB7XHJcblx0XHRwcm9maWxlSWQgPSBleGlzdGluZ1Byb2ZpbGVJZDtcclxuXHRcdHByb2ZpbGVOYW1lID0gZXhpc3RpbmdQcm9maWxlTmFtZTtcclxuXHRcdGNvbnN0IHByb2ZpbGVOdW1iZXIgPSBwYXJzZUludChwcm9maWxlSWQuc3BsaXQoXCItXCIpLnBvcCgpKTtcclxuXHRcdGNvbG9yID0gY29sb3JzW3Byb2ZpbGVOdW1iZXIgLSAxXTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gSmXFm2xpIHRvIG5vd3kgcHJvZmlsXHJcblx0XHRpZiAoT2JqZWN0LmtleXMoZXhpc3RpbmdQcm9maWxlcykubGVuZ3RoID49IDMpIHJldHVybjtcclxuXHJcblx0XHQvLyBabmFqZMW6IG5ham1uaWVqc3p5IGRvc3TEmXBueSBudW1lciBJRFxyXG5cdFx0bGV0IG5leHROdW1iZXIgPSAxO1xyXG5cdFx0d2hpbGUgKGV4aXN0aW5nUHJvZmlsZXNbYHVzZXItcHJvZmlsZS0ke25leHROdW1iZXJ9YF0pIHtcclxuXHRcdFx0bmV4dE51bWJlcisrO1xyXG5cdFx0fVxyXG5cclxuXHRcdHByb2ZpbGVJZCA9IGB1c2VyLXByb2ZpbGUtJHtuZXh0TnVtYmVyfWA7XHJcblx0XHRwcm9maWxlTmFtZSA9IGBIYW5kc29tZSBVc2VyICR7bmV4dE51bWJlcn1gO1xyXG5cdFx0Y29sb3IgPSBjb2xvcnNbbmV4dE51bWJlciAtIDFdO1xyXG5cdH1cclxuXHJcblx0Y29uc3QgdXNlclByb2ZpbGUgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX3Byb2ZpbGVcIl0pO1xyXG5cdGNvbnN0IHVzZXJBdmF0YXJCb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2F2YXRhclwiXSk7XHJcblx0Y29uc3QgdXNlclByb2ZpbGVCdG4gPSBjcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIFtcIm1haW4tcHJvZmlsZXNfX2J0blwiXSwge1xyXG5cdFx0XCJhcmlhLWxhYmVsXCI6IGFyaWFJbmZvLFxyXG5cdFx0XCJkYXRhLWlkXCI6IHByb2ZpbGVJZCxcclxuXHR9KTtcclxuXHJcblx0Y29uc3QgdXNlclByb2ZpbGVJbmZvQm94ID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX191c2VyLWluZm9cIl0pO1xyXG5cdGNvbnN0IHVzZXJQcm9maWxlSW5mbyA9IGNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCBbXCJtYWluLXByb2ZpbGVzX19uYW1lXCJdLCB7XHJcblx0XHR0eXBlOiBcInRleHRcIixcclxuXHRcdHJlYWRvbmx5OiB0cnVlLFxyXG5cdFx0dmFsdWU6IHByb2ZpbGVOYW1lLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGVkaXRVc2VySW5mb0J0biA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImJ1dHRvblwiLFxyXG5cdFx0W1wibWFpbi1wcm9maWxlc19fZWRpdC1uYW1lXCJdLFxyXG5cdFx0eyBcImFyaWEtbGFiZWxcIjogdXNlckJ0bkluZm8gfVxyXG5cdCk7XHJcblx0Y29uc3QgcmVtb3ZlVXNlckJ0biA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImJ1dHRvblwiLFxyXG5cdFx0W1wibWFpbi1wcm9maWxlc19fcmVtb3ZlLXVzZXJcIl0sXHJcblx0XHR7IFwiYXJpYS1sYWJlbFwiOiBcIlByenljaXNrIHVtb8W8bGl3aWFqxIVjeSB1c3VuacSZY2llIHXFvHl0a293bmlrYVwiIH1cclxuXHQpO1xyXG5cdGNvbnN0IHJlbW92ZVVzZXJJY29uID0gY3JlYXRlRWxlbWVudChcImltZ1wiLCBbXCJtYWluLXByb2ZpbGVzX19yZW1vdmUtaWNvblwiXSwge1xyXG5cdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdFx0bG9hZGluZzogXCJsYXp5XCIsXHJcblx0XHRhbHQ6IFwiXCIsXHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvcmVtb3ZlLXByb2ZpbGUtaWNvbi5zdmdcIixcclxuXHR9KTtcclxuXHRjb25zdCBlZGl0VXNlckluZm9JY29uID0gY3JlYXRlRWxlbWVudChcImltZ1wiLCBbXCJtYWluLXByb2ZpbGVzX19lZGl0LWljb25cIl0sIHtcclxuXHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRoZWlnaHQ6IFwiMjRcIixcclxuXHRcdGxvYWRpbmc6IFwibGF6eVwiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdFx0c3JjOiBcIi4vc3JjL2ljb25zL2VkaXQuc3ZnXCIsXHJcblx0fSk7XHJcblxyXG5cdHVzZXJQcm9maWxlQnRuLmlubmVySFRNTCA9IGA8c3ZnIGNsYXNzPVwibWFpbi1wcm9maWxlc19faW1nXCIgd2lkdGg9XCIxNTBcIiBoZWlnaHQ9XCIxNTBcIiB2aWV3Qm94PVwiMCAwIDIwMCAyMDBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+XHJcbiAgICA8Y2lyY2xlIGN4PVwiNzBcIiBjeT1cIjcwXCIgcj1cIjhcIiBmaWxsPVwid2hpdGVcIiAvPlxyXG4gICAgPGNpcmNsZSBjeD1cIjEzMFwiIGN5PVwiNzBcIiByPVwiOFwiIGZpbGw9XCJ3aGl0ZVwiIC8+XHJcbiAgICA8cGF0aCBkPVwiTTYwIDExMCBRMTAwIDE1MCAxNDAgMTEwXCIgc3Ryb2tlPVwid2hpdGVcIiBzdHJva2Utd2lkdGg9XCI2XCJcclxuICAgIGZpbGw9XCJ0cmFuc3BhcmVudFwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiAvPlxyXG4gICAgPC9zdmc+YDtcclxuXHR1c2VyUHJvZmlsZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcclxuXHJcblx0dXNlckF2YXRhckJveC5hcHBlbmQodXNlclByb2ZpbGVCdG4pO1xyXG5cdGVkaXRVc2VySW5mb0J0bi5hcHBlbmQoZWRpdFVzZXJJbmZvSWNvbik7XHJcblx0cmVtb3ZlVXNlckJ0bi5hcHBlbmQocmVtb3ZlVXNlckljb24pO1xyXG5cdHVzZXJQcm9maWxlSW5mb0JveC5hcHBlbmQodXNlclByb2ZpbGVJbmZvLCBlZGl0VXNlckluZm9CdG4sIHJlbW92ZVVzZXJCdG4pO1xyXG5cdHVzZXJQcm9maWxlLmFwcGVuZCh1c2VyQXZhdGFyQm94LCB1c2VyUHJvZmlsZUluZm9Cb3gpO1xyXG5cclxuXHQvLyBaYXBpc3ogcHJvZmlsIHR5bGtvIGplxZtsaSB0byBub3d5IHByb2ZpbFxyXG5cdGlmICghZXhpc3RpbmdQcm9maWxlSWQpIHtcclxuXHRcdGNvbnN0IHVwZGF0ZWRQcm9maWxlcyA9IHtcclxuXHRcdFx0Li4uZXhpc3RpbmdQcm9maWxlcyxcclxuXHRcdFx0W3Byb2ZpbGVJZF06IHByb2ZpbGVOYW1lLFxyXG5cdFx0fTtcclxuXHRcdHNldFVzZXJQcmVmZXJlbmNlKFwidXNlclByb2ZpbGVzXCIsIHVwZGF0ZWRQcm9maWxlcywgdXNlckRhdGEpO1xyXG5cdH1cclxuXHJcblx0ZWRpdFVzZXJJbmZvQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0ZWRpdFVzZXJuYW1lKGUsIHVzZXJQcm9maWxlSW5mb0JveCwgc2F2ZUJ0bkFyaWEsIGVtcHR5RmllbGRFcnJvcik7XHJcblx0fSk7XHJcblx0cmVtb3ZlVXNlckJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdHJlbW92ZVVzZXIoZSk7XHJcblx0fSk7XHJcblxyXG5cdHVzZXJQcm9maWxlSW5mby5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG5cdFx0aWYgKGUua2V5ID09PSBcIkVudGVyXCIpIHtcclxuXHRcdFx0c2F2ZVVzZXJuYW1lKGUsIGVtcHR5RmllbGRFcnJvcik7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHJldHVybiB1c2VyUHJvZmlsZTtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZVByb2ZpbGVBZGRCdG4gPSAoXHJcblx0YXJpYUluZm8sXHJcblx0aW5mbyxcclxuXHR1c2VyQnRuQXJpYSxcclxuXHRwcm9maWxlc0JveCxcclxuXHR1c2VyQnRuSW5mbyxcclxuXHRzYXZlQnRuQXJpYSxcclxuXHRtYXhQcm9maWxlc0Vycm9yLFxyXG5cdGVtcHR5RmllbGRFcnJvclxyXG4pID0+IHtcclxuXHRjb25zdCBhZGRQcm9maWxlQm94ID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX19hZGQtcHJvZmlsZVwiXSk7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUF2YXRhciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fYXZhdGFyXCJdKTtcclxuXHRjb25zdCBhZGRQcm9maWxlQnRuID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiYnV0dG9uXCIsXHJcblx0XHRbXCJtYWluLXByb2ZpbGVzX19idG5cIiwgXCJtYWluLXByb2ZpbGVzX19idG4tLWFkZC1wcm9maWxlXCJdLFxyXG5cdFx0eyBcImFyaWEtbGFiZWxcIjogYXJpYUluZm8gfVxyXG5cdCk7XHJcblx0Y29uc3QgYWRkUHJvZmlsZVBsdXNJY29uID0gY3JlYXRlRWxlbWVudChcImltZ1wiLCBbXCJtYWluLXByb2ZpbGVzX19hZGQtaW1nXCJdLCB7XHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvYWRkLXByb2ZpbGUuc3ZnXCIsXHJcblx0XHRsb2FkaW5nOiBcImxhenlcIixcclxuXHRcdGFsdDogXCJcIixcclxuXHR9KTtcclxuXHRjb25zdCBhZGRQcm9maWxlSW5mbyA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW4tcHJvZmlsZXNfX25hbWVcIl0pO1xyXG5cclxuXHRhZGRQcm9maWxlSW5mby50ZXh0Q29udGVudCA9IGluZm87XHJcblxyXG5cdGFkZFByb2ZpbGVCdG4uYXBwZW5kKGFkZFByb2ZpbGVQbHVzSWNvbik7XHJcblx0YWRkUHJvZmlsZUF2YXRhci5hcHBlbmQoYWRkUHJvZmlsZUJ0bik7XHJcblx0YWRkUHJvZmlsZUJveC5hcHBlbmQoYWRkUHJvZmlsZUF2YXRhciwgYWRkUHJvZmlsZUluZm8pO1xyXG5cclxuXHRhZGRQcm9maWxlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcblx0XHRjb25zdCB1c2VyRGF0YSA9IGdldERhdGEoKTtcclxuXHRcdGNvbnN0IGV4aXN0aW5nUHJvZmlsZXMgPSB1c2VyRGF0YT8udXNlclByb2ZpbGVzIHx8IHt9O1xyXG5cclxuXHRcdGlmIChPYmplY3Qua2V5cyhleGlzdGluZ1Byb2ZpbGVzKS5sZW5ndGggPj0gMykge1xyXG5cdFx0XHRzaG93RXJyb3JQb3B1cChtYXhQcm9maWxlc0Vycm9yLCBcIiNkYzRhMzRcIik7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBwcm9maWxlID0gY3JlYXRlUHJvZmlsZShcclxuXHRcdFx0dXNlckJ0bkFyaWEsXHJcblx0XHRcdHVzZXJCdG5JbmZvLFxyXG5cdFx0XHRzYXZlQnRuQXJpYSxcclxuXHRcdFx0ZW1wdHlGaWVsZEVycm9yXHJcblx0XHQpO1xyXG5cclxuXHRcdGlmIChwcm9maWxlKSB7XHJcblx0XHRcdHByb2ZpbGVzQm94Lmluc2VydEJlZm9yZShwcm9maWxlLCBhZGRQcm9maWxlQm94KTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0cmV0dXJuIGFkZFByb2ZpbGVCb3g7XHJcbn07XHJcblxyXG5jb25zdCBlZGl0VXNlcm5hbWUgPSAoZSwgcGFyZW50LCBzYXZlQnRuQXJpYSwgZW1wdHlGaWVsZEVycm9yKSA9PiB7XHJcblx0cmVzZXRTdGF0ZU9mRWRpdGluZyhlKTtcclxuXHJcblx0Y29uc3QgZWRpdEJ0biA9IGUudGFyZ2V0O1xyXG5cdGNvbnN0IG5hbWVUb0VkaXQgPSBlZGl0QnRuLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XHJcblx0Y29uc3Qgc2F2ZUJ0biA9IGNyZWF0ZVNhdmVCdG4oc2F2ZUJ0bkFyaWEpO1xyXG5cclxuXHRlZGl0QnRuLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XHJcblx0c2F2ZUJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xyXG5cclxuXHRwYXJlbnQuYXBwZW5kKHNhdmVCdG4pO1xyXG5cclxuXHRuYW1lVG9FZGl0LmZvY3VzKCk7XHJcblx0bmFtZVRvRWRpdC5zZWxlY3QoKTtcclxuXHRuYW1lVG9FZGl0LnJlbW92ZUF0dHJpYnV0ZShcInJlYWRvbmx5XCIpO1xyXG5cdG5hbWVUb0VkaXQuY2xhc3NMaXN0LmFkZChcImZvY3VzZWRcIik7XHJcblxyXG5cdHNhdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRzYXZlVXNlcm5hbWUoZSwgZW1wdHlGaWVsZEVycm9yKTtcclxuXHR9KTtcclxufTtcclxuXHJcbmNvbnN0IHNhdmVVc2VybmFtZSA9IChlLCBlbXB0eUZpZWxkRXJyb3IpID0+IHtcclxuXHRjb25zdCB1c2VyRGF0YSA9IGdldERhdGEoKTtcclxuXHRjb25zdCBleGlzdGluZ1Byb2ZpbGVzID0gdXNlckRhdGE/LnVzZXJQcm9maWxlcyB8fCBbXTtcclxuXHJcblx0Y29uc3Qgc2F2ZUJ0biA9IGUudGFyZ2V0O1xyXG5cdGNvbnN0IGNsb3Nlc3RQcm9maWxlID0gc2F2ZUJ0bi5jbG9zZXN0KFwiLm1haW4tcHJvZmlsZXNfX3Byb2ZpbGVcIik7XHJcblx0Y29uc3QgY2xvc2VzdFByb2ZpbGVJZCA9IGNsb3Nlc3RQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1wcm9maWxlc19fYnRuXCIpXHJcblx0XHQuZGF0YXNldC5pZDtcclxuXHRjb25zdCBjbG9zZXN0UHJvZmlsZU5hbWUgPSBjbG9zZXN0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0XCIubWFpbi1wcm9maWxlc19fbmFtZVwiXHJcblx0KTtcclxuXHJcblx0Y29uc3QgYWxsRWRpdEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1haW4tcHJvZmlsZXNfX2VkaXQtbmFtZVwiKTtcclxuXHJcblx0YWxsRWRpdEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIikpO1xyXG5cclxuXHRpZiAoY2xvc2VzdFByb2ZpbGVOYW1lLnZhbHVlLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0YWxsRWRpdEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSkpO1xyXG5cdFx0cmV0dXJuIHNob3dFcnJvclBvcHVwKGVtcHR5RmllbGRFcnJvciwgXCIjRkFDMDQ0XCIpO1xyXG5cdH1cclxuXHJcblx0Y29uc3QgdXBkYXRlZFByb2ZpbGVzID0ge1xyXG5cdFx0Li4uZXhpc3RpbmdQcm9maWxlcyxcclxuXHRcdFtjbG9zZXN0UHJvZmlsZUlkXTogY2xvc2VzdFByb2ZpbGVOYW1lLnZhbHVlLFxyXG5cdH07XHJcblx0c2V0VXNlclByZWZlcmVuY2UoXCJ1c2VyUHJvZmlsZXNcIiwgdXBkYXRlZFByb2ZpbGVzLCB1c2VyRGF0YSk7XHJcblxyXG5cdHJlc2V0U3RhdGVPZkVkaXRpbmcoZSk7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVTYXZlQnRuID0gKHNhdmVCdG5BcmlhKSA9PiB7XHJcblx0Y29uc3Qgc2F2ZVVzZXJJbmZvQnRuID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiYnV0dG9uXCIsXHJcblx0XHRbXCJtYWluLXByb2ZpbGVzX19zYXZlLW5hbWVcIiwgXCJoaWRkZW5cIl0sXHJcblx0XHR7IFwiYXJpYS1sYWJlbFwiOiBzYXZlQnRuQXJpYSB9XHJcblx0KTtcclxuXHRjb25zdCBzYXZlVXNlckluZm9JY29uID0gY3JlYXRlRWxlbWVudChcImltZ1wiLCBbXCJtYWluLXByb2ZpbGVzX19zYXZlLWljb25cIl0sIHtcclxuXHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRoZWlnaHQ6IFwiMjRcIixcclxuXHRcdGxvYWRpbmc6IFwibGF6eVwiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdFx0c3JjOiBcIi4vc3JjL2ljb25zL3NhdmUuc3ZnXCIsXHJcblx0fSk7XHJcblxyXG5cdHNhdmVVc2VySW5mb0J0bi5hcHBlbmQoc2F2ZVVzZXJJbmZvSWNvbik7XHJcblxyXG5cdHJldHVybiBzYXZlVXNlckluZm9CdG47XHJcbn07XHJcblxyXG5jb25zdCByZXNldFN0YXRlT2ZFZGl0aW5nID0gKGUpID0+IHtcclxuXHRjb25zdCBmb2N1c2VkTmFtZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvY3VzZWRcIik7XHJcblx0Y29uc3QgYWxsU2F2ZUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1haW4tcHJvZmlsZXNfX3NhdmUtbmFtZVwiKTtcclxuXHRjb25zdCBhbGxFZGl0QnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWFpbi1wcm9maWxlc19fZWRpdC1uYW1lXCIpO1xyXG5cclxuXHRmb2N1c2VkTmFtZXMuZm9yRWFjaCgoZWwpID0+IHtcclxuXHRcdGVsLnNldEF0dHJpYnV0ZShcInJlYWRvbmx5XCIsIHRydWUpO1xyXG5cdFx0ZWwuY2xhc3NMaXN0LnJlbW92ZShcImZvY3VzZWRcIik7XHJcblx0XHRlbC5ibHVyKCk7XHJcblx0fSk7XHJcblx0YWxsU2F2ZUJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKSk7XHJcblx0YWxsRWRpdEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKSk7XHJcbn07XHJcblxyXG5sZXQgcG9wdXBWaXNpYmxlID0gZmFsc2U7XHJcbmNvbnN0IHNob3dFcnJvclBvcHVwID0gKHRleHQsIGNvbG9yKSA9PiB7XHJcblx0aWYgKHBvcHVwVmlzaWJsZSkgcmV0dXJuO1xyXG5cdHBvcHVwVmlzaWJsZSA9IHRydWU7XHJcblxyXG5cdGNvbnN0IHJvb3QgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XHJcblx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250YWluZXJcIik7XHJcblxyXG5cdGNvbnN0IHBvcHVwID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJlcnJvci1wb3B1cFwiXSk7XHJcblx0Y29uc3QgcG9wdXBFcnJvciA9IGNyZWF0ZUVsZW1lbnQoXCJwXCIsIFtcImVycm9yLXBvcHVwX190ZXh0XCJdKTtcclxuXHJcblx0cG9wdXBFcnJvci50ZXh0Q29udGVudCA9IHRleHQ7XHJcblx0cm9vdC5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tZXJyb3JUeHRDb2xvclwiLCBjb2xvcik7XHJcblxyXG5cdHBvcHVwLmFwcGVuZChwb3B1cEVycm9yKTtcclxuXHRjb250YWluZXIuYXBwZW5kKHBvcHVwKTtcclxuXHJcblx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRwb3B1cC5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xyXG5cdH0sIDIwMDApO1xyXG5cdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0cG9wdXAucmVtb3ZlKCk7XHJcblx0XHRwb3B1cFZpc2libGUgPSBmYWxzZTtcclxuXHR9LCAyNTAwKTtcclxufTtcclxuXHJcbmNvbnN0IHJlbW92ZVVzZXIgPSAoZSkgPT4ge1xyXG5cdGNvbnN0IHVzZXJEYXRhID0gZ2V0RGF0YSgpO1xyXG5cdGNvbnN0IHVzZXJQcm9maWxlcyA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXM7XHJcblx0Y29uc3QgYWxsRWRpdEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1haW4tcHJvZmlsZXNfX2VkaXQtbmFtZVwiKTtcclxuXHJcblx0Y29uc3QgZGVsZXRlQnRuID0gZS50YXJnZXQ7XHJcblx0Y29uc3QgY2xvc2VzdFByb2ZpbGUgPSBkZWxldGVCdG4uY2xvc2VzdChcIi5tYWluLXByb2ZpbGVzX19wcm9maWxlXCIpO1xyXG5cdGNvbnN0IGNsb3Nlc3RQcm9maWxlQnRuID0gY2xvc2VzdFByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5tYWluLXByb2ZpbGVzX19idG5cIik7XHJcblx0YWxsRWRpdEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIikpO1xyXG5cclxuXHRkZWxldGUgdXNlclByb2ZpbGVzW2Nsb3Nlc3RQcm9maWxlQnRuLmRhdGFzZXQuaWRdO1xyXG5cclxuXHRzZXRVc2VyUHJlZmVyZW5jZShcInVzZXJQcm9maWxlc1wiLCB1c2VyUHJvZmlsZXMsIHVzZXJEYXRhKTtcclxuXHJcblx0Y2xvc2VzdFByb2ZpbGUucmVtb3ZlKCk7XHJcbn07XHJcbiJdfQ==
