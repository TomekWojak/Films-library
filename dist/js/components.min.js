import{createElement}from"./helpers.min.js";import{setUserPreference}from"./updateStateFunctions.min.js";const userData=JSON.parse?.(localStorage.getItem("userData"));let profilesCount=userData?.profilesCount||0;const USERNAME="handsomeUser404",PASSWORD="5jksH9d.";export const createLoginHeader=({header:{alt:{logo:e},aria:{logoLink:t,changeLanguageButton:a}}},n,r,o,i)=>{const l=createElement("header",["header"]),s=createElement("a",["header__logo","login-header__logo"],{href:"/","aria-label":`${t}`}),c=createElement("img",["header__logo-img","login-header__logo-img"],{src:"./src/icons/logo.svg",alt:`${e}`,width:"24",height:"24"}),d=createElement("span",["header__logo-text","login-header__logo-text"]);d.textContent="Stream",s.append(c,d),l.append(s);const p=createElement("button",["login-header__lang-select"],{"aria-label":`${a}`}),m=createElement("span",["login-header__lang-platform-lang"]),g=createElement("img",["login-header__lang-arrow"],{src:"./src/icons/chevron-down.svg",alt:"",width:"24",height:"24"}),f=createElement("ul",["login-header__lang-list"]);for(let e=0;e<n;e++){const t=createElement("li",["login-header__lang-choice"],{tabindex:0}),a=Object.keys(r)[e],n=Object.values(r)[e];t.dataset.lang=a,t.textContent=n,t.style.animationDelay=100*e+"ms",f.append(t)}return m.textContent=r[o],p.addEventListener("click",e=>{i.call(p,e,m)}),p.append(m,g,f),l.append(p),l};export const createLoginPage=({main:{text:{title:e,subtitle:t,description:a,button:n},placeholder:{username:r,password:o}}})=>{const i=createElement("main",["main"]),l=createElement("div",["wrapper"]),s=createElement("h1"),c=createElement("span",["main__title"]),d=createElement("span",["main__subtitle"]),p=createElement("p",["main__text"]),m=createElement("form",["main__form"]),g=createElement("input",["main__form-input","main__form-input--username"],{type:"text",placeholder:r}),f=createElement("input",["main__form-input","main__form-input--password"],{type:"password",placeholder:o}),u=createElement("button",["main__form-button"],{type:"submit"}),_=createElement("span",["main__form-button-text"]),h=createElement("p",["main__form-error-txt"]);return c.textContent=e,d.textContent=t,p.textContent=a,_.textContent=n,s.append(c,d),u.append(_),m.append(g,f,u,h),l.append(s,p,m),i.append(l),u.addEventListener("click",e=>{const t=JSON.parse?.(localStorage.getItem("userData"));handleLoginValidation(e,g,f,translations.main.text.errorRequired,translations.main.text.errorInvalid,USERNAME,PASSWORD,h)||(h.classList.remove("visible"),e.target.append(showSmallLoader()),e.target.disabled=!0,setTimeout(()=>{e.target.disabled=!1,hideSmallLoader(),setUserPreference("translations",translations,t),setUserPreference("loggedIn",!0,t),window.location.href="profiles.html"},3e3))}),i};const handleLoginValidation=(e,t,a,n,r,o,i,l)=>(e.preventDefault(),""===t.value.trim()||""===a.value.trim()?(l.classList.add("visible"),l.textContent=n,n):t.value.trim()!==o||a.value.trim()!==i?(e.target.disabled=!0,e.target.append(showSmallLoader()),l.classList.remove("visible"),setTimeout(()=>{l.classList.add("visible"),l.textContent=r,e.target.disabled=!1,hideSmallLoader()},3e3),r):null);export const showBigLoader=()=>{const e=createElement("div",["loading-area"]);return e.innerHTML='            <svg class="loader-big" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="#4da8da" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="#4da8da" stop-opacity="0.4" />\n                        <stop offset="100%" stop-color="#4da8da" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-big" r="35" cx="60" cy="60"></circle>\n            </svg>',e};export const hideBigLoader=()=>{const e=document.querySelector(".loading-area");e?.remove()};export const showSmallLoader=()=>{const e=createElement("div",["loading-area-small"]);return e.innerHTML='<svg class="loader-small" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent-small" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="white" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="white" stop-opacity="0.3" />\n                        <stop offset="100%" stop-color="white" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-small" r="12" cx="60" cy="60"></circle>\n            </svg>',e};export const hideSmallLoader=()=>{document.querySelector(".loading-area-small").remove()};export const createProfilesPage=({profiles:{text:{title:e,addProfileInfo:t},aria:{addProfileBtn:a,userProfileBtn:n,userBtnCustomize:r}}})=>{JSON.parse?.(localStorage.getItem("userData"));const o=document.querySelector(".container"),i=createElement("main",["main-profiles"]),l=createElement("div",["wrapper"]),s=createElement("h1",["main__title","main-profiles__title"]),c=createElement("div",["main-profiles__box"]);s.textContent=e,c.append(createProfileAddBtn(a,t,n,c,r)),l.append(s,c),i.append(l),o.append(i)};const createProfile=(e,t)=>{const a=JSON.parse?.(localStorage.getItem("userData")),n=a?.userProfiles||[];let r;if(3==profilesCount||3===n.length)return;profilesCount++,r=["#dc4a34","#062E63","#FAC044"][profilesCount];const o=createElement("div",["main-profiles__profile"]),i=createElement("div",["main-profiles__avatar"]),l=createElement("button",["main-profiles__btn"],{"aria-label":e,"data-id":`user-profile-${profilesCount}`}),s=createElement("div",["main-profiles__user-info"]),c=createElement("input",["main-profiles__name"],{type:"text",readonly:!0,value:`${n[profilesCount]?.username||"Handsome User"} ${profilesCount}`}),d=createElement("button",["main-profiles__edit-name"],{"aria-label":t}),p=createElement("img",["main-profiles__edit-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/edit.svg"});return l.innerHTML='<svg class="main-profiles__img" width="150" height="150" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">\n\t<circle cx="70" cy="70" r="8" fill="white" />\n\t<circle cx="130" cy="70" r="8" fill="white" />\n\t<path d="M60 110 Q100 150 140 110" stroke="white" stroke-width="6"\n\tfill="transparent" stroke-linecap="round" />\n\t</svg>',l.style.backgroundColor=r,i.append(l),d.append(p),s.append(c,d),o.append(i,s),d.addEventListener("click",e=>{editUsername(e)}),o},createProfileAddBtn=(e,t,a,n,r)=>{const o=createElement("div",["main-profiles__add-profile"]),i=createElement("div",["main-profiles__avatar"]),l=createElement("button",["main-profiles__btn","main-profiles__btn--add-profile"],{"aria-label":e}),s=createElement("img",["main-profiles__add-img"],{src:"./src/icons/add-profile.svg",loading:"lazy",alt:""}),c=createElement("span",["main-profiles__name"]);return c.textContent=t,l.append(s),i.append(l),o.append(i,c),l.addEventListener("click",()=>{const e=createProfile(a,r);e?n.append(e):alert("Osiągnięto maksymalną liczbę profilów!")}),o},editUsername=e=>{const t=e.target.previousElementSibling;t.focus(),t.select(),t.removeAttribute("readonly"),t.classList.add("focused")},saveUsername=e=>{const t=[...document.getElementsByClassName("focused")],a=t.some(e=>e.classList.contains("focused"));0!==t.length&&(a&&e.target.closest(".focused")||e.target.closest(".main-profiles__edit-name")||t.forEach(e=>{e.setAttribute("readonly",!0),e.classList.remove("focused")}))};window.addEventListener("click",e=>{saveUsername(e)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50cy5taW4uanMiLCJuYW1lcyI6WyJjcmVhdGVFbGVtZW50Iiwic2V0VXNlclByZWZlcmVuY2UiLCJ1c2VyRGF0YSIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJwcm9maWxlc0NvdW50IiwiVVNFUk5BTUUiLCJQQVNTV09SRCIsImNyZWF0ZUxvZ2luSGVhZGVyIiwiaGVhZGVyIiwiYWx0IiwibG9nbyIsImFyaWEiLCJsb2dvTGluayIsImNoYW5nZUxhbmd1YWdlQnV0dG9uIiwibGFuZ0Ftb3VudCIsImxhbmdOYW1lcyIsImxhbmd1YWdlIiwiaGFuZGxlTGFuZ1NlbGVjdCIsInBhZ2VMb2dvIiwiaHJlZiIsImxvZ29JbWciLCJzcmMiLCJ3aWR0aCIsImhlaWdodCIsImxvZ29UZXh0IiwidGV4dENvbnRlbnQiLCJhcHBlbmQiLCJsYW5nU2VsZWN0IiwibGFuZ1BsYXRmb3JtTGFuZyIsImxhbmdBcnJvdyIsImxhbmdMaXN0IiwiaSIsImxhbmdDaG9pY2UiLCJ0YWJpbmRleCIsImRhdGEiLCJPYmplY3QiLCJrZXlzIiwidGV4dCIsInZhbHVlcyIsImRhdGFzZXQiLCJsYW5nIiwic3R5bGUiLCJhbmltYXRpb25EZWxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY2FsbCIsImNyZWF0ZUxvZ2luUGFnZSIsIm1haW4iLCJ0aXRsZSIsInN1YnRpdGxlIiwiZGVzY3JpcHRpb24iLCJidXR0b24iLCJwbGFjZWhvbGRlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJtYWluQ29udGVudCIsIndyYXBwZXIiLCJsb2dpblRpdGxlIiwibG9naW5UaXRsZVRvcCIsImxvZ2luVGl0bGVCb3R0b20iLCJsb2dpblRleHQiLCJmb3JtIiwidXNlcm5hbWVJbnB1dCIsInR5cGUiLCJwYXNzd29yZElucHV0Iiwic3VibWl0QnRuIiwiYnV0dG9uVGV4dCIsImVycm9yVHh0IiwiaGFuZGxlTG9naW5WYWxpZGF0aW9uIiwidHJhbnNsYXRpb25zIiwiZXJyb3JSZXF1aXJlZCIsImVycm9ySW52YWxpZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRhcmdldCIsInNob3dTbWFsbExvYWRlciIsImRpc2FibGVkIiwic2V0VGltZW91dCIsImhpZGVTbWFsbExvYWRlciIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVxdWlyZUVycm9yIiwiaW52YWxpZEVycm9yIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsInRyaW0iLCJhZGQiLCJzaG93QmlnTG9hZGVyIiwibG9hZGluZ0FyZWEiLCJpbm5lckhUTUwiLCJoaWRlQmlnTG9hZGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY3JlYXRlUHJvZmlsZXNQYWdlIiwicHJvZmlsZXMiLCJhZGRQcm9maWxlSW5mbyIsImFkZFByb2ZpbGVCdG4iLCJ1c2VyUHJvZmlsZUJ0biIsInVzZXJCdG5DdXN0b21pemUiLCJjb250YWluZXIiLCJwcm9maWxlc1BhZ2VNYWluIiwicHJvZmlsZXNUaXRsZSIsInByb2ZpbGVzQm94IiwiY3JlYXRlUHJvZmlsZUFkZEJ0biIsImNyZWF0ZVByb2ZpbGUiLCJhcmlhSW5mbyIsInVzZXJCdG5JbmZvIiwiZXhpc3RpbmdQcm9maWxlcyIsInVzZXJQcm9maWxlcyIsImNvbG9yIiwibGVuZ3RoIiwidXNlclByb2ZpbGUiLCJ1c2VyQXZhdGFyQm94IiwidXNlclByb2ZpbGVJbmZvQm94IiwidXNlclByb2ZpbGVJbmZvIiwicmVhZG9ubHkiLCJlZGl0VXNlckluZm9CdG4iLCJlZGl0VXNlckluZm9JY29uIiwibG9hZGluZyIsImJhY2tncm91bmRDb2xvciIsImVkaXRVc2VybmFtZSIsImluZm8iLCJ1c2VyQnRuQXJpYSIsImFkZFByb2ZpbGVCb3giLCJhZGRQcm9maWxlQXZhdGFyIiwiYWRkUHJvZmlsZVBsdXNJY29uIiwicHJvZmlsZSIsImFsZXJ0IiwibmFtZVRvRWRpdCIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJmb2N1cyIsInNlbGVjdCIsInJlbW92ZUF0dHJpYnV0ZSIsInNhdmVVc2VybmFtZSIsImVkaXRlZE5hbWVzIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImF0TGVhc3RPbmVBY3RpdmUiLCJzb21lIiwiZWwiLCJjb250YWlucyIsImNsb3Nlc3QiLCJmb3JFYWNoIiwibmFtZSIsInNldEF0dHJpYnV0ZSJdLCJzb3VyY2VzIjpbImNvbXBvbmVudHMuanMiXSwibWFwcGluZ3MiOiJPQUFTQSxrQkFBcUIsMEJBQ3JCQyxzQkFBeUIsZ0NBQ2xDLE1BQU1DLFNBQVdDLEtBQUtDLFFBQVFDLGFBQWFDLFFBQVEsYUFFbkQsSUFBSUMsY0FBZ0JMLFVBQVVLLGVBQWlCLEVBQy9DLE1BQU1DLFNBQVcsa0JBQ1hDLFNBQVcsa0JBRVYsTUFBTUMsa0JBQW9CLEVBRS9CQyxRQUNDQyxLQUFPQyxRQUNQQyxNQUFRQyxXQUFVQywwQkFHcEJDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEtBR0EsTUFBTVQsRUFBU1gsY0FBYyxTQUFVLENBQUMsV0FDbENxQixFQUFXckIsY0FBYyxJQUFLLENBQUMsZUFBZ0Isc0JBQXVCLENBQzNFc0IsS0FBTSxJQUNOLGFBQWMsR0FBR1AsTUFFWlEsRUFBVXZCLGNBQ2YsTUFDQSxDQUFDLG1CQUFvQiwwQkFDckIsQ0FDQ3dCLElBQUssdUJBQ0xaLElBQUssR0FBR0MsSUFDUlksTUFBTyxLQUNQQyxPQUFRLE9BR0pDLEVBQVczQixjQUFjLE9BQVEsQ0FDdEMsb0JBQ0EsNEJBRUQyQixFQUFTQyxZQUFjLFNBQ3ZCUCxFQUFTUSxPQUFPTixFQUFTSSxHQUN6QmhCLEVBQU9rQixPQUFPUixHQUlkLE1BQU1TLEVBQWE5QixjQUFjLFNBQVUsQ0FBQyw2QkFBOEIsQ0FDekUsYUFBYyxHQUFHZ0IsTUFFWmUsRUFBbUIvQixjQUFjLE9BQVEsQ0FDOUMscUNBRUtnQyxFQUFZaEMsY0FBYyxNQUFPLENBQUMsNEJBQTZCLENBQ3BFd0IsSUFBSywrQkFDTFosSUFBSyxHQUNMYSxNQUFPLEtBQ1BDLE9BQVEsT0FFSE8sRUFBV2pDLGNBQWMsS0FBTSxDQUFDLDRCQUV0QyxJQUFLLElB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Ii4vaGVscGVycy5taW4uanNcIjtcclxuaW1wb3J0IHsgc2V0VXNlclByZWZlcmVuY2UgfSBmcm9tIFwiLi91cGRhdGVTdGF0ZUZ1bmN0aW9ucy5taW4uanNcIjtcclxuY29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlPy4obG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKSk7XHJcblxyXG5sZXQgcHJvZmlsZXNDb3VudCA9IHVzZXJEYXRhPy5wcm9maWxlc0NvdW50IHx8IDA7XHJcbmNvbnN0IFVTRVJOQU1FID0gXCJoYW5kc29tZVVzZXI0MDRcIjtcclxuY29uc3QgUEFTU1dPUkQgPSBcIjVqa3NIOWQuXCI7XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTG9naW5IZWFkZXIgPSAoXHJcblx0e1xyXG5cdFx0aGVhZGVyOiB7XHJcblx0XHRcdGFsdDogeyBsb2dvIH0sXHJcblx0XHRcdGFyaWE6IHsgbG9nb0xpbmssIGNoYW5nZUxhbmd1YWdlQnV0dG9uIH0sXHJcblx0XHR9LFxyXG5cdH0sXHJcblx0bGFuZ0Ftb3VudCxcclxuXHRsYW5nTmFtZXMsXHJcblx0bGFuZ3VhZ2UsXHJcblx0aGFuZGxlTGFuZ1NlbGVjdFxyXG4pID0+IHtcclxuXHQvLyBsb2dvXHJcblx0Y29uc3QgaGVhZGVyID0gY3JlYXRlRWxlbWVudChcImhlYWRlclwiLCBbXCJoZWFkZXJcIl0pO1xyXG5cdGNvbnN0IHBhZ2VMb2dvID0gY3JlYXRlRWxlbWVudChcImFcIiwgW1wiaGVhZGVyX19sb2dvXCIsIFwibG9naW4taGVhZGVyX19sb2dvXCJdLCB7XHJcblx0XHRocmVmOiBcIi9cIixcclxuXHRcdFwiYXJpYS1sYWJlbFwiOiBgJHtsb2dvTGlua31gLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGxvZ29JbWcgPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJpbWdcIixcclxuXHRcdFtcImhlYWRlcl9fbG9nby1pbWdcIiwgXCJsb2dpbi1oZWFkZXJfX2xvZ28taW1nXCJdLFxyXG5cdFx0e1xyXG5cdFx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvbG9nby5zdmdcIixcclxuXHRcdFx0YWx0OiBgJHtsb2dvfWAsXHJcblx0XHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdFx0fVxyXG5cdCk7XHJcblx0Y29uc3QgbG9nb1RleHQgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXHJcblx0XHRcImhlYWRlcl9fbG9nby10ZXh0XCIsXHJcblx0XHRcImxvZ2luLWhlYWRlcl9fbG9nby10ZXh0XCIsXHJcblx0XSk7XHJcblx0bG9nb1RleHQudGV4dENvbnRlbnQgPSBcIlN0cmVhbVwiO1xyXG5cdHBhZ2VMb2dvLmFwcGVuZChsb2dvSW1nLCBsb2dvVGV4dCk7XHJcblx0aGVhZGVyLmFwcGVuZChwYWdlTG9nbyk7XHJcblx0Ly8gZW5kIG9mIGxvZ29cclxuXHJcblx0Ly8gbGFuZ3VhZ2Ugc2VsZWN0b3JcclxuXHRjb25zdCBsYW5nU2VsZWN0ID0gY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCBbXCJsb2dpbi1oZWFkZXJfX2xhbmctc2VsZWN0XCJdLCB7XHJcblx0XHRcImFyaWEtbGFiZWxcIjogYCR7Y2hhbmdlTGFuZ3VhZ2VCdXR0b259YCxcclxuXHR9KTtcclxuXHRjb25zdCBsYW5nUGxhdGZvcm1MYW5nID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1xyXG5cdFx0XCJsb2dpbi1oZWFkZXJfX2xhbmctcGxhdGZvcm0tbGFuZ1wiLFxyXG5cdF0pO1xyXG5cdGNvbnN0IGxhbmdBcnJvdyA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibG9naW4taGVhZGVyX19sYW5nLWFycm93XCJdLCB7XHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvY2hldnJvbi1kb3duLnN2Z1wiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGxhbmdMaXN0ID0gY3JlYXRlRWxlbWVudChcInVsXCIsIFtcImxvZ2luLWhlYWRlcl9fbGFuZy1saXN0XCJdKTtcclxuXHJcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsYW5nQW1vdW50OyBpKyspIHtcclxuXHRcdGNvbnN0IGxhbmdDaG9pY2UgPSBjcmVhdGVFbGVtZW50KFwibGlcIiwgW1wibG9naW4taGVhZGVyX19sYW5nLWNob2ljZVwiXSwge1xyXG5cdFx0XHR0YWJpbmRleDogMCxcclxuXHRcdH0pO1xyXG5cdFx0Y29uc3QgZGF0YSA9IE9iamVjdC5rZXlzKGxhbmdOYW1lcylbaV07XHJcblx0XHRjb25zdCB0ZXh0ID0gT2JqZWN0LnZhbHVlcyhsYW5nTmFtZXMpW2ldO1xyXG5cclxuXHRcdGxhbmdDaG9pY2UuZGF0YXNldC5sYW5nID0gZGF0YTtcclxuXHRcdGxhbmdDaG9pY2UudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG5cdFx0bGFuZ0Nob2ljZS5zdHlsZS5hbmltYXRpb25EZWxheSA9IGkgKiAxMDAgKyBcIm1zXCI7XHJcblx0XHRsYW5nTGlzdC5hcHBlbmQobGFuZ0Nob2ljZSk7XHJcblx0fVxyXG5cclxuXHRsYW5nUGxhdGZvcm1MYW5nLnRleHRDb250ZW50ID0gbGFuZ05hbWVzW2xhbmd1YWdlXTtcclxuXHJcblx0bGFuZ1NlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdGhhbmRsZUxhbmdTZWxlY3QuY2FsbChsYW5nU2VsZWN0LCBlLCBsYW5nUGxhdGZvcm1MYW5nKTtcclxuXHR9KTtcclxuXHJcblx0bGFuZ1NlbGVjdC5hcHBlbmQobGFuZ1BsYXRmb3JtTGFuZywgbGFuZ0Fycm93LCBsYW5nTGlzdCk7XHJcblx0aGVhZGVyLmFwcGVuZChsYW5nU2VsZWN0KTtcclxuXHJcblx0cmV0dXJuIGhlYWRlcjtcclxuXHQvLyBlbmQgb2YgbGFuZ3VhZ2Ugc2VsZWN0b3JcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVMb2dpblBhZ2UgPSAoe1xyXG5cdG1haW46IHtcclxuXHRcdHRleHQ6IHsgdGl0bGUsIHN1YnRpdGxlLCBkZXNjcmlwdGlvbiwgYnV0dG9uIH0sXHJcblx0XHRwbGFjZWhvbGRlcjogeyB1c2VybmFtZSwgcGFzc3dvcmQgfSxcclxuXHR9LFxyXG59KSA9PiB7XHJcblx0Y29uc3QgbWFpbkNvbnRlbnQgPSBjcmVhdGVFbGVtZW50KFwibWFpblwiLCBbXCJtYWluXCJdKTtcclxuXHRjb25zdCB3cmFwcGVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJ3cmFwcGVyXCJdKTtcclxuXHRjb25zdCBsb2dpblRpdGxlID0gY3JlYXRlRWxlbWVudChcImgxXCIpO1xyXG5cdGNvbnN0IGxvZ2luVGl0bGVUb3AgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXCJtYWluX190aXRsZVwiXSk7XHJcblx0Y29uc3QgbG9naW5UaXRsZUJvdHRvbSA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW5fX3N1YnRpdGxlXCJdKTtcclxuXHRjb25zdCBsb2dpblRleHQgPSBjcmVhdGVFbGVtZW50KFwicFwiLCBbXCJtYWluX190ZXh0XCJdKTtcclxuXHRjb25zdCBmb3JtID0gY3JlYXRlRWxlbWVudChcImZvcm1cIiwgW1wibWFpbl9fZm9ybVwiXSk7XHJcblx0Y29uc3QgdXNlcm5hbWVJbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImlucHV0XCIsXHJcblx0XHRbXCJtYWluX19mb3JtLWlucHV0XCIsIFwibWFpbl9fZm9ybS1pbnB1dC0tdXNlcm5hbWVcIl0sXHJcblx0XHR7IHR5cGU6IFwidGV4dFwiLCBwbGFjZWhvbGRlcjogdXNlcm5hbWUgfVxyXG5cdCk7XHJcblx0Y29uc3QgcGFzc3dvcmRJbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImlucHV0XCIsXHJcblx0XHRbXCJtYWluX19mb3JtLWlucHV0XCIsIFwibWFpbl9fZm9ybS1pbnB1dC0tcGFzc3dvcmRcIl0sXHJcblx0XHR7IHR5cGU6IFwicGFzc3dvcmRcIiwgcGxhY2Vob2xkZXI6IHBhc3N3b3JkIH1cclxuXHQpO1xyXG5cdGNvbnN0IHN1Ym1pdEJ0biA9IGNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwgW1wibWFpbl9fZm9ybS1idXR0b25cIl0sIHtcclxuXHRcdHR5cGU6IFwic3VibWl0XCIsXHJcblx0fSk7XHJcblx0Y29uc3QgYnV0dG9uVGV4dCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW5fX2Zvcm0tYnV0dG9uLXRleHRcIl0pO1xyXG5cclxuXHRjb25zdCBlcnJvclR4dCA9IGNyZWF0ZUVsZW1lbnQoXCJwXCIsIFtcIm1haW5fX2Zvcm0tZXJyb3ItdHh0XCJdKTtcclxuXHRsb2dpblRpdGxlVG9wLnRleHRDb250ZW50ID0gdGl0bGU7XHJcblx0bG9naW5UaXRsZUJvdHRvbS50ZXh0Q29udGVudCA9IHN1YnRpdGxlO1xyXG5cdGxvZ2luVGV4dC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG5cdGJ1dHRvblRleHQudGV4dENvbnRlbnQgPSBidXR0b247XHJcblxyXG5cdGxvZ2luVGl0bGUuYXBwZW5kKGxvZ2luVGl0bGVUb3AsIGxvZ2luVGl0bGVCb3R0b20pO1xyXG5cdHN1Ym1pdEJ0bi5hcHBlbmQoYnV0dG9uVGV4dCk7XHJcblx0Zm9ybS5hcHBlbmQodXNlcm5hbWVJbnB1dCwgcGFzc3dvcmRJbnB1dCwgc3VibWl0QnRuLCBlcnJvclR4dCk7XHJcblxyXG5cdHdyYXBwZXIuYXBwZW5kKGxvZ2luVGl0bGUsIGxvZ2luVGV4dCwgZm9ybSk7XHJcblx0bWFpbkNvbnRlbnQuYXBwZW5kKHdyYXBwZXIpO1xyXG5cclxuXHRzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRjb25zdCB1c2VyRGF0YSA9IEpTT04ucGFyc2U/Lihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInVzZXJEYXRhXCIpKTtcclxuXHJcblx0XHRjb25zdCByZXN1bHRzID0gaGFuZGxlTG9naW5WYWxpZGF0aW9uKFxyXG5cdFx0XHRlLFxyXG5cdFx0XHR1c2VybmFtZUlucHV0LFxyXG5cdFx0XHRwYXNzd29yZElucHV0LFxyXG5cdFx0XHR0cmFuc2xhdGlvbnMubWFpbi50ZXh0LmVycm9yUmVxdWlyZWQsXHJcblx0XHRcdHRyYW5zbGF0aW9ucy5tYWluLnRleHQuZXJyb3JJbnZhbGlkLFxyXG5cdFx0XHRVU0VSTkFNRSxcclxuXHRcdFx0UEFTU1dPUkQsXHJcblx0XHRcdGVycm9yVHh0XHJcblx0XHQpO1xyXG5cclxuXHRcdGlmICghcmVzdWx0cykge1xyXG5cdFx0XHRlcnJvclR4dC5jbGFzc0xpc3QucmVtb3ZlKFwidmlzaWJsZVwiKTtcclxuXHRcdFx0ZS50YXJnZXQuYXBwZW5kKHNob3dTbWFsbExvYWRlcigpKTtcclxuXHRcdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSB0cnVlO1xyXG5cclxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHRcdFx0XHRoaWRlU21hbGxMb2FkZXIoKTtcclxuXHJcblx0XHRcdFx0c2V0VXNlclByZWZlcmVuY2UoXCJ0cmFuc2xhdGlvbnNcIiwgdHJhbnNsYXRpb25zLCB1c2VyRGF0YSk7XHJcblx0XHRcdFx0c2V0VXNlclByZWZlcmVuY2UoXCJsb2dnZWRJblwiLCB0cnVlLCB1c2VyRGF0YSk7XHJcblx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSBcInByb2ZpbGVzLmh0bWxcIjsgLy8gcHJ6ZWrFm2NpZSBuYSBzdHJvbsSZIHogcHJvZmlsYW1pXHJcblx0XHRcdH0sIDMwMDApO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHRyZXR1cm4gbWFpbkNvbnRlbnQ7XHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVMb2dpblZhbGlkYXRpb24gPSAoXHJcblx0ZSxcclxuXHR1c2VybmFtZUlucHV0LFxyXG5cdHBhc3N3b3JkSW5wdXQsXHJcblx0cmVxdWlyZUVycm9yLFxyXG5cdGludmFsaWRFcnJvcixcclxuXHR1c2VybmFtZSxcclxuXHRwYXNzd29yZCxcclxuXHRlcnJvclR4dFxyXG4pID0+IHtcclxuXHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdGlmICh1c2VybmFtZUlucHV0LnZhbHVlLnRyaW0oKSA9PT0gXCJcIiB8fCBwYXNzd29yZElucHV0LnZhbHVlLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LmFkZChcInZpc2libGVcIik7XHJcblx0XHRlcnJvclR4dC50ZXh0Q29udGVudCA9IHJlcXVpcmVFcnJvcjtcclxuXHRcdHJldHVybiByZXF1aXJlRXJyb3I7XHJcblx0fSBlbHNlIGlmIChcclxuXHRcdHVzZXJuYW1lSW5wdXQudmFsdWUudHJpbSgpICE9PSB1c2VybmFtZSB8fFxyXG5cdFx0cGFzc3dvcmRJbnB1dC52YWx1ZS50cmltKCkgIT09IHBhc3N3b3JkXHJcblx0KSB7XHJcblx0XHRlLnRhcmdldC5kaXNhYmxlZCA9IHRydWU7XHJcblx0XHRlLnRhcmdldC5hcHBlbmQoc2hvd1NtYWxsTG9hZGVyKCkpO1xyXG5cdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LnJlbW92ZShcInZpc2libGVcIik7XHJcblxyXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdGVycm9yVHh0LmNsYXNzTGlzdC5hZGQoXCJ2aXNpYmxlXCIpO1xyXG5cdFx0XHRlcnJvclR4dC50ZXh0Q29udGVudCA9IGludmFsaWRFcnJvcjtcclxuXHJcblx0XHRcdGUudGFyZ2V0LmRpc2FibGVkID0gZmFsc2U7XHJcblxyXG5cdFx0XHRoaWRlU21hbGxMb2FkZXIoKTtcclxuXHRcdH0sIDMwMDApO1xyXG5cdFx0cmV0dXJuIGludmFsaWRFcnJvcjtcclxuXHR9IGVsc2Uge1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHNob3dCaWdMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcImxvYWRpbmctYXJlYVwiXSk7XHJcblx0bG9hZGluZ0FyZWEuaW5uZXJIVE1MID0gYCAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJsb2FkZXItYmlnXCIgdmlld0JveD1cIjAgMCAxMjAgMTIwXCIgd2lkdGg9XCIxMjBcIiBoZWlnaHQ9XCIxMjBcIj5cclxuICAgICAgICAgICAgICAgIDxkZWZzPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsaW5lYXJHcmFkaWVudCBpZD1cImxvYWRlci1hY2NlbnRcIiB4MT1cIjAlXCIgeTE9XCIwJVwiIHgyPVwiMTAwJVwiIHkyPVwiMCVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMCVcIiBzdG9wLWNvbG9yPVwiIzRkYThkYVwiIHN0b3Atb3BhY2l0eT1cIjAuOFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjcwJVwiIHN0b3AtY29sb3I9XCIjNGRhOGRhXCIgc3RvcC1vcGFjaXR5PVwiMC40XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMTAwJVwiIHN0b3AtY29sb3I9XCIjNGRhOGRhXCIgc3RvcC1vcGFjaXR5PVwiMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9saW5lYXJHcmFkaWVudD5cclxuICAgICAgICAgICAgICAgIDwvZGVmcz5cclxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3M9XCJsb2FkaW5nLWNpcmNsZS1iaWdcIiByPVwiMzVcIiBjeD1cIjYwXCIgY3k9XCI2MFwiPjwvY2lyY2xlPlxyXG4gICAgICAgICAgICA8L3N2Zz5gO1xyXG5cdHJldHVybiBsb2FkaW5nQXJlYTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGhpZGVCaWdMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmxvYWRpbmctYXJlYVwiKTtcclxuXHRsb2FkaW5nQXJlYT8ucmVtb3ZlKCk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc2hvd1NtYWxsTG9hZGVyID0gKCkgPT4ge1xyXG5cdGNvbnN0IGxvYWRpbmdBcmVhID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJsb2FkaW5nLWFyZWEtc21hbGxcIl0pO1xyXG5cdGxvYWRpbmdBcmVhLmlubmVySFRNTCA9IGA8c3ZnIGNsYXNzPVwibG9hZGVyLXNtYWxsXCIgdmlld0JveD1cIjAgMCAxMjAgMTIwXCIgd2lkdGg9XCIxMjBcIiBoZWlnaHQ9XCIxMjBcIj5cclxuICAgICAgICAgICAgICAgIDxkZWZzPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsaW5lYXJHcmFkaWVudCBpZD1cImxvYWRlci1hY2NlbnQtc21hbGxcIiB4MT1cIjAlXCIgeTE9XCIwJVwiIHgyPVwiMTAwJVwiIHkyPVwiMCVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMCVcIiBzdG9wLWNvbG9yPVwid2hpdGVcIiBzdG9wLW9wYWNpdHk9XCIwLjhcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCI3MCVcIiBzdG9wLWNvbG9yPVwid2hpdGVcIiBzdG9wLW9wYWNpdHk9XCIwLjNcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIxMDAlXCIgc3RvcC1jb2xvcj1cIndoaXRlXCIgc3RvcC1vcGFjaXR5PVwiMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9saW5lYXJHcmFkaWVudD5cclxuICAgICAgICAgICAgICAgIDwvZGVmcz5cclxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3M9XCJsb2FkaW5nLWNpcmNsZS1zbWFsbFwiIHI9XCIxMlwiIGN4PVwiNjBcIiBjeT1cIjYwXCI+PC9jaXJjbGU+XHJcbiAgICAgICAgICAgIDwvc3ZnPmA7XHJcblxyXG5cdHJldHVybiBsb2FkaW5nQXJlYTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGhpZGVTbWFsbExvYWRlciA9ICgpID0+IHtcclxuXHRjb25zdCBsb2FkaW5nQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubG9hZGluZy1hcmVhLXNtYWxsXCIpO1xyXG5cdGxvYWRpbmdBcmVhLnJlbW92ZSgpO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVByb2ZpbGVzUGFnZSA9ICh7XHJcblx0cHJvZmlsZXM6IHtcclxuXHRcdHRleHQ6IHsgdGl0bGUsIGFkZFByb2ZpbGVJbmZvIH0sXHJcblx0XHRhcmlhOiB7IGFkZFByb2ZpbGVCdG4sIHVzZXJQcm9maWxlQnRuLCB1c2VyQnRuQ3VzdG9taXplIH0sXHJcblx0fSxcclxufSkgPT4ge1xyXG5cdGNvbnN0IHVzZXJEYXRhID0gSlNPTi5wYXJzZT8uKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidXNlckRhdGFcIikpO1xyXG5cclxuXHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhaW5lclwiKTtcclxuXHRjb25zdCBwcm9maWxlc1BhZ2VNYWluID0gY3JlYXRlRWxlbWVudChcIm1haW5cIiwgW1wibWFpbi1wcm9maWxlc1wiXSk7XHJcblx0Y29uc3Qgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wid3JhcHBlclwiXSk7XHJcblx0Y29uc3QgcHJvZmlsZXNUaXRsZSA9IGNyZWF0ZUVsZW1lbnQoXCJoMVwiLCBbXHJcblx0XHRcIm1haW5fX3RpdGxlXCIsXHJcblx0XHRcIm1haW4tcHJvZmlsZXNfX3RpdGxlXCIsXHJcblx0XSk7XHJcblx0Y29uc3QgcHJvZmlsZXNCb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2JveFwiXSk7XHJcblxyXG5cdHByb2ZpbGVzVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcclxuXHJcblx0Ly8gaWYgKCF1c2VyRGF0YSB8fCAhdXNlclByb2ZpbGVzQXJyIHx8IHVzZXJQcm9maWxlc0Fyci5sZW5ndGggPT09IDApIHtcclxuXHJcblx0Ly8gfVxyXG5cclxuXHRwcm9maWxlc0JveC5hcHBlbmQoXHJcblx0XHRjcmVhdGVQcm9maWxlQWRkQnRuKFxyXG5cdFx0XHRhZGRQcm9maWxlQnRuLFxyXG5cdFx0XHRhZGRQcm9maWxlSW5mbyxcclxuXHRcdFx0dXNlclByb2ZpbGVCdG4sXHJcblx0XHRcdHByb2ZpbGVzQm94LFxyXG5cdFx0XHR1c2VyQnRuQ3VzdG9taXplXHJcblx0XHQpXHJcblx0KTtcclxuXHR3cmFwcGVyLmFwcGVuZChwcm9maWxlc1RpdGxlLCBwcm9maWxlc0JveCk7XHJcblx0cHJvZmlsZXNQYWdlTWFpbi5hcHBlbmQod3JhcHBlcik7XHJcblxyXG5cdGNvbnRhaW5lci5hcHBlbmQocHJvZmlsZXNQYWdlTWFpbik7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVQcm9maWxlID0gKGFyaWFJbmZvLCB1c2VyQnRuSW5mbykgPT4ge1xyXG5cdGNvbnN0IHVzZXJEYXRhID0gSlNPTi5wYXJzZT8uKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidXNlckRhdGFcIikpO1xyXG5cdGNvbnN0IGV4aXN0aW5nUHJvZmlsZXMgPSB1c2VyRGF0YT8udXNlclByb2ZpbGVzIHx8IFtdO1xyXG5cclxuXHRsZXQgY29sb3I7XHJcblxyXG5cdGNvbnN0IGNvbG9ycyA9IFtcIiNkYzRhMzRcIiwgXCIjMDYyRTYzXCIsIFwiI0ZBQzA0NFwiXTtcclxuXHJcblx0aWYgKHByb2ZpbGVzQ291bnQgPT0gMyB8fCBleGlzdGluZ1Byb2ZpbGVzLmxlbmd0aCA9PT0gMykgcmV0dXJuO1xyXG5cclxuXHRwcm9maWxlc0NvdW50Kys7XHJcblx0Y29sb3IgPSBjb2xvcnNbcHJvZmlsZXNDb3VudF07XHJcblxyXG5cdGNvbnN0IHVzZXJQcm9maWxlID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX19wcm9maWxlXCJdKTtcclxuXHRjb25zdCB1c2VyQXZhdGFyQm94ID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX19hdmF0YXJcIl0pO1xyXG5cdGNvbnN0IHVzZXJQcm9maWxlQnRuID0gY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCBbXCJtYWluLXByb2ZpbGVzX19idG5cIl0sIHtcclxuXHRcdFwiYXJpYS1sYWJlbFwiOiBhcmlhSW5mbyxcclxuXHRcdFwiZGF0YS1pZFwiOiBgdXNlci1wcm9maWxlLSR7cHJvZmlsZXNDb3VudH1gLFxyXG5cdH0pO1xyXG5cclxuXHRjb25zdCB1c2VyUHJvZmlsZUluZm9Cb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX3VzZXItaW5mb1wiXSk7XHJcblx0Y29uc3QgdXNlclByb2ZpbGVJbmZvID0gY3JlYXRlRWxlbWVudChcImlucHV0XCIsIFtcIm1haW4tcHJvZmlsZXNfX25hbWVcIl0sIHtcclxuXHRcdHR5cGU6IFwidGV4dFwiLFxyXG5cdFx0cmVhZG9ubHk6IHRydWUsXHJcblx0XHR2YWx1ZTogYCR7XHJcblx0XHRcdGV4aXN0aW5nUHJvZmlsZXNbcHJvZmlsZXNDb3VudF0/LnVzZXJuYW1lIHx8IFwiSGFuZHNvbWUgVXNlclwiXHJcblx0XHR9ICR7cHJvZmlsZXNDb3VudH1gLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGVkaXRVc2VySW5mb0J0biA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImJ1dHRvblwiLFxyXG5cdFx0W1wibWFpbi1wcm9maWxlc19fZWRpdC1uYW1lXCJdLFxyXG5cdFx0eyBcImFyaWEtbGFiZWxcIjogdXNlckJ0bkluZm8gfVxyXG5cdCk7XHJcblx0Y29uc3QgZWRpdFVzZXJJbmZvSWNvbiA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibWFpbi1wcm9maWxlc19fZWRpdC1pY29uXCJdLCB7XHJcblx0XHR3aWR0aDogXCIyNFwiLFxyXG5cdFx0aGVpZ2h0OiBcIjI0XCIsXHJcblx0XHRsb2FkaW5nOiBcImxhenlcIixcclxuXHRcdGFsdDogXCJcIixcclxuXHRcdHNyYzogXCIuL3NyYy9pY29ucy9lZGl0LnN2Z1wiLFxyXG5cdH0pO1xyXG5cclxuXHR1c2VyUHJvZmlsZUJ0bi5pbm5lckhUTUwgPSBgPHN2ZyBjbGFzcz1cIm1haW4tcHJvZmlsZXNfX2ltZ1wiIHdpZHRoPVwiMTUwXCIgaGVpZ2h0PVwiMTUwXCIgdmlld0JveD1cIjAgMCAyMDAgMjAwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxyXG5cdDxjaXJjbGUgY3g9XCI3MFwiIGN5PVwiNzBcIiByPVwiOFwiIGZpbGw9XCJ3aGl0ZVwiIC8+XHJcblx0PGNpcmNsZSBjeD1cIjEzMFwiIGN5PVwiNzBcIiByPVwiOFwiIGZpbGw9XCJ3aGl0ZVwiIC8+XHJcblx0PHBhdGggZD1cIk02MCAxMTAgUTEwMCAxNTAgMTQwIDExMFwiIHN0cm9rZT1cIndoaXRlXCIgc3Ryb2tlLXdpZHRoPVwiNlwiXHJcblx0ZmlsbD1cInRyYW5zcGFyZW50XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIC8+XHJcblx0PC9zdmc+YDtcclxuXHR1c2VyUHJvZmlsZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcclxuXHJcblx0dXNlckF2YXRhckJveC5hcHBlbmQodXNlclByb2ZpbGVCdG4pO1xyXG5cdGVkaXRVc2VySW5mb0J0bi5hcHBlbmQoZWRpdFVzZXJJbmZvSWNvbik7XHJcblx0dXNlclByb2ZpbGVJbmZvQm94LmFwcGVuZCh1c2VyUHJvZmlsZUluZm8sIGVkaXRVc2VySW5mb0J0bik7XHJcblx0dXNlclByb2ZpbGUuYXBwZW5kKHVzZXJBdmF0YXJCb3gsIHVzZXJQcm9maWxlSW5mb0JveCk7XHJcblxyXG5cdC8vIHNldFVzZXJQcmVmZXJlbmNlKFwicHJvZmlsZXNDb3VudFwiLCBwcm9maWxlc0NvdW50LCB1c2VyRGF0YSlcclxuXHJcblx0ZWRpdFVzZXJJbmZvQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0ZWRpdFVzZXJuYW1lKGUpO1xyXG5cdH0pO1xyXG5cclxuXHRyZXR1cm4gdXNlclByb2ZpbGU7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVQcm9maWxlQWRkQnRuID0gKFxyXG5cdGFyaWFJbmZvLFxyXG5cdGluZm8sXHJcblx0dXNlckJ0bkFyaWEsXHJcblx0cHJvZmlsZXNCb3gsXHJcblx0dXNlckJ0bkluZm9cclxuKSA9PiB7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUJveCA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fYWRkLXByb2ZpbGVcIl0pO1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVBdmF0YXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2F2YXRhclwiXSk7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUJ0biA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImJ1dHRvblwiLFxyXG5cdFx0W1wibWFpbi1wcm9maWxlc19fYnRuXCIsIFwibWFpbi1wcm9maWxlc19fYnRuLS1hZGQtcHJvZmlsZVwiXSxcclxuXHRcdHsgXCJhcmlhLWxhYmVsXCI6IGFyaWFJbmZvIH1cclxuXHQpO1xyXG5cdGNvbnN0IGFkZFByb2ZpbGVQbHVzSWNvbiA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibWFpbi1wcm9maWxlc19fYWRkLWltZ1wiXSwge1xyXG5cdFx0c3JjOiBcIi4vc3JjL2ljb25zL2FkZC1wcm9maWxlLnN2Z1wiLFxyXG5cdFx0bG9hZGluZzogXCJsYXp5XCIsXHJcblx0XHRhbHQ6IFwiXCIsXHJcblx0fSk7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUluZm8gPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXCJtYWluLXByb2ZpbGVzX19uYW1lXCJdKTtcclxuXHJcblx0YWRkUHJvZmlsZUluZm8udGV4dENvbnRlbnQgPSBpbmZvO1xyXG5cclxuXHRhZGRQcm9maWxlQnRuLmFwcGVuZChhZGRQcm9maWxlUGx1c0ljb24pO1xyXG5cdGFkZFByb2ZpbGVBdmF0YXIuYXBwZW5kKGFkZFByb2ZpbGVCdG4pO1xyXG5cdGFkZFByb2ZpbGVCb3guYXBwZW5kKGFkZFByb2ZpbGVBdmF0YXIsIGFkZFByb2ZpbGVJbmZvKTtcclxuXHJcblx0YWRkUHJvZmlsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0Y29uc3QgcHJvZmlsZSA9IGNyZWF0ZVByb2ZpbGUodXNlckJ0bkFyaWEsIHVzZXJCdG5JbmZvKTtcclxuXHJcblx0XHRpZiAocHJvZmlsZSkge1xyXG5cdFx0XHRwcm9maWxlc0JveC5hcHBlbmQocHJvZmlsZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRhbGVydChcIk9zacSFZ25pxJl0byBtYWtzeW1hbG7EhSBsaWN6YsSZIHByb2ZpbMOzdyFcIik7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHJldHVybiBhZGRQcm9maWxlQm94O1xyXG59O1xyXG5cclxuY29uc3QgZWRpdFVzZXJuYW1lID0gKGUpID0+IHtcclxuXHRjb25zdCBlZGl0QnRuID0gZS50YXJnZXQ7XHJcblx0Y29uc3QgbmFtZVRvRWRpdCA9IGVkaXRCdG4ucHJldmlvdXNFbGVtZW50U2libGluZztcclxuXHJcblx0bmFtZVRvRWRpdC5mb2N1cygpO1xyXG5cdG5hbWVUb0VkaXQuc2VsZWN0KCk7XHJcblx0bmFtZVRvRWRpdC5yZW1vdmVBdHRyaWJ1dGUoXCJyZWFkb25seVwiKTtcclxuXHRuYW1lVG9FZGl0LmNsYXNzTGlzdC5hZGQoXCJmb2N1c2VkXCIpO1xyXG59O1xyXG5cclxuY29uc3Qgc2F2ZVVzZXJuYW1lID0gKGUpID0+IHtcclxuXHRjb25zdCBlZGl0ZWROYW1lcyA9IFsuLi5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZm9jdXNlZFwiKV07XHJcblx0Y29uc3QgYXRMZWFzdE9uZUFjdGl2ZSA9IGVkaXRlZE5hbWVzLnNvbWUoKGVsKSA9PlxyXG5cdFx0ZWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZm9jdXNlZFwiKVxyXG5cdCk7XHJcblxyXG5cdGlmIChlZGl0ZWROYW1lcy5sZW5ndGggPT09IDApIHJldHVybjtcclxuXHRpZiAoXHJcblx0XHRhdExlYXN0T25lQWN0aXZlICYmXHJcblx0XHRlLnRhcmdldC5jbG9zZXN0KFwiLmZvY3VzZWRcIikgfHxcclxuXHRcdGUudGFyZ2V0LmNsb3Nlc3QoXCIubWFpbi1wcm9maWxlc19fZWRpdC1uYW1lXCIpXHJcblx0KVxyXG5cdFx0cmV0dXJuO1xyXG5cclxuXHRlZGl0ZWROYW1lcy5mb3JFYWNoKChuYW1lKSA9PiB7XHJcblx0XHRuYW1lLnNldEF0dHJpYnV0ZShcInJlYWRvbmx5XCIsIHRydWUpO1xyXG5cdFx0bmFtZS5jbGFzc0xpc3QucmVtb3ZlKFwiZm9jdXNlZFwiKTtcclxuXHR9KTtcclxuXHJcblx0XHJcbn07XHJcblxyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0c2F2ZVVzZXJuYW1lKGUpO1xyXG59KTtcclxuIl19
