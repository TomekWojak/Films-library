import{createElement}from"./helpers.min.js";import{setUserPreference}from"./updateStateFunctions.min.js";const userData=JSON.parse?.(localStorage.getItem("userData"));let profilesCount=userData?.profilesCount||0;const USERNAME="handsomeUser404",PASSWORD="5jksH9d.";export const createLoginHeader=({header:{alt:{logo:e},aria:{logoLink:t,changeLanguageButton:a}}},n,r,o,i)=>{const l=createElement("header",["header"]),s=createElement("a",["header__logo","login-header__logo"],{href:"/","aria-label":`${t}`}),c=createElement("img",["header__logo-img","login-header__logo-img"],{src:"./src/icons/logo.svg",alt:`${e}`,width:"24",height:"24"}),d=createElement("span",["header__logo-text","login-header__logo-text"]);d.textContent="Stream",s.append(c,d),l.append(s);const m=createElement("button",["login-header__lang-select"],{"aria-label":`${a}`}),p=createElement("span",["login-header__lang-platform-lang"]),g=createElement("img",["login-header__lang-arrow"],{src:"./src/icons/chevron-down.svg",alt:"",width:"24",height:"24"}),f=createElement("ul",["login-header__lang-list"]);for(let e=0;e<n;e++){const t=createElement("li",["login-header__lang-choice"],{tabindex:0}),a=Object.keys(r)[e],n=Object.values(r)[e];t.dataset.lang=a,t.textContent=n,t.style.animationDelay=100*e+"ms",f.append(t)}return p.textContent=r[o],m.addEventListener("click",e=>{i.call(m,e,p)}),m.append(p,g,f),l.append(m),l};export const createLoginPage=({main:{text:{title:e,subtitle:t,description:a,button:n},placeholder:{username:r,password:o}}})=>{const i=createElement("main",["main"]),l=createElement("div",["wrapper"]),s=createElement("h1"),c=createElement("span",["main__title"]),d=createElement("span",["main__subtitle"]),m=createElement("p",["main__text"]),p=createElement("form",["main__form"]),g=createElement("input",["main__form-input","main__form-input--username"],{type:"text",placeholder:r}),f=createElement("input",["main__form-input","main__form-input--password"],{type:"password",placeholder:o}),_=createElement("button",["main__form-button"],{type:"submit"}),u=createElement("span",["main__form-button-text"]),h=createElement("p",["main__form-error-txt"]);return c.textContent=e,d.textContent=t,m.textContent=a,u.textContent=n,s.append(c,d),_.append(u),p.append(g,f,_,h),l.append(s,m,p),i.append(l),_.addEventListener("click",e=>{const t=JSON.parse?.(localStorage.getItem("userData"));handleLoginValidation(e,g,f,translations.main.text.errorRequired,translations.main.text.errorInvalid,USERNAME,PASSWORD,h)||(h.classList.remove("visible"),e.target.append(showSmallLoader()),e.target.disabled=!0,setTimeout(()=>{e.target.disabled=!1,hideSmallLoader(),setUserPreference("translations",translations,t),setUserPreference("loggedIn",!0,t),window.location.href="profiles.html"},3e3))}),i};const handleLoginValidation=(e,t,a,n,r,o,i,l)=>(e.preventDefault(),""===t.value.trim()||""===a.value.trim()?(l.classList.add("visible"),l.textContent=n,n):t.value.trim()!==o||a.value.trim()!==i?(e.target.disabled=!0,e.target.append(showSmallLoader()),l.classList.remove("visible"),setTimeout(()=>{l.classList.add("visible"),l.textContent=r,e.target.disabled=!1,hideSmallLoader()},3e3),r):null);export const showBigLoader=()=>{const e=createElement("div",["loading-area"]);return e.innerHTML='            <svg class="loader-big" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="#4da8da" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="#4da8da" stop-opacity="0.4" />\n                        <stop offset="100%" stop-color="#4da8da" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-big" r="35" cx="60" cy="60"></circle>\n            </svg>',e};export const hideBigLoader=()=>{const e=document.querySelector(".loading-area");e?.remove()};export const showSmallLoader=()=>{const e=createElement("div",["loading-area-small"]);return e.innerHTML='<svg class="loader-small" viewBox="0 0 120 120" width="120" height="120">\n                <defs>\n                    <linearGradient id="loader-accent-small" x1="0%" y1="0%" x2="100%" y2="0%">\n                        <stop offset="0%" stop-color="white" stop-opacity="0.8" />\n                        <stop offset="70%" stop-color="white" stop-opacity="0.3" />\n                        <stop offset="100%" stop-color="white" stop-opacity="0" />\n                    </linearGradient>\n                </defs>\n                <circle class="loading-circle-small" r="12" cx="60" cy="60"></circle>\n            </svg>',e};export const hideSmallLoader=()=>{document.querySelector(".loading-area-small").remove()};export const createProfilesPage=({profiles:{text:{title:e,addProfileInfo:t},aria:{addProfileBtn:a,userProfileBtn:n,userBtnCustomize:r}}})=>{JSON.parse?.(localStorage.getItem("userData"));const o=document.querySelector(".container"),i=createElement("main",["main-profiles"]),l=createElement("div",["wrapper"]),s=createElement("h1",["main__title","main-profiles__title"]),c=createElement("div",["main-profiles__box"]);s.textContent=e,c.append(createProfileAddBtn(a,t,n,c,r,r)),l.append(s,c),i.append(l),o.append(i)};const createProfile=(e,t,a)=>{const n=JSON.parse?.(localStorage.getItem("userData")),r=n?.userProfiles||[];let o;if(3==profilesCount||3===r.length)return;profilesCount++,o=["#dc4a34","#062E63","#FAC044"][profilesCount];const i=createElement("div",["main-profiles__profile"]),l=createElement("div",["main-profiles__avatar"]),s=createElement("button",["main-profiles__btn"],{"aria-label":e,"data-id":`user-profile-${profilesCount}`}),c=createElement("div",["main-profiles__user-info"]),d=createElement("input",["main-profiles__name"],{type:"text",readonly:!0,value:`${r[profilesCount]?.username||"Handsome User"} ${profilesCount}`}),m=createElement("button",["main-profiles__edit-name"],{"aria-label":t}),p=createElement("img",["main-profiles__edit-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/edit.svg"});return s.innerHTML='<svg class="main-profiles__img" width="150" height="150" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">\n\t<circle cx="70" cy="70" r="8" fill="white" />\n\t<circle cx="130" cy="70" r="8" fill="white" />\n\t<path d="M60 110 Q100 150 140 110" stroke="white" stroke-width="6"\n\tfill="transparent" stroke-linecap="round" />\n\t</svg>',s.style.backgroundColor=o,l.append(s),m.append(p),c.append(d,m),i.append(l,c),m.addEventListener("click",e=>{editUsername(e,c,a)}),i},createProfileAddBtn=(e,t,a,n,r,o)=>{const i=createElement("div",["main-profiles__add-profile"]),l=createElement("div",["main-profiles__avatar"]),s=createElement("button",["main-profiles__btn","main-profiles__btn--add-profile"],{"aria-label":e}),c=createElement("img",["main-profiles__add-img"],{src:"./src/icons/add-profile.svg",loading:"lazy",alt:""}),d=createElement("span",["main-profiles__name"]);return d.textContent=t,s.append(c),l.append(s),i.append(l,d),s.addEventListener("click",()=>{const e=createProfile(a,r,o);e?n.append(e):alert("Osiągnięto maksymalną liczbę profilów!")}),i},editUsername=(e,t,a)=>{const n=e.target,r=n.previousElementSibling,o=createSaveBtn(a);n.classList.add("hidden"),o.classList.remove("hidden"),t.append(o),r.focus(),r.select(),r.removeAttribute("readonly"),r.classList.add("focused"),o.addEventListener("click",e=>{saveUsername(e)})},saveUsername=e=>{JSON.parse?.(localStorage.getItem("userData"));const t=e.target.closest(".main-profiles__profile"),a=t.querySelector(".main-profiles__btn").dataset.id;console.log(a);const n=t.querySelector(".main-profiles__name");n.value;setUserPreference(),resetStateOfEditing()},createSaveBtn=e=>{const t=createElement("button",["main-profiles__save-name","hidden"],{"aria-label":e}),a=createElement("img",["main-profiles__save-icon"],{width:"24",height:"24",loading:"lazy",alt:"",src:"./src/icons/save.svg"});return t.append(a),t},resetStateOfEditing=()=>{const e=document.querySelectorAll(".focused"),t=document.querySelectorAll(".main-profiles__save-name"),a=document.querySelectorAll(".main-profiles__edit-name");e.forEach(e=>{e.setAttribute("readonly",!0),e.classList.remove("focused")}),t.forEach(e=>e.classList.add("hidden")),a.forEach(e=>e.classList.remove("hidden"))};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50cy5taW4uanMiLCJuYW1lcyI6WyJjcmVhdGVFbGVtZW50Iiwic2V0VXNlclByZWZlcmVuY2UiLCJ1c2VyRGF0YSIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJwcm9maWxlc0NvdW50IiwiVVNFUk5BTUUiLCJQQVNTV09SRCIsImNyZWF0ZUxvZ2luSGVhZGVyIiwiaGVhZGVyIiwiYWx0IiwibG9nbyIsImFyaWEiLCJsb2dvTGluayIsImNoYW5nZUxhbmd1YWdlQnV0dG9uIiwibGFuZ0Ftb3VudCIsImxhbmdOYW1lcyIsImxhbmd1YWdlIiwiaGFuZGxlTGFuZ1NlbGVjdCIsInBhZ2VMb2dvIiwiaHJlZiIsImxvZ29JbWciLCJzcmMiLCJ3aWR0aCIsImhlaWdodCIsImxvZ29UZXh0IiwidGV4dENvbnRlbnQiLCJhcHBlbmQiLCJsYW5nU2VsZWN0IiwibGFuZ1BsYXRmb3JtTGFuZyIsImxhbmdBcnJvdyIsImxhbmdMaXN0IiwiaSIsImxhbmdDaG9pY2UiLCJ0YWJpbmRleCIsImRhdGEiLCJPYmplY3QiLCJrZXlzIiwidGV4dCIsInZhbHVlcyIsImRhdGFzZXQiLCJsYW5nIiwic3R5bGUiLCJhbmltYXRpb25EZWxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY2FsbCIsImNyZWF0ZUxvZ2luUGFnZSIsIm1haW4iLCJ0aXRsZSIsInN1YnRpdGxlIiwiZGVzY3JpcHRpb24iLCJidXR0b24iLCJwbGFjZWhvbGRlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJtYWluQ29udGVudCIsIndyYXBwZXIiLCJsb2dpblRpdGxlIiwibG9naW5UaXRsZVRvcCIsImxvZ2luVGl0bGVCb3R0b20iLCJsb2dpblRleHQiLCJmb3JtIiwidXNlcm5hbWVJbnB1dCIsInR5cGUiLCJwYXNzd29yZElucHV0Iiwic3VibWl0QnRuIiwiYnV0dG9uVGV4dCIsImVycm9yVHh0IiwiaGFuZGxlTG9naW5WYWxpZGF0aW9uIiwidHJhbnNsYXRpb25zIiwiZXJyb3JSZXF1aXJlZCIsImVycm9ySW52YWxpZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRhcmdldCIsInNob3dTbWFsbExvYWRlciIsImRpc2FibGVkIiwic2V0VGltZW91dCIsImhpZGVTbWFsbExvYWRlciIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVxdWlyZUVycm9yIiwiaW52YWxpZEVycm9yIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsInRyaW0iLCJhZGQiLCJzaG93QmlnTG9hZGVyIiwibG9hZGluZ0FyZWEiLCJpbm5lckhUTUwiLCJoaWRlQmlnTG9hZGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY3JlYXRlUHJvZmlsZXNQYWdlIiwicHJvZmlsZXMiLCJhZGRQcm9maWxlSW5mbyIsImFkZFByb2ZpbGVCdG4iLCJ1c2VyUHJvZmlsZUJ0biIsInVzZXJCdG5DdXN0b21pemUiLCJjb250YWluZXIiLCJwcm9maWxlc1BhZ2VNYWluIiwicHJvZmlsZXNUaXRsZSIsInByb2ZpbGVzQm94IiwiY3JlYXRlUHJvZmlsZUFkZEJ0biIsImNyZWF0ZVByb2ZpbGUiLCJhcmlhSW5mbyIsInVzZXJCdG5JbmZvIiwic2F2ZUJ0bkFyaWEiLCJleGlzdGluZ1Byb2ZpbGVzIiwidXNlclByb2ZpbGVzIiwiY29sb3IiLCJsZW5ndGgiLCJ1c2VyUHJvZmlsZSIsInVzZXJBdmF0YXJCb3giLCJ1c2VyUHJvZmlsZUluZm9Cb3giLCJ1c2VyUHJvZmlsZUluZm8iLCJyZWFkb25seSIsImVkaXRVc2VySW5mb0J0biIsImVkaXRVc2VySW5mb0ljb24iLCJsb2FkaW5nIiwiYmFja2dyb3VuZENvbG9yIiwiZWRpdFVzZXJuYW1lIiwiaW5mbyIsInVzZXJCdG5BcmlhIiwiYWRkUHJvZmlsZUJveCIsImFkZFByb2ZpbGVBdmF0YXIiLCJhZGRQcm9maWxlUGx1c0ljb24iLCJwcm9maWxlIiwiYWxlcnQiLCJwYXJlbnQiLCJlZGl0QnRuIiwibmFtZVRvRWRpdCIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJzYXZlQnRuIiwiY3JlYXRlU2F2ZUJ0biIsImZvY3VzIiwic2VsZWN0IiwicmVtb3ZlQXR0cmlidXRlIiwic2F2ZVVzZXJuYW1lIiwiY2xvc2VzdFByb2ZpbGUiLCJjbG9zZXN0IiwiY2xvc2VzdFByb2ZpbGVJZCIsImlkIiwiY29uc29sZSIsImxvZyIsImNsb3Nlc3RQcm9maWxlTmFtZSIsInJlc2V0U3RhdGVPZkVkaXRpbmciLCJzYXZlVXNlckluZm9CdG4iLCJzYXZlVXNlckluZm9JY29uIiwiZm9jdXNlZE5hbWVzIiwicXVlcnlTZWxlY3RvckFsbCIsImFsbFNhdmVCdG5zIiwiYWxsRWRpdEJ0bnMiLCJmb3JFYWNoIiwiZWwiLCJzZXRBdHRyaWJ1dGUiLCJidG4iXSwic291cmNlcyI6WyJjb21wb25lbnRzLmpzIl0sIm1hcHBpbmdzIjoiT0FBU0Esa0JBQXFCLDBCQUNyQkMsc0JBQXlCLGdDQUNsQyxNQUFNQyxTQUFXQyxLQUFLQyxRQUFRQyxhQUFhQyxRQUFRLGFBRW5ELElBQUlDLGNBQWdCTCxVQUFVSyxlQUFpQixFQUMvQyxNQUFNQyxTQUFXLGtCQUNYQyxTQUFXLGtCQUVWLE1BQU1DLGtCQUFvQixFQUUvQkMsUUFDQ0MsS0FBT0MsUUFDUEMsTUFBUUMsV0FBVUMsMEJBR3BCQyxFQUNBQyxFQUNBQyxFQUNBQyxLQUdBLE1BQU1ULEVBQVNYLGNBQWMsU0FBVSxDQUFDLFdBQ2xDcUIsRUFBV3JCLGNBQWMsSUFBSyxDQUFDLGVBQWdCLHNCQUF1QixDQUMzRXNCLEtBQU0sSUFDTixhQUFjLEdBQUdQLE1BRVpRLEVBQVV2QixjQUNmLE1BQ0EsQ0FBQyxtQkFBb0IsMEJBQ3JCLENBQ0N3QixJQUFLLHVCQUNMWixJQUFLLEdBQUdDLElBQ1JZLE1BQU8sS0FDUEMsT0FBUSxPQUdKQyxFQUFXM0IsY0FBYyxPQUFRLENBQ3RDLG9CQUNBLDRCQUVEMkIsRUFBU0MsWUFBYyxTQUN2QlAsRUFBU1EsT0FBT04sRUFBU0ksR0FDekJoQixFQUFPa0IsT0FBT1IsR0FJZCxNQUFNUyxFQUFhOUIsY0FBYyxTQUFVLENBQUMs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LFFBQVVDLElBQ2xDOEYsYUFBYTlGLE1BSVQ4RixhQUFnQjlGLElBQ0o1QyxLQUFLQyxRQUFRQyxhQUFhQyxRQUFRLGFBQW5ELE1BSU13SSxFQURVL0YsRUFBRThCLE9BQ2FrRSxRQUFRLDJCQUNqQ0MsRUFBbUJGLEVBQWUvQyxjQUFjLHVCQUNwRHJELFFBQVF1RyxHQUNWQyxRQUFRQyxJQUFJSCxHQUNaLE1BQU1JLEVBQXFCTixFQUFlL0MsY0FDekMsd0JBSW9CcUQsRUFBbUI3RCxNQUd4Q3RGLG9CQUVBb0osdUJBR0taLGNBQWlCM0IsSUFDdEIsTUFBTXdDLEVBQWtCdEosY0FDdkIsU0FDQSxDQUFDLDJCQUE0QixVQUM3QixDQUFFLGFBQWM4RyxJQUVYeUMsRUFBbUJ2SixjQUFjLE1BQU8sQ0FBQyw0QkFBNkIsQ0FDM0V5QixNQUFPLEtBQ1BDLE9BQVEsS0FDUmdHLFFBQVMsT0FDVDlHLElBQUssR0FDTFksSUFBSyx5QkFLTixPQUZBOEgsRUFBZ0J6SCxPQUFPMEgsR0FFaEJELEdBR0ZELG9CQUFzQixLQUMzQixNQUFNRyxFQUFlMUQsU0FBUzJELGlCQUFpQixZQUN6Q0MsRUFBYzVELFNBQVMyRCxpQkFBaUIsNkJBQ3hDRSxFQUFjN0QsU0FBUzJELGlCQUFpQiw2QkFFOUNELEVBQWFJLFFBQVNDLElBQ3JCQSxFQUFHQyxhQUFhLFlBQVksR0FDNUJELEVBQUdsRixVQUFVQyxPQUFPLGFBRXJCOEUsRUFBWUUsUUFBU0csR0FBUUEsRUFBSXBGLFVBQVVjLElBQUksV0FDL0NrRSxFQUFZQyxRQUFTRyxHQUFRQSxFQUFJcEYsVUFBVUMsT0FBTyIsImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVFbGVtZW50IH0gZnJvbSBcIi4vaGVscGVycy5taW4uanNcIjtcclxuaW1wb3J0IHsgc2V0VXNlclByZWZlcmVuY2UgfSBmcm9tIFwiLi91cGRhdGVTdGF0ZUZ1bmN0aW9ucy5taW4uanNcIjtcclxuY29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlPy4obG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKSk7XHJcblxyXG5sZXQgcHJvZmlsZXNDb3VudCA9IHVzZXJEYXRhPy5wcm9maWxlc0NvdW50IHx8IDA7XHJcbmNvbnN0IFVTRVJOQU1FID0gXCJoYW5kc29tZVVzZXI0MDRcIjtcclxuY29uc3QgUEFTU1dPUkQgPSBcIjVqa3NIOWQuXCI7XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTG9naW5IZWFkZXIgPSAoXHJcblx0e1xyXG5cdFx0aGVhZGVyOiB7XHJcblx0XHRcdGFsdDogeyBsb2dvIH0sXHJcblx0XHRcdGFyaWE6IHsgbG9nb0xpbmssIGNoYW5nZUxhbmd1YWdlQnV0dG9uIH0sXHJcblx0XHR9LFxyXG5cdH0sXHJcblx0bGFuZ0Ftb3VudCxcclxuXHRsYW5nTmFtZXMsXHJcblx0bGFuZ3VhZ2UsXHJcblx0aGFuZGxlTGFuZ1NlbGVjdFxyXG4pID0+IHtcclxuXHQvLyBsb2dvXHJcblx0Y29uc3QgaGVhZGVyID0gY3JlYXRlRWxlbWVudChcImhlYWRlclwiLCBbXCJoZWFkZXJcIl0pO1xyXG5cdGNvbnN0IHBhZ2VMb2dvID0gY3JlYXRlRWxlbWVudChcImFcIiwgW1wiaGVhZGVyX19sb2dvXCIsIFwibG9naW4taGVhZGVyX19sb2dvXCJdLCB7XHJcblx0XHRocmVmOiBcIi9cIixcclxuXHRcdFwiYXJpYS1sYWJlbFwiOiBgJHtsb2dvTGlua31gLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGxvZ29JbWcgPSBjcmVhdGVFbGVtZW50KFxyXG5cdFx0XCJpbWdcIixcclxuXHRcdFtcImhlYWRlcl9fbG9nby1pbWdcIiwgXCJsb2dpbi1oZWFkZXJfX2xvZ28taW1nXCJdLFxyXG5cdFx0e1xyXG5cdFx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvbG9nby5zdmdcIixcclxuXHRcdFx0YWx0OiBgJHtsb2dvfWAsXHJcblx0XHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdFx0fVxyXG5cdCk7XHJcblx0Y29uc3QgbG9nb1RleHQgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXHJcblx0XHRcImhlYWRlcl9fbG9nby10ZXh0XCIsXHJcblx0XHRcImxvZ2luLWhlYWRlcl9fbG9nby10ZXh0XCIsXHJcblx0XSk7XHJcblx0bG9nb1RleHQudGV4dENvbnRlbnQgPSBcIlN0cmVhbVwiO1xyXG5cdHBhZ2VMb2dvLmFwcGVuZChsb2dvSW1nLCBsb2dvVGV4dCk7XHJcblx0aGVhZGVyLmFwcGVuZChwYWdlTG9nbyk7XHJcblx0Ly8gZW5kIG9mIGxvZ29cclxuXHJcblx0Ly8gbGFuZ3VhZ2Ugc2VsZWN0b3JcclxuXHRjb25zdCBsYW5nU2VsZWN0ID0gY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCBbXCJsb2dpbi1oZWFkZXJfX2xhbmctc2VsZWN0XCJdLCB7XHJcblx0XHRcImFyaWEtbGFiZWxcIjogYCR7Y2hhbmdlTGFuZ3VhZ2VCdXR0b259YCxcclxuXHR9KTtcclxuXHRjb25zdCBsYW5nUGxhdGZvcm1MYW5nID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgW1xyXG5cdFx0XCJsb2dpbi1oZWFkZXJfX2xhbmctcGxhdGZvcm0tbGFuZ1wiLFxyXG5cdF0pO1xyXG5cdGNvbnN0IGxhbmdBcnJvdyA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibG9naW4taGVhZGVyX19sYW5nLWFycm93XCJdLCB7XHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvY2hldnJvbi1kb3duLnN2Z1wiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdFx0d2lkdGg6IFwiMjRcIixcclxuXHRcdGhlaWdodDogXCIyNFwiLFxyXG5cdH0pO1xyXG5cdGNvbnN0IGxhbmdMaXN0ID0gY3JlYXRlRWxlbWVudChcInVsXCIsIFtcImxvZ2luLWhlYWRlcl9fbGFuZy1saXN0XCJdKTtcclxuXHJcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsYW5nQW1vdW50OyBpKyspIHtcclxuXHRcdGNvbnN0IGxhbmdDaG9pY2UgPSBjcmVhdGVFbGVtZW50KFwibGlcIiwgW1wibG9naW4taGVhZGVyX19sYW5nLWNob2ljZVwiXSwge1xyXG5cdFx0XHR0YWJpbmRleDogMCxcclxuXHRcdH0pO1xyXG5cdFx0Y29uc3QgZGF0YSA9IE9iamVjdC5rZXlzKGxhbmdOYW1lcylbaV07XHJcblx0XHRjb25zdCB0ZXh0ID0gT2JqZWN0LnZhbHVlcyhsYW5nTmFtZXMpW2ldO1xyXG5cclxuXHRcdGxhbmdDaG9pY2UuZGF0YXNldC5sYW5nID0gZGF0YTtcclxuXHRcdGxhbmdDaG9pY2UudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG5cdFx0bGFuZ0Nob2ljZS5zdHlsZS5hbmltYXRpb25EZWxheSA9IGkgKiAxMDAgKyBcIm1zXCI7XHJcblx0XHRsYW5nTGlzdC5hcHBlbmQobGFuZ0Nob2ljZSk7XHJcblx0fVxyXG5cclxuXHRsYW5nUGxhdGZvcm1MYW5nLnRleHRDb250ZW50ID0gbGFuZ05hbWVzW2xhbmd1YWdlXTtcclxuXHJcblx0bGFuZ1NlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdGhhbmRsZUxhbmdTZWxlY3QuY2FsbChsYW5nU2VsZWN0LCBlLCBsYW5nUGxhdGZvcm1MYW5nKTtcclxuXHR9KTtcclxuXHJcblx0bGFuZ1NlbGVjdC5hcHBlbmQobGFuZ1BsYXRmb3JtTGFuZywgbGFuZ0Fycm93LCBsYW5nTGlzdCk7XHJcblx0aGVhZGVyLmFwcGVuZChsYW5nU2VsZWN0KTtcclxuXHJcblx0cmV0dXJuIGhlYWRlcjtcclxuXHQvLyBlbmQgb2YgbGFuZ3VhZ2Ugc2VsZWN0b3JcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVMb2dpblBhZ2UgPSAoe1xyXG5cdG1haW46IHtcclxuXHRcdHRleHQ6IHsgdGl0bGUsIHN1YnRpdGxlLCBkZXNjcmlwdGlvbiwgYnV0dG9uIH0sXHJcblx0XHRwbGFjZWhvbGRlcjogeyB1c2VybmFtZSwgcGFzc3dvcmQgfSxcclxuXHR9LFxyXG59KSA9PiB7XHJcblx0Y29uc3QgbWFpbkNvbnRlbnQgPSBjcmVhdGVFbGVtZW50KFwibWFpblwiLCBbXCJtYWluXCJdKTtcclxuXHRjb25zdCB3cmFwcGVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJ3cmFwcGVyXCJdKTtcclxuXHRjb25zdCBsb2dpblRpdGxlID0gY3JlYXRlRWxlbWVudChcImgxXCIpO1xyXG5cdGNvbnN0IGxvZ2luVGl0bGVUb3AgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBbXCJtYWluX190aXRsZVwiXSk7XHJcblx0Y29uc3QgbG9naW5UaXRsZUJvdHRvbSA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW5fX3N1YnRpdGxlXCJdKTtcclxuXHRjb25zdCBsb2dpblRleHQgPSBjcmVhdGVFbGVtZW50KFwicFwiLCBbXCJtYWluX190ZXh0XCJdKTtcclxuXHRjb25zdCBmb3JtID0gY3JlYXRlRWxlbWVudChcImZvcm1cIiwgW1wibWFpbl9fZm9ybVwiXSk7XHJcblx0Y29uc3QgdXNlcm5hbWVJbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImlucHV0XCIsXHJcblx0XHRbXCJtYWluX19mb3JtLWlucHV0XCIsIFwibWFpbl9fZm9ybS1pbnB1dC0tdXNlcm5hbWVcIl0sXHJcblx0XHR7IHR5cGU6IFwidGV4dFwiLCBwbGFjZWhvbGRlcjogdXNlcm5hbWUgfVxyXG5cdCk7XHJcblx0Y29uc3QgcGFzc3dvcmRJbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImlucHV0XCIsXHJcblx0XHRbXCJtYWluX19mb3JtLWlucHV0XCIsIFwibWFpbl9fZm9ybS1pbnB1dC0tcGFzc3dvcmRcIl0sXHJcblx0XHR7IHR5cGU6IFwicGFzc3dvcmRcIiwgcGxhY2Vob2xkZXI6IHBhc3N3b3JkIH1cclxuXHQpO1xyXG5cdGNvbnN0IHN1Ym1pdEJ0biA9IGNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwgW1wibWFpbl9fZm9ybS1idXR0b25cIl0sIHtcclxuXHRcdHR5cGU6IFwic3VibWl0XCIsXHJcblx0fSk7XHJcblx0Y29uc3QgYnV0dG9uVGV4dCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW5fX2Zvcm0tYnV0dG9uLXRleHRcIl0pO1xyXG5cclxuXHRjb25zdCBlcnJvclR4dCA9IGNyZWF0ZUVsZW1lbnQoXCJwXCIsIFtcIm1haW5fX2Zvcm0tZXJyb3ItdHh0XCJdKTtcclxuXHRsb2dpblRpdGxlVG9wLnRleHRDb250ZW50ID0gdGl0bGU7XHJcblx0bG9naW5UaXRsZUJvdHRvbS50ZXh0Q29udGVudCA9IHN1YnRpdGxlO1xyXG5cdGxvZ2luVGV4dC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG5cdGJ1dHRvblRleHQudGV4dENvbnRlbnQgPSBidXR0b247XHJcblxyXG5cdGxvZ2luVGl0bGUuYXBwZW5kKGxvZ2luVGl0bGVUb3AsIGxvZ2luVGl0bGVCb3R0b20pO1xyXG5cdHN1Ym1pdEJ0bi5hcHBlbmQoYnV0dG9uVGV4dCk7XHJcblx0Zm9ybS5hcHBlbmQodXNlcm5hbWVJbnB1dCwgcGFzc3dvcmRJbnB1dCwgc3VibWl0QnRuLCBlcnJvclR4dCk7XHJcblxyXG5cdHdyYXBwZXIuYXBwZW5kKGxvZ2luVGl0bGUsIGxvZ2luVGV4dCwgZm9ybSk7XHJcblx0bWFpbkNvbnRlbnQuYXBwZW5kKHdyYXBwZXIpO1xyXG5cclxuXHRzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRjb25zdCB1c2VyRGF0YSA9IEpTT04ucGFyc2U/Lihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInVzZXJEYXRhXCIpKTtcclxuXHJcblx0XHRjb25zdCByZXN1bHRzID0gaGFuZGxlTG9naW5WYWxpZGF0aW9uKFxyXG5cdFx0XHRlLFxyXG5cdFx0XHR1c2VybmFtZUlucHV0LFxyXG5cdFx0XHRwYXNzd29yZElucHV0LFxyXG5cdFx0XHR0cmFuc2xhdGlvbnMubWFpbi50ZXh0LmVycm9yUmVxdWlyZWQsXHJcblx0XHRcdHRyYW5zbGF0aW9ucy5tYWluLnRleHQuZXJyb3JJbnZhbGlkLFxyXG5cdFx0XHRVU0VSTkFNRSxcclxuXHRcdFx0UEFTU1dPUkQsXHJcblx0XHRcdGVycm9yVHh0XHJcblx0XHQpO1xyXG5cclxuXHRcdGlmICghcmVzdWx0cykge1xyXG5cdFx0XHRlcnJvclR4dC5jbGFzc0xpc3QucmVtb3ZlKFwidmlzaWJsZVwiKTtcclxuXHRcdFx0ZS50YXJnZXQuYXBwZW5kKHNob3dTbWFsbExvYWRlcigpKTtcclxuXHRcdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSB0cnVlO1xyXG5cclxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdFx0ZS50YXJnZXQuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHRcdFx0XHRoaWRlU21hbGxMb2FkZXIoKTtcclxuXHJcblx0XHRcdFx0c2V0VXNlclByZWZlcmVuY2UoXCJ0cmFuc2xhdGlvbnNcIiwgdHJhbnNsYXRpb25zLCB1c2VyRGF0YSk7XHJcblx0XHRcdFx0c2V0VXNlclByZWZlcmVuY2UoXCJsb2dnZWRJblwiLCB0cnVlLCB1c2VyRGF0YSk7XHJcblx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSBcInByb2ZpbGVzLmh0bWxcIjsgLy8gcHJ6ZWrFm2NpZSBuYSBzdHJvbsSZIHogcHJvZmlsYW1pXHJcblx0XHRcdH0sIDMwMDApO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHRyZXR1cm4gbWFpbkNvbnRlbnQ7XHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVMb2dpblZhbGlkYXRpb24gPSAoXHJcblx0ZSxcclxuXHR1c2VybmFtZUlucHV0LFxyXG5cdHBhc3N3b3JkSW5wdXQsXHJcblx0cmVxdWlyZUVycm9yLFxyXG5cdGludmFsaWRFcnJvcixcclxuXHR1c2VybmFtZSxcclxuXHRwYXNzd29yZCxcclxuXHRlcnJvclR4dFxyXG4pID0+IHtcclxuXHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdGlmICh1c2VybmFtZUlucHV0LnZhbHVlLnRyaW0oKSA9PT0gXCJcIiB8fCBwYXNzd29yZElucHV0LnZhbHVlLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LmFkZChcInZpc2libGVcIik7XHJcblx0XHRlcnJvclR4dC50ZXh0Q29udGVudCA9IHJlcXVpcmVFcnJvcjtcclxuXHRcdHJldHVybiByZXF1aXJlRXJyb3I7XHJcblx0fSBlbHNlIGlmIChcclxuXHRcdHVzZXJuYW1lSW5wdXQudmFsdWUudHJpbSgpICE9PSB1c2VybmFtZSB8fFxyXG5cdFx0cGFzc3dvcmRJbnB1dC52YWx1ZS50cmltKCkgIT09IHBhc3N3b3JkXHJcblx0KSB7XHJcblx0XHRlLnRhcmdldC5kaXNhYmxlZCA9IHRydWU7XHJcblx0XHRlLnRhcmdldC5hcHBlbmQoc2hvd1NtYWxsTG9hZGVyKCkpO1xyXG5cdFx0ZXJyb3JUeHQuY2xhc3NMaXN0LnJlbW92ZShcInZpc2libGVcIik7XHJcblxyXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdGVycm9yVHh0LmNsYXNzTGlzdC5hZGQoXCJ2aXNpYmxlXCIpO1xyXG5cdFx0XHRlcnJvclR4dC50ZXh0Q29udGVudCA9IGludmFsaWRFcnJvcjtcclxuXHJcblx0XHRcdGUudGFyZ2V0LmRpc2FibGVkID0gZmFsc2U7XHJcblxyXG5cdFx0XHRoaWRlU21hbGxMb2FkZXIoKTtcclxuXHRcdH0sIDMwMDApO1xyXG5cdFx0cmV0dXJuIGludmFsaWRFcnJvcjtcclxuXHR9IGVsc2Uge1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHNob3dCaWdMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcImxvYWRpbmctYXJlYVwiXSk7XHJcblx0bG9hZGluZ0FyZWEuaW5uZXJIVE1MID0gYCAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJsb2FkZXItYmlnXCIgdmlld0JveD1cIjAgMCAxMjAgMTIwXCIgd2lkdGg9XCIxMjBcIiBoZWlnaHQ9XCIxMjBcIj5cclxuICAgICAgICAgICAgICAgIDxkZWZzPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsaW5lYXJHcmFkaWVudCBpZD1cImxvYWRlci1hY2NlbnRcIiB4MT1cIjAlXCIgeTE9XCIwJVwiIHgyPVwiMTAwJVwiIHkyPVwiMCVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMCVcIiBzdG9wLWNvbG9yPVwiIzRkYThkYVwiIHN0b3Atb3BhY2l0eT1cIjAuOFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjcwJVwiIHN0b3AtY29sb3I9XCIjNGRhOGRhXCIgc3RvcC1vcGFjaXR5PVwiMC40XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMTAwJVwiIHN0b3AtY29sb3I9XCIjNGRhOGRhXCIgc3RvcC1vcGFjaXR5PVwiMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9saW5lYXJHcmFkaWVudD5cclxuICAgICAgICAgICAgICAgIDwvZGVmcz5cclxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3M9XCJsb2FkaW5nLWNpcmNsZS1iaWdcIiByPVwiMzVcIiBjeD1cIjYwXCIgY3k9XCI2MFwiPjwvY2lyY2xlPlxyXG4gICAgICAgICAgICA8L3N2Zz5gO1xyXG5cdHJldHVybiBsb2FkaW5nQXJlYTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGhpZGVCaWdMb2FkZXIgPSAoKSA9PiB7XHJcblx0Y29uc3QgbG9hZGluZ0FyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmxvYWRpbmctYXJlYVwiKTtcclxuXHRsb2FkaW5nQXJlYT8ucmVtb3ZlKCk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc2hvd1NtYWxsTG9hZGVyID0gKCkgPT4ge1xyXG5cdGNvbnN0IGxvYWRpbmdBcmVhID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJsb2FkaW5nLWFyZWEtc21hbGxcIl0pO1xyXG5cdGxvYWRpbmdBcmVhLmlubmVySFRNTCA9IGA8c3ZnIGNsYXNzPVwibG9hZGVyLXNtYWxsXCIgdmlld0JveD1cIjAgMCAxMjAgMTIwXCIgd2lkdGg9XCIxMjBcIiBoZWlnaHQ9XCIxMjBcIj5cclxuICAgICAgICAgICAgICAgIDxkZWZzPlxyXG4gICAgICAgICAgICAgICAgICAgIDxsaW5lYXJHcmFkaWVudCBpZD1cImxvYWRlci1hY2NlbnQtc21hbGxcIiB4MT1cIjAlXCIgeTE9XCIwJVwiIHgyPVwiMTAwJVwiIHkyPVwiMCVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMCVcIiBzdG9wLWNvbG9yPVwid2hpdGVcIiBzdG9wLW9wYWNpdHk9XCIwLjhcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCI3MCVcIiBzdG9wLWNvbG9yPVwid2hpdGVcIiBzdG9wLW9wYWNpdHk9XCIwLjNcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIxMDAlXCIgc3RvcC1jb2xvcj1cIndoaXRlXCIgc3RvcC1vcGFjaXR5PVwiMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9saW5lYXJHcmFkaWVudD5cclxuICAgICAgICAgICAgICAgIDwvZGVmcz5cclxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3M9XCJsb2FkaW5nLWNpcmNsZS1zbWFsbFwiIHI9XCIxMlwiIGN4PVwiNjBcIiBjeT1cIjYwXCI+PC9jaXJjbGU+XHJcbiAgICAgICAgICAgIDwvc3ZnPmA7XHJcblxyXG5cdHJldHVybiBsb2FkaW5nQXJlYTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGhpZGVTbWFsbExvYWRlciA9ICgpID0+IHtcclxuXHRjb25zdCBsb2FkaW5nQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubG9hZGluZy1hcmVhLXNtYWxsXCIpO1xyXG5cdGxvYWRpbmdBcmVhLnJlbW92ZSgpO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVByb2ZpbGVzUGFnZSA9ICh7XHJcblx0cHJvZmlsZXM6IHtcclxuXHRcdHRleHQ6IHsgdGl0bGUsIGFkZFByb2ZpbGVJbmZvIH0sXHJcblx0XHRhcmlhOiB7IGFkZFByb2ZpbGVCdG4sIHVzZXJQcm9maWxlQnRuLCB1c2VyQnRuQ3VzdG9taXplIH0sXHJcblx0fSxcclxufSkgPT4ge1xyXG5cdGNvbnN0IHVzZXJEYXRhID0gSlNPTi5wYXJzZT8uKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidXNlckRhdGFcIikpO1xyXG5cclxuXHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRhaW5lclwiKTtcclxuXHRjb25zdCBwcm9maWxlc1BhZ2VNYWluID0gY3JlYXRlRWxlbWVudChcIm1haW5cIiwgW1wibWFpbi1wcm9maWxlc1wiXSk7XHJcblx0Y29uc3Qgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wid3JhcHBlclwiXSk7XHJcblx0Y29uc3QgcHJvZmlsZXNUaXRsZSA9IGNyZWF0ZUVsZW1lbnQoXCJoMVwiLCBbXHJcblx0XHRcIm1haW5fX3RpdGxlXCIsXHJcblx0XHRcIm1haW4tcHJvZmlsZXNfX3RpdGxlXCIsXHJcblx0XSk7XHJcblx0Y29uc3QgcHJvZmlsZXNCb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2JveFwiXSk7XHJcblxyXG5cdHByb2ZpbGVzVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcclxuXHJcblx0cHJvZmlsZXNCb3guYXBwZW5kKFxyXG5cdFx0Y3JlYXRlUHJvZmlsZUFkZEJ0bihcclxuXHRcdFx0YWRkUHJvZmlsZUJ0bixcclxuXHRcdFx0YWRkUHJvZmlsZUluZm8sXHJcblx0XHRcdHVzZXJQcm9maWxlQnRuLFxyXG5cdFx0XHRwcm9maWxlc0JveCxcclxuXHRcdFx0dXNlckJ0bkN1c3RvbWl6ZSxcclxuXHRcdFx0dXNlckJ0bkN1c3RvbWl6ZVxyXG5cdFx0KVxyXG5cdCk7XHJcblx0d3JhcHBlci5hcHBlbmQocHJvZmlsZXNUaXRsZSwgcHJvZmlsZXNCb3gpO1xyXG5cdHByb2ZpbGVzUGFnZU1haW4uYXBwZW5kKHdyYXBwZXIpO1xyXG5cclxuXHRjb250YWluZXIuYXBwZW5kKHByb2ZpbGVzUGFnZU1haW4pO1xyXG59O1xyXG5cclxuY29uc3QgY3JlYXRlUHJvZmlsZSA9IChhcmlhSW5mbywgdXNlckJ0bkluZm8sIHNhdmVCdG5BcmlhKSA9PiB7XHJcblx0Y29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlPy4obG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKSk7XHJcblx0Y29uc3QgZXhpc3RpbmdQcm9maWxlcyA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXMgfHwgW107XHJcblxyXG5cdGxldCBjb2xvcjtcclxuXHJcblx0Y29uc3QgY29sb3JzID0gW1wiI2RjNGEzNFwiLCBcIiMwNjJFNjNcIiwgXCIjRkFDMDQ0XCJdO1xyXG5cclxuXHRpZiAocHJvZmlsZXNDb3VudCA9PSAzIHx8IGV4aXN0aW5nUHJvZmlsZXMubGVuZ3RoID09PSAzKSByZXR1cm47XHJcblxyXG5cdHByb2ZpbGVzQ291bnQrKztcclxuXHRjb2xvciA9IGNvbG9yc1twcm9maWxlc0NvdW50XTtcclxuXHJcblx0Y29uc3QgdXNlclByb2ZpbGUgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX3Byb2ZpbGVcIl0pO1xyXG5cdGNvbnN0IHVzZXJBdmF0YXJCb3ggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFtcIm1haW4tcHJvZmlsZXNfX2F2YXRhclwiXSk7XHJcblx0Y29uc3QgdXNlclByb2ZpbGVCdG4gPSBjcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIFtcIm1haW4tcHJvZmlsZXNfX2J0blwiXSwge1xyXG5cdFx0XCJhcmlhLWxhYmVsXCI6IGFyaWFJbmZvLFxyXG5cdFx0XCJkYXRhLWlkXCI6IGB1c2VyLXByb2ZpbGUtJHtwcm9maWxlc0NvdW50fWAsXHJcblx0fSk7XHJcblxyXG5cdGNvbnN0IHVzZXJQcm9maWxlSW5mb0JveCA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fdXNlci1pbmZvXCJdKTtcclxuXHRjb25zdCB1c2VyUHJvZmlsZUluZm8gPSBjcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwgW1wibWFpbi1wcm9maWxlc19fbmFtZVwiXSwge1xyXG5cdFx0dHlwZTogXCJ0ZXh0XCIsXHJcblx0XHRyZWFkb25seTogdHJ1ZSxcclxuXHRcdHZhbHVlOiBgJHtcclxuXHRcdFx0ZXhpc3RpbmdQcm9maWxlc1twcm9maWxlc0NvdW50XT8udXNlcm5hbWUgfHwgXCJIYW5kc29tZSBVc2VyXCJcclxuXHRcdH0gJHtwcm9maWxlc0NvdW50fWAsXHJcblx0fSk7XHJcblx0Y29uc3QgZWRpdFVzZXJJbmZvQnRuID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiYnV0dG9uXCIsXHJcblx0XHRbXCJtYWluLXByb2ZpbGVzX19lZGl0LW5hbWVcIl0sXHJcblx0XHR7IFwiYXJpYS1sYWJlbFwiOiB1c2VyQnRuSW5mbyB9XHJcblx0KTtcclxuXHRjb25zdCBlZGl0VXNlckluZm9JY29uID0gY3JlYXRlRWxlbWVudChcImltZ1wiLCBbXCJtYWluLXByb2ZpbGVzX19lZGl0LWljb25cIl0sIHtcclxuXHRcdHdpZHRoOiBcIjI0XCIsXHJcblx0XHRoZWlnaHQ6IFwiMjRcIixcclxuXHRcdGxvYWRpbmc6IFwibGF6eVwiLFxyXG5cdFx0YWx0OiBcIlwiLFxyXG5cdFx0c3JjOiBcIi4vc3JjL2ljb25zL2VkaXQuc3ZnXCIsXHJcblx0fSk7XHJcblxyXG5cdHVzZXJQcm9maWxlQnRuLmlubmVySFRNTCA9IGA8c3ZnIGNsYXNzPVwibWFpbi1wcm9maWxlc19faW1nXCIgd2lkdGg9XCIxNTBcIiBoZWlnaHQ9XCIxNTBcIiB2aWV3Qm94PVwiMCAwIDIwMCAyMDBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+XHJcblx0PGNpcmNsZSBjeD1cIjcwXCIgY3k9XCI3MFwiIHI9XCI4XCIgZmlsbD1cIndoaXRlXCIgLz5cclxuXHQ8Y2lyY2xlIGN4PVwiMTMwXCIgY3k9XCI3MFwiIHI9XCI4XCIgZmlsbD1cIndoaXRlXCIgLz5cclxuXHQ8cGF0aCBkPVwiTTYwIDExMCBRMTAwIDE1MCAxNDAgMTEwXCIgc3Ryb2tlPVwid2hpdGVcIiBzdHJva2Utd2lkdGg9XCI2XCJcclxuXHRmaWxsPVwidHJhbnNwYXJlbnRcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgLz5cclxuXHQ8L3N2Zz5gO1xyXG5cdHVzZXJQcm9maWxlQnRuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xyXG5cclxuXHR1c2VyQXZhdGFyQm94LmFwcGVuZCh1c2VyUHJvZmlsZUJ0bik7XHJcblx0ZWRpdFVzZXJJbmZvQnRuLmFwcGVuZChlZGl0VXNlckluZm9JY29uKTtcclxuXHR1c2VyUHJvZmlsZUluZm9Cb3guYXBwZW5kKHVzZXJQcm9maWxlSW5mbywgZWRpdFVzZXJJbmZvQnRuKTtcclxuXHR1c2VyUHJvZmlsZS5hcHBlbmQodXNlckF2YXRhckJveCwgdXNlclByb2ZpbGVJbmZvQm94KTtcclxuXHJcblx0Ly8gc2V0VXNlclByZWZlcmVuY2UoXCJwcm9maWxlc0NvdW50XCIsIHByb2ZpbGVzQ291bnQsIHVzZXJEYXRhKVxyXG5cclxuXHRlZGl0VXNlckluZm9CdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRlZGl0VXNlcm5hbWUoZSwgdXNlclByb2ZpbGVJbmZvQm94LCBzYXZlQnRuQXJpYSk7XHJcblx0fSk7XHJcblxyXG5cdHJldHVybiB1c2VyUHJvZmlsZTtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZVByb2ZpbGVBZGRCdG4gPSAoXHJcblx0YXJpYUluZm8sXHJcblx0aW5mbyxcclxuXHR1c2VyQnRuQXJpYSxcclxuXHRwcm9maWxlc0JveCxcclxuXHR1c2VyQnRuSW5mbyxcclxuXHRzYXZlQnRuQXJpYVxyXG4pID0+IHtcclxuXHRjb25zdCBhZGRQcm9maWxlQm94ID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBbXCJtYWluLXByb2ZpbGVzX19hZGQtcHJvZmlsZVwiXSk7XHJcblx0Y29uc3QgYWRkUHJvZmlsZUF2YXRhciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgW1wibWFpbi1wcm9maWxlc19fYXZhdGFyXCJdKTtcclxuXHRjb25zdCBhZGRQcm9maWxlQnRuID0gY3JlYXRlRWxlbWVudChcclxuXHRcdFwiYnV0dG9uXCIsXHJcblx0XHRbXCJtYWluLXByb2ZpbGVzX19idG5cIiwgXCJtYWluLXByb2ZpbGVzX19idG4tLWFkZC1wcm9maWxlXCJdLFxyXG5cdFx0eyBcImFyaWEtbGFiZWxcIjogYXJpYUluZm8gfVxyXG5cdCk7XHJcblx0Y29uc3QgYWRkUHJvZmlsZVBsdXNJY29uID0gY3JlYXRlRWxlbWVudChcImltZ1wiLCBbXCJtYWluLXByb2ZpbGVzX19hZGQtaW1nXCJdLCB7XHJcblx0XHRzcmM6IFwiLi9zcmMvaWNvbnMvYWRkLXByb2ZpbGUuc3ZnXCIsXHJcblx0XHRsb2FkaW5nOiBcImxhenlcIixcclxuXHRcdGFsdDogXCJcIixcclxuXHR9KTtcclxuXHRjb25zdCBhZGRQcm9maWxlSW5mbyA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFtcIm1haW4tcHJvZmlsZXNfX25hbWVcIl0pO1xyXG5cclxuXHRhZGRQcm9maWxlSW5mby50ZXh0Q29udGVudCA9IGluZm87XHJcblxyXG5cdGFkZFByb2ZpbGVCdG4uYXBwZW5kKGFkZFByb2ZpbGVQbHVzSWNvbik7XHJcblx0YWRkUHJvZmlsZUF2YXRhci5hcHBlbmQoYWRkUHJvZmlsZUJ0bik7XHJcblx0YWRkUHJvZmlsZUJveC5hcHBlbmQoYWRkUHJvZmlsZUF2YXRhciwgYWRkUHJvZmlsZUluZm8pO1xyXG5cclxuXHRhZGRQcm9maWxlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcblx0XHRjb25zdCBwcm9maWxlID0gY3JlYXRlUHJvZmlsZSh1c2VyQnRuQXJpYSwgdXNlckJ0bkluZm8sIHNhdmVCdG5BcmlhKTtcclxuXHJcblx0XHRpZiAocHJvZmlsZSkge1xyXG5cdFx0XHRwcm9maWxlc0JveC5hcHBlbmQocHJvZmlsZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRhbGVydChcIk9zacSFZ25pxJl0byBtYWtzeW1hbG7EhSBsaWN6YsSZIHByb2ZpbMOzdyFcIik7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHJldHVybiBhZGRQcm9maWxlQm94O1xyXG59O1xyXG5cclxuY29uc3QgZWRpdFVzZXJuYW1lID0gKGUsIHBhcmVudCwgc2F2ZUJ0bkFyaWEpID0+IHtcclxuXHRjb25zdCBlZGl0QnRuID0gZS50YXJnZXQ7XHJcblx0Y29uc3QgbmFtZVRvRWRpdCA9IGVkaXRCdG4ucHJldmlvdXNFbGVtZW50U2libGluZztcclxuXHRjb25zdCBzYXZlQnRuID0gY3JlYXRlU2F2ZUJ0bihzYXZlQnRuQXJpYSk7XHJcblxyXG5cdGVkaXRCdG4uY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcclxuXHRzYXZlQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XHJcblxyXG5cdHBhcmVudC5hcHBlbmQoc2F2ZUJ0bik7XHJcblxyXG5cdG5hbWVUb0VkaXQuZm9jdXMoKTtcclxuXHRuYW1lVG9FZGl0LnNlbGVjdCgpO1xyXG5cdG5hbWVUb0VkaXQucmVtb3ZlQXR0cmlidXRlKFwicmVhZG9ubHlcIik7XHJcblx0bmFtZVRvRWRpdC5jbGFzc0xpc3QuYWRkKFwiZm9jdXNlZFwiKTtcclxuXHJcblx0c2F2ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHRcdHNhdmVVc2VybmFtZShlKTtcclxuXHR9KTtcclxufTtcclxuXHJcbmNvbnN0IHNhdmVVc2VybmFtZSA9IChlKSA9PiB7XHJcblx0Y29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlPy4obG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKSk7XHJcblx0Y29uc3QgZXhpc3RpbmdQcm9maWxlcyA9IHVzZXJEYXRhPy51c2VyUHJvZmlsZXMgfHwgW107XHJcblxyXG5cdGNvbnN0IHNhdmVCdG4gPSBlLnRhcmdldDtcclxuXHRjb25zdCBjbG9zZXN0UHJvZmlsZSA9IHNhdmVCdG4uY2xvc2VzdChcIi5tYWluLXByb2ZpbGVzX19wcm9maWxlXCIpO1xyXG5cdGNvbnN0IGNsb3Nlc3RQcm9maWxlSWQgPSBjbG9zZXN0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLm1haW4tcHJvZmlsZXNfX2J0blwiKVxyXG5cdFx0LmRhdGFzZXQuaWQ7XHJcblx0Y29uc29sZS5sb2coY2xvc2VzdFByb2ZpbGVJZCk7XHJcblx0Y29uc3QgY2xvc2VzdFByb2ZpbGVOYW1lID0gY2xvc2VzdFByb2ZpbGUucXVlcnlTZWxlY3RvcihcclxuXHRcdFwiLm1haW4tcHJvZmlsZXNfX25hbWVcIlxyXG5cdCk7XHJcblxyXG5cdGNvbnN0IHRlc3RPYmogPSB7XHJcblx0XHRbY2xvc2VzdFByb2ZpbGVJZF06IGNsb3Nlc3RQcm9maWxlTmFtZS52YWx1ZSxcclxuXHR9O1xyXG5cdFxyXG5cdHNldFVzZXJQcmVmZXJlbmNlKClcclxuXHJcblx0cmVzZXRTdGF0ZU9mRWRpdGluZygpO1xyXG59O1xyXG5cclxuY29uc3QgY3JlYXRlU2F2ZUJ0biA9IChzYXZlQnRuQXJpYSkgPT4ge1xyXG5cdGNvbnN0IHNhdmVVc2VySW5mb0J0biA9IGNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcImJ1dHRvblwiLFxyXG5cdFx0W1wibWFpbi1wcm9maWxlc19fc2F2ZS1uYW1lXCIsIFwiaGlkZGVuXCJdLFxyXG5cdFx0eyBcImFyaWEtbGFiZWxcIjogc2F2ZUJ0bkFyaWEgfVxyXG5cdCk7XHJcblx0Y29uc3Qgc2F2ZVVzZXJJbmZvSWNvbiA9IGNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgW1wibWFpbi1wcm9maWxlc19fc2F2ZS1pY29uXCJdLCB7XHJcblx0XHR3aWR0aDogXCIyNFwiLFxyXG5cdFx0aGVpZ2h0OiBcIjI0XCIsXHJcblx0XHRsb2FkaW5nOiBcImxhenlcIixcclxuXHRcdGFsdDogXCJcIixcclxuXHRcdHNyYzogXCIuL3NyYy9pY29ucy9zYXZlLnN2Z1wiLFxyXG5cdH0pO1xyXG5cclxuXHRzYXZlVXNlckluZm9CdG4uYXBwZW5kKHNhdmVVc2VySW5mb0ljb24pO1xyXG5cclxuXHRyZXR1cm4gc2F2ZVVzZXJJbmZvQnRuO1xyXG59O1xyXG5cclxuY29uc3QgcmVzZXRTdGF0ZU9mRWRpdGluZyA9ICgpID0+IHtcclxuXHRjb25zdCBmb2N1c2VkTmFtZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvY3VzZWRcIik7XHJcblx0Y29uc3QgYWxsU2F2ZUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1haW4tcHJvZmlsZXNfX3NhdmUtbmFtZVwiKTtcclxuXHRjb25zdCBhbGxFZGl0QnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWFpbi1wcm9maWxlc19fZWRpdC1uYW1lXCIpO1xyXG5cclxuXHRmb2N1c2VkTmFtZXMuZm9yRWFjaCgoZWwpID0+IHtcclxuXHRcdGVsLnNldEF0dHJpYnV0ZShcInJlYWRvbmx5XCIsIHRydWUpO1xyXG5cdFx0ZWwuY2xhc3NMaXN0LnJlbW92ZShcImZvY3VzZWRcIik7XHJcblx0fSk7XHJcblx0YWxsU2F2ZUJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKSk7XHJcblx0YWxsRWRpdEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKSk7XHJcbn07XHJcbiJdfQ==
